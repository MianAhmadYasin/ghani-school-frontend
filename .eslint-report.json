[{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\admin\\announcements\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\admin\\attendance\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Download' is defined but never used.","line":13,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":43},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Calculator' is defined but never used.","line":13,"column":55,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":65},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Trash2' is defined but never used.","line":14,"column":51,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":57},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FileSpreadsheet' is defined but never used.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DollarSign' is defined but never used.","line":15,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":30},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendingDown' is defined but never used.","line":15,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":56},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'showBulkForm' is assigned a value but never used.","line":33,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":22},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":35,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1753,1756],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1753,1756],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":89,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":89,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3280,3283],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3280,3283],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'bulkAttendanceMutation' is assigned a value but never used.","line":100,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":100,"endColumn":31},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":134,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":134,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4784,4787],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4784,4787],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":153,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":153,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5561,5564],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5561,5564],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":280,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":280,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9965,9968],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9965,9968],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":336,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":336,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12165,12168],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12165,12168],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":442,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":442,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17940,17943],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17940,17943],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":502,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":502,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21090,21093],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21090,21093],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":1,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":695,"column":30,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[31769,31831],"text":"\n                        Today&apos;s Report\n                      "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[31769,31831],"text":"\n                        Today&lsquo;s Report\n                      "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[31769,31831],"text":"\n                        Today&#39;s Report\n                      "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[31769,31831],"text":"\n                        Today&rsquo;s Report\n                      "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":17,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState } from 'react'\nimport { useRouter, useSearchParams } from 'next/navigation'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { toast } from '@/components/ui/toast'\nimport {\n  Calendar, Users, Clock, Upload, Download, Settings, Calculator, \n  CheckCircle, XCircle, AlertCircle, Plus, Edit2, Trash2, Eye,\n  FileSpreadsheet, DollarSign, TrendingUp, TrendingDown, Save, X,\n  FileText, BarChart3\n} from 'lucide-react'\nimport { attendanceService } from '@/services/attendanceService'\nimport { teacherService } from '@/services/teacherService'\nimport { studentService } from '@/services/studentService'\nimport { classService } from '@/services/classService'\nimport { AttendanceStatus } from '@/types'\n\ntype TabId = 'teachers' | 'students' | 'bulk' | 'reports' | 'settings'\n\nexport default function AttendancePage() {\n  const router = useRouter()\n  const searchParams = useSearchParams()\n  const queryClient = useQueryClient()\n  const [activeTab, setActiveTab] = useState<TabId>('teachers')\n  const [selectedDate, setSelectedDate] = useState(searchParams.get('date') || new Date().toISOString().split('T')[0])\n  const [selectedClass, setSelectedClass] = useState<string>(searchParams.get('class_id') || '')\n  const [showBulkForm, setShowBulkForm] = useState(false)\n  const [showCSVUpload, setShowCSVUpload] = useState(false)\n  const [editingAttendance, setEditingAttendance] = useState<any>(null)\n\n  // Fetch data\n  const { data: teachers = [] } = useQuery({\n    queryKey: ['teachers'],\n    queryFn: () => teacherService.getTeachers({ limit: 1000 }),\n  })\n\n  const { data: classes = [] } = useQuery({\n    queryKey: ['classes'],\n    queryFn: () => classService.getClasses({ limit: 1000 }),\n  })\n\n  const { data: students = [] } = useQuery({\n    queryKey: ['students', selectedClass],\n    queryFn: () => studentService.getStudents({ \n      class_id: selectedClass || undefined,\n      limit: 1000 \n    }),\n    enabled: !!selectedClass\n  })\n\n  const { data: attendanceRecords = [] } = useQuery({\n    queryKey: ['attendance', selectedDate],\n    queryFn: () => attendanceService.getAttendance({ \n      date_from: selectedDate, \n      date_to: selectedDate,\n      limit: 1000 \n      }),\n  })\n\n  // Mark attendance mutation\n  const markAttendanceMutation = useMutation({\n    mutationFn: (data: {\n      user_id: string\n      date: string\n      status: AttendanceStatus\n      remarks?: string\n    }) => {\n      // Validate date is not in the future\n      const attendanceDate = new Date(data.date)\n      const today = new Date()\n      today.setHours(23, 59, 59, 999)\n      \n      if (attendanceDate > today) {\n        throw new Error('Attendance date cannot be in the future')\n      }\n      \n      return attendanceService.markAttendance(data)\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['attendance'] })\n      toast.success('Attendance marked successfully!')\n    },\n    onError: (error: any) => {\n      const errorMessage = error?.message || \n                          error?.response?.data?.message || \n                          error?.response?.data?.detail || \n                          'Failed to mark attendance'\n      toast.error(errorMessage)\n      console.error('Attendance marking error:', error)\n    }\n  })\n\n  // Bulk attendance mutation\n  const bulkAttendanceMutation = useMutation({\n    mutationFn: (attendances: Array<{\n      user_id: string\n      date: string\n      status: AttendanceStatus\n      remarks?: string\n    }>) => {\n      // Validate all dates are not in the future\n      const today = new Date()\n      today.setHours(23, 59, 59, 999)\n      \n      for (const att of attendances) {\n        const attendanceDate = new Date(att.date)\n        if (attendanceDate > today) {\n          throw new Error(`Attendance date ${att.date} cannot be in the future`)\n        }\n      }\n      \n      return attendanceService.markBulkAttendance(attendances)\n    },\n    onSuccess: (result) => {\n      queryClient.invalidateQueries({ queryKey: ['attendance'] })\n      \n      // Show detailed success message if there were errors\n      if (result.errors && result.errors.length > 0) {\n        toast.success(\n          `Bulk attendance completed: ${result.success_count}/${result.total_count} successful. Some records had errors.`\n        )\n      } else {\n        toast.success('Bulk attendance marked successfully!')\n      }\n      \n      setShowBulkForm(false)\n    },\n    onError: (error: any) => {\n      const errorMessage = error?.message || \n                          error?.response?.data?.message || \n                          error?.response?.data?.detail || \n                          'Failed to mark bulk attendance'\n      toast.error(errorMessage)\n      console.error('Bulk attendance error:', error)\n    }\n  })\n\n  // Update attendance mutation\n  const updateAttendanceMutation = useMutation({\n    mutationFn: ({ id, data }: { id: string; data: { status?: AttendanceStatus; remarks?: string } }) =>\n      attendanceService.updateAttendance(id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['attendance'] })\n      toast.success('Attendance updated successfully!')\n      setEditingAttendance(null)\n    },\n    onError: (error: any) => {\n      toast.error(error?.response?.data?.detail || 'Failed to update attendance')\n    }\n  })\n\n  const tabs = [\n    { id: 'teachers' as TabId, name: 'Teachers Attendance', icon: Users },\n    { id: 'students' as TabId, name: 'Students Attendance', icon: Calendar },\n    { id: 'bulk' as TabId, name: 'Bulk Attendance', icon: Plus },\n    { id: 'reports' as TabId, name: 'Reports', icon: TrendingUp },\n    { id: 'settings' as TabId, name: 'Settings', icon: Settings },\n  ]\n\n  const handleMarkAttendance = (userId: string, status: AttendanceStatus) => {\n    markAttendanceMutation.mutate({\n      user_id: userId,\n      date: selectedDate,\n      status: status\n    })\n  }\n\n  const handleUpdateAttendance = (id: string, status: AttendanceStatus, remarks?: string) => {\n    updateAttendanceMutation.mutate({\n      id,\n      data: { status, remarks }\n    })\n  }\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'present':\n        return <CheckCircle className=\"h-5 w-5 text-green-600\" />\n      case 'absent':\n        return <XCircle className=\"h-5 w-5 text-red-600\" />\n      case 'late':\n        return <AlertCircle className=\"h-5 w-5 text-yellow-600\" />\n      case 'excused':\n        return <Clock className=\"h-5 w-5 text-blue-600\" />\n      default:\n        return <Clock className=\"h-5 w-5 text-gray-600\" />\n    }\n  }\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'present':\n        return 'bg-green-100 text-green-800'\n      case 'absent':\n        return 'bg-red-100 text-red-800'\n      case 'late':\n        return 'bg-yellow-100 text-yellow-800'\n      case 'excused':\n        return 'bg-blue-100 text-blue-800'\n      default:\n        return 'bg-gray-100 text-gray-800'\n    }\n  }\n\n  const getAttendanceForUser = (userId: string) => {\n    return attendanceRecords.find(record => record.user_id === userId)\n  }\n\n  return (\n    <DashboardLayout allowedRoles={['admin', 'principal', 'teacher']}>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900\">Attendance Management</h1>\n            <p className=\"text-gray-600 mt-1\">Manage teacher and student attendance</p>\n          </div>\n          <div className=\"flex gap-3\">\n            {selectedClass && (\n              <Button \n                variant=\"outline\"\n                onClick={() => router.push(`/admin/reports?type=attendance&class_id=${selectedClass}&date_from=${selectedDate}`)}\n              >\n                <BarChart3 className=\"h-4 w-4 mr-2\" />\n                Class Report\n              </Button>\n            )}\n            <Button variant=\"outline\" onClick={() => setShowCSVUpload(true)}>\n              <Upload className=\"h-4 w-4 mr-2\" />\n              Upload CSV\n            </Button>\n            <Button onClick={() => setShowBulkForm(true)}>\n              <Plus className=\"h-4 w-4 mr-2\" />\n              Bulk Attendance\n            </Button>\n          </div>\n        </div>\n\n        {/* Date Selector */}\n        <div className=\"flex gap-4 items-center\">\n          <div>\n            <Label htmlFor=\"date\">Select Date</Label>\n            <Input\n              type=\"date\"\n              id=\"date\"\n              value={selectedDate}\n              max={new Date().toISOString().split('T')[0]} // Prevent future dates\n              onChange={(e) => {\n                const dateValue = e.target.value\n                const selected = new Date(dateValue)\n                const today = new Date()\n                today.setHours(23, 59, 59, 999)\n                \n                if (selected > today) {\n                  toast.error('Cannot select a future date')\n                  return\n                }\n                \n                setSelectedDate(dateValue)\n              }}\n              className=\"w-40\"\n            />\n          </div>\n          {activeTab === 'students' && (\n            <div>\n              <Label htmlFor=\"class\">Select Class</Label>\n              <select\n                id=\"class\"\n                value={selectedClass}\n                onChange={(e) => setSelectedClass(e.target.value)}\n                className=\"flex h-10 w-48 rounded-md border border-input bg-background px-3 py-2 text-sm\"\n              >\n                <option value=\"\">Select a class</option>\n                {classes.map((classItem: any) => (\n                  <option key={classItem.id} value={classItem.id}>\n                    {classItem.name} - {classItem.section}\n                  </option>\n                ))}\n              </select>\n            </div>\n          )}\n        </div>\n\n        {/* Tab Navigation */}\n        <div className=\"border-b border-gray-200\">\n          <nav className=\"-mb-px flex space-x-8\" aria-label=\"Tabs\">\n            {tabs.map((tab) => {\n              const Icon = tab.icon\n              return (\n                <button\n                  key={tab.id}\n                  onClick={() => setActiveTab(tab.id)}\n                  className={`\n                    ${activeTab === tab.id\n                      ? 'border-blue-500 text-blue-600'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n                    }\n                    whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2\n                  `}\n                >\n                  <Icon className=\"h-5 w-5\" />\n                  {tab.name}\n                </button>\n              )\n            })}\n          </nav>\n        </div>\n\n        {/* Tab Content */}\n        <div className=\"mt-6\">\n          {/* Teachers Attendance Tab */}\n          {activeTab === 'teachers' && (\n          <Card>\n              <CardHeader>\n                <CardTitle>Teachers Attendance - {new Date(selectedDate).toLocaleDateString()}</CardTitle>\n                <CardDescription>Mark attendance for all teachers</CardDescription>\n            </CardHeader>\n            <CardContent>\n                <div className=\"overflow-x-auto\">\n                  <table className=\"w-full\">\n                    <thead>\n                      <tr className=\"border-b\">\n                        <th className=\"text-left py-3 px-4\">Teacher</th>\n                        <th className=\"text-left py-3 px-4\">Employee ID</th>\n                        <th className=\"text-center py-3 px-4\">Status</th>\n                        <th className=\"text-center py-3 px-4\">Actions</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {teachers.map((teacher: any) => {\n                        const attendance = getAttendanceForUser(teacher.user_id)\n                        return (\n                          <tr key={teacher.id} className=\"border-b hover:bg-gray-50\">\n                            <td className=\"py-3 px-4\">\n                              <div className=\"flex items-center gap-3\">\n                                <div className=\"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center\">\n                                  <Users className=\"h-4 w-4 text-blue-600\" />\n                                </div>\n                                <div>\n                                  <div className=\"font-medium\">{teacher.user?.full_name || 'Unknown'}</div>\n                                  <div className=\"text-sm text-gray-600\">{teacher.subjects?.join(', ') || 'No subjects'}</div>\n                                </div>\n                              </div>\n                            </td>\n                            <td className=\"py-3 px-4\">{teacher.employee_id}</td>\n                            <td className=\"py-3 px-4 text-center\">\n                              {attendance ? (\n                                <div className=\"flex items-center justify-center gap-2\">\n                                  {getStatusIcon(attendance.status)}\n                                  <span className={`px-2 py-1 text-xs font-medium rounded-full ${getStatusColor(attendance.status)}`}>\n                                    {attendance.status}\n                                  </span>\n                                </div>\n                              ) : (\n                                <span className=\"text-gray-400\">Not marked</span>\n                              )}\n                            </td>\n                            <td className=\"py-3 px-4 text-center\">\n                              <div className=\"flex justify-center gap-2\">\n                                {attendance ? (\n                                  <>\n                                    <Button \n                                      size=\"sm\" \n                                      variant=\"outline\"\n                                      onClick={() => setEditingAttendance(attendance)}\n                                    >\n                                      <Edit2 className=\"h-4 w-4\" />\n                                    </Button>\n                                    <Button \n                                      size=\"sm\" \n                                      variant=\"outline\"\n                                      onClick={() => handleMarkAttendance(teacher.user_id, 'present')}\n                                      disabled={markAttendanceMutation.isPending}\n                                    >\n                                      <CheckCircle className=\"h-4 w-4 text-green-600\" />\n                                    </Button>\n                                    <Button \n                                      size=\"sm\" \n                                      variant=\"outline\"\n                                      onClick={() => handleMarkAttendance(teacher.user_id, 'absent')}\n                                      disabled={markAttendanceMutation.isPending}\n                                    >\n                                      <XCircle className=\"h-4 w-4 text-red-600\" />\n                                    </Button>\n                                  </>\n                                ) : (\n                                  <div className=\"flex gap-1\">\n                                    <Button \n                                      size=\"sm\" \n                                      onClick={() => handleMarkAttendance(teacher.user_id, 'present')}\n                                      disabled={markAttendanceMutation.isPending}\n                                    >\n                                      Present\n                                    </Button>\n                                    <Button \n                                      size=\"sm\" \n                                      variant=\"outline\"\n                                      onClick={() => handleMarkAttendance(teacher.user_id, 'absent')}\n                                      disabled={markAttendanceMutation.isPending}\n                                    >\n                                      Absent\n                                    </Button>\n                                    <Button \n                                      size=\"sm\" \n                                      variant=\"outline\"\n                                      onClick={() => handleMarkAttendance(teacher.user_id, 'late')}\n                                      disabled={markAttendanceMutation.isPending}\n                                    >\n                                      Late\n                                    </Button>\n                                  </div>\n                                )}\n                              </div>\n                            </td>\n                          </tr>\n                        )\n                      })}\n                    </tbody>\n                  </table>\n                </div>\n            </CardContent>\n          </Card>\n          )}\n\n          {/* Students Attendance Tab */}\n          {activeTab === 'students' && (\n            <div className=\"space-y-6\">\n              {!selectedClass ? (\n          <Card>\n                  <CardHeader>\n                    <CardTitle>Select a Class</CardTitle>\n                    <CardDescription>Choose a class to mark student attendance</CardDescription>\n            </CardHeader>\n            <CardContent>\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                      {classes.map((classItem: any) => (\n                        <div \n                          key={classItem.id} \n                          className=\"p-4 border rounded-lg hover:border-blue-500 transition-colors cursor-pointer\"\n                          onClick={() => setSelectedClass(classItem.id)}\n                        >\n                          <div className=\"flex items-center gap-3\">\n                            <div className=\"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center\">\n                              <Calendar className=\"h-5 w-5 text-purple-600\" />\n                            </div>\n                            <div>\n                              <h4 className=\"font-medium\">{classItem.name} - {classItem.section}</h4>\n                              <p className=\"text-sm text-gray-600\">{classItem.academic_year}</p>\n                              <p className=\"text-xs text-gray-500\">\n                                Teacher: {classItem.teacher?.user?.full_name || 'Not assigned'}\n                              </p>\n                            </div>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  </CardContent>\n                </Card>\n              ) : (\n                <Card>\n                  <CardHeader>\n                    <div className=\"flex justify-between items-center\">\n                      <div>\n                        <CardTitle>Students Attendance</CardTitle>\n                        <CardDescription>\n                          {classes.find(c => c.id === selectedClass)?.name} - {classes.find(c => c.id === selectedClass)?.section}\n                        </CardDescription>\n                      </div>\n                      <div className=\"flex gap-2\">\n                        <Button \n                          variant=\"outline\"\n                          onClick={() => router.push(`/admin/reports?type=attendance&class_id=${selectedClass}&date_from=${selectedDate}`)}\n                        >\n                          <BarChart3 className=\"h-4 w-4 mr-2\" />\n                          Class Report\n                        </Button>\n                        <Button variant=\"outline\" onClick={() => setSelectedClass('')}>\n                          <X className=\"h-4 w-4 mr-2\" />\n                          Back to Classes\n                        </Button>\n                      </div>\n                    </div>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"overflow-x-auto\">\n                      <table className=\"w-full\">\n                        <thead>\n                          <tr className=\"border-b\">\n                            <th className=\"text-left py-3 px-4\">Student</th>\n                            <th className=\"text-left py-3 px-4\">Admission Number</th>\n                            <th className=\"text-center py-3 px-4\">Status</th>\n                            <th className=\"text-center py-3 px-4\">Actions</th>\n                          </tr>\n                        </thead>\n                        <tbody>\n                          {students.map((student: any) => {\n                            const attendance = getAttendanceForUser(student.user_id)\n                            return (\n                              <tr key={student.id} className=\"border-b hover:bg-gray-50\">\n                                <td className=\"py-3 px-4\">\n                                  <div className=\"flex items-center gap-3\">\n                                    <div className=\"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center\">\n                                      <Users className=\"h-4 w-4 text-green-600\" />\n                                    </div>\n                                    <div>\n                                      <div \n                                        className=\"font-medium cursor-pointer hover:text-blue-600 hover:underline\"\n                                        onClick={() => router.push(`/admin/students?student_id=${student.id}`)}\n                                        title=\"View Student Details\"\n                                      >\n                                        {student.user?.full_name || 'Unknown'}\n                                      </div>\n                                      <div className=\"text-sm text-gray-600\">{student.guardian_info?.name || 'No guardian'}</div>\n                                    </div>\n                                  </div>\n                                </td>\n                                <td className=\"py-3 px-4\">{student.admission_number}</td>\n                                <td className=\"py-3 px-4 text-center\">\n                                  {attendance ? (\n                                    <div className=\"flex items-center justify-center gap-2\">\n                                      {getStatusIcon(attendance.status)}\n                                      <span className={`px-2 py-1 text-xs font-medium rounded-full ${getStatusColor(attendance.status)}`}>\n                                        {attendance.status}\n                                      </span>\n                                    </div>\n                                  ) : (\n                                    <span className=\"text-gray-400\">Not marked</span>\n                                  )}\n                                </td>\n                                <td className=\"py-3 px-4 text-center\">\n                                  <div className=\"flex justify-center gap-1\">\n                                    <Button \n                                      size=\"sm\" \n                                      variant=\"ghost\"\n                                      onClick={() => router.push(`/admin/students?student_id=${student.id}`)}\n                                      title=\"View Student Profile\"\n                                      className=\"h-8 w-8 p-0\"\n                                    >\n                                      <Eye className=\"h-4 w-4\" />\n                                    </Button>\n                                    <Button \n                                      size=\"sm\" \n                                      variant=\"ghost\"\n                                      onClick={() => router.push(`/admin/grades?student_id=${student.id}`)}\n                                      title=\"View Grades\"\n                                      className=\"h-8 w-8 p-0\"\n                                    >\n                                      <FileText className=\"h-4 w-4\" />\n                                    </Button>\n                                    {attendance ? (\n                                      <>\n                                        <Button \n                                          size=\"sm\" \n                                          variant=\"ghost\"\n                                          onClick={() => setEditingAttendance(attendance)}\n                                          title=\"Edit Attendance\"\n                                          className=\"h-8 w-8 p-0\"\n                                        >\n                                          <Edit2 className=\"h-4 w-4\" />\n                                        </Button>\n                                        <Button \n                                          size=\"sm\" \n                                          variant=\"ghost\"\n                                          onClick={() => handleMarkAttendance(student.user_id, 'present')}\n                                          disabled={markAttendanceMutation.isPending}\n                                          title=\"Mark Present\"\n                                          className=\"h-8 w-8 p-0\"\n                                        >\n                                          <CheckCircle className=\"h-4 w-4 text-green-600\" />\n                                        </Button>\n                                        <Button \n                                          size=\"sm\" \n                                          variant=\"ghost\"\n                                          onClick={() => handleMarkAttendance(student.user_id, 'absent')}\n                                          disabled={markAttendanceMutation.isPending}\n                                          title=\"Mark Absent\"\n                                          className=\"h-8 w-8 p-0\"\n                                        >\n                                          <XCircle className=\"h-4 w-4 text-red-600\" />\n                                        </Button>\n                                      </>\n                                    ) : (\n                                      <div className=\"flex gap-1\">\n                                        <Button \n                                          size=\"sm\" \n                                          onClick={() => handleMarkAttendance(student.user_id, 'present')}\n                                          disabled={markAttendanceMutation.isPending}\n                                        >\n                                          Present\n                                        </Button>\n                                        <Button \n                                          size=\"sm\" \n                                          variant=\"outline\"\n                                          onClick={() => handleMarkAttendance(student.user_id, 'absent')}\n                                          disabled={markAttendanceMutation.isPending}\n                                        >\n                                          Absent\n                                        </Button>\n                                        <Button \n                                          size=\"sm\" \n                                          variant=\"outline\"\n                                          onClick={() => handleMarkAttendance(student.user_id, 'late')}\n                                          disabled={markAttendanceMutation.isPending}\n                                        >\n                                          Late\n                                        </Button>\n                                      </div>\n                                    )}\n                                  </div>\n                                </td>\n                              </tr>\n                            )\n                          })}\n                        </tbody>\n                      </table>\n                    </div>\n            </CardContent>\n          </Card>\n              )}\n            </div>\n          )}\n\n          {/* Bulk Attendance Tab */}\n          {activeTab === 'bulk' && (\n          <Card>\n              <CardHeader>\n                <CardTitle>Bulk Attendance</CardTitle>\n                <CardDescription>Mark attendance for multiple users at once</CardDescription>\n            </CardHeader>\n            <CardContent>\n                <div className=\"text-center py-8 text-gray-500\">\n                  <Plus className=\"h-12 w-12 mx-auto mb-3 text-gray-300\" />\n                  <p>Bulk attendance functionality coming soon...</p>\n                  <Button className=\"mt-4\" onClick={() => setShowBulkForm(true)}>\n                    <Plus className=\"h-4 w-4 mr-2\" />\n                    Start Bulk Attendance\n                  </Button>\n                </div>\n            </CardContent>\n          </Card>\n          )}\n\n          {/* Reports Tab */}\n          {activeTab === 'reports' && (\n          <Card>\n              <CardHeader>\n                <CardTitle>Attendance Reports</CardTitle>\n                <CardDescription>View attendance statistics and reports</CardDescription>\n            </CardHeader>\n            <CardContent>\n                <div className=\"space-y-4\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <Button \n                      variant=\"outline\" \n                      className=\"h-auto p-6 flex flex-col items-start\"\n                      onClick={() => router.push('/admin/reports?type=attendance')}\n                    >\n                      <BarChart3 className=\"h-8 w-8 mb-2 text-blue-600\" />\n                      <span className=\"font-semibold\">View All Attendance Reports</span>\n                      <span className=\"text-sm text-gray-600 mt-1\">Comprehensive attendance analytics</span>\n                    </Button>\n                    {selectedClass && (\n                      <Button \n                        variant=\"outline\" \n                        className=\"h-auto p-6 flex flex-col items-start\"\n                        onClick={() => router.push(`/admin/reports?type=attendance&class_id=${selectedClass}`)}\n                      >\n                        <Calendar className=\"h-8 w-8 mb-2 text-purple-600\" />\n                        <span className=\"font-semibold\">Class Attendance Report</span>\n                        <span className=\"text-sm text-gray-600 mt-1\">View attendance for selected class</span>\n                      </Button>\n                    )}\n                  </div>\n                  <div className=\"pt-4 border-t\">\n                    <p className=\"text-sm text-gray-600 mb-4\">Quick Report Links:</p>\n                    <div className=\"flex flex-wrap gap-2\">\n                      <Button \n                        size=\"sm\"\n                        variant=\"outline\"\n                        onClick={() => router.push('/admin/reports?type=attendance')}\n                      >\n                        Overall Attendance\n                      </Button>\n                      <Button \n                        size=\"sm\"\n                        variant=\"outline\"\n                        onClick={() => router.push(`/admin/reports?type=attendance&date_from=${selectedDate}`)}\n                      >\n                        Today's Report\n                      </Button>\n                      <Button \n                        size=\"sm\"\n                        variant=\"outline\"\n                        onClick={() => {\n                          const today = new Date()\n                          const monthStart = new Date(today.getFullYear(), today.getMonth(), 1).toISOString().split('T')[0]\n                          router.push(`/admin/reports?type=attendance&date_from=${monthStart}`)\n                        }}\n                      >\n                        This Month\n                      </Button>\n                    </div>\n                  </div>\n                </div>\n            </CardContent>\n          </Card>\n          )}\n\n          {/* Settings Tab */}\n          {activeTab === 'settings' && (\n          <Card>\n              <CardHeader>\n                <CardTitle>Attendance Settings</CardTitle>\n                <CardDescription>Configure attendance rules and settings</CardDescription>\n            </CardHeader>\n            <CardContent>\n                <div className=\"text-center py-8 text-gray-500\">\n                  <Settings className=\"h-12 w-12 mx-auto mb-3 text-gray-300\" />\n                  <p>Settings configuration coming soon...</p>\n                </div>\n            </CardContent>\n          </Card>\n          )}\n        </div>\n\n        {/* Edit Attendance Modal */}\n        {editingAttendance && (\n          <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50\">\n            <div className=\"w-full max-w-md rounded-lg bg-white p-6 shadow-xl\">\n              <div className=\"mb-4 flex items-center justify-between\">\n                <h2 className=\"text-2xl font-bold\">Edit Attendance</h2>\n                <button\n                  onClick={() => setEditingAttendance(null)}\n                  className=\"rounded-full p-1 hover:bg-gray-100\"\n                >\n                  <X className=\"h-5 w-5\" />\n                </button>\n              </div>\n              <div className=\"space-y-4\">\n                <div>\n                  <Label htmlFor=\"status\">Status</Label>\n              <select\n                    id=\"status\"\n                    value={editingAttendance.status}\n                    onChange={(e) => setEditingAttendance({...editingAttendance, status: e.target.value})}\n                    className=\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm\"\n                  >\n                <option value=\"present\">Present</option>\n                <option value=\"absent\">Absent</option>\n                <option value=\"late\">Late</option>\n                <option value=\"excused\">Excused</option>\n              </select>\n              </div>\n                      <div>\n                  <Label htmlFor=\"remarks\">Remarks</Label>\n                  <Input\n                    id=\"remarks\"\n                    value={editingAttendance.remarks || ''}\n                    onChange={(e) => setEditingAttendance({...editingAttendance, remarks: e.target.value})}\n                    placeholder=\"Optional remarks\"\n                  />\n                    </div>\n                    <div className=\"flex gap-2\">\n                      <Button\n                    onClick={() => handleUpdateAttendance(editingAttendance.id, editingAttendance.status, editingAttendance.remarks)}\n                    disabled={updateAttendanceMutation.isPending}\n                    className=\"flex-1\"\n                  >\n                    <Save className=\"h-4 w-4 mr-2\" />\n                    {updateAttendanceMutation.isPending ? 'Saving...' : 'Save Changes'}\n                      </Button>\n                  <Button variant=\"outline\" onClick={() => setEditingAttendance(null)}>\n                    Cancel\n                      </Button>\n                    </div>\n                  </div>\n            </div>\n              </div>\n            )}\n\n        {/* CSV Upload Modal */}\n        {showCSVUpload && (\n          <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50\">\n            <div className=\"w-full max-w-md rounded-lg bg-white p-6 shadow-xl\">\n              <div className=\"mb-4 flex items-center justify-between\">\n                <h2 className=\"text-2xl font-bold\">Upload CSV</h2>\n                <button\n                  onClick={() => setShowCSVUpload(false)}\n                  className=\"rounded-full p-1 hover:bg-gray-100\"\n                >\n                  <X className=\"h-5 w-5\" />\n                </button>\n      </div>\n              <div className=\"space-y-4\">\n                <div>\n                  <Label htmlFor=\"csv-file\">Select CSV File</Label>\n                  <Input\n                    type=\"file\"\n                    id=\"csv-file\"\n                    accept=\".csv,.xlsx\"\n                    className=\"mt-1\"\n                  />\n                </div>\n                <div className=\"text-sm text-gray-600\">\n                  <p><strong>Expected format:</strong></p>\n                  <p>• Name: Teacher/Student name</p>\n                  <p>• Date: Attendance date</p>\n                  <p>• Status: Present/Absent/Late</p>\n                </div>\n                <Button className=\"w-full\">\n                  <Upload className=\"h-4 w-4 mr-2\" />\n                  Upload File\n                </Button>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </DashboardLayout>\n  )\n}","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\admin\\classes\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'studentService' is defined but never used.","line":12,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'GraduationCap' is defined but never used.","line":17,"column":84,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":97},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'teachers' is assigned a value but never used.","line":36,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setTeachers' is assigned a value but never used.","line":36,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":36,"endColumn":31},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'studentIds' is assigned a value but never used.","line":98,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":98,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":110,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":110,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4356,4359],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4356,4359],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":366,"column":74,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":366,"endColumn":77,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15332,15335],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15332,15335],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState } from 'react'\nimport { useRouter, useSearchParams } from 'next/navigation'\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { classService } from '@/services/classService'\nimport { studentService } from '@/services/studentService'\nimport { teacherService } from '@/services/teacherService'\nimport { gradeService } from '@/services/gradeService'\nimport { attendanceService } from '@/services/attendanceService'\nimport { EntityLink } from '@/components/shared/EntityLink'\nimport { Plus, Search, Edit, Trash2, Users, Eye, X, Calendar, FileText, BarChart3, GraduationCap } from 'lucide-react'\nimport { formatDate } from '@/lib/utils'\nimport { ClassForm } from '@/components/classes/ClassForm'\nimport { StudentEnrollment } from '@/components/classes/StudentEnrollment'\nimport { Class, Teacher, Student, Grade } from '@/types'\nimport { useEffect } from 'react'\nimport { toast } from '@/components/ui/toast'\nimport { ConfirmDialog } from '@/components/shared/ConfirmDialog'\n\nexport default function ClassesPage() {\n  const router = useRouter()\n  const searchParams = useSearchParams()\n  const [search, setSearch] = useState('')\n  const [showForm, setShowForm] = useState(false)\n  const [selectedClass, setSelectedClass] = useState<Class | null>(null)\n  const [showViewModal, setShowViewModal] = useState(false)\n  const [viewClass, setViewClass] = useState<Class | null>(null)\n  const [showEnrollment, setShowEnrollment] = useState(false)\n  const [enrollmentClass, setEnrollmentClass] = useState<Class | null>(null)\n  const [teachers, setTeachers] = useState<Teacher[]>([])\n  const [confirmDialog, setConfirmDialog] = useState<{\n    open: boolean\n    title: string\n    description: string\n    onConfirm: () => void\n  }>({\n    open: false,\n    title: '',\n    description: '',\n    onConfirm: () => {},\n  })\n  const queryClient = useQueryClient()\n\n  const selectedTeacherId = searchParams.get('teacher_id')\n  const selectedClassId = searchParams.get('class_id')\n\n  const { data: classes = [], isLoading } = useQuery({\n    queryKey: ['classes', selectedTeacherId],\n    queryFn: () => classService.getClasses({ \n      teacher_id: selectedTeacherId || undefined,\n      limit: 1000 \n    }),\n  })\n\n  // Auto-open class detail if class_id is in query params\n  useEffect(() => {\n    if (selectedClassId && classes.length > 0) {\n      const classToView = classes.find((c: Class) => c.id === selectedClassId)\n      if (classToView && !viewClass) {\n        setViewClass(classToView)\n        setShowViewModal(true)\n      }\n    }\n  }, [selectedClassId, classes, viewClass])\n\n  // Fetch students for viewed class\n  const { data: classStudents = [] } = useQuery({\n    queryKey: ['class-students', viewClass?.id],\n    queryFn: () => classService.getClassStudents(viewClass!.id),\n    enabled: !!viewClass?.id,\n  })\n\n  // Fetch teacher info for viewed class\n  const { data: classTeacher } = useQuery({\n    queryKey: ['teacher', viewClass?.teacher_id],\n    queryFn: () => teacherService.getTeacher(viewClass!.teacher_id!),\n    enabled: !!viewClass?.teacher_id,\n  })\n\n  // Fetch class grades for statistics\n  const { data: classGrades = [] } = useQuery({\n    queryKey: ['class-grades', viewClass?.id],\n    queryFn: () => gradeService.getGrades({ class_id: viewClass!.id, limit: 1000 }),\n    enabled: !!viewClass?.id,\n  })\n\n  // Fetch class attendance statistics\n  const { data: classAttendance = [] } = useQuery({\n    queryKey: ['class-attendance', viewClass?.id],\n    queryFn: () => {\n      if (!viewClass || !classStudents.length) return []\n      const studentIds = classStudents.map((s: Student) => s.user_id).filter(Boolean)\n      return attendanceService.getAttendance({ limit: 1000 })\n    },\n    enabled: !!viewClass?.id && classStudents.length > 0,\n  })\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: string) => classService.deleteClass(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['classes'] })\n      toast.success('Class deleted successfully')\n    },\n    onError: (error: any) => {\n      toast.error(error.response?.data?.detail || 'Failed to delete class')\n    }\n  })\n\n  const filteredClasses = classes.filter(cls =>\n    cls.name.toLowerCase().includes(search.toLowerCase()) ||\n    cls.section.toLowerCase().includes(search.toLowerCase()) ||\n    cls.academic_year.toLowerCase().includes(search.toLowerCase())\n  )\n\n  const handleAddClass = () => {\n    setSelectedClass(null)\n    setShowForm(true)\n  }\n\n  const handleEditClass = (classData: Class) => {\n    setSelectedClass(classData)\n    setShowForm(true)\n  }\n\n  const handleViewClass = (classData: Class) => {\n    setViewClass(classData)\n    setShowViewModal(true)\n  }\n\n  const handleManageStudents = (classData: Class) => {\n    setEnrollmentClass(classData)\n    setShowEnrollment(true)\n  }\n\n  const handleDeleteClass = (classData: Class) => {\n    setConfirmDialog({\n      open: true,\n      title: 'Delete Class',\n      description: `Are you sure you want to delete ${classData.name} - ${classData.section}? This action cannot be undone.`,\n      onConfirm: () => {\n        deleteMutation.mutate(classData.id)\n      },\n    })\n  }\n\n  const handleFormSuccess = () => {\n    queryClient.invalidateQueries({ queryKey: ['classes'] })\n    setShowForm(false)\n    setSelectedClass(null)\n  }\n\n  return (\n    <DashboardLayout allowedRoles={['admin', 'principal']}>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-bold\">Classes</h1>\n            <p className=\"text-gray-600\">Manage school classes</p>\n          </div>\n          <Button onClick={handleAddClass}>\n            <Plus className=\"mr-2 h-4 w-4\" />\n            Create Class\n          </Button>\n        </div>\n\n        <Card>\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <CardTitle>All Classes</CardTitle>\n              <div className=\"flex items-center gap-2\">\n                <div className=\"relative\">\n                  <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400\" />\n                  <Input\n                    placeholder=\"Search classes...\"\n                    value={search}\n                    onChange={(e) => setSearch(e.target.value)}\n                    className=\"pl-10 w-64\"\n                  />\n                </div>\n              </div>\n            </div>\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <div className=\"text-center py-8 text-gray-500\">Loading...</div>\n            ) : filteredClasses.length === 0 ? (\n              <div className=\"text-center py-8 text-gray-500\">\n                No classes found\n              </div>\n            ) : (\n              <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\n                {filteredClasses.map((cls) => (\n                  <Card key={cls.id}>\n                    <CardHeader>\n                      <CardTitle className=\"flex items-center justify-between\">\n                        <span>\n                          {cls.name} - {cls.section}\n                        </span>\n                        <div className=\"flex items-center gap-1\">\n                          <Button \n                            size=\"sm\" \n                            variant=\"ghost\"\n                            onClick={() => handleViewClass(cls)}\n                            title=\"View Details\"\n                          >\n                            <Eye className=\"h-4 w-4\" />\n                          </Button>\n                          <Button \n                            size=\"sm\" \n                            variant=\"ghost\"\n                            onClick={() => handleEditClass(cls)}\n                            title=\"Edit Class\"\n                          >\n                            <Edit className=\"h-4 w-4\" />\n                          </Button>\n                          <Button \n                            size=\"sm\" \n                            variant=\"ghost\"\n                            onClick={() => handleDeleteClass(cls)}\n                            title=\"Delete Class\"\n                            disabled={deleteMutation.isPending}\n                          >\n                            <Trash2 className=\"h-4 w-4 text-red-600\" />\n                          </Button>\n                        </div>\n                      </CardTitle>\n                    </CardHeader>\n                    <CardContent>\n                      <div className=\"space-y-2 text-sm\">\n                        <div className=\"flex items-center justify-between\">\n                          <span className=\"text-gray-600\">Academic Year:</span>\n                          <span className=\"font-medium\">{cls.academic_year}</span>\n                        </div>\n                        <div className=\"flex items-center justify-between\">\n                          <span className=\"text-gray-600\">Teacher:</span>\n                          <span className=\"font-medium\">\n                            {cls.teacher_id ? 'Assigned' : 'Not Assigned'}\n                          </span>\n                        </div>\n                        <div className=\"mt-4 flex gap-2\">\n                          <Button \n                            size=\"sm\" \n                            className=\"flex-1\" \n                            variant=\"outline\"\n                            onClick={() => handleManageStudents(cls)}\n                          >\n                            <Users className=\"mr-2 h-4 w-4\" />\n                            Students\n                          </Button>\n                          <Button \n                            size=\"sm\" \n                            variant=\"outline\"\n                            onClick={() => router.push(`/admin/attendance?class_id=${cls.id}`)}\n                            title=\"View Attendance\"\n                          >\n                            <Calendar className=\"h-4 w-4\" />\n                          </Button>\n                          <Button \n                            size=\"sm\" \n                            variant=\"outline\"\n                            onClick={() => router.push(`/admin/grades?class_id=${cls.id}`)}\n                            title=\"View Grades\"\n                          >\n                            <FileText className=\"h-4 w-4\" />\n                          </Button>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Class Form Modal */}\n        {showForm && (\n          <ClassForm\n            classData={selectedClass || undefined}\n            onClose={() => setShowForm(false)}\n            onSuccess={handleFormSuccess}\n          />\n        )}\n\n        {/* Class View Modal */}\n        {showViewModal && viewClass && (\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n            <Card className=\"w-full max-w-2xl max-h-[90vh] overflow-y-auto\">\n              <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-4\">\n                <CardTitle>Class Details</CardTitle>\n                <Button variant=\"ghost\" size=\"sm\" onClick={() => setShowViewModal(false)}>\n                  <X className=\"h-4 w-4\" />\n                </Button>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                <div className=\"space-y-4\">\n                  <h3 className=\"text-lg font-semibold\">Class Information</h3>\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <div>\n                      <Label className=\"text-sm font-medium text-gray-600\">Class Name</Label>\n                      <p className=\"text-sm font-semibold\">{viewClass.name} - {viewClass.section}</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-gray-600\">Academic Year</Label>\n                      <p className=\"text-sm\">{viewClass.academic_year}</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-gray-600\">Class Teacher</Label>\n                      {classTeacher ? (\n                        <EntityLink \n                          href={`/admin/teachers?teacher_id=${classTeacher.id}`}\n                          variant=\"badge\"\n                        >\n                          {classTeacher.user?.full_name || classTeacher.employee_id}\n                        </EntityLink>\n                      ) : (\n                        <p className=\"text-sm\">{viewClass.teacher_id ? 'Assigned' : 'Not Assigned'}</p>\n                      )}\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-gray-600\">Created Date</Label>\n                      <p className=\"text-sm\">{formatDate(viewClass.created_at)}</p>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Class Statistics */}\n                <div className=\"space-y-4\">\n                  <h3 className=\"text-lg font-semibold\">Class Statistics</h3>\n                  <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                    <Card>\n                      <CardContent className=\"p-4\">\n                        <div className=\"flex items-center justify-between\">\n                          <div>\n                            <p className=\"text-xs text-gray-600\">Total Students</p>\n                            <p className=\"text-2xl font-bold text-blue-600\">{classStudents.length}</p>\n                          </div>\n                          <Users className=\"h-8 w-8 text-blue-600 opacity-50\" />\n                        </div>\n                      </CardContent>\n                    </Card>\n                    <Card>\n                      <CardContent className=\"p-4\">\n                        <div className=\"flex items-center justify-between\">\n                          <div>\n                            <p className=\"text-xs text-gray-600\">Total Grades</p>\n                            <p className=\"text-2xl font-bold text-purple-600\">{classGrades.length}</p>\n                          </div>\n                          <FileText className=\"h-8 w-8 text-purple-600 opacity-50\" />\n                        </div>\n                      </CardContent>\n                    </Card>\n                    <Card>\n                      <CardContent className=\"p-4\">\n                        <div className=\"flex items-center justify-between\">\n                          <div>\n                            <p className=\"text-xs text-gray-600\">Avg Attendance</p>\n                            <p className=\"text-2xl font-bold text-green-600\">\n                              {classAttendance.length > 0 \n                                ? Math.round((classAttendance.filter((a: any) => a.status === 'present').length / classAttendance.length) * 100)\n                                : 0}%\n                            </p>\n                          </div>\n                          <Calendar className=\"h-8 w-8 text-green-600 opacity-50\" />\n                        </div>\n                      </CardContent>\n                    </Card>\n                    <Card>\n                      <CardContent className=\"p-4\">\n                        <div className=\"flex items-center justify-between\">\n                          <div>\n                            <p className=\"text-xs text-gray-600\">Avg Grade</p>\n                            <p className=\"text-2xl font-bold text-orange-600\">\n                              {classGrades.length > 0\n                                ? (classGrades.reduce((sum: number, g: Grade) => sum + Number(g.marks), 0) / classGrades.length).toFixed(1)\n                                : '0'}%\n                            </p>\n                          </div>\n                          <BarChart3 className=\"h-8 w-8 text-orange-600 opacity-50\" />\n                        </div>\n                      </CardContent>\n                    </Card>\n                  </div>\n                </div>\n\n                {/* Students List Preview */}\n                {classStudents.length > 0 && (\n                  <div className=\"space-y-4\">\n                    <div className=\"flex justify-between items-center\">\n                      <h3 className=\"text-lg font-semibold\">Students ({classStudents.length})</h3>\n                      <Button\n                        variant=\"outline\"\n                        size=\"sm\"\n                        onClick={() => {\n                          setShowViewModal(false)\n                          handleManageStudents(viewClass)\n                        }}\n                      >\n                        Manage All\n                      </Button>\n                    </div>\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3 max-h-48 overflow-y-auto\">\n                      {classStudents.slice(0, 6).map((student: Student) => (\n                        <div\n                          key={student.id}\n                          className=\"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50\"\n                        >\n                          <div className=\"flex items-center gap-2\">\n                            <Users className=\"h-4 w-4 text-blue-600\" />\n                            <div>\n                              <p className=\"text-sm font-medium\">{student.user?.full_name || 'Unknown'}</p>\n                              <p className=\"text-xs text-gray-500\">{student.admission_number}</p>\n                            </div>\n                          </div>\n                          <Button\n                            size=\"sm\"\n                            variant=\"ghost\"\n                            onClick={() => {\n                              setShowViewModal(false)\n                              router.push(`/admin/students?student_id=${student.id}`)\n                            }}\n                          >\n                            <Eye className=\"h-4 w-4\" />\n                          </Button>\n                        </div>\n                      ))}\n                      {classStudents.length > 6 && (\n                        <div className=\"col-span-full text-center text-sm text-gray-500\">\n                          +{classStudents.length - 6} more students\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                )}\n\n                {/* Quick Actions */}\n                <div className=\"space-y-4\">\n                  <h3 className=\"text-lg font-semibold\">Quick Actions</h3>\n                  <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\n                    <Button \n                      variant=\"outline\" \n                      onClick={() => {\n                        setShowViewModal(false)\n                        handleManageStudents(viewClass)\n                      }}\n                      className=\"flex items-center gap-2\"\n                    >\n                      <Users className=\"h-4 w-4\" />\n                      Manage Students\n                    </Button>\n                    <Button \n                      variant=\"outline\" \n                      onClick={() => {\n                        setShowViewModal(false)\n                        router.push(`/admin/attendance?class_id=${viewClass.id}`)\n                      }}\n                      className=\"flex items-center gap-2\"\n                    >\n                      <Calendar className=\"h-4 w-4\" />\n                      View Attendance\n                    </Button>\n                    <Button \n                      variant=\"outline\" \n                      onClick={() => {\n                        setShowViewModal(false)\n                        router.push(`/admin/grades?class_id=${viewClass.id}`)\n                      }}\n                      className=\"flex items-center gap-2\"\n                    >\n                      <FileText className=\"h-4 w-4\" />\n                      View Grades\n                    </Button>\n                    <Button \n                      variant=\"outline\" \n                      onClick={() => {\n                        setShowViewModal(false)\n                        router.push(`/admin/reports?class_id=${viewClass.id}&type=academic`)\n                      }}\n                      className=\"flex items-center gap-2\"\n                    >\n                      <BarChart3 className=\"h-4 w-4\" />\n                      Class Report\n                    </Button>\n                  </div>\n                </div>\n\n                <div className=\"flex justify-end space-x-2 pt-4 border-t\">\n                  <Button variant=\"outline\" onClick={() => setShowViewModal(false)}>\n                    Close\n                  </Button>\n                  <Button onClick={() => {\n                    setShowViewModal(false)\n                    handleEditClass(viewClass)\n                  }}>\n                    Edit Class\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        )}\n\n        {/* Student Enrollment Modal */}\n        {showEnrollment && enrollmentClass && (\n          <StudentEnrollment\n            classData={enrollmentClass}\n            onClose={() => setShowEnrollment(false)}\n          />\n        )}\n\n        {/* Confirm Dialog */}\n        <ConfirmDialog\n          open={confirmDialog.open}\n          onOpenChange={(open) => setConfirmDialog({ ...confirmDialog, open })}\n          title={confirmDialog.title}\n          description={confirmDialog.description}\n          onConfirm={confirmDialog.onConfirm}\n          variant=\"destructive\"\n        />\n      </div>\n    </DashboardLayout>\n  )\n}\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\admin\\dashboard\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FileText' is defined but never used.","line":9,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getSetting' is assigned a value but never used.","line":24,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":54},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":82,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":82,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2910,2913],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2910,2913],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":83,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":83,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2993,2996],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2993,2996],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":87,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":87,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3168,3171],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3168,3171],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":88,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":88,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3244,3247],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3244,3247],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":89,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":89,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3332,3335],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3332,3335],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":90,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":90,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3417,3420],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3417,3420],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":97,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":97,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3709,3712],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3709,3712],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":102,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":102,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3918,3921],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3918,3921],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":106,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":106,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4069,4072],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4069,4072],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":109,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":109,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4245,4248],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4245,4248],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":116,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":116,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4505,4508],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4505,4508],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":117,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":117,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4603,4606],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4603,4606],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":121,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":121,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4776,4779],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4776,4779],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":124,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":124,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4909,4912],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4909,4912],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":126,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":126,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4996,4999],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4996,4999],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":129,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":129,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5131,5134],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5131,5134],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":1,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":359,"column":31,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[13895,13922],"text":"Today&apos;s Attendance Overview"},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[13895,13922],"text":"Today&lsquo;s Attendance Overview"},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[13895,13922],"text":"Today&#39;s Attendance Overview"},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[13895,13922],"text":"Today&rsquo;s Attendance Overview"},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":481,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":481,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19966,19969],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19966,19969],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":20,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { \n  Users, GraduationCap, BookOpen, DollarSign, TrendingUp, Calendar, AlertCircle, CheckCircle,\n  UserCheck, UserX, Clock, Award, Target, Activity, ArrowUpRight, ArrowDownRight,\n  FileText, Bell, Settings, BarChart3, RefreshCw\n} from 'lucide-react'\nimport { useQuery } from '@tanstack/react-query'\nimport { studentService } from '@/services/studentService'\nimport { teacherService } from '@/services/teacherService'\nimport { classService } from '@/services/classService'\nimport { gradeService } from '@/services/gradeService'\nimport { attendanceService } from '@/services/attendanceService'\nimport { financeService } from '@/services/financeService'\nimport { announcementService } from '@/services/announcementService'\nimport { useSettings } from '@/contexts/SettingsContext'\nimport Link from 'next/link'\nimport { useQueryClient } from '@tanstack/react-query'\n\nexport default function AdminDashboard() {\n  const { schoolName, currentAcademicYear, getSetting } = useSettings()\n  const queryClient = useQueryClient()\n\n  // Refresh all data\n  const handleRefresh = () => {\n    queryClient.invalidateQueries()\n  }\n\n  // Fetch all data - filter by current academic year if available\n  const academicYearFilter = currentAcademicYear?.year_name || new Date().getFullYear().toString()\n  \n  const { data: students = [] } = useQuery({\n    queryKey: ['students'],\n    queryFn: () => studentService.getStudents({ limit: 1000 }),\n  })\n\n  const { data: classes = [] } = useQuery({\n    queryKey: ['classes', academicYearFilter],\n    queryFn: () => classService.getClasses({ \n      academic_year: academicYearFilter,\n      limit: 1000 \n    }),\n  })\n\n  const { data: teachers = [] } = useQuery({\n    queryKey: ['teachers'],\n    queryFn: () => teacherService.getTeachers({ limit: 1000 }),\n  })\n\n  const { data: grades = [] } = useQuery({\n    queryKey: ['grades', academicYearFilter],\n    queryFn: () => gradeService.getGrades({ \n      academic_year: academicYearFilter,\n      limit: 1000 \n    }),\n  })\n\n  const { data: attendanceRecords = [] } = useQuery({\n    queryKey: ['attendance-recent'],\n    queryFn: () => attendanceService.getAttendance({ limit: 1000 }),\n  })\n\n  const { data: expenses = [] } = useQuery({\n    queryKey: ['expenses'],\n    queryFn: () => financeService.getExpenses({}),\n  })\n\n  const { data: donations = [] } = useQuery({\n    queryKey: ['donations'],\n    queryFn: () => financeService.getDonations({}),\n  })\n\n  const { data: announcements = [] } = useQuery({\n    queryKey: ['announcements-active'],\n    queryFn: () => announcementService.getAll({ is_active: true, limit: 5 }),\n  })\n\n  // Calculate comprehensive statistics\n  const activeStudents = students.filter((s: any) => s.status === 'active').length\n  const activeTeachers = teachers.filter((t: any) => t.status === 'active').length\n  \n  // Today's attendance\n  const today = new Date().toISOString().split('T')[0]\n  const todayAttendance = attendanceRecords.filter((a: any) => a.date === today)\n  const presentToday = todayAttendance.filter((a: any) => a.status === 'present').length\n  const absentToday = todayAttendance.filter((a: any) => a.status === 'absent').length\n  const lateToday = todayAttendance.filter((a: any) => a.status === 'late').length\n  const attendanceRate = todayAttendance.length > 0 \n    ? Math.round((presentToday / todayAttendance.length) * 100) \n    : 0\n\n  // This month's attendance\n  const currentMonth = new Date().getMonth()\n  const monthAttendance = attendanceRecords.filter((a: any) => {\n    const recordMonth = new Date(a.date).getMonth()\n    return recordMonth === currentMonth\n  })\n  const monthAttendanceRate = monthAttendance.length > 0\n    ? Math.round((monthAttendance.filter((a: any) => a.status === 'present').length / monthAttendance.length) * 100)\n    : 0\n  \n  // Academic performance\n  const passingGrades = grades.filter((g: any) => parseFloat(g.marks) >= 50).length\n  const failingGrades = grades.length - passingGrades\n  const averageGrade = grades.length > 0 \n    ? (grades.reduce((sum: number, g: any) => sum + parseFloat(g.marks), 0) / grades.length).toFixed(1)\n    : '0'\n  const passRate = grades.length > 0 \n    ? Math.round((passingGrades / grades.length) * 100)\n    : 0\n\n  // Financial overview\n  const totalExpenses = expenses.reduce((sum: number, e: any) => sum + parseFloat(e.amount), 0)\n  const totalDonations = donations.reduce((sum: number, d: any) => sum + parseFloat(d.amount), 0)\n  const financialBalance = totalDonations - totalExpenses\n\n  // This month's finances\n  const thisMonthExpenses = expenses.filter((e: any) => {\n    const expenseMonth = new Date(e.date).getMonth()\n    return expenseMonth === currentMonth\n  }).reduce((sum: number, e: any) => sum + parseFloat(e.amount), 0)\n\n  const thisMonthIncome = donations.filter((d: any) => {\n    const donationMonth = new Date(d.date).getMonth()\n    return donationMonth === currentMonth\n  }).reduce((sum: number, d: any) => sum + parseFloat(d.amount), 0)\n\n  // Main statistics cards\n  const mainStats = [\n    {\n      title: 'Total Students',\n      value: students.length,\n      subtitle: `${activeStudents} active, ${students.length - activeStudents} inactive`,\n      icon: Users,\n      color: 'text-blue-600',\n      bgColor: 'bg-blue-100',\n      trend: '+12%',\n      trendUp: true,\n      link: '/admin/students'\n    },\n    {\n      title: 'Total Teachers',\n      value: teachers.length,\n      subtitle: `${activeTeachers} active staff members`,\n      icon: GraduationCap,\n      color: 'text-green-600',\n      bgColor: 'bg-green-100',\n      trend: '+5%',\n      trendUp: true,\n      link: '/admin/teachers'\n    },\n    {\n      title: 'Active Classes',\n      value: classes.length,\n      subtitle: 'Current academic year',\n      icon: BookOpen,\n      color: 'text-purple-600',\n      bgColor: 'bg-purple-100',\n      trend: '+8%',\n      trendUp: true,\n      link: '/admin/classes'\n    },\n    {\n      title: 'Today\\'s Attendance',\n      value: `${attendanceRate}%`,\n      subtitle: `${presentToday} present, ${absentToday} absent`,\n      icon: Calendar,\n      color: 'text-yellow-600',\n      bgColor: 'bg-yellow-100',\n      trend: monthAttendanceRate > attendanceRate ? '-2%' : '+2%',\n      trendUp: monthAttendanceRate <= attendanceRate,\n      link: `/admin/attendance?date=${new Date().toISOString().split('T')[0]}`\n    },\n  ]\n\n  // Secondary statistics\n  const secondaryStats = [\n    {\n      title: 'Average Grade',\n      value: `${averageGrade}%`,\n      subtitle: `${passingGrades} passing`,\n      icon: Award,\n      color: 'text-indigo-600',\n      bgColor: 'bg-indigo-100',\n      link: '/admin/grades'\n    },\n    {\n      title: 'Pass Rate',\n      value: `${passRate}%`,\n      subtitle: `${failingGrades} need support`,\n      icon: Target,\n      color: 'text-pink-600',\n      bgColor: 'bg-pink-100',\n      link: '/admin/grades?tab=analytics'\n    },\n    {\n      title: 'Monthly Income',\n      value: `$${thisMonthIncome.toLocaleString()}`,\n      subtitle: 'This month',\n      icon: DollarSign,\n      color: 'text-green-600',\n      bgColor: 'bg-green-100',\n      link: '/admin/finance'\n    },\n    {\n      title: 'Monthly Expenses',\n      value: `$${thisMonthExpenses.toLocaleString()}`,\n      subtitle: 'This month',\n      icon: TrendingUp,\n      color: 'text-red-600',\n      bgColor: 'bg-red-100',\n      link: '/admin/finance'\n    },\n  ]\n\n  // Quick actions\n  const quickActions = [\n    { label: 'Add Student', icon: Users, link: '/admin/students', color: 'bg-blue-500 hover:bg-blue-600' },\n    { label: 'Add Teacher', icon: GraduationCap, link: '/admin/teachers', color: 'bg-green-500 hover:bg-green-600' },\n    { label: 'Create Class', icon: BookOpen, link: '/admin/classes', color: 'bg-purple-500 hover:bg-purple-600' },\n    { label: 'Mark Attendance', icon: CheckCircle, link: '/admin/attendance', color: 'bg-yellow-500 hover:bg-yellow-600' },\n    { label: 'Enter Grades', icon: Award, link: '/admin/grades', color: 'bg-indigo-500 hover:bg-indigo-600' },\n    { label: 'Finance', icon: DollarSign, link: '/admin/finance', color: 'bg-green-500 hover:bg-green-600' },\n    { label: 'Announcements', icon: Bell, link: '/admin/announcements', color: 'bg-pink-500 hover:bg-pink-600' },\n    { label: 'Settings', icon: Settings, link: '/admin/settings', color: 'bg-gray-500 hover:bg-gray-600' },\n  ]\n\n  return (\n    <DashboardLayout allowedRoles={['admin']}>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900\">{schoolName}</h1>\n            <p className=\"text-gray-600 mt-1\">\n              Dashboard - {currentAcademicYear?.year_name || 'Current Academic Year'}\n              {currentAcademicYear && (\n                <span className=\"text-sm ml-2\">\n                  ({new Date(currentAcademicYear.start_date).toLocaleDateString()} - {new Date(currentAcademicYear.end_date).toLocaleDateString()})\n                </span>\n              )}\n            </p>\n          </div>\n          <div className=\"flex gap-3\">\n            <Button variant=\"outline\" onClick={handleRefresh} title=\"Refresh Data\">\n              <RefreshCw className=\"h-4 w-4 mr-2\" />\n              Refresh\n            </Button>\n            <Link href=\"/admin/reports\">\n              <Button variant=\"outline\">\n                <BarChart3 className=\"h-4 w-4 mr-2\" />\n                View Reports\n              </Button>\n            </Link>\n            <Link href=\"/admin/settings\">\n              <Button>\n                <Settings className=\"h-4 w-4 mr-2\" />\n                Settings\n              </Button>\n            </Link>\n          </div>\n        </div>\n\n        {/* Main Statistics */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n          {mainStats.map((stat, index) => {\n            const Icon = stat.icon\n            return (\n              <Link key={index} href={stat.link}>\n                <Card className=\"hover:shadow-lg transition-shadow cursor-pointer\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex-1\">\n                        <p className=\"text-sm font-medium text-gray-600\">{stat.title}</p>\n                        <div className=\"flex items-baseline gap-2 mt-2\">\n                          <h3 className=\"text-3xl font-bold text-gray-900\">{stat.value}</h3>\n                          <span className={`text-sm font-medium flex items-center ${\n                            stat.trendUp ? 'text-green-600' : 'text-red-600'\n                          }`}>\n                            {stat.trendUp ? (\n                              <ArrowUpRight className=\"h-4 w-4\" />\n                            ) : (\n                              <ArrowDownRight className=\"h-4 w-4\" />\n                            )}\n                            {stat.trend}\n                          </span>\n                        </div>\n                        <p className=\"text-xs text-gray-500 mt-1\">{stat.subtitle}</p>\n                      </div>\n                      <div className={`${stat.bgColor} p-3 rounded-lg`}>\n                        <Icon className={`h-6 w-6 ${stat.color}`} />\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </Link>\n            )\n          })}\n        </div>\n\n        {/* Secondary Statistics */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n          {secondaryStats.map((stat, index) => {\n            const Icon = stat.icon\n            return (\n              <Link key={index} href={stat.link || '#'}>\n                <Card className=\"hover:shadow-lg transition-shadow cursor-pointer\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-center gap-4\">\n                      <div className={`${stat.bgColor} p-3 rounded-lg`}>\n                        <Icon className={`h-5 w-5 ${stat.color}`} />\n                      </div>\n                      <div>\n                        <p className=\"text-sm font-medium text-gray-600\">{stat.title}</p>\n                        <p className=\"text-2xl font-bold text-gray-900 mt-1\">{stat.value}</p>\n                        <p className=\"text-xs text-gray-500 mt-1\">{stat.subtitle}</p>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </Link>\n            )\n          })}\n        </div>\n\n        {/* Quick Actions */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Quick Actions</CardTitle>\n            <CardDescription>Frequently used actions for quick access</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-3\">\n              {quickActions.map((action, index) => {\n                const Icon = action.icon\n                return (\n                  <Link key={index} href={action.link}>\n                    <Button\n                      className={`w-full h-auto flex-col gap-2 py-4 ${action.color} text-white`}\n                      variant=\"default\"\n                    >\n                      <Icon className=\"h-6 w-6\" />\n                      <span className=\"text-xs font-medium\">{action.label}</span>\n                    </Button>\n                  </Link>\n                )\n              })}\n            </div>\n          </CardContent>\n        </Card>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n          {/* Attendance Overview */}\n          <Card>\n            <CardHeader>\n              <CardTitle>Today's Attendance Overview</CardTitle>\n              <CardDescription>Real-time attendance tracking</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-4\">\n                <div className=\"flex items-center justify-between p-4 bg-green-50 rounded-lg\">\n                  <div className=\"flex items-center gap-3\">\n                    <UserCheck className=\"h-5 w-5 text-green-600\" />\n                    <div>\n                      <p className=\"font-medium text-green-900\">Present</p>\n                      <p className=\"text-sm text-green-700\">{presentToday} students</p>\n                    </div>\n                  </div>\n                  <span className=\"text-2xl font-bold text-green-600\">\n                    {todayAttendance.length > 0 ? Math.round((presentToday / todayAttendance.length) * 100) : 0}%\n                  </span>\n                </div>\n                <div className=\"flex items-center justify-between p-4 bg-red-50 rounded-lg\">\n                  <div className=\"flex items-center gap-3\">\n                    <UserX className=\"h-5 w-5 text-red-600\" />\n                    <div>\n                      <p className=\"font-medium text-red-900\">Absent</p>\n                      <p className=\"text-sm text-red-700\">{absentToday} students</p>\n                    </div>\n                  </div>\n                  <span className=\"text-2xl font-bold text-red-600\">\n                    {todayAttendance.length > 0 ? Math.round((absentToday / todayAttendance.length) * 100) : 0}%\n                  </span>\n                </div>\n                <div className=\"flex items-center justify-between p-4 bg-yellow-50 rounded-lg\">\n                  <div className=\"flex items-center gap-3\">\n                    <Clock className=\"h-5 w-5 text-yellow-600\" />\n                    <div>\n                      <p className=\"font-medium text-yellow-900\">Late</p>\n                      <p className=\"text-sm text-yellow-700\">{lateToday} students</p>\n                    </div>\n                  </div>\n                  <span className=\"text-2xl font-bold text-yellow-600\">\n                    {todayAttendance.length > 0 ? Math.round((lateToday / todayAttendance.length) * 100) : 0}%\n                  </span>\n                </div>\n                <div className=\"mt-4\">\n                  <Link href=\"/admin/attendance\">\n                    <Button className=\"w-full\">View Full Attendance</Button>\n                  </Link>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Financial Overview */}\n          <Card>\n            <CardHeader>\n              <CardTitle>Financial Overview</CardTitle>\n              <CardDescription>Income and expenses summary</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-4\">\n                <div className=\"p-4 bg-green-50 rounded-lg\">\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <span className=\"text-sm font-medium text-green-700\">Total Income</span>\n                    <TrendingUp className=\"h-4 w-4 text-green-600\" />\n                  </div>\n                  <p className=\"text-3xl font-bold text-green-600\">\n                    ${totalDonations.toLocaleString()}\n                  </p>\n                  <p className=\"text-xs text-green-700 mt-1\">\n                    ${thisMonthIncome.toLocaleString()} this month\n                  </p>\n                </div>\n                <div className=\"p-4 bg-red-50 rounded-lg\">\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <span className=\"text-sm font-medium text-red-700\">Total Expenses</span>\n                    <TrendingUp className=\"h-4 w-4 text-red-600\" />\n                  </div>\n                  <p className=\"text-3xl font-bold text-red-600\">\n                    ${totalExpenses.toLocaleString()}\n                  </p>\n                  <p className=\"text-xs text-red-700 mt-1\">\n                    ${thisMonthExpenses.toLocaleString()} this month\n                  </p>\n                </div>\n                <div className={`p-4 rounded-lg ${financialBalance >= 0 ? 'bg-blue-50' : 'bg-orange-50'}`}>\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <span className={`text-sm font-medium ${financialBalance >= 0 ? 'text-blue-700' : 'text-orange-700'}`}>\n                      Net Balance\n                    </span>\n                    <Activity className={`h-4 w-4 ${financialBalance >= 0 ? 'text-blue-600' : 'text-orange-600'}`} />\n                  </div>\n                  <p className={`text-3xl font-bold ${financialBalance >= 0 ? 'text-blue-600' : 'text-orange-600'}`}>\n                    ${Math.abs(financialBalance).toLocaleString()}\n                  </p>\n                  <p className={`text-xs mt-1 ${financialBalance >= 0 ? 'text-blue-700' : 'text-orange-700'}`}>\n                    {financialBalance >= 0 ? 'Surplus' : 'Deficit'}\n                  </p>\n                </div>\n                <div className=\"mt-4\">\n                  <Link href=\"/admin/finance\">\n                    <Button className=\"w-full\">View Finance Details</Button>\n                  </Link>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Recent Announcements */}\n        <Card>\n          <CardHeader>\n            <div className=\"flex justify-between items-center\">\n              <div>\n                <CardTitle>Recent Announcements</CardTitle>\n                <CardDescription>Latest updates and notices</CardDescription>\n              </div>\n              <Link href=\"/admin/announcements\">\n                <Button variant=\"outline\" size=\"sm\">View All</Button>\n              </Link>\n            </div>\n          </CardHeader>\n          <CardContent>\n            {announcements.length > 0 ? (\n              <div className=\"space-y-3\">\n                {announcements.slice(0, 5).map((announcement: any) => (\n                  <div key={announcement.id} className=\"flex items-start gap-3 p-3 border rounded-lg hover:border-blue-500 transition-colors\">\n                    <Bell className=\"h-5 w-5 text-blue-600 mt-0.5\" />\n                    <div className=\"flex-1\">\n                      <p className=\"font-medium text-gray-900\">{announcement.title}</p>\n                      <p className=\"text-sm text-gray-600 mt-1 line-clamp-2\">{announcement.content}</p>\n                      <div className=\"flex items-center gap-3 mt-2 text-xs text-gray-500\">\n                        <span className=\"capitalize\">{announcement.target_audience}</span>\n                        <span>•</span>\n                        <span>{new Date(announcement.created_at).toLocaleDateString()}</span>\n                        <span className={`px-2 py-0.5 rounded-full ${\n                          announcement.priority === 'urgent' ? 'bg-red-100 text-red-700' :\n                          announcement.priority === 'high' ? 'bg-orange-100 text-orange-700' :\n                          'bg-blue-100 text-blue-700'\n                        }`}>\n                          {announcement.priority}\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            ) : (\n              <div className=\"text-center py-8 text-gray-500\">\n                <Bell className=\"h-12 w-12 mx-auto mb-3 text-gray-300\" />\n                <p>No active announcements</p>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Academic Performance */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Academic Performance Overview</CardTitle>\n            <CardDescription>Student grade distribution and trends</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n              <div className=\"text-center p-6 bg-green-50 rounded-lg\">\n                <CheckCircle className=\"h-12 w-12 text-green-600 mx-auto mb-3\" />\n                <p className=\"text-3xl font-bold text-green-600\">{passingGrades}</p>\n                <p className=\"text-sm text-green-700 mt-1\">Passing Students</p>\n                <p className=\"text-xs text-green-600 mt-2\">{passRate}% pass rate</p>\n              </div>\n              <div className=\"text-center p-6 bg-red-50 rounded-lg\">\n                <AlertCircle className=\"h-12 w-12 text-red-600 mx-auto mb-3\" />\n                <p className=\"text-3xl font-bold text-red-600\">{failingGrades}</p>\n                <p className=\"text-sm text-red-700 mt-1\">Need Support</p>\n                <p className=\"text-xs text-red-600 mt-2\">{100 - passRate}% need help</p>\n              </div>\n              <div className=\"text-center p-6 bg-blue-50 rounded-lg\">\n                <Award className=\"h-12 w-12 text-blue-600 mx-auto mb-3\" />\n                <p className=\"text-3xl font-bold text-blue-600\">{averageGrade}%</p>\n                <p className=\"text-sm text-blue-700 mt-1\">Average Grade</p>\n                <p className=\"text-xs text-blue-600 mt-2\">Across all subjects</p>\n              </div>\n            </div>\n            <div className=\"mt-6\">\n              <Link href=\"/admin/grades\">\n                <Button className=\"w-full\">View All Grades</Button>\n              </Link>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </DashboardLayout>\n  )\n}","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\admin\\events\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'formatDate' is defined but never used.","line":14,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ConfirmDialog' is defined but never used.","line":17,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":22,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1108,1111],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1108,1111],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":81,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":81,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2871,2874],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2871,2874],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":94,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":94,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3320,3323],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3320,3323],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":111,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":111,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3638,3641],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3638,3641],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":143,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":143,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4412,4415],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4412,4415],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":300,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":300,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10866,10869],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10866,10869],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState } from 'react'\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Textarea } from '@/components/ui/textarea'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { Badge } from '@/components/ui/badge'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { Plus, Search, Edit, Trash2, X, Calendar, Clock, MapPin, TrendingUp } from 'lucide-react'\nimport { formatDate } from '@/lib/utils'\nimport { eventService } from '@/services/eventService'\nimport { toast } from '@/components/ui/toast'\nimport { ConfirmDialog } from '@/components/shared/ConfirmDialog'\n\nexport default function EventsPage() {\n  const [search, setSearch] = useState('')\n  const [showForm, setShowForm] = useState(false)\n  const [selectedEvent, setSelectedEvent] = useState<any>(null)\n  const [typeFilter, setTypeFilter] = useState<string>('all')\n  const [statusFilter, setStatusFilter] = useState<string>('all')\n  const queryClient = useQueryClient()\n\n  // Form state\n  const [formData, setFormData] = useState({\n    title: '',\n    description: '',\n    date: '',\n    time: '',\n    location: '',\n    type: '',\n    status: 'upcoming'\n  })\n\n  // Fetch events from database\n  const { data: events = [], isLoading } = useQuery({\n    queryKey: ['events', typeFilter, statusFilter],\n    queryFn: () => eventService.getEvents({\n      type: typeFilter !== 'all' ? typeFilter : undefined,\n      status: statusFilter !== 'all' ? statusFilter : undefined,\n      limit: 1000\n    }),\n  })\n\n  // Fetch stats\n  const { data: stats } = useQuery({\n    queryKey: ['event-stats'],\n    queryFn: () => eventService.getEventStats(),\n  })\n\n  // Create/Update mutation\n  const saveMutation = useMutation({\n    mutationFn: async (data: typeof formData) => {\n      const eventData = {\n        title: data.title,\n        description: data.description || undefined,\n        date: data.date,\n        time: data.time || undefined,\n        location: data.location || undefined,\n        type: data.type,\n        status: data.status\n      }\n\n      if (selectedEvent) {\n        return eventService.updateEvent(selectedEvent.id, eventData)\n      } else {\n        return eventService.createEvent(eventData)\n      }\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['events'] })\n      queryClient.invalidateQueries({ queryKey: ['event-stats'] })\n      setShowForm(false)\n      setSelectedEvent(null)\n      resetForm()\n      toast.success(selectedEvent ? 'Event updated successfully!' : 'Event created successfully!')\n    },\n    onError: (error: any) => {\n      toast.error(error.response?.data?.detail || 'Failed to save event')\n    }\n  })\n\n  // Delete mutation\n  const deleteMutation = useMutation({\n    mutationFn: (id: string) => eventService.deleteEvent(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['events'] })\n      queryClient.invalidateQueries({ queryKey: ['event-stats'] })\n      toast.success('Event deleted successfully!')\n    },\n    onError: (error: any) => {\n      toast.error(error.response?.data?.detail || 'Failed to delete event')\n    }\n  })\n\n  const resetForm = () => {\n    setFormData({\n      title: '',\n      description: '',\n      date: '',\n      time: '',\n      location: '',\n      type: '',\n      status: 'upcoming'\n    })\n  }\n\n  const handleEdit = (event: any) => {\n    setSelectedEvent(event)\n    setFormData({\n      title: event.title,\n      description: event.description || '',\n      date: event.date,\n      time: event.time || '',\n      location: event.location || '',\n      type: event.type,\n      status: event.status\n    })\n    setShowForm(true)\n  }\n\n  const handleDelete = (id: string) => {\n    if (confirm('Are you sure you want to delete this event?')) {\n      deleteMutation.mutate(id)\n    }\n  }\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault()\n    \n    if (!formData.title || !formData.date || !formData.type) {\n      toast.error('Please fill all required fields')\n      return\n    }\n\n    saveMutation.mutate(formData)\n  }\n\n  // Filter by search\n  const filteredEvents = events.filter((event: any) =>\n    event.title?.toLowerCase().includes(search.toLowerCase()) ||\n    event.description?.toLowerCase().includes(search.toLowerCase()) ||\n    event.location?.toLowerCase().includes(search.toLowerCase())\n  )\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'upcoming': return 'bg-blue-100 text-blue-800'\n      case 'ongoing': return 'bg-green-100 text-green-800'\n      case 'completed': return 'bg-gray-100 text-gray-800'\n      case 'cancelled': return 'bg-red-100 text-red-800'\n      default: return 'bg-gray-100 text-gray-800'\n    }\n  }\n\n  const getTypeColor = (type: string) => {\n    switch (type) {\n      case 'academic': return 'bg-purple-100 text-purple-800'\n      case 'sports': return 'bg-orange-100 text-orange-800'\n      case 'cultural': return 'bg-pink-100 text-pink-800'\n      case 'meeting': return 'bg-yellow-100 text-yellow-800'\n      default: return 'bg-gray-100 text-gray-800'\n    }\n  }\n\n  return (\n    <DashboardLayout allowedRoles={['admin', 'principal']}>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-bold\">Events Management</h1>\n            <p className=\"text-gray-600\">Manage school events and activities</p>\n          </div>\n          <Button onClick={() => { resetForm(); setShowForm(true); setSelectedEvent(null) }}>\n            <Plus className=\"mr-2 h-4 w-4\" />\n            Add Event\n          </Button>\n        </div>\n\n        {/* Stats Cards */}\n        <div className=\"grid gap-6 md:grid-cols-4\">\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Total Events</CardTitle>\n              <Calendar className=\"h-4 w-4 text-gray-600\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">{stats?.total_events || 0}</div>\n              <p className=\"text-xs text-gray-600\">All time</p>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Upcoming</CardTitle>\n              <TrendingUp className=\"h-4 w-4 text-blue-600\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-blue-600\">{stats?.upcoming_events || 0}</div>\n              <p className=\"text-xs text-gray-600\">Scheduled</p>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">This Month</CardTitle>\n              <Calendar className=\"h-4 w-4 text-green-600\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-green-600\">{stats?.events_this_month || 0}</div>\n              <p className=\"text-xs text-gray-600\">Current month</p>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Completed</CardTitle>\n              <Calendar className=\"h-4 w-4 text-purple-600\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-purple-600\">{stats?.completed_events || 0}</div>\n              <p className=\"text-xs text-gray-600\">Finished</p>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Filters */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Filters</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid gap-4 md:grid-cols-4\">\n              <div className=\"relative\">\n                <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400\" />\n                <Input\n                  placeholder=\"Search events...\"\n                  value={search}\n                  onChange={(e) => setSearch(e.target.value)}\n                  className=\"pl-10\"\n                />\n              </div>\n\n              <Select value={typeFilter} onValueChange={setTypeFilter}>\n                <SelectTrigger>\n                  <SelectValue placeholder=\"All Types\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">All Types</SelectItem>\n                  <SelectItem value=\"academic\">Academic</SelectItem>\n                  <SelectItem value=\"sports\">Sports</SelectItem>\n                  <SelectItem value=\"cultural\">Cultural</SelectItem>\n                  <SelectItem value=\"meeting\">Meeting</SelectItem>\n                  <SelectItem value=\"other\">Other</SelectItem>\n                </SelectContent>\n              </Select>\n\n              <Select value={statusFilter} onValueChange={setStatusFilter}>\n                <SelectTrigger>\n                  <SelectValue placeholder=\"All Status\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">All Status</SelectItem>\n                  <SelectItem value=\"upcoming\">Upcoming</SelectItem>\n                  <SelectItem value=\"ongoing\">Ongoing</SelectItem>\n                  <SelectItem value=\"completed\">Completed</SelectItem>\n                  <SelectItem value=\"cancelled\">Cancelled</SelectItem>\n                </SelectContent>\n              </Select>\n\n              <Button variant=\"outline\" onClick={() => {\n                setSearch('')\n                setTypeFilter('all')\n                setStatusFilter('all')\n              }}>\n                Clear Filters\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Events List */}\n        <Card>\n          <CardHeader>\n            <CardTitle>All Events ({filteredEvents.length})</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <div className=\"text-center py-8\">Loading events...</div>\n            ) : filteredEvents.length === 0 ? (\n              <div className=\"text-center py-8 text-gray-500\">\n                No events found. Create your first event!\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                {filteredEvents.map((event: any) => (\n                  <div key={event.id} className=\"border rounded-lg p-4 hover:bg-gray-50 transition\">\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-2 mb-2\">\n                          <h3 className=\"text-lg font-semibold\">{event.title}</h3>\n                          <Badge className={getTypeColor(event.type)}>\n                            {event.type}\n                          </Badge>\n                          <Badge className={getStatusColor(event.status)}>\n                            {event.status}\n                          </Badge>\n                        </div>\n                        \n                        {event.description && (\n                          <p className=\"text-gray-600 mb-3\">{event.description}</p>\n                        )}\n                        \n                        <div className=\"flex flex-wrap gap-4 text-sm text-gray-500\">\n                          <div className=\"flex items-center gap-1\">\n                            <Calendar className=\"h-4 w-4\" />\n                            <span>{new Date(event.date).toLocaleDateString()}</span>\n                          </div>\n                          {event.time && (\n                            <div className=\"flex items-center gap-1\">\n                              <Clock className=\"h-4 w-4\" />\n                              <span>{event.time}</span>\n                            </div>\n                          )}\n                          {event.location && (\n                            <div className=\"flex items-center gap-1\">\n                              <MapPin className=\"h-4 w-4\" />\n                              <span>{event.location}</span>\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                      \n                      <div className=\"flex gap-2 ml-4\">\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => handleEdit(event)}\n                        >\n                          <Edit className=\"h-4 w-4\" />\n                        </Button>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => handleDelete(event.id)}\n                          className=\"text-red-600 hover:text-red-700\"\n                        >\n                          <Trash2 className=\"h-4 w-4\" />\n                        </Button>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Add/Edit Form Modal */}\n        {showForm && (\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\n            <Card className=\"w-full max-w-2xl max-h-[90vh] overflow-y-auto\">\n              <CardHeader>\n                <div className=\"flex items-center justify-between\">\n                  <CardTitle>{selectedEvent ? 'Edit Event' : 'Add New Event'}</CardTitle>\n                  <Button variant=\"ghost\" size=\"sm\" onClick={() => { setShowForm(false); setSelectedEvent(null); resetForm() }}>\n                    <X className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </CardHeader>\n              <CardContent>\n                <form onSubmit={handleSubmit} className=\"space-y-4\">\n                  <div>\n                    <Label>Event Title *</Label>\n                    <Input\n                      value={formData.title}\n                      onChange={(e) => setFormData({...formData, title: e.target.value})}\n                      placeholder=\"e.g., Annual Sports Day\"\n                      required\n                    />\n                  </div>\n\n                  <div>\n                    <Label>Description</Label>\n                    <Textarea\n                      value={formData.description}\n                      onChange={(e) => setFormData({...formData, description: e.target.value})}\n                      placeholder=\"Event details and information...\"\n                      rows={3}\n                    />\n                  </div>\n\n                  <div className=\"grid gap-4 md:grid-cols-2\">\n                    <div>\n                      <Label>Date *</Label>\n                      <Input\n                        type=\"date\"\n                        value={formData.date}\n                        onChange={(e) => setFormData({...formData, date: e.target.value})}\n                        required\n                      />\n                    </div>\n\n                    <div>\n                      <Label>Time</Label>\n                      <Input\n                        type=\"time\"\n                        value={formData.time}\n                        onChange={(e) => setFormData({...formData, time: e.target.value})}\n                      />\n                    </div>\n\n                    <div>\n                      <Label>Event Type *</Label>\n                      <Select value={formData.type} onValueChange={(value) => setFormData({...formData, type: value})}>\n                        <SelectTrigger>\n                          <SelectValue placeholder=\"Select type\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"academic\">Academic</SelectItem>\n                          <SelectItem value=\"sports\">Sports</SelectItem>\n                          <SelectItem value=\"cultural\">Cultural</SelectItem>\n                          <SelectItem value=\"meeting\">Meeting</SelectItem>\n                          <SelectItem value=\"other\">Other</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </div>\n\n                    <div>\n                      <Label>Status *</Label>\n                      <Select value={formData.status} onValueChange={(value) => setFormData({...formData, status: value})}>\n                        <SelectTrigger>\n                          <SelectValue placeholder=\"Select status\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"upcoming\">Upcoming</SelectItem>\n                          <SelectItem value=\"ongoing\">Ongoing</SelectItem>\n                          <SelectItem value=\"completed\">Completed</SelectItem>\n                          <SelectItem value=\"cancelled\">Cancelled</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </div>\n                  </div>\n\n                  <div>\n                    <Label>Location</Label>\n                    <Input\n                      value={formData.location}\n                      onChange={(e) => setFormData({...formData, location: e.target.value})}\n                      placeholder=\"e.g., School Auditorium\"\n                    />\n                  </div>\n\n                  <div className=\"flex justify-end gap-2 pt-4\">\n                    <Button type=\"button\" variant=\"outline\" onClick={() => { setShowForm(false); setSelectedEvent(null); resetForm() }}>\n                      Cancel\n                    </Button>\n                    <Button type=\"submit\" disabled={saveMutation.isPending}>\n                      {saveMutation.isPending ? 'Saving...' : selectedEvent ? 'Update Event' : 'Create Event'}\n                    </Button>\n                  </div>\n                </form>\n              </CardContent>\n            </Card>\n          </div>\n        )}\n      </div>\n    </DashboardLayout>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\admin\\exams\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Input' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Edit' is defined but never used.","line":15,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Calendar' is defined but never used.","line":15,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":46},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Filter' is defined but never used.","line":15,"column":48,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":54},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'XCircle' is defined but never used.","line":16,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":16,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":30},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendingUp' is defined but never used.","line":16,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":52},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":38,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1651,1654],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1651,1654],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":58,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":58,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2405,2408],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2405,2408],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":103,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":103,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4110,4113],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4110,4113],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { Badge } from '@/components/ui/badge'\nimport { toast } from '@/components/ui/toast'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { \n  Plus, Edit, Trash2, Eye, BookOpen, Calendar, Filter,\n  CheckCircle, XCircle, Clock, FileText, TrendingUp\n} from 'lucide-react'\nimport { examService } from '@/services/examService'\nimport { classService } from '@/services/classService'\nimport { Exam, ExamStatus } from '@/types'\nimport { CardGridSkeleton } from '@/components/shared/LoadingSkeleton'\nimport { ErrorBoundary } from '@/components/shared/ErrorBoundary'\n\nexport default function AdminExamsPage() {\n  const router = useRouter()\n  const queryClient = useQueryClient()\n  const [selectedClass, setSelectedClass] = useState<string>('all')\n  const [selectedStatus, setSelectedStatus] = useState<string>('all')\n  const [selectedTerm, setSelectedTerm] = useState<string>('all')\n\n  // Fetch all classes\n  const { data: classes = [] } = useQuery({\n    queryKey: ['all-classes'],\n    queryFn: () => classService.getClasses({ limit: 1000 }),\n  })\n\n  // Create classes map for quick lookup\n  const classesMap = new Map(classes.map((cls: any) => [cls.id, cls]))\n\n  // Fetch exams with filters\n  const { data: exams = [], isLoading } = useQuery({\n    queryKey: ['all-exams', selectedClass, selectedStatus, selectedTerm],\n    queryFn: () => examService.getExams({ \n      class_id: selectedClass === 'all' ? undefined : selectedClass,\n      status: selectedStatus === 'all' ? undefined : selectedStatus,\n      term: selectedTerm === 'all' ? undefined : selectedTerm,\n      limit: 1000 \n    }),\n  })\n\n  // Delete exam mutation\n  const deleteExamMutation = useMutation({\n    mutationFn: (id: string) => examService.deleteExam(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['all-exams'] })\n      toast.success('Exam deleted successfully!')\n    },\n    onError: (error: any) => {\n      toast.error(error?.message || 'Failed to delete exam')\n    }\n  })\n\n  const getStatusBadge = (status: ExamStatus) => {\n    switch (status) {\n      case 'published':\n        return <Badge className=\"bg-green-100 text-green-800\"><CheckCircle className=\"h-3 w-3 mr-1\" />Published</Badge>\n      case 'completed':\n        return <Badge className=\"bg-blue-100 text-blue-800\">Completed</Badge>\n      case 'archived':\n        return <Badge className=\"bg-gray-100 text-gray-800\">Archived</Badge>\n      default:\n        return <Badge variant=\"outline\">Draft</Badge>\n    }\n  }\n\n  return (\n    <DashboardLayout allowedRoles={['admin', 'principal']}>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900\">Exam Management</h1>\n            <p className=\"text-gray-600 mt-1\">View and manage all exams across the school</p>\n          </div>\n          <Button onClick={() => router.push('/teacher/exams')}>\n            <Plus className=\"h-4 w-4 mr-2\" />\n            Create Exam\n          </Button>\n        </div>\n\n        {/* Filters */}\n        <Card>\n          <CardContent className=\"p-6\">\n            <div className=\"grid gap-4 md:grid-cols-3\">\n              <div>\n                <Label>Filter by Class</Label>\n                <Select value={selectedClass} onValueChange={setSelectedClass}>\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"All Classes\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">All Classes</SelectItem>\n                    {classes.map((cls: any) => (\n                      <SelectItem key={cls.id} value={cls.id}>\n                        {cls.name} - {cls.section}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div>\n                <Label>Filter by Status</Label>\n                <Select value={selectedStatus} onValueChange={setSelectedStatus}>\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"All Statuses\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">All Statuses</SelectItem>\n                    <SelectItem value=\"draft\">Draft</SelectItem>\n                    <SelectItem value=\"published\">Published</SelectItem>\n                    <SelectItem value=\"completed\">Completed</SelectItem>\n                    <SelectItem value=\"archived\">Archived</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div>\n                <Label>Filter by Term</Label>\n                <Select value={selectedTerm} onValueChange={setSelectedTerm}>\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"All Terms\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">All Terms</SelectItem>\n                    <SelectItem value=\"First Term\">First Term</SelectItem>\n                    <SelectItem value=\"Second Term\">Second Term</SelectItem>\n                    <SelectItem value=\"Third Term\">Third Term</SelectItem>\n                    <SelectItem value=\"Final\">Final / Annual</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Exams List */}\n        <ErrorBoundary>\n          {isLoading ? (\n            <CardGridSkeleton count={6} />\n          ) : exams.length === 0 ? (\n            <Card>\n              <CardContent className=\"p-12 text-center text-gray-500\">\n                <BookOpen className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n                <p className=\"text-lg font-medium mb-2\">No Exams Found</p>\n                <p className=\"mb-4\">No exams match your filters or no exams have been created yet</p>\n                <Button \n                  variant=\"outline\" \n                  onClick={() => router.push('/teacher/exams')}\n                >\n                  Create Your First Exam\n                </Button>\n              </CardContent>\n            </Card>\n          ) : (\n          <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\n            {exams.map((exam: Exam) => (\n              <Card key={exam.id} className=\"hover:shadow-lg transition-shadow\">\n                <CardHeader>\n                  <div className=\"flex justify-between items-start\">\n                    <CardTitle className=\"text-lg\">{exam.exam_name}</CardTitle>\n                    {getStatusBadge(exam.status)}\n                  </div>\n                  <div className=\"flex items-center gap-2 text-sm text-gray-600 mt-2\">\n                    <FileText className=\"h-4 w-4\" />\n                    <span>{exam.subject}</span>\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-2 text-sm mb-4\">\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-gray-600\">Class:</span>\n                      <span className=\"font-medium\">\n                        {classesMap.get(exam.class_id) \n                          ? `${classesMap.get(exam.class_id)!.name} - ${classesMap.get(exam.class_id)!.section}`\n                          : exam.class_id}\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-gray-600\">Term:</span>\n                      <span className=\"font-medium\">{exam.term}</span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-gray-600\">Academic Year:</span>\n                      <span className=\"font-medium\">{exam.academic_year}</span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-gray-600\">Total Marks:</span>\n                      <span className=\"font-medium\">{exam.total_marks}</span>\n                    </div>\n                    {exam.exam_date && (\n                      <div className=\"flex justify-between\">\n                        <span className=\"text-gray-600\">Date:</span>\n                        <span className=\"font-medium\">{new Date(exam.exam_date).toLocaleDateString()}</span>\n                      </div>\n                    )}\n                  </div>\n                  <div className=\"flex gap-2\">\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      className=\"flex-1\"\n                      onClick={() => router.push(`/admin/results?exam_id=${exam.id}`)}\n                    >\n                      <Eye className=\"h-4 w-4 mr-1\" />\n                      View Results\n                    </Button>\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      onClick={() => deleteExamMutation.mutate(exam.id)}\n                      disabled={deleteExamMutation.isPending}\n                      className=\"text-red-600 hover:text-red-700\"\n                    >\n                      <Trash2 className=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n          )}\n        </ErrorBoundary>\n      </div>\n    </DashboardLayout>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\admin\\finance\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Filter' is defined but never used.","line":24,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Calendar' is defined but never used.","line":26,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ConfirmDialog' is defined but never used.","line":34,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":42,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":42,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1421,1424],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1421,1424],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":44,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":44,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1545,1548],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1545,1548],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":46,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1673,1676],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1673,1676],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":48,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":48,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1793,1796],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1793,1796],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'confirmDialog' is assigned a value but never used.","line":49,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":49,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setConfirmDialog' is assigned a value but never used.","line":49,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":49,"endColumn":41},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":489,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":489,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[21095,21098],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[21095,21098],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":576,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":576,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[25358,25361],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[25358,25361],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":672,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":672,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[30265,30268],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[30265,30268],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\nimport { useState } from 'react'\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { useQuery, useQueryClient } from '@tanstack/react-query'\nimport { financeService } from '@/services/financeService'\nimport {\n  Package,\n  DollarSign,\n  TrendingUp,\n  TrendingDown,\n  Heart,\n  Plus,\n  AlertTriangle,\n  Receipt,\n  Wallet,\n  PieChart,\n  CreditCard,\n  FileText,\n  Search,\n  Filter,\n  Download,\n  Calendar\n} from 'lucide-react'\nimport { formatCurrency } from '@/lib/utils'\nimport { StationeryItemForm } from '@/components/finance/StationeryItemForm'\nimport { ExpenseForm } from '@/components/finance/ExpenseForm'\nimport { DonationForm } from '@/components/finance/DonationForm'\nimport { SalaryForm } from '@/components/finance/SalaryForm'\nimport { toast } from '@/components/ui/toast'\nimport { ConfirmDialog } from '@/components/shared/ConfirmDialog'\n\ntype FinanceTab = 'overview' | 'expenses' | 'income' | 'stationery' | 'salaries' | 'reports'\n\nexport default function FinancePage() {\n  const queryClient = useQueryClient()\n  const [activeTab, setActiveTab] = useState<FinanceTab>('overview')\n  const [showItemForm, setShowItemForm] = useState(false)\n  const [editItem, setEditItem] = useState<any>(null)\n  const [showExpenseForm, setShowExpenseForm] = useState(false)\n  const [editExpense, setEditExpense] = useState<any>(null)\n  const [showDonationForm, setShowDonationForm] = useState(false)\n  const [editDonation, setEditDonation] = useState<any>(null)\n  const [showSalaryForm, setShowSalaryForm] = useState(false)\n  const [editSalary, setEditSalary] = useState<any>(null)\n  const [confirmDialog, setConfirmDialog] = useState<{\n    open: boolean\n    title: string\n    description: string\n    onConfirm: () => void\n  }>({\n    open: false,\n    title: '',\n    description: '',\n    onConfirm: () => {},\n  })\n  \n  // Filters\n  const [dateFilter, setDateFilter] = useState(new Date().toISOString().split('T')[0])\n  const [categoryFilter, setCategoryFilter] = useState('')\n  const [searchTerm, setSearchTerm] = useState('')\n\n  const { data: stationeryItems = [] } = useQuery({\n    queryKey: ['stationery-items'],\n    queryFn: () => financeService.getStationeryItems(),\n  })\n\n  const { data: expenses = [] } = useQuery({\n    queryKey: ['expenses'],\n    queryFn: () => financeService.getExpenses(),\n  })\n\n  const { data: donations = [] } = useQuery({\n    queryKey: ['donations'],\n    queryFn: () => financeService.getDonations(),\n  })\n\n  const { data: salaries = [] } = useQuery({\n    queryKey: ['salaries'],\n    queryFn: () => financeService.getSalaryRecords(),\n  })\n\n  // Calculate financial metrics\n  const lowStockItems = stationeryItems.filter(\n    item => item.quantity <= item.reorder_level\n  )\n\n  const totalExpenses = expenses.reduce((sum, exp) => sum + exp.amount, 0)\n  const totalDonations = donations.reduce((sum, don) => sum + don.amount, 0)\n  const totalSalaries = salaries.reduce((sum, sal) => sum + sal.net_salary, 0)\n  const totalStationeryValue = stationeryItems.reduce((sum, item) => sum + (item.quantity * 10), 0) // Assuming avg price\n  \n  // Monthly breakdown\n  const currentMonth = new Date().getMonth()\n  const currentYear = new Date().getFullYear()\n  \n  const monthlyExpenses = expenses.filter(exp => {\n    const expDate = new Date(exp.date)\n    return expDate.getMonth() === currentMonth && expDate.getFullYear() === currentYear\n  }).reduce((sum, exp) => sum + exp.amount, 0)\n\n  const monthlyDonations = donations.filter(don => {\n    const donDate = new Date(don.date)\n    return donDate.getMonth() === currentMonth && donDate.getFullYear() === currentYear\n  }).reduce((sum, don) => sum + don.amount, 0)\n\n  // Category breakdown\n  const expensesByCategory = expenses.reduce((acc, exp) => {\n    acc[exp.category] = (acc[exp.category] || 0) + exp.amount\n    return acc\n  }, {} as Record<string, number>)\n\n  const netBalance = totalDonations - totalExpenses - totalSalaries\n\n  const stats = [\n    {\n      title: 'Total Income',\n      value: formatCurrency(totalDonations),\n      icon: TrendingUp,\n      color: 'text-green-600',\n      bgColor: 'bg-green-100',\n      change: '+12% from last month'\n    },\n    {\n      title: 'Total Expenses',\n      value: formatCurrency(totalExpenses),\n      icon: TrendingDown,\n      color: 'text-red-600',\n      bgColor: 'bg-red-100',\n      change: '-5% from last month'\n    },\n    {\n      title: 'Salary Payouts',\n      value: formatCurrency(totalSalaries),\n      icon: Wallet,\n      color: 'text-blue-600',\n      bgColor: 'bg-blue-100',\n      change: 'On track'\n    },\n    {\n      title: 'Net Balance',\n      value: formatCurrency(netBalance),\n      icon: DollarSign,\n      color: netBalance >= 0 ? 'text-green-600' : 'text-red-600',\n      bgColor: netBalance >= 0 ? 'bg-green-100' : 'bg-red-100',\n      change: netBalance >= 0 ? 'Positive' : 'Deficit'\n    },\n    {\n      title: 'Stationery Value',\n      value: formatCurrency(totalStationeryValue),\n      icon: Package,\n      color: 'text-purple-600',\n      bgColor: 'bg-purple-100',\n      change: `${stationeryItems.length} items`\n    },\n    {\n      title: 'Low Stock Alert',\n      value: lowStockItems.length.toString(),\n      icon: AlertTriangle,\n      color: 'text-yellow-600',\n      bgColor: 'bg-yellow-100',\n      change: 'Needs attention'\n    },\n  ]\n\n  const tabs = [\n    { id: 'overview' as FinanceTab, name: 'Overview', icon: PieChart },\n    { id: 'expenses' as FinanceTab, name: 'Expenses', icon: Receipt },\n    { id: 'income' as FinanceTab, name: 'Income & Donations', icon: Heart },\n    { id: 'stationery' as FinanceTab, name: 'Stationery', icon: Package },\n    { id: 'salaries' as FinanceTab, name: 'Salaries', icon: Wallet },\n    { id: 'reports' as FinanceTab, name: 'Reports', icon: FileText },\n  ]\n\n  return (\n    <DashboardLayout allowedRoles={['admin', 'principal']}>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex justify-between items-start\">\n          <div>\n            <h1 className=\"text-3xl font-bold\">Finance Management</h1>\n            <p className=\"text-gray-600 mt-1\">\n              Comprehensive financial tracking and management system\n            </p>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button variant=\"outline\" className=\"gap-2\">\n              <Download className=\"h-4 w-4\" />\n              Export\n            </Button>\n            <Button variant=\"outline\" className=\"gap-2\">\n              <FileText className=\"h-4 w-4\" />\n              Generate Report\n            </Button>\n          </div>\n        </div>\n\n        {/* Statistics Grid */}\n        <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6\">\n          {stats.map((stat) => {\n            const Icon = stat.icon\n            return (\n              <Card key={stat.title} className=\"hover:shadow-lg transition-shadow\">\n                <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                  <CardTitle className=\"text-sm font-medium\">\n                    {stat.title}\n                  </CardTitle>\n                  <div className={`rounded-full p-2 ${stat.bgColor}`}>\n                    <Icon className={`h-4 w-4 ${stat.color}`} />\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  <div className={`text-2xl font-bold ${stat.color}`}>{stat.value}</div>\n                  <p className=\"text-xs text-gray-600 mt-1\">{stat.change}</p>\n                </CardContent>\n              </Card>\n            )\n          })}\n        </div>\n\n        {/* Tab Navigation */}\n        <div className=\"border-b border-gray-200\">\n          <nav className=\"-mb-px flex space-x-8\" aria-label=\"Tabs\">\n            {tabs.map((tab) => {\n              const Icon = tab.icon\n              return (\n                <button\n                  key={tab.id}\n                  onClick={() => setActiveTab(tab.id)}\n                  className={`\n                    ${activeTab === tab.id\n                      ? 'border-blue-500 text-blue-600'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n                    }\n                    whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2\n                  `}\n                >\n                  <Icon className=\"h-5 w-5\" />\n                  {tab.name}\n                </button>\n              )\n            })}\n          </nav>\n        </div>\n\n        {/* Tab Content */}\n        <div className=\"mt-6\">\n          {/* OVERVIEW TAB */}\n          {activeTab === 'overview' && (\n            <div className=\"space-y-6\">\n              {/* Monthly Summary */}\n              <Card>\n                <CardHeader>\n                  <CardTitle>Monthly Summary</CardTitle>\n                  <CardDescription>\n                    Financial overview for {new Date().toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"grid gap-4 md:grid-cols-3\">\n                    <div className=\"rounded-lg border p-4\">\n                      <div className=\"flex items-center justify-between\">\n                        <p className=\"text-sm font-medium text-gray-600\">Income</p>\n                        <TrendingUp className=\"h-4 w-4 text-green-600\" />\n                      </div>\n                      <p className=\"text-2xl font-bold text-green-600 mt-2\">\n                        {formatCurrency(monthlyDonations)}\n                      </p>\n                      <p className=\"text-xs text-gray-600 mt-1\">This month</p>\n                    </div>\n                    <div className=\"rounded-lg border p-4\">\n                      <div className=\"flex items-center justify-between\">\n                        <p className=\"text-sm font-medium text-gray-600\">Expenses</p>\n                        <TrendingDown className=\"h-4 w-4 text-red-600\" />\n                      </div>\n                      <p className=\"text-2xl font-bold text-red-600 mt-2\">\n                        {formatCurrency(monthlyExpenses)}\n                      </p>\n                      <p className=\"text-xs text-gray-600 mt-1\">This month</p>\n                    </div>\n                    <div className=\"rounded-lg border p-4\">\n                      <div className=\"flex items-center justify-between\">\n                        <p className=\"text-sm font-medium text-gray-600\">Savings</p>\n                        <Wallet className=\"h-4 w-4 text-blue-600\" />\n                      </div>\n                      <p className={`text-2xl font-bold mt-2 ${monthlyDonations - monthlyExpenses >= 0 ? 'text-green-600' : 'text-red-600'}`}>\n                        {formatCurrency(monthlyDonations - monthlyExpenses)}\n                      </p>\n                      <p className=\"text-xs text-gray-600 mt-1\">Net this month</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Expense Breakdown by Category */}\n              <Card>\n                <CardHeader>\n                  <CardTitle>Expense Breakdown by Category</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-3\">\n                    {Object.entries(expensesByCategory).sort(([,a], [,b]) => b - a).slice(0, 8).map(([category, amount]) => {\n                      const percentage = totalExpenses > 0 ? (amount / totalExpenses * 100) : 0\n                      return (\n                        <div key={category} className=\"space-y-2\">\n                          <div className=\"flex justify-between text-sm\">\n                            <span className=\"font-medium\">{category}</span>\n                            <span className=\"text-gray-600\">{formatCurrency(amount)} ({percentage.toFixed(1)}%)</span>\n                          </div>\n                          <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                            <div \n                              className=\"bg-blue-600 h-2 rounded-full transition-all\"\n                              style={{ width: `${percentage}%` }}\n                            />\n                          </div>\n                        </div>\n                      )\n                    })}\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Quick Actions */}\n              <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\n                <Card className=\"hover:shadow-lg transition-shadow cursor-pointer\" onClick={() => setActiveTab('expenses')}>\n                  <CardContent className=\"pt-6\">\n                    <div className=\"flex items-center gap-4\">\n                      <div className=\"rounded-full p-3 bg-red-100\">\n                        <Receipt className=\"h-6 w-6 text-red-600\" />\n                      </div>\n                      <div>\n                        <p className=\"text-sm font-medium text-gray-600\">Record Expense</p>\n                        <p className=\"text-xs text-gray-500\">Add new expense</p>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                <Card className=\"hover:shadow-lg transition-shadow cursor-pointer\" onClick={() => setActiveTab('income')}>\n                  <CardContent className=\"pt-6\">\n                    <div className=\"flex items-center gap-4\">\n                      <div className=\"rounded-full p-3 bg-green-100\">\n                        <Heart className=\"h-6 w-6 text-green-600\" />\n                      </div>\n                      <div>\n                        <p className=\"text-sm font-medium text-gray-600\">Record Income</p>\n                        <p className=\"text-xs text-gray-500\">Add donation/fee</p>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                <Card className=\"hover:shadow-lg transition-shadow cursor-pointer\" onClick={() => setActiveTab('stationery')}>\n                  <CardContent className=\"pt-6\">\n                    <div className=\"flex items-center gap-4\">\n                      <div className=\"rounded-full p-3 bg-purple-100\">\n                        <Package className=\"h-6 w-6 text-purple-600\" />\n                      </div>\n                      <div>\n                        <p className=\"text-sm font-medium text-gray-600\">Manage Stock</p>\n                        <p className=\"text-xs text-gray-500\">Update inventory</p>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                <Card className=\"hover:shadow-lg transition-shadow cursor-pointer\" onClick={() => setActiveTab('reports')}>\n                  <CardContent className=\"pt-6\">\n                    <div className=\"flex items-center gap-4\">\n                      <div className=\"rounded-full p-3 bg-blue-100\">\n                        <FileText className=\"h-6 w-6 text-blue-600\" />\n                      </div>\n                      <div>\n                        <p className=\"text-sm font-medium text-gray-600\">View Reports</p>\n                        <p className=\"text-xs text-gray-500\">Financial analysis</p>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n            </div>\n          )}\n\n          {/* EXPENSES TAB */}\n          {activeTab === 'expenses' && (\n            <div className=\"space-y-6\">\n              <Card>\n                <CardHeader>\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <CardTitle>Expense Management</CardTitle>\n                      <CardDescription>\n                        Track and manage all school expenses\n                      </CardDescription>\n                    </div>\n                    <Button onClick={() => { setEditExpense(null); setShowExpenseForm(true) }}>\n                      <Plus className=\"mr-2 h-4 w-4\" />\n                      Add Expense\n                    </Button>\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  {/* Filters */}\n                  <div className=\"grid gap-4 md:grid-cols-4 mb-6\">\n                    <div className=\"relative\">\n                      <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400\" />\n                      <Input\n                        placeholder=\"Search expenses...\"\n                        value={searchTerm}\n                        onChange={(e) => setSearchTerm(e.target.value)}\n                        className=\"pl-10\"\n                      />\n                    </div>\n                    <Input\n                      type=\"date\"\n                      value={dateFilter}\n                      onChange={(e) => setDateFilter(e.target.value)}\n                    />\n                    <select\n                      className=\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm\"\n                      value={categoryFilter}\n                      onChange={(e) => setCategoryFilter(e.target.value)}\n                    >\n                      <option value=\"\">All Categories</option>\n                      <option value=\"Utilities\">Utilities</option>\n                      <option value=\"Salaries\">Salaries & Wages</option>\n                      <option value=\"Maintenance\">Maintenance</option>\n                      <option value=\"Supplies\">Supplies</option>\n                      <option value=\"Transportation\">Transportation</option>\n                      <option value=\"Marketing\">Marketing</option>\n                      <option value=\"Technology\">Technology</option>\n                      <option value=\"Events\">Events</option>\n                      <option value=\"Other\">Other</option>\n                    </select>\n                    <Button variant=\"outline\" onClick={() => { setSearchTerm(''); setDateFilter(''); setCategoryFilter('') }}>\n                      Clear Filters\n                    </Button>\n                  </div>\n\n                  {/* Expenses List */}\n                  <div className=\"space-y-3\">\n                    {expenses\n                      .filter(exp => {\n                        const matchesSearch = exp.description.toLowerCase().includes(searchTerm.toLowerCase())\n                        const matchesCategory = !categoryFilter || exp.category === categoryFilter\n                        return matchesSearch && matchesCategory\n                      })\n                      .slice(0, 20)\n                      .map((expense) => (\n                      <div\n                        key={expense.id}\n                        className=\"flex items-center justify-between rounded-lg border p-4 hover:bg-gray-50 transition\"\n                      >\n                        <div className=\"flex-1\">\n                          <div className=\"flex items-center gap-3\">\n                            <div className=\"rounded-full p-2 bg-red-50\">\n                              <Receipt className=\"h-4 w-4 text-red-600\" />\n                            </div>\n                            <div>\n                              <p className=\"font-medium\">{expense.description}</p>\n                              <p className=\"text-sm text-gray-600\">{expense.category}</p>\n                            </div>\n                          </div>\n                        </div>\n                        <div className=\"flex items-center gap-4\">\n                          <div className=\"text-right\">\n                            <p className=\"font-bold text-red-600\">\n                              {formatCurrency(expense.amount)}\n                            </p>\n                            <p className=\"text-xs text-gray-600\">{new Date(expense.date).toLocaleDateString()}</p>\n                          </div>\n                          <div className=\"flex gap-2\">\n                            <Button size=\"sm\" variant=\"outline\" onClick={() => { setEditExpense(expense); setShowExpenseForm(true) }}>\n                              Edit\n                            </Button>\n                            <Button \n                              size=\"sm\" \n                              variant=\"outline\" \n                              className=\"text-red-600\"\n                              onClick={async () => { \n                                if (confirm('Delete this expense?')) { \n                                  try {\n                                    await financeService.deleteExpense(expense.id); \n                                    queryClient.invalidateQueries({ queryKey: ['expenses'] });\n                                    toast.success('Expense deleted successfully');\n                                  } catch (error: any) {\n                                    toast.error(error?.response?.data?.detail || 'Failed to delete expense');\n                                  }\n                                } \n                              }}\n                            >\n                              Delete\n                            </Button>\n                          </div>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n\n                  {expenses.length === 0 && (\n                    <div className=\"text-center py-12\">\n                      <Receipt className=\"mx-auto h-12 w-12 text-gray-400\" />\n                      <p className=\"mt-2 text-gray-600\">No expenses recorded yet</p>\n                      <Button className=\"mt-4\" onClick={() => setShowExpenseForm(true)}>\n                        Add Your First Expense\n                      </Button>\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n            </div>\n          )}\n\n          {/* INCOME TAB */}\n          {activeTab === 'income' && (\n            <div className=\"space-y-6\">\n              <Card>\n                <CardHeader>\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <CardTitle>Income & Donations</CardTitle>\n                      <CardDescription>\n                        Track all income sources including donations, fees, and grants\n                      </CardDescription>\n                    </div>\n                    <Button onClick={() => { setEditDonation(null); setShowDonationForm(true) }}>\n                      <Plus className=\"mr-2 h-4 w-4\" />\n                      Record Income\n                    </Button>\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-3\">\n                    {donations.map((donation) => (\n                      <div\n                        key={donation.id}\n                        className=\"flex items-center justify-between rounded-lg border p-4 hover:bg-gray-50 transition\"\n                      >\n                        <div className=\"flex-1\">\n                          <div className=\"flex items-center gap-3\">\n                            <div className=\"rounded-full p-2 bg-green-50\">\n                              <Heart className=\"h-4 w-4 text-green-600\" />\n                            </div>\n                            <div>\n                              <p className=\"font-medium\">{donation.donor_name}</p>\n                              <p className=\"text-sm text-gray-600\">\n                                {donation.purpose || 'General Donation'} • Receipt: {donation.receipt_number}\n                              </p>\n                            </div>\n                          </div>\n                        </div>\n                        <div className=\"flex items-center gap-4\">\n                          <div className=\"text-right\">\n                            <p className=\"font-bold text-green-600\">\n                              {formatCurrency(donation.amount)}\n                            </p>\n                            <p className=\"text-xs text-gray-600\">{new Date(donation.date).toLocaleDateString()}</p>\n                          </div>\n                          <div className=\"flex gap-2\">\n                            <Button size=\"sm\" variant=\"outline\" onClick={() => { setEditDonation(donation); setShowDonationForm(true) }}>\n                              Edit\n                            </Button>\n                            <Button \n                              size=\"sm\" \n                              variant=\"outline\" \n                              className=\"text-red-600\"\n                              onClick={async () => { \n                                if (confirm('Delete this donation?')) { \n                                  try {\n                                    await financeService.deleteDonation(donation.id); \n                                    queryClient.invalidateQueries({ queryKey: ['donations'] });\n                                    toast.success('Donation deleted successfully');\n                                  } catch (error: any) {\n                                    toast.error(error?.response?.data?.detail || 'Failed to delete donation');\n                                  }\n                                } \n                              }}\n                            >\n                              Delete\n                            </Button>\n                          </div>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n\n                  {donations.length === 0 && (\n                    <div className=\"text-center py-12\">\n                      <Heart className=\"mx-auto h-12 w-12 text-gray-400\" />\n                      <p className=\"mt-2 text-gray-600\">No income recorded yet</p>\n                      <Button className=\"mt-4\" onClick={() => setShowDonationForm(true)}>\n                        Record Your First Income\n                      </Button>\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n            </div>\n          )}\n\n          {/* STATIONERY TAB */}\n          {activeTab === 'stationery' && (\n            <div className=\"space-y-6\">\n              <Card>\n                <CardHeader>\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <CardTitle>Stationery Inventory</CardTitle>\n                      <CardDescription>\n                        Manage school stationery and supplies inventory\n                      </CardDescription>\n                    </div>\n                    <Button onClick={() => { setEditItem(null); setShowItemForm(true) }}>\n                      <Plus className=\"mr-2 h-4 w-4\" />\n                      Add Item\n                    </Button>\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  {lowStockItems.length > 0 && (\n                    <div className=\"mb-6 rounded-lg bg-yellow-50 border border-yellow-200 p-4\">\n                      <div className=\"flex items-center gap-2\">\n                        <AlertTriangle className=\"h-5 w-5 text-yellow-600\" />\n                        <p className=\"text-sm font-medium text-yellow-800\">\n                          {lowStockItems.length} items running low on stock - Reorder needed!\n                        </p>\n                      </div>\n                    </div>\n                  )}\n\n                  <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\n                    {stationeryItems.map((item) => (\n                      <Card key={item.id} className={`${item.quantity <= item.reorder_level ? 'border-yellow-300 bg-yellow-50' : ''}`}>\n                        <CardContent className=\"pt-6\">\n                          <div className=\"flex items-start justify-between\">\n                            <div className=\"flex-1\">\n                              <div className=\"flex items-center gap-2 mb-2\">\n                                <Package className=\"h-5 w-5 text-purple-600\" />\n                                <h3 className=\"font-semibold\">{item.name}</h3>\n                              </div>\n                              <p className=\"text-sm text-gray-600 mb-2\">{item.category}</p>\n                              <div className=\"flex items-baseline gap-2\">\n                                <p className=\"text-2xl font-bold text-purple-600\">\n                                  {item.quantity}\n                                </p>\n                                <p className=\"text-sm text-gray-600\">{item.unit}</p>\n                              </div>\n                              {item.quantity <= item.reorder_level && (\n                                <p className=\"text-xs text-yellow-600 mt-1 font-medium\">\n                                  ⚠️ Below reorder level ({item.reorder_level})\n                                </p>\n                              )}\n                            </div>\n                          </div>\n                          <div className=\"mt-4 flex gap-2\">\n                            <Button size=\"sm\" variant=\"outline\" className=\"flex-1\" onClick={() => { setEditItem(item); setShowItemForm(true) }}>\n                              Edit\n                            </Button>\n                            <Button \n                              size=\"sm\" \n                              variant=\"outline\" \n                              className=\"text-red-600\"\n                              onClick={async () => { \n                                if (confirm('Delete this item?')) { \n                                  try {\n                                    await financeService.deleteStationeryItem(item.id); \n                                    queryClient.invalidateQueries({ queryKey: ['stationery-items'] });\n                                    toast.success('Item deleted successfully');\n                                  } catch (error: any) {\n                                    toast.error(error?.response?.data?.detail || 'Failed to delete item');\n                                  }\n                                } \n                              }}\n                            >\n                              Delete\n                            </Button>\n                          </div>\n                        </CardContent>\n                      </Card>\n                    ))}\n                  </div>\n\n                  {stationeryItems.length === 0 && (\n                    <div className=\"text-center py-12\">\n                      <Package className=\"mx-auto h-12 w-12 text-gray-400\" />\n                      <p className=\"mt-2 text-gray-600\">No stationery items yet</p>\n                      <Button className=\"mt-4\" onClick={() => setShowItemForm(true)}>\n                        Add Your First Item\n                      </Button>\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n            </div>\n          )}\n\n          {/* SALARIES TAB */}\n          {activeTab === 'salaries' && (\n            <Card>\n              <CardHeader>\n                <div className=\"flex justify-between items-center\">\n                  <div>\n                    <CardTitle>Salary Management</CardTitle>\n                    <CardDescription>View and manage teacher salary records</CardDescription>\n                  </div>\n                  <Button onClick={() => setShowSalaryForm(true)}>\n                    <Plus className=\"h-4 w-4 mr-2\" />\n                    Add Salary Record\n                  </Button>\n                </div>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  {salaries.slice(0, 15).map((salary) => (\n                    <div\n                      key={salary.id}\n                      className=\"flex items-center justify-between rounded-lg border p-4 hover:bg-gray-50 transition-colors\"\n                    >\n                      <div className=\"flex-1\">\n                        <p className=\"font-medium text-lg\">\n                          {new Date(salary.year, salary.month - 1).toLocaleDateString('en-US', {\n                            month: 'long',\n                            year: 'numeric',\n                          })}\n                        </p>\n                        <p className=\"text-sm text-gray-600 mt-1\">\n                          Teacher ID: {salary.teacher_id?.substring(0, 8)}...\n                        </p>\n                        <div className=\"flex items-center gap-4 mt-2 text-sm text-gray-500\">\n                          <span>Basic: {formatCurrency(salary.basic_salary)}</span>\n                          {salary.bonuses > 0 && <span className=\"text-green-600\">Bonuses: +{formatCurrency(salary.bonuses)}</span>}\n                          {salary.deductions > 0 && <span className=\"text-red-600\">Deductions: -{formatCurrency(salary.deductions)}</span>}\n                        </div>\n                      </div>\n                      <div className=\"text-right\">\n                        <p className=\"text-2xl font-bold\">\n                          {formatCurrency(salary.net_salary)}\n                        </p>\n                        <div className={`inline-flex items-center rounded-full px-3 py-1 text-xs font-medium mt-2 ${\n                          salary.paid_date ? 'bg-green-100 text-green-700' : 'bg-yellow-100 text-yellow-700'\n                        }`}>\n                          {salary.paid_date ? `Paid ${new Date(salary.paid_date).toLocaleDateString()}` : 'Pending Payment'}\n                        </div>\n                        <div className=\"flex gap-2 mt-3 justify-end\">\n                          <Button \n                            size=\"sm\" \n                            variant=\"outline\"\n                            onClick={() => { setEditSalary(salary); setShowSalaryForm(true) }}\n                          >\n                            Edit\n                          </Button>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n\n                {salaries.length === 0 && (\n                  <div className=\"text-center py-12\">\n                    <Wallet className=\"mx-auto h-12 w-12 text-gray-400\" />\n                    <p className=\"mt-2 text-gray-600 mb-4\">No salary records found</p>\n                    <Button onClick={() => setShowSalaryForm(true)}>\n                      <Plus className=\"h-4 w-4 mr-2\" />\n                      Add First Salary Record\n                    </Button>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          )}\n\n          {/* REPORTS TAB */}\n          {activeTab === 'reports' && (\n            <div className=\"space-y-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle>Financial Reports & Analytics</CardTitle>\n                  <CardDescription>Comprehensive financial analysis and reporting</CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"grid gap-6 md:grid-cols-2\">\n                    {/* Income vs Expenses */}\n                    <div className=\"rounded-lg border p-6\">\n                      <h3 className=\"font-semibold mb-4\">Income vs Expenses</h3>\n                      <div className=\"space-y-4\">\n                        <div>\n                          <div className=\"flex justify-between mb-2\">\n                            <span className=\"text-sm\">Total Income</span>\n                            <span className=\"font-medium text-green-600\">{formatCurrency(totalDonations)}</span>\n                          </div>\n                          <div className=\"w-full bg-gray-200 rounded-full h-3\">\n                            <div className=\"bg-green-600 h-3 rounded-full\" style={{ width: '100%' }} />\n                          </div>\n                        </div>\n                        <div>\n                          <div className=\"flex justify-between mb-2\">\n                            <span className=\"text-sm\">Total Expenses</span>\n                            <span className=\"font-medium text-red-600\">{formatCurrency(totalExpenses)}</span>\n                          </div>\n                          <div className=\"w-full bg-gray-200 rounded-full h-3\">\n                            <div \n                              className=\"bg-red-600 h-3 rounded-full\" \n                              style={{ width: `${totalDonations > 0 ? (totalExpenses / totalDonations * 100) : 0}%` }} \n                            />\n                          </div>\n                        </div>\n                        <div>\n                          <div className=\"flex justify-between mb-2\">\n                            <span className=\"text-sm\">Salaries</span>\n                            <span className=\"font-medium text-blue-600\">{formatCurrency(totalSalaries)}</span>\n                          </div>\n                          <div className=\"w-full bg-gray-200 rounded-full h-3\">\n                            <div \n                              className=\"bg-blue-600 h-3 rounded-full\" \n                              style={{ width: `${totalDonations > 0 ? (totalSalaries / totalDonations * 100) : 0}%` }} \n                            />\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n\n                    {/* Summary Stats */}\n                    <div className=\"rounded-lg border p-6\">\n                      <h3 className=\"font-semibold mb-4\">Financial Summary</h3>\n                      <div className=\"space-y-3\">\n                        <div className=\"flex justify-between py-2 border-b\">\n                          <span className=\"text-gray-600\">Total Transactions</span>\n                          <span className=\"font-semibold\">{expenses.length + donations.length}</span>\n                        </div>\n                        <div className=\"flex justify-between py-2 border-b\">\n                          <span className=\"text-gray-600\">Expense Categories</span>\n                          <span className=\"font-semibold\">{Object.keys(expensesByCategory).length}</span>\n                        </div>\n                        <div className=\"flex justify-between py-2 border-b\">\n                          <span className=\"text-gray-600\">Average Expense</span>\n                          <span className=\"font-semibold\">\n                            {expenses.length > 0 ? formatCurrency(totalExpenses / expenses.length) : formatCurrency(0)}\n                          </span>\n                        </div>\n                        <div className=\"flex justify-between py-2 border-b\">\n                          <span className=\"text-gray-600\">Average Donation</span>\n                          <span className=\"font-semibold\">\n                            {donations.length > 0 ? formatCurrency(totalDonations / donations.length) : formatCurrency(0)}\n                          </span>\n                        </div>\n                        <div className=\"flex justify-between py-2\">\n                          <span className=\"text-gray-600\">Inventory Items</span>\n                          <span className=\"font-semibold\">{stationeryItems.length}</span>\n                        </div>\n                      </div>\n                    </div>\n\n                    {/* Top Expense Categories */}\n                    <div className=\"rounded-lg border p-6\">\n                      <h3 className=\"font-semibold mb-4\">Top Expense Categories</h3>\n                      <div className=\"space-y-3\">\n                        {Object.entries(expensesByCategory)\n                          .sort(([,a], [,b]) => b - a)\n                          .slice(0, 5)\n                          .map(([category, amount], index) => (\n                          <div key={category} className=\"flex items-center gap-3\">\n                            <div className=\"flex-shrink-0 w-8 h-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center font-semibold text-sm\">\n                              {index + 1}\n                            </div>\n                            <div className=\"flex-1\">\n                              <p className=\"font-medium\">{category}</p>\n                              <p className=\"text-sm text-gray-600\">{formatCurrency(amount)}</p>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    </div>\n\n                    {/* Action Items */}\n                    <div className=\"rounded-lg border p-6 bg-blue-50\">\n                      <h3 className=\"font-semibold mb-4\">Recommended Actions</h3>\n                      <ul className=\"space-y-2\">\n                        {netBalance < 0 && (\n                          <li className=\"flex items-start gap-2 text-sm\">\n                            <AlertTriangle className=\"h-4 w-4 text-red-600 mt-0.5\" />\n                            <span>Review expenses - currently in deficit</span>\n                          </li>\n                        )}\n                        {lowStockItems.length > 0 && (\n                          <li className=\"flex items-start gap-2 text-sm\">\n                            <AlertTriangle className=\"h-4 w-4 text-yellow-600 mt-0.5\" />\n                            <span>Reorder {lowStockItems.length} stationery items</span>\n                          </li>\n                        )}\n                        <li className=\"flex items-start gap-2 text-sm\">\n                          <CreditCard className=\"h-4 w-4 text-blue-600 mt-0.5\" />\n                          <span>Monthly expenses are {monthlyExpenses > 0 ? 'on track' : 'not recorded'}</span>\n                        </li>\n                        <li className=\"flex items-start gap-2 text-sm\">\n                          <FileText className=\"h-4 w-4 text-green-600 mt-0.5\" />\n                          <span>Export reports for accounting records</span>\n                        </li>\n                      </ul>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Forms */}\n      {showItemForm && (\n        <StationeryItemForm onClose={() => { setShowItemForm(false); setEditItem(null) }} initialData={editItem || undefined}\n          onSuccess={() => queryClient.invalidateQueries({ queryKey: ['stationery-items'] })} />\n      )}\n      {showExpenseForm && (\n        <ExpenseForm onClose={() => { setShowExpenseForm(false); setEditExpense(null) }} initialData={editExpense || undefined}\n          onSuccess={() => queryClient.invalidateQueries({ queryKey: ['expenses'] })} />\n      )}\n      {showDonationForm && (\n        <DonationForm onClose={() => { setShowDonationForm(false); setEditDonation(null) }} initialData={editDonation || undefined}\n          onSuccess={() => queryClient.invalidateQueries({ queryKey: ['donations'] })} />\n      )}\n      {showSalaryForm && (\n        <SalaryForm onClose={() => { setShowSalaryForm(false); setEditSalary(null) }} initialData={editSalary || undefined}\n          onSuccess={() => queryClient.invalidateQueries({ queryKey: ['salaries'] })} />\n      )}\n    </DashboardLayout>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\admin\\grades\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Label' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Textarea' is defined but never used.","line":12,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ConfirmDialog' is defined but never used.","line":14,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Upload' is defined but never used.","line":18,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendingDown' is defined but never used.","line":19,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertCircle' is defined but never used.","line":20,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'XCircle' is defined but never used.","line":20,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":36},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":20,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":43},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FileSpreadsheet' is defined but never used.","line":20,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":60},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setSelectedStudentId' is assigned a value but never used.","line":63,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":63,"endColumn":49},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isLoadingPositions' is assigned a value but never used.","line":101,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":101,"endColumn":61},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":224,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":224,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8698,8701],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8698,8701],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":276,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":276,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10664,10667],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10664,10667],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":305,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":305,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11717,11720],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11717,11720],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":319,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":319,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12240,12243],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12240,12243],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":342,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":342,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12999,13002],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12999,13002],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":360,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":360,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13643,13646],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13643,13646],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":469,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":469,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17121,17124],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17121,17124],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":489,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":489,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17800,17803],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17800,17803],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":654,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":654,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[23957,23960],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[23957,23960],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":1,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":1061,"column":31,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[47211,47374],"text":"\n                      Use the &quot;Student Grades\" tab to enter grades. You can quickly add grades by clicking the + button for each subject.\n                        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[47211,47374],"text":"\n                      Use the &ldquo;Student Grades\" tab to enter grades. You can quickly add grades by clicking the + button for each subject.\n                        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[47211,47374],"text":"\n                      Use the &#34;Student Grades\" tab to enter grades. You can quickly add grades by clicking the + button for each subject.\n                        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[47211,47374],"text":"\n                      Use the &rdquo;Student Grades\" tab to enter grades. You can quickly add grades by clicking the + button for each subject.\n                        "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":1,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":1061,"column":46,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[47211,47374],"text":"\n                      Use the \"Student Grades&quot; tab to enter grades. You can quickly add grades by clicking the + button for each subject.\n                        "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[47211,47374],"text":"\n                      Use the \"Student Grades&ldquo; tab to enter grades. You can quickly add grades by clicking the + button for each subject.\n                        "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[47211,47374],"text":"\n                      Use the \"Student Grades&#34; tab to enter grades. You can quickly add grades by clicking the + button for each subject.\n                        "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[47211,47374],"text":"\n                      Use the \"Student Grades&rdquo; tab to enter grades. You can quickly add grades by clicking the + button for each subject.\n                        "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":22,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useEffect, useMemo, useCallback } from 'react'\nimport { useRouter, useSearchParams } from 'next/navigation'\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { Badge } from '@/components/ui/badge'\nimport { Textarea } from '@/components/ui/textarea'\nimport { toast } from '@/components/ui/toast'\nimport { ConfirmDialog } from '@/components/shared/ConfirmDialog'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { \n  Plus, Search, Edit, Trash2, Eye, X, Calculator, Award, \n  Download, Upload, Save, RefreshCw, Filter, BarChart3,\n  TrendingUp, TrendingDown, Users, BookOpen, Target,\n  CheckCircle, AlertCircle, XCircle, Clock, FileSpreadsheet,\n  FileText, Printer, Trophy, Medal\n} from 'lucide-react'\nimport { gradeService } from '@/services/gradeService'\nimport { studentService } from '@/services/studentService'\nimport { classService } from '@/services/classService'\nimport { gradingSchemeService } from '@/services/gradingSchemeService'\nimport { useSettings } from '@/contexts/SettingsContext'\nimport { Grade, Student } from '@/types'\n\ntype TabId = 'student-grades' | 'bulk-entry' | 'report-cards' | 'analytics'\n\ninterface GradeEntry {\n  id?: string\n  student_id: string\n  student_name: string\n  admission_number: string\n  class_id: string\n  class_name: string\n  subject: string\n  marks: number | ''\n  grade?: string\n  term: string\n  academic_year: string\n  remarks: string\n  isEditing?: boolean\n}\n\ninterface StudentWithGrades {\n  student: Student\n  grades: Record<string, GradeEntry> // key is subject\n  overallGPA?: number\n  totalSubjects?: number\n  passedSubjects?: number\n}\n\nexport default function GradesPage() {\n  const router = useRouter()\n  const searchParams = useSearchParams()\n  const queryClient = useQueryClient()\n  const { schoolName } = useSettings()\n  const [activeTab, setActiveTab] = useState<TabId>('student-grades')\n  const [selectedClass, setSelectedClass] = useState<string>(searchParams.get('class_id') || '')\n  const [selectedStudentId, setSelectedStudentId] = useState<string | null>(searchParams.get('student_id') || null)\n  const [selectedTerm, setSelectedTerm] = useState<string>(searchParams.get('term') || 'First Term')\n  const [selectedYear, setSelectedYear] = useState<string>(searchParams.get('year') || new Date().getFullYear().toString())\n  const [searchTerm, setSearchTerm] = useState('')\n  const [editingGrade, setEditingGrade] = useState<GradeEntry | null>(null)\n  const [selectedStudentForReport, setSelectedStudentForReport] = useState<string | null>(null)\n  const [showReportCardModal, setShowReportCardModal] = useState(false)\n  const [isSaving, setIsSaving] = useState(false)\n\n  // Fetch data\n  const { data: students = [] } = useQuery({\n    queryKey: ['students'],\n    queryFn: () => studentService.getStudents({ limit: 1000 }),\n  })\n\n  const { data: classes = [] } = useQuery({\n    queryKey: ['classes'],\n    queryFn: () => classService.getClasses({ limit: 1000 }),\n  })\n\n  const { data: grades = [], isLoading: isLoadingGrades, error: gradesError } = useQuery({\n    queryKey: ['grades', selectedClass, selectedStudentId, selectedTerm, selectedYear],\n    queryFn: () => {\n      // Normalize term: 'Final' -> 'Annual' for API\n      const apiTerm = selectedTerm === 'Final' ? 'Annual' : selectedTerm\n      return gradeService.getGrades({\n        class_id: selectedClass || undefined,\n        student_id: selectedStudentId || undefined,\n        term: apiTerm || undefined,\n        academic_year: selectedYear || undefined,\n        limit: 1000\n      })\n    },\n    retry: 1,\n    refetchOnWindowFocus: false,\n  })\n\n  // Fetch positions\n  const { data: positionsData, isLoading: isLoadingPositions } = useQuery({\n    queryKey: ['positions', selectedClass, selectedTerm, selectedYear],\n    queryFn: () => {\n      if (!selectedClass || !selectedTerm || !selectedYear) return null\n      return gradeService.getPositions({\n        class_id: selectedClass,\n        term: selectedTerm,\n        academic_year: selectedYear,\n        top_n: 3\n      })\n    },\n    enabled: !!selectedClass && !!selectedTerm && !!selectedYear,\n    retry: 1,\n    refetchOnWindowFocus: false,\n  })\n  \n  // Show error if grades query fails\n  useEffect(() => {\n    if (gradesError) {\n      console.error('Grades fetch error:', gradesError)\n      const errorMessage = gradesError instanceof Error \n        ? gradesError.message \n        : 'Failed to load grades. Please check your connection and try again.'\n      toast.error(errorMessage)\n    }\n  }, [gradesError])\n\n  // Get students for selected class\n  const classStudents = useMemo(() => {\n    if (!selectedClass) return []\n    return students.filter((student: Student) => student.class_id === selectedClass)\n  }, [students, selectedClass])\n\n  // Get unique subjects from grades\n  const availableSubjects = useMemo(() => {\n    const subjects = new Set<string>()\n    grades.forEach((grade: Grade) => {\n      subjects.add(grade.subject)\n    })\n    return Array.from(subjects).sort()\n  }, [grades])\n\n  // Get active grading scheme for preview (backend calculates on save)\n  const { data: activeScheme } = useQuery({\n    queryKey: ['default-grading-scheme'],\n    queryFn: async () => {\n      try {\n        return await gradingSchemeService.getDefaultGradingScheme()\n      } catch (error) {\n        // Silently fail - will use fallback calculation\n        return undefined\n      }\n    },\n    retry: 1,\n    staleTime: 5 * 60 * 1000, // Cache for 5 minutes\n  })\n\n  // Calculate grade letter from marks (for display preview only - backend calculates on save)\n  const calculateGrade = useCallback((marks: number): string => {\n    // Use active scheme if available\n    if (activeScheme && 'criteria' in activeScheme && activeScheme.criteria && activeScheme.criteria.length > 0) {\n      const sorted = [...activeScheme.criteria].sort((a, b) => (b.display_order || 0) - (a.display_order || 0))\n      for (const criterion of sorted) {\n        if (marks >= criterion.min_marks && marks <= criterion.max_marks) {\n          return criterion.grade_name\n        }\n      }\n      // Fallback to lowest grade\n      if (sorted.length > 0) {\n        const lowest = sorted.sort((a, b) => (a.display_order || 0) - (b.display_order || 0))[0]\n        return lowest.grade_name\n      }\n    }\n    \n    // Fallback to default calculation\n    if (marks >= 90) return 'A+'\n    if (marks >= 80) return 'A'\n    if (marks >= 70) return 'B+'\n    if (marks >= 60) return 'B'\n    if (marks >= 50) return 'C+'\n    if (marks >= 40) return 'C'\n    if (marks >= 33) return 'D'\n    return 'F'\n  }, [activeScheme])\n\n  // Organize grades by student and subject\n  const studentsWithGrades = useMemo(() => {\n    const result: Record<string, StudentWithGrades> = {}\n    \n    classStudents.forEach((student: Student) => {\n      const studentGrades: Record<string, GradeEntry> = {}\n      const studentGradeRecords = grades.filter((g: Grade) => g.student_id === student.id)\n      \n          studentGradeRecords.forEach((grade: Grade) => {\n        // Normalize term back to 'Final' for display if it's 'Annual'\n        const displayTerm = grade.term === 'Annual' ? 'Final' : grade.term\n        studentGrades[grade.subject] = {\n          id: grade.id,\n          student_id: grade.student_id,\n          student_name: student.user?.full_name || 'Unknown',\n          admission_number: student.admission_number,\n          class_id: grade.class_id,\n          class_name: classes.find(c => c.id === grade.class_id)?.name || '',\n          subject: grade.subject,\n          marks: Number(grade.marks),\n          grade: grade.grade,\n          term: displayTerm, // Use display term\n          academic_year: grade.academic_year,\n          remarks: grade.remarks || '',\n          isEditing: false\n        }\n      })\n\n      // Calculate statistics\n      const gradeValues = Object.values(studentGrades)\n      const totalSubjects = availableSubjects.length || gradeValues.length\n      const passedSubjects = gradeValues.filter(g => {\n        const marks = Number(g.marks || 0)\n        if (isNaN(marks)) return false\n        \n        // Use active scheme to determine passing if available\n        if (activeScheme && 'criteria' in activeScheme && activeScheme.criteria) {\n          const calculatedGrade = calculateGrade(marks)\n          const criterion = activeScheme.criteria.find((c: any) => c.grade_name === calculatedGrade)\n          if (criterion) {\n            return criterion.is_passing\n          }\n        }\n        \n        // Fallback: marks >= 50\n        return marks >= 50\n      }).length\n      \n      const totalMarks = gradeValues.reduce((sum, g) => {\n        const marks = Number(g.marks || 0)\n        return sum + (isNaN(marks) ? 0 : marks)\n      }, 0)\n      const overallGPA = gradeValues.length > 0 && totalMarks > 0 ? totalMarks / gradeValues.length : 0\n\n      result[student.id] = {\n        student,\n        grades: studentGrades,\n        overallGPA,\n        totalSubjects,\n        passedSubjects\n      }\n    })\n\n    return result\n  }, [classStudents, grades, availableSubjects, classes, activeScheme, calculateGrade])\n  \n  // Note: Grade calculation is handled by the backend automatically using active grading scheme\n  // calculateGrade function is only for UI preview purposes\n\n  // Get grade color (works with custom grade names too)\n  const getGradeColor = (grade: string | undefined) => {\n    if (!grade) return 'bg-gray-100 text-gray-800 border-gray-200'\n    const gradeUpper = grade.toUpperCase()\n    // Check if it's a standard grade first\n    if (gradeUpper.startsWith('A')) {\n      if (gradeUpper === 'A+' || gradeUpper === 'A') {\n        return 'bg-green-100 text-green-800 border-green-200'\n      }\n    } else if (gradeUpper.startsWith('B')) {\n      return 'bg-blue-100 text-blue-800 border-blue-200'\n    } else if (gradeUpper.startsWith('C')) {\n      return 'bg-yellow-100 text-yellow-800 border-yellow-200'\n    } else if (gradeUpper.startsWith('D')) {\n      return 'bg-orange-100 text-orange-800 border-orange-200'\n    } else if (gradeUpper.startsWith('F')) {\n      return 'bg-red-100 text-red-800 border-red-200'\n    }\n    \n    // Use active scheme to determine if passing/failing\n    if (activeScheme && 'criteria' in activeScheme && activeScheme.criteria) {\n      const criterion = activeScheme.criteria.find((c: any) => c.grade_name.toUpperCase() === gradeUpper)\n      if (criterion && !criterion.is_passing) {\n        return 'bg-red-100 text-red-800 border-red-200'\n      }\n    }\n    \n    // Default for unknown grades\n    return 'bg-gray-100 text-gray-800 border-gray-200'\n  }\n\n  // Create grade mutation\n  const createGradeMutation = useMutation({\n    mutationFn: (data: GradeEntry) => gradeService.createGrade({\n      student_id: data.student_id,\n      class_id: data.class_id,\n      subject: data.subject,\n      marks: Number(data.marks),\n      // Backend will auto-calculate grade from marks\n      // Don't send grade - backend handles calculation\n      term: data.term === 'Final' ? 'Annual' : data.term, // Normalize term\n      academic_year: data.academic_year,\n      remarks: data.remarks || ''\n    }),\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['grades'] })\n      toast.success(`Grade created successfully! ${data.grade} (${data.marks}%)`)\n      setEditingGrade(null)\n      setIsSaving(false)\n    },\n    onError: (error: any) => {\n      setIsSaving(false)\n      const errorMessage = error?.message || \n                          error?.response?.data?.message || \n                          error?.response?.data?.detail || \n                          'Failed to create grade'\n      toast.error(errorMessage)\n      console.error('Grade creation error:', error)\n    }\n  })\n\n  // Update grade mutation\n  const updateGradeMutation = useMutation({\n    mutationFn: ({ id, data }: { id: string; data: Partial<GradeEntry> }) => {\n      const updateData: any = {\n        remarks: data.remarks\n      }\n      \n      // If marks are updated, backend will auto-recalculate grade\n      if (data.marks !== undefined && data.marks !== '') {\n        updateData.marks = Number(data.marks)\n        // Don't send grade - backend will recalculate from marks\n      }\n      \n      // Only send grade if explicitly provided (for override)\n      if (data.grade) {\n        updateData.grade = data.grade\n      }\n      \n      return gradeService.updateGrade(id, updateData)\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['grades'] })\n      toast.success(`Grade updated successfully! ${data.grade} (${data.marks}%)`)\n      setEditingGrade(null)\n      setIsSaving(false)\n    },\n    onError: (error: any) => {\n      setIsSaving(false)\n      const errorMessage = error?.response?.data?.message || \n                          error?.response?.data?.detail || \n                          error?.message || \n                          'Failed to update grade'\n      toast.error(errorMessage)\n      console.error('Grade update error:', error)\n    }\n  })\n\n  // Delete grade mutation\n  const deleteGradeMutation = useMutation({\n    mutationFn: (id: string) => gradeService.deleteGrade(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['grades'] })\n      toast.success('Grade deleted successfully!')\n    },\n    onError: (error: any) => {\n      const errorMessage = error?.response?.data?.message || \n                          error?.response?.data?.detail || \n                          error?.message || \n                          'Failed to delete grade'\n      toast.error(errorMessage)\n      console.error('Grade deletion error:', error)\n    }\n  })\n\n  // Handle start edit\n  const startEdit = (studentId: string, subject: string, existingGrade?: GradeEntry) => {\n    const student = classStudents.find((s: Student) => s.id === studentId)\n    if (!student) return\n\n    if (existingGrade) {\n      setEditingGrade({ ...existingGrade, isEditing: true })\n    } else {\n      setEditingGrade({\n        student_id: studentId,\n        student_name: student.user?.full_name || 'Unknown',\n        admission_number: student.admission_number,\n        class_id: selectedClass,\n        class_name: classes.find(c => c.id === selectedClass)?.name || '',\n        subject: subject,\n        marks: '',\n        grade: '',\n        term: selectedTerm,\n        academic_year: selectedYear,\n        remarks: '',\n        isEditing: true\n      })\n    }\n  }\n\n  // Handle save\n  const handleSave = () => {\n    if (!editingGrade || isSaving) return\n\n    // Validate marks\n    if (editingGrade.marks === '' || editingGrade.marks === null || editingGrade.marks === undefined) {\n      toast.error('Please enter marks')\n      return\n    }\n\n    const marks = typeof editingGrade.marks === 'string' ? Number(editingGrade.marks) : editingGrade.marks\n    if (isNaN(marks)) {\n      toast.error('Please enter valid marks')\n      return\n    }\n    \n    // Clamp marks to 0-100 range\n    const clampedMarks = Math.max(0, Math.min(100, marks))\n    if (clampedMarks !== marks) {\n      toast.error('Marks must be between 0 and 100')\n      setEditingGrade({ ...editingGrade, marks: clampedMarks })\n      return\n    }\n\n    // Validate required fields\n    if (!editingGrade.student_id || !editingGrade.class_id || !editingGrade.subject) {\n      toast.error('Missing required fields: student, class, or subject')\n      return\n    }\n\n    if (!editingGrade.term || !editingGrade.academic_year) {\n      toast.error('Missing required fields: term or academic year')\n      return\n    }\n\n    setIsSaving(true)\n\n    // Backend will automatically calculate grade from marks\n    // We don't need to send grade - backend handles it\n    const gradeToSave = { \n      ...editingGrade, \n      marks: clampedMarks,\n      // Ensure term is properly formatted (Final -> Annual for backend)\n      term: editingGrade.term === 'Final' ? 'Annual' : editingGrade.term,\n      // Don't send grade - let backend calculate it\n      grade: undefined\n    }\n\n    if (gradeToSave.id) {\n      updateGradeMutation.mutate({ \n        id: gradeToSave.id, \n        data: {\n          marks: gradeToSave.marks,\n          remarks: gradeToSave.remarks || ''\n        }\n      }, {\n        onSettled: () => setIsSaving(false)\n      })\n    } else {\n      createGradeMutation.mutate(gradeToSave, {\n        onSettled: () => setIsSaving(false)\n      })\n    }\n  }\n\n  // Calculate statistics\n  const stats = useMemo(() => {\n    const totalGrades = grades.length\n    const passingGrades = grades.filter((g: Grade) => {\n      const marks = Number(g.marks || 0)\n      if (isNaN(marks)) return false\n      \n      // Use active scheme to determine passing if available\n      if (activeScheme && 'criteria' in activeScheme && activeScheme.criteria) {\n        const criterion = activeScheme.criteria.find((c: any) => c.grade_name === g.grade)\n        if (criterion) {\n          return criterion.is_passing\n        }\n      }\n      \n      // Fallback: marks >= 50 or grade !== 'F'\n      return marks >= 50 || g.grade?.toUpperCase() !== 'F'\n    }).length\n    \n    const totalMarks = grades.reduce((sum: number, g: Grade) => {\n      const marks = Number(g.marks || 0)\n      return sum + (isNaN(marks) ? 0 : marks)\n    }, 0)\n    \n    const averageMarks = totalGrades > 0 && totalMarks > 0\n      ? (totalMarks / totalGrades).toFixed(1)\n      : '0'\n    const passRate = totalGrades > 0 ? Math.round((passingGrades / totalGrades) * 100) : 0\n    \n    const gradeDistribution = grades.reduce((acc: any, grade: Grade) => {\n      if (grade.grade) {\n        acc[grade.grade] = (acc[grade.grade] || 0) + 1\n      }\n      return acc\n    }, {})\n\n    return {\n      totalGrades,\n      passingGrades,\n      averageMarks,\n      passRate,\n      gradeDistribution\n    }\n  }, [grades, activeScheme])\n\n  // Filtered students\n  const filteredStudents = useMemo(() => {\n    const studentEntries = Object.values(studentsWithGrades)\n    if (!searchTerm) return studentEntries\n    \n    const lowerSearch = searchTerm.toLowerCase()\n    return studentEntries.filter(({ student }) => {\n      const name = student.user?.full_name?.toLowerCase() || ''\n      const admission = student.admission_number?.toLowerCase() || ''\n      return name.includes(lowerSearch) || admission.includes(lowerSearch)\n    })\n  }, [studentsWithGrades, searchTerm])\n\n  // Get selected student for report card\n  const selectedStudentData = useMemo(() => {\n    if (!selectedStudentForReport) return null\n    return studentsWithGrades[selectedStudentForReport]\n  }, [selectedStudentForReport, studentsWithGrades])\n\n  // Print report card\n  const handlePrintReportCard = () => {\n    window.print()\n  }\n\n  const tabs = [\n    { id: 'student-grades' as TabId, name: 'Student Grades', icon: BookOpen },\n    { id: 'bulk-entry' as TabId, name: 'Bulk Entry', icon: Plus },\n    { id: 'report-cards' as TabId, name: 'Report Cards', icon: FileText },\n    { id: 'analytics' as TabId, name: 'Analytics', icon: TrendingUp },\n  ]\n\n  return (\n    <DashboardLayout allowedRoles={['admin', 'principal', 'teacher']}>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900\">Grade Management System</h1>\n            <p className=\"text-gray-600 mt-1\">Complete grade management with report cards</p>\n          </div>\n          <div className=\"flex gap-3\">\n            <Button \n              variant=\"outline\"\n              onClick={() => router.push('/admin/reports?type=academic')}\n            >\n              <BarChart3 className=\"h-4 w-4 mr-2\" />\n              Generate Report\n            </Button>\n            <Button variant=\"outline\">\n              <Download className=\"h-4 w-4 mr-2\" />\n              Export Grades\n            </Button>\n            {selectedClass && (\n              <Button \n                variant=\"outline\"\n                onClick={() => router.push(`/admin/reports?class_id=${selectedClass}&type=academic`)}\n              >\n                <FileText className=\"h-4 w-4 mr-2\" />\n                Class Performance\n              </Button>\n            )}\n          </div>\n        </div>\n\n        {/* Quick Stats */}\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-gray-600\">Total Grades</p>\n                  <p className=\"text-3xl font-bold text-gray-900\">{stats.totalGrades}</p>\n                </div>\n                <div className=\"p-3 bg-blue-100 rounded-full\">\n                  <Calculator className=\"h-6 w-6 text-blue-600\" />\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-gray-600\">Passing Grades</p>\n                  <p className=\"text-3xl font-bold text-green-600\">{stats.passingGrades}</p>\n                </div>\n                <div className=\"p-3 bg-green-100 rounded-full\">\n                  <CheckCircle className=\"h-6 w-6 text-green-600\" />\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-gray-600\">Average Marks</p>\n                  <p className=\"text-3xl font-bold text-blue-600\">{stats.averageMarks}%</p>\n                </div>\n                <div className=\"p-3 bg-blue-100 rounded-full\">\n                  <Target className=\"h-6 w-6 text-blue-600\" />\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-gray-600\">Pass Rate</p>\n                  <p className=\"text-3xl font-bold text-purple-600\">{stats.passRate}%</p>\n                </div>\n                <div className=\"p-3 bg-purple-100 rounded-full\">\n                  <Award className=\"h-6 w-6 text-purple-600\" />\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Filters */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Filter className=\"h-5 w-5\" />\n              Filters & Search\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid gap-4 md:grid-cols-5\">\n              <div className=\"relative\">\n                <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400\" />\n                <Input\n                  placeholder=\"Search students...\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                  className=\"pl-10\"\n                />\n              </div>\n\n              <Select value={selectedClass || \"all\"} onValueChange={(value) => setSelectedClass(value === \"all\" ? \"\" : value)}>\n                <SelectTrigger>\n                  <SelectValue placeholder=\"Select Class\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">All Classes</SelectItem>\n                  {classes.map((cls: any) => (\n                    <SelectItem key={cls.id} value={cls.id}>\n                      {cls.name} - {cls.section}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n\n              <Select value={selectedTerm} onValueChange={setSelectedTerm}>\n                <SelectTrigger>\n                  <SelectValue placeholder=\"Select Term\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"First Term\">First Term</SelectItem>\n                  <SelectItem value=\"Second Term\">Second Term</SelectItem>\n                  <SelectItem value=\"Third Term\">Third Term</SelectItem>\n                  <SelectItem value=\"Final\">Final / Annual</SelectItem>\n                </SelectContent>\n              </Select>\n\n              <Input\n                type=\"text\"\n                placeholder=\"Academic Year\"\n                value={selectedYear}\n                onChange={(e) => setSelectedYear(e.target.value)}\n              />\n\n              <Button variant=\"outline\" onClick={() => {\n                setSearchTerm('')\n                setSelectedClass('')\n                setSelectedTerm('First Term')\n                setSelectedYear(new Date().getFullYear().toString())\n              }}>\n                <RefreshCw className=\"h-4 w-4 mr-2\" />\n                Reset\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Tab Navigation */}\n        <div className=\"border-b border-gray-200\">\n          <nav className=\"-mb-px flex space-x-8\" aria-label=\"Tabs\">\n            {tabs.map((tab) => {\n              const Icon = tab.icon\n              return (\n                <button\n                  key={tab.id}\n                  onClick={() => setActiveTab(tab.id)}\n                  className={`\n                    ${activeTab === tab.id\n                      ? 'border-blue-500 text-blue-600'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n                    }\n                    whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2\n                  `}\n                >\n                  <Icon className=\"h-5 w-5\" />\n                  {tab.name}\n                </button>\n              )\n            })}\n          </nav>\n        </div>\n\n        {/* Tab Content */}\n        <div className=\"mt-6\">\n          {/* Student Grades Tab */}\n          {activeTab === 'student-grades' && (\n              <Card>\n                <CardHeader>\n                <CardTitle>Student Grades Management</CardTitle>\n                <p className=\"text-sm text-gray-600\">View and manage all grades for each student</p>\n                </CardHeader>\n                <CardContent>\n                {!selectedClass ? (\n                  <div className=\"text-center py-12 text-gray-500\">\n                    <BookOpen className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n                    <p className=\"text-lg font-medium mb-2\">Select a Class</p>\n                    <p>Choose a class to view and manage student grades</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-6\">\n                    {/* Class Info */}\n                    <div className=\"flex items-center justify-between p-4 bg-blue-50 rounded-lg\">\n                      <div>\n                        <h3 className=\"font-semibold text-blue-900\">\n                          {classes.find(c => c.id === selectedClass)?.name} - {classes.find(c => c.id === selectedClass)?.section}\n                        </h3>\n                        <p className=\"text-sm text-blue-700\">{selectedTerm} • {selectedYear}</p>\n                      </div>\n                      <div className=\"text-right\">\n                        <p className=\"text-sm text-blue-700\">Students: {classStudents.length}</p>\n                        <p className=\"text-sm text-blue-700\">Subjects: {availableSubjects.length}</p>\n                        {positionsData && (\n                          <p className=\"text-sm text-blue-700\">Class Average: {positionsData.class_average.toFixed(1)}%</p>\n                        )}\n                      </div>\n                    </div>\n\n                    {/* Top Positions Section */}\n                    {positionsData && positionsData.positions.length > 0 && (\n                      <Card className=\"bg-gradient-to-r from-yellow-50 to-amber-50 border-yellow-200\">\n                        <CardHeader>\n                          <CardTitle className=\"flex items-center gap-2\">\n                            <Trophy className=\"h-5 w-5 text-yellow-600\" />\n                            Top 3 Positions - {selectedTerm}\n                          </CardTitle>\n                        </CardHeader>\n                        <CardContent>\n                          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                            {positionsData.positions.map((pos, index) => {\n                              const medalColors = [\n                                { bg: 'bg-yellow-100', border: 'border-yellow-400', text: 'text-yellow-800', icon: 'text-yellow-600' },\n                                { bg: 'bg-gray-100', border: 'border-gray-400', text: 'text-gray-800', icon: 'text-gray-600' },\n                                { bg: 'bg-orange-100', border: 'border-orange-400', text: 'text-orange-800', icon: 'text-orange-600' }\n                              ]\n                              const colors = medalColors[index] || medalColors[2]\n                              const positionLabels = ['1st', '2nd', '3rd']\n                              \n                              return (\n                                <div\n                                  key={pos.student_id}\n                                  className={`${colors.bg} ${colors.border} border-2 rounded-lg p-4 relative overflow-hidden`}\n                                >\n                                  <div className=\"absolute top-2 right-2\">\n                                    <Medal className={`h-6 w-6 ${colors.icon}`} />\n                                  </div>\n                                  <div className=\"flex items-center gap-3 mb-2\">\n                                    <div className={`${colors.bg} ${colors.border} border-2 rounded-full w-10 h-10 flex items-center justify-center font-bold ${colors.text}`}>\n                                      {positionLabels[index] || pos.position}\n                                    </div>\n                                    <div className=\"flex-1\">\n                                      <h4 className=\"font-bold text-lg\">{pos.student_name}</h4>\n                                      <p className=\"text-sm opacity-75\">{pos.admission_number}</p>\n                                    </div>\n                                  </div>\n                                  <div className=\"space-y-1 mt-3\">\n                                    <div className=\"flex justify-between text-sm\">\n                                      <span className=\"opacity-75\">Average:</span>\n                                      <span className={`font-bold ${colors.text}`}>{pos.average_marks.toFixed(1)}%</span>\n                                    </div>\n                                    <div className=\"flex justify-between text-sm\">\n                                      <span className=\"opacity-75\">Subjects:</span>\n                                      <span>{pos.passed_subjects}/{pos.total_subjects} Passed</span>\n                                    </div>\n                                  </div>\n                                </div>\n                              )\n                            })}\n                          </div>\n                        </CardContent>\n                      </Card>\n                    )}\n\n                    {/* Students with all subjects table */}\n                    <div className=\"overflow-x-auto border rounded-lg\">\n                      <table className=\"w-full\">\n                        <thead className=\"bg-gray-50\">\n                          <tr>\n                            <th className=\"text-left py-3 px-4 font-medium text-gray-900 sticky left-0 bg-gray-50 z-10 min-w-[200px]\">\n                              Position\n                            </th>\n                            <th className=\"text-left py-3 px-4 font-medium text-gray-900 sticky left-[60px] bg-gray-50 z-10 min-w-[200px]\">\n                              Student Name / Admission\n                            </th>\n                            {availableSubjects.map(subject => (\n                              <th key={subject} className=\"text-center py-3 px-4 font-medium text-gray-900 min-w-[140px]\">\n                                {subject}\n                              </th>\n                            ))}\n                            <th className=\"text-center py-3 px-4 font-medium text-gray-900 min-w-[100px]\">\n                              Overall\n                            </th>\n                            <th className=\"text-center py-3 px-4 font-medium text-gray-900 min-w-[120px]\">\n                              Actions\n                            </th>\n                          </tr>\n                        </thead>\n                        <tbody>\n                          {(isLoadingGrades && !grades.length) ? (\n                            <tr>\n                              <td colSpan={(availableSubjects.length || 1) + 4} className=\"py-8 text-center text-gray-500\">\n                                Loading grades...\n                              </td>\n                            </tr>\n                          ) : filteredStudents.length === 0 ? (\n                            <tr>\n                              <td colSpan={(availableSubjects.length || 1) + 4} className=\"py-8 text-center text-gray-500\">\n                                {availableSubjects.length === 0 \n                                  ? 'No grades found for this class. Select a class and term to start adding grades.' \n                                  : 'No students found in this class'}\n                              </td>\n                            </tr>\n                          ) : (\n                            filteredStudents.map(({ student, grades, overallGPA, passedSubjects, totalSubjects }) => {\n                              // Find student position\n                              const studentPosition = positionsData?.positions.find(p => p.student_id === student.id)\n                              const getPositionBadge = (position?: number) => {\n                                if (!position) return null\n                                if (position === 1) return <Badge className=\"bg-yellow-100 text-yellow-800 border-yellow-400\"><Trophy className=\"h-3 w-3 mr-1\" />1st</Badge>\n                                if (position === 2) return <Badge className=\"bg-gray-100 text-gray-800 border-gray-400\"><Medal className=\"h-3 w-3 mr-1\" />2nd</Badge>\n                                if (position === 3) return <Badge className=\"bg-orange-100 text-orange-800 border-orange-400\"><Medal className=\"h-3 w-3 mr-1\" />3rd</Badge>\n                                return <Badge variant=\"outline\">{position}</Badge>\n                              }\n                              \n                              return (\n                              <tr key={student.id} className=\"border-b hover:bg-gray-50\">\n                              <td className=\"py-3 px-4 sticky left-0 bg-white z-10 text-center\">\n                                  {getPositionBadge(studentPosition?.position) || '-'}\n                                </td>\n                              <td className=\"py-3 px-4 sticky left-[60px] bg-white z-10\">\n                                  <div className=\"flex items-center gap-3\">\n                                  <div className=\"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center\">\n                                    <Users className=\"h-4 w-4 text-blue-600\" />\n                                    </div>\n                                    <div>\n                                      <div \n                                        className=\"font-medium cursor-pointer hover:text-blue-600 hover:underline\"\n                                        onClick={() => router.push(`/admin/students?student_id=${student.id}`)}\n                                        title=\"View Student Details\"\n                                      >\n                                        {student.user?.full_name || 'Unknown'}\n                                      </div>\n                                      <div className=\"text-sm text-gray-600\">{student.admission_number}</div>\n                                    </div>\n                                  </div>\n                                </td>\n                              {availableSubjects.map(subject => {\n                                const grade = grades[subject]\n                                const isEditing = editingGrade?.student_id === student.id && \n                                                  editingGrade?.subject === subject\n                                \n                                return (\n                                  <td key={subject} className=\"py-3 px-4 text-center\">\n                                  {isEditing ? (\n                                      <div className=\"flex flex-col gap-1\">\n                                    <Input\n                                      type=\"number\"\n                                      min=\"0\"\n                                      max=\"100\"\n                                      step=\"0.01\"\n                                          value={editingGrade.marks}\n                                          onChange={(e) => {\n                                            const value = e.target.value\n                                            const marks = value === '' ? '' : (isNaN(Number(value)) ? editingGrade.marks : Number(value))\n                                            // Clamp marks between 0 and 100\n                                            const clampedMarks = typeof marks === 'number' \n                                              ? Math.max(0, Math.min(100, marks)) \n                                              : marks\n                                            const newGrade = clampedMarks !== '' && typeof clampedMarks === 'number' \n                                              ? calculateGrade(clampedMarks) \n                                              : ''\n                                            setEditingGrade({ \n                                              ...editingGrade, \n                                              marks: clampedMarks, \n                                              grade: newGrade \n                                            })\n                                          }}\n                                          className=\"w-20 text-center mx-auto\"\n                                          autoFocus\n                                        />\n                                        {editingGrade.grade && (\n                                          <Badge className={`${getGradeColor(editingGrade.grade)} text-xs`}>\n                                            {editingGrade.grade}\n                                    </Badge>\n                                        )}\n                                        <div className=\"flex gap-1 justify-center\">\n                                          <Button \n                                            size=\"sm\" \n                                            variant=\"outline\"\n                                            onClick={handleSave}\n                                            disabled={isSaving || createGradeMutation.isPending || updateGradeMutation.isPending}\n                                            className=\"h-6 px-2\"\n                                            title=\"Save grade\"\n                                          >\n                                            <Save className=\"h-3 w-3\" />\n                                          </Button>\n                                          <Button \n                                            size=\"sm\" \n                                            variant=\"outline\"\n                                            onClick={() => setEditingGrade(null)}\n                                            className=\"h-6 px-2\"\n                                          >\n                                            <X className=\"h-3 w-3\" />\n                                          </Button>\n                                    </div>\n                                    </div>\n                                    ) : grade ? (\n                                      <div className=\"flex flex-col items-center gap-1 group\">\n                                        <div className=\"font-medium\">{grade.marks}/100</div>\n                                        <Badge className={getGradeColor(grade.grade)}>\n                                          {grade.grade}\n                                        </Badge>\n                                        <div className=\"flex gap-1 mt-1 opacity-0 group-hover:opacity-100 transition-opacity\">\n                                          <Button \n                                            size=\"sm\" \n                                            variant=\"ghost\"\n                                            onClick={() => startEdit(student.id, subject, grade)}\n                                            className=\"h-6 w-6 p-0\"\n                                            title=\"Edit\"\n                                          >\n                                            <Edit className=\"h-3 w-3\" />\n                                          </Button>\n                                          {grade.id && (\n                                          <Button \n                                            size=\"sm\" \n                                              variant=\"ghost\"\n                                              onClick={() => {\n                                                if (confirm(`Delete grade for ${subject}?`)) {\n                                                  deleteGradeMutation.mutate(grade.id!)\n                                                }\n                                              }}\n                                              className=\"h-6 w-6 p-0 text-red-600 hover:text-red-700\"\n                                              title=\"Delete\"\n                                            >\n                                              <Trash2 className=\"h-3 w-3\" />\n                                          </Button>\n                                          )}\n                                        </div>\n                                      </div>\n                                      ) : (\n                                          <Button \n                                            size=\"sm\" \n                                        variant=\"ghost\"\n                                        onClick={() => startEdit(student.id, subject)}\n                                        className=\"text-gray-400 hover:text-gray-600\"\n                                        title=\"Add Grade\"\n                                      >\n                                        <Plus className=\"h-4 w-4\" />\n                                          </Button>\n                                    )}\n                                  </td>\n                                )\n                              })}\n                              <td className=\"py-3 px-4 text-center\">\n                                <div className=\"flex flex-col items-center gap-1\">\n                                  <div className=\"font-semibold text-lg\">\n                                    {overallGPA ? overallGPA.toFixed(1) : '-'}%\n                                  </div>\n                                  <div className=\"text-xs text-gray-500\">\n                                    {passedSubjects ?? 0}/{totalSubjects ?? 0} Pass\n                                  </div>\n                                </div>\n                              </td>\n                              <td className=\"py-3 px-4 text-center\">\n                                <div className=\"flex justify-center gap-2\">\n                                          <Button \n                                            size=\"sm\" \n                                            variant=\"outline\"\n                                    onClick={() => {\n                                      setSelectedStudentForReport(student.id)\n                                      setShowReportCardModal(true)\n                                    }}\n                                    title=\"View Report Card\"\n                                  >\n                                    <Eye className=\"h-4 w-4\" />\n                                          </Button>\n                                      <Button \n                                        size=\"sm\"\n                                    variant=\"outline\"\n                                        onClick={() => {\n                                      const hasAllGrades = availableSubjects.every(subj => grades[subj])\n                                      if (!hasAllGrades) {\n                                        toast.info(`This student has ${Object.keys(grades).length} of ${availableSubjects.length} subjects graded`)\n                                      } else {\n                                        setSelectedStudentForReport(student.id)\n                                        setShowReportCardModal(true)\n                                      }\n                                    }}\n                                    title=\"Quick View\"\n                                  >\n                                    <FileText className=\"h-4 w-4\" />\n                                      </Button>\n                                  </div>\n                                </td>\n                              </tr>\n                            )\n                            })\n                          )}\n                        </tbody>\n                      </table>\n                    </div>\n\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          )}\n\n          {/* Bulk Entry Tab */}\n          {activeTab === 'bulk-entry' && (\n            <Card>\n              <CardHeader>\n                <CardTitle>Bulk Grade Entry</CardTitle>\n                <p className=\"text-sm text-gray-600\">Enter grades for multiple students at once</p>\n              </CardHeader>\n              <CardContent>\n                {!selectedClass ? (\n                  <div className=\"text-center py-12 text-gray-500\">\n                    <Plus className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n                    <p className=\"text-lg font-medium mb-2\">Select a Class</p>\n                    <p>Choose a class to start bulk grade entry</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-4\">\n                    <p className=\"text-sm text-gray-600\">\n                      Use the \"Student Grades\" tab to enter grades. You can quickly add grades by clicking the + button for each subject.\n                        </p>\n                      </div>\n                )}\n              </CardContent>\n            </Card>\n          )}\n\n          {/* Report Cards Tab */}\n          {activeTab === 'report-cards' && (\n            <Card>\n              <CardHeader>\n                <CardTitle>Report Cards</CardTitle>\n                <p className=\"text-sm text-gray-600\">Generate and view student report cards</p>\n              </CardHeader>\n              <CardContent>\n                {!selectedClass ? (\n                  <div className=\"text-center py-12 text-gray-500\">\n                    <FileText className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n                    <p className=\"text-lg font-medium mb-2\">Select a Class</p>\n                    <p>Choose a class to view report cards</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-4\">\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                      {filteredStudents.map(({ student, overallGPA, passedSubjects, totalSubjects }) => (\n                        <Card key={student.id} className=\"hover:shadow-lg transition-shadow\">\n                          <CardContent className=\"p-6\">\n                            <div className=\"flex items-start justify-between mb-4\">\n                                <div className=\"flex items-center gap-3\">\n                                <div className=\"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center\">\n                                  <Users className=\"h-6 w-6 text-blue-600\" />\n                                  </div>\n                                  <div>\n                                  <div className=\"font-semibold\">{student.user?.full_name || 'Unknown'}</div>\n                                  <div className=\"text-sm text-gray-600\">{student.admission_number}</div>\n                                  </div>\n                                </div>\n                            </div>\n                            <div className=\"space-y-2 mb-4\">\n                              <div className=\"flex justify-between text-sm\">\n                                <span className=\"text-gray-600\">Overall GPA:</span>\n                                <span className=\"font-semibold\">{overallGPA ? overallGPA.toFixed(1) : 'N/A'}%</span>\n                              </div>\n                              <div className=\"flex justify-between text-sm\">\n                                <span className=\"text-gray-600\">Status:</span>\n                                <Badge className={passedSubjects === totalSubjects && (passedSubjects ?? 0) > 0 ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'}>\n                                  {passedSubjects ?? 0}/{totalSubjects ?? 0} Passed\n                                </Badge>\n                    </div>\n                      </div>\n                        <Button \n                              className=\"w-full\"\n                          onClick={() => {\n                                setSelectedStudentForReport(student.id)\n                                setShowReportCardModal(true)\n                          }}\n                        >\n                              <Eye className=\"h-4 w-4 mr-2\" />\n                              View Report Card\n                        </Button>\n                          </CardContent>\n                        </Card>\n                      ))}\n                      </div>\n\n                    {filteredStudents.length === 0 && (\n                      <div className=\"text-center py-12 text-gray-500\">\n                        <Users className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n                        <p className=\"text-lg font-medium mb-2\">No students found</p>\n                        <p>No students match your search criteria</p>\n                    </div>\n                    )}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          )}\n\n          {/* Analytics Tab */}\n          {activeTab === 'analytics' && (\n            <div className=\"space-y-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle>Grade Analytics</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4 mb-6\">\n                    {Object.entries(stats.gradeDistribution).map(([grade, count]) => (\n                      <div key={grade} className=\"text-center p-4 border rounded-lg\">\n                        <div className={`inline-flex items-center justify-center w-12 h-12 rounded-full text-lg font-bold ${getGradeColor(grade)}`}>\n                          {grade}\n                  </div>\n                        <p className=\"mt-2 text-sm font-medium\">{count as number}</p>\n                        <p className=\"text-xs text-gray-500\">students</p>\n            </div>\n                    ))}\n                  </div>\n                  \n                  {availableSubjects.length > 0 && (\n                    <div>\n                      <h3 className=\"font-semibold mb-4\">Subject-wise Performance</h3>\n                      <div className=\"space-y-3\">\n                        {availableSubjects.map(subject => {\n                          const subjectGrades = grades.filter((g: Grade) => g.subject === subject)\n                          const avgMarks = subjectGrades.length > 0\n                            ? (subjectGrades.reduce((sum: number, g: Grade) => sum + Number(g.marks), 0) / subjectGrades.length).toFixed(1)\n                            : 0\n                          const passRate = subjectGrades.length > 0\n                            ? Math.round((subjectGrades.filter((g: Grade) => Number(g.marks) >= 50).length / subjectGrades.length) * 100)\n                            : 0\n                          \n                          return (\n                            <div key={subject} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                              <span className=\"font-medium\">{subject}</span>\n                              <div className=\"flex gap-4\">\n                                <span className=\"text-sm text-gray-600\">Avg: {avgMarks}%</span>\n                                <span className=\"text-sm text-gray-600\">Pass: {passRate}%</span>\n                  </div>\n                            </div>\n                          )\n                        })}\n                      </div>\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n            </div>\n          )}\n        </div>\n\n        {/* Report Card Modal */}\n        {showReportCardModal && selectedStudentData && (\n          <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4\">\n            <div className=\"w-full max-w-4xl bg-white rounded-lg shadow-xl max-h-[90vh] overflow-auto print:shadow-none print:max-h-none\">\n              {/* Report Card Header */}\n              <div className=\"p-6 border-b print:border-b-2 print:border-gray-900\">\n                <div className=\"flex justify-between items-start mb-4 print:mb-6\">\n                  <div>\n                    <h2 className=\"text-3xl font-bold print:text-4xl\">ACADEMIC REPORT CARD</h2>\n                    <p className=\"text-lg text-gray-600 print:text-xl\">{schoolName}</p>\n                  </div>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => setShowReportCardModal(false)}\n                    className=\"print:hidden\"\n                >\n                  <X className=\"h-5 w-5\" />\n                  </Button>\n              </div>\n                \n                {/* Student Info */}\n                <div className=\"grid grid-cols-2 gap-4 print:gap-6 mb-4\">\n                <div>\n                    <p className=\"text-sm text-gray-600 print:text-base\">Student Name:</p>\n                    <p className=\"font-semibold text-lg print:text-xl\">\n                      {selectedStudentData.student.user?.full_name || 'Unknown'}\n                    </p>\n                </div>\n                  <div>\n                    <p className=\"text-sm text-gray-600 print:text-base\">Admission Number:</p>\n                    <p className=\"font-semibold text-lg print:text-xl\">\n                      {selectedStudentData.student.admission_number}\n                    </p>\n                </div>\n                  <div>\n                    <p className=\"text-sm text-gray-600 print:text-base\">Class:</p>\n                    <p className=\"font-semibold text-lg print:text-xl\">\n                      {classes.find(c => c.id === selectedClass)?.name} - {classes.find(c => c.id === selectedClass)?.section}\n                    </p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-600 print:text-base\">Term & Year:</p>\n                    <p className=\"font-semibold text-lg print:text-xl\">\n                      {selectedTerm} {selectedYear}\n                    </p>\n                  </div>\n                </div>\n              </div>\n\n              {/* Grades Table */}\n              <div className=\"p-6\">\n                <table className=\"w-full border-collapse print:border-2 print:border-gray-900\">\n                  <thead>\n                    <tr className=\"bg-gray-50 print:bg-gray-200\">\n                      <th className=\"border py-3 px-4 text-left font-semibold print:border-gray-900\">Subject</th>\n                      <th className=\"border py-3 px-4 text-center font-semibold print:border-gray-900\">Marks</th>\n                      <th className=\"border py-3 px-4 text-center font-semibold print:border-gray-900\">Grade</th>\n                      <th className=\"border py-3 px-4 text-center font-semibold print:border-gray-900\">Remarks</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {availableSubjects.map((subject, index) => {\n                      const grade = selectedStudentData.grades[subject]\n                      return (\n                        <tr key={subject} className={index % 2 === 0 ? 'bg-white' : 'bg-gray-50'}>\n                          <td className=\"border py-3 px-4 font-medium print:border-gray-900\">{subject}</td>\n                          <td className=\"border py-3 px-4 text-center print:border-gray-900\">\n                            {grade ? `${grade.marks}/100` : '-'}\n                          </td>\n                          <td className=\"border py-3 px-4 text-center print:border-gray-900\">\n                            {grade ? (\n                              <Badge className={getGradeColor(grade.grade)}>\n                                {grade.grade}\n                              </Badge>\n                            ) : (\n                              '-'\n                            )}\n                          </td>\n                          <td className=\"border py-3 px-4 text-center text-sm print:border-gray-900\">\n                            {grade?.remarks || '-'}\n                          </td>\n                        </tr>\n                      )\n                    })}\n                  </tbody>\n                  <tfoot className=\"bg-gray-50 print:bg-gray-200 font-semibold\">\n                    <tr>\n                      <td className=\"border py-3 px-4 print:border-gray-900\">Overall</td>\n                      <td className=\"border py-3 px-4 text-center print:border-gray-900\">\n                        {selectedStudentData.overallGPA ? selectedStudentData.overallGPA.toFixed(1) : '-'}%\n                      </td>\n                      <td className=\"border py-3 px-4 text-center print:border-gray-900\">\n                        {selectedStudentData.overallGPA ? calculateGrade(selectedStudentData.overallGPA) : '-'}\n                      </td>\n                      <td className=\"border py-3 px-4 text-center print:border-gray-900\">\n                        {selectedStudentData.passedSubjects}/{selectedStudentData.totalSubjects} Passed\n                      </td>\n                    </tr>\n                  </tfoot>\n                </table>\n\n                {/* Summary */}\n                <div className=\"mt-6 p-4 bg-blue-50 print:bg-gray-100 rounded-lg print:rounded-none\">\n                  <h3 className=\"font-semibold mb-2 print:text-lg\">Performance Summary</h3>\n                  <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm print:text-base\">\n                    <div>\n                      <p className=\"text-gray-600\">Total Subjects</p>\n                      <p className=\"font-semibold text-lg\">{availableSubjects.length}</p>\n                    </div>\n                    <div>\n                      <p className=\"text-gray-600\">Passed</p>\n                      <p className=\"font-semibold text-lg text-green-600\">\n                        {selectedStudentData.passedSubjects || 0}\n                      </p>\n                    </div>\n                    <div>\n                      <p className=\"text-gray-600\">Overall GPA</p>\n                      <p className=\"font-semibold text-lg text-blue-600\">\n                        {selectedStudentData.overallGPA ? selectedStudentData.overallGPA.toFixed(1) : 'N/A'}%\n                      </p>\n                    </div>\n                    <div>\n                      <p className=\"text-gray-600\">Status</p>\n                      <p className=\"font-semibold text-lg\">\n                        {selectedStudentData.passedSubjects === selectedStudentData.totalSubjects && \n                         (selectedStudentData.totalSubjects ?? 0) > 0 ? 'Passed' : 'In Progress'}\n                      </p>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Action Buttons */}\n              <div className=\"p-6 border-t flex justify-end gap-3 print:hidden\">\n                <Button variant=\"outline\" onClick={handlePrintReportCard}>\n                  <Printer className=\"h-4 w-4 mr-2\" />\n                  Print\n                </Button>\n                <Button onClick={() => setShowReportCardModal(false)}>\n                  Close\n                </Button>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </DashboardLayout>\n  )\n}","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\admin\\grading-schemes\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ConfirmDialog' is defined but never used.","line":11,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":14,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":30},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertCircle' is defined but never used.","line":14,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":50},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":50,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":50,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1991,1994],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1991,1994],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":68,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":68,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2739,2742],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2739,2742],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":86,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":86,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3524,3527],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3524,3527],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":102,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":102,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4184,4187],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4184,4187],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":161,"column":99,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":161,"endColumn":102,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5729,5732],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5729,5732],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":1,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":382,"column":53,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[13400,13454],"text":"No criteria added yet. Click &quot;Add Criterion\" to start."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[13400,13454],"text":"No criteria added yet. Click &ldquo;Add Criterion\" to start."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[13400,13454],"text":"No criteria added yet. Click &#34;Add Criterion\" to start."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[13400,13454],"text":"No criteria added yet. Click &rdquo;Add Criterion\" to start."},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":1,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":382,"column":67,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[13400,13454],"text":"No criteria added yet. Click \"Add Criterion&quot; to start."},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[13400,13454],"text":"No criteria added yet. Click \"Add Criterion&ldquo; to start."},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[13400,13454],"text":"No criteria added yet. Click \"Add Criterion&#34; to start."},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[13400,13454],"text":"No criteria added yet. Click \"Add Criterion&rdquo; to start."},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState } from 'react'\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Textarea } from '@/components/ui/textarea'\nimport { toast } from '@/components/ui/toast'\nimport { ConfirmDialog } from '@/components/shared/ConfirmDialog'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { \n  Plus, Edit, Trash2, Save, X, Check, AlertCircle, \n  Settings, Award, Info, ArrowUp, ArrowDown\n} from 'lucide-react'\nimport { gradingSchemeService, GradingScheme, GradingCriterion } from '@/services/gradingSchemeService'\n\nexport default function GradingSchemesPage() {\n  const queryClient = useQueryClient()\n  const [editingScheme, setEditingScheme] = useState<GradingScheme | null>(null)\n  const [isCreating, setIsCreating] = useState(false)\n  const [formData, setFormData] = useState({\n    name: '',\n    description: '',\n    is_active: true,\n    is_default: false,\n    criteria: [] as Omit<GradingCriterion, 'id'>[]\n  })\n\n  const { data: schemes = [], isLoading } = useQuery({\n    queryKey: ['grading-schemes'],\n    queryFn: () => gradingSchemeService.getGradingSchemes({ include_default: true }),\n  })\n\n  const { data: defaultScheme } = useQuery({\n    queryKey: ['default-grading-scheme'],\n    queryFn: () => gradingSchemeService.getDefaultGradingScheme(),\n  })\n\n  const createMutation = useMutation({\n    mutationFn: (data: typeof formData) => gradingSchemeService.createGradingScheme(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['grading-schemes'] })\n      queryClient.invalidateQueries({ queryKey: ['default-grading-scheme'] })\n      toast.success('Grading scheme created successfully!')\n      setIsCreating(false)\n      resetForm()\n    },\n    onError: (error: any) => {\n      const errorMessage = error?.response?.data?.message || \n                          error?.response?.data?.detail || \n                          error?.message || \n                          'Failed to create grading scheme'\n      toast.error(errorMessage)\n    }\n  })\n\n  const updateMutation = useMutation({\n    mutationFn: ({ id, data }: { id: string; data: Partial<GradingScheme> }) => \n      gradingSchemeService.updateGradingScheme(id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['grading-schemes'] })\n      queryClient.invalidateQueries({ queryKey: ['default-grading-scheme'] })\n      toast.success('Grading scheme updated successfully!')\n      setEditingScheme(null)\n    },\n    onError: (error: any) => {\n      const errorMessage = error?.response?.data?.message || \n                          error?.response?.data?.detail || \n                          error?.message || \n                          'Failed to update grading scheme'\n      toast.error(errorMessage)\n    }\n  })\n\n  const updateCriteriaMutation = useMutation({\n    mutationFn: ({ id, criteria }: { id: string; criteria: Omit<GradingCriterion, 'id'>[] }) =>\n      gradingSchemeService.updateGradingSchemeCriteria(id, criteria),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['grading-schemes'] })\n      queryClient.invalidateQueries({ queryKey: ['default-grading-scheme'] })\n      toast.success('Grading criteria updated successfully!')\n      setEditingScheme(null)\n    },\n    onError: (error: any) => {\n      const errorMessage = error?.response?.data?.message || \n                          error?.response?.data?.detail || \n                          error?.message || \n                          'Failed to update grading criteria'\n      toast.error(errorMessage)\n    }\n  })\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: string) => gradingSchemeService.deleteGradingScheme(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['grading-schemes'] })\n      queryClient.invalidateQueries({ queryKey: ['default-grading-scheme'] })\n      toast.success('Grading scheme deleted successfully!')\n    },\n    onError: (error: any) => {\n      const errorMessage = error?.response?.data?.message || \n                          error?.response?.data?.detail || \n                          error?.message || \n                          'Failed to delete grading scheme'\n      toast.error(errorMessage)\n    }\n  })\n\n  const resetForm = () => {\n    setFormData({\n      name: '',\n      description: '',\n      is_active: true,\n      is_default: false,\n      criteria: []\n    })\n  }\n\n  const handleStartCreate = () => {\n    resetForm()\n    setIsCreating(true)\n    setEditingScheme(null)\n  }\n\n  const handleStartEdit = (scheme: GradingScheme) => {\n    setEditingScheme(scheme)\n    setFormData({\n      name: scheme.name,\n      description: scheme.description || '',\n      is_active: scheme.is_active,\n      is_default: scheme.is_default,\n      criteria: scheme.criteria.map(c => ({\n        grade_name: c.grade_name,\n        min_marks: c.min_marks,\n        max_marks: c.max_marks,\n        gpa_value: c.gpa_value,\n        is_passing: c.is_passing,\n        display_order: c.display_order\n      }))\n    })\n    setIsCreating(false)\n  }\n\n  const handleAddCriterion = () => {\n    const newCriterion: Omit<GradingCriterion, 'id'> = {\n      grade_name: '',\n      min_marks: 0,\n      max_marks: 100,\n      gpa_value: 0,\n      is_passing: true,\n      display_order: formData.criteria.length\n    }\n    setFormData({\n      ...formData,\n      criteria: [...formData.criteria, newCriterion]\n    })\n  }\n\n  const handleUpdateCriterion = (index: number, field: keyof Omit<GradingCriterion, 'id'>, value: any) => {\n    const updated = [...formData.criteria]\n    updated[index] = { ...updated[index], [field]: value }\n    setFormData({ ...formData, criteria: updated })\n  }\n\n  const handleRemoveCriterion = (index: number) => {\n    const updated = formData.criteria.filter((_, i) => i !== index)\n    // Update display_order\n    updated.forEach((c, i) => {\n      c.display_order = i\n    })\n    setFormData({ ...formData, criteria: updated })\n  }\n\n  const handleMoveCriterion = (index: number, direction: 'up' | 'down') => {\n    if (direction === 'up' && index === 0) return\n    if (direction === 'down' && index === formData.criteria.length - 1) return\n\n    const updated = [...formData.criteria]\n    const newIndex = direction === 'up' ? index - 1 : index + 1\n    ;[updated[index], updated[newIndex]] = [updated[newIndex], updated[index]]\n    \n    // Update display_order\n    updated.forEach((c, i) => {\n      c.display_order = i\n    })\n    \n    setFormData({ ...formData, criteria: updated })\n  }\n\n  const handleSave = () => {\n    // Validate\n    if (!formData.name.trim()) {\n      toast.error('Please enter a scheme name')\n      return\n    }\n\n    if (formData.criteria.length === 0) {\n      toast.error('Please add at least one grading criterion')\n      return\n    }\n\n    // Validate criteria\n    for (let i = 0; i < formData.criteria.length; i++) {\n      const c = formData.criteria[i]\n      if (!c.grade_name.trim()) {\n        toast.error(`Criterion ${i + 1}: Grade name is required`)\n        return\n      }\n      if (c.min_marks < 0 || c.min_marks > 100) {\n        toast.error(`Criterion ${i + 1}: Min marks must be 0-100`)\n        return\n      }\n      if (c.max_marks < 0 || c.max_marks > 100) {\n        toast.error(`Criterion ${i + 1}: Max marks must be 0-100`)\n        return\n      }\n      if (c.min_marks > c.max_marks) {\n        toast.error(`Criterion ${i + 1}: Min marks cannot be greater than max marks`)\n        return\n      }\n      if (c.gpa_value < 0 || c.gpa_value > 4.0) {\n        toast.error(`Criterion ${i + 1}: GPA value must be 0-4.0`)\n        return\n      }\n    }\n\n    // Check for overlapping ranges\n    const sorted = [...formData.criteria].sort((a, b) => a.display_order - b.display_order)\n    for (let i = 0; i < sorted.length - 1; i++) {\n      if (sorted[i].max_marks >= sorted[i + 1].min_marks) {\n        toast.error(`Overlapping mark ranges: ${sorted[i].grade_name} and ${sorted[i + 1].grade_name}`)\n        return\n      }\n    }\n\n    if (isCreating) {\n      createMutation.mutate(formData)\n    } else if (editingScheme) {\n      // Update scheme info\n      updateMutation.mutate({\n        id: editingScheme.id,\n        data: {\n          name: formData.name,\n          description: formData.description,\n          is_active: formData.is_active,\n          is_default: formData.is_default\n        }\n      }, {\n        onSuccess: () => {\n          // Update criteria\n          updateCriteriaMutation.mutate({\n            id: editingScheme.id,\n            criteria: formData.criteria\n          })\n        }\n      })\n    }\n  }\n\n  const handleDelete = (id: string) => {\n    if (confirm('Are you sure you want to delete this grading scheme? This action cannot be undone.')) {\n      deleteMutation.mutate(id)\n    }\n  }\n\n  const handleSetDefault = (id: string) => {\n    updateMutation.mutate({\n      id,\n      data: { is_default: true }\n    })\n  }\n\n  return (\n    <DashboardLayout allowedRoles={['admin', 'principal']}>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900\">Grading Schemes Management</h1>\n            <p className=\"text-gray-600 mt-1\">Configure custom grading criteria for your school</p>\n          </div>\n          {!isCreating && !editingScheme && (\n            <Button onClick={handleStartCreate}>\n              <Plus className=\"h-4 w-4 mr-2\" />\n              Create New Scheme\n            </Button>\n          )}\n        </div>\n\n        {/* Info Card */}\n        {defaultScheme && (\n          <Card className=\"bg-blue-50 border-blue-200\">\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-start gap-3\">\n                <Info className=\"h-5 w-5 text-blue-600 mt-0.5\" />\n                <div className=\"flex-1\">\n                  <p className=\"font-semibold text-blue-900\">Active Grading Scheme</p>\n                  <p className=\"text-sm text-blue-700\">{defaultScheme.name}</p>\n                  {defaultScheme.description && (\n                    <p className=\"text-xs text-blue-600 mt-1\">{defaultScheme.description}</p>\n                  )}\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Create/Edit Form */}\n        {(isCreating || editingScheme) && (\n          <Card>\n            <CardHeader>\n              <CardTitle>\n                {isCreating ? 'Create New Grading Scheme' : 'Edit Grading Scheme'}\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-6\">\n              {/* Basic Info */}\n              <div className=\"space-y-4\">\n                <div>\n                  <Label htmlFor=\"name\">Scheme Name *</Label>\n                  <Input\n                    id=\"name\"\n                    value={formData.name}\n                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                    placeholder=\"e.g., Standard Grading System\"\n                  />\n                </div>\n\n                <div>\n                  <Label htmlFor=\"description\">Description</Label>\n                  <Textarea\n                    id=\"description\"\n                    value={formData.description}\n                    onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                    placeholder=\"Describe this grading scheme...\"\n                    rows={3}\n                  />\n                </div>\n\n                <div className=\"flex gap-6\">\n                  <label className=\"flex items-center gap-2\">\n                    <input\n                      type=\"checkbox\"\n                      checked={formData.is_active}\n                      onChange={(e) => setFormData({ ...formData, is_active: e.target.checked })}\n                      className=\"h-4 w-4\"\n                    />\n                    <span>Active</span>\n                  </label>\n                  <label className=\"flex items-center gap-2\">\n                    <input\n                      type=\"checkbox\"\n                      checked={formData.is_default}\n                      onChange={(e) => setFormData({ ...formData, is_default: e.target.checked })}\n                      className=\"h-4 w-4\"\n                    />\n                    <span>Set as Default</span>\n                  </label>\n                </div>\n              </div>\n\n              {/* Criteria */}\n              <div className=\"space-y-4\">\n                <div className=\"flex justify-between items-center\">\n                  <Label>Grading Criteria *</Label>\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={handleAddCriterion}\n                  >\n                    <Plus className=\"h-4 w-4 mr-2\" />\n                    Add Criterion\n                  </Button>\n                </div>\n\n                {formData.criteria.length === 0 ? (\n                  <div className=\"text-center py-8 text-gray-500 border-2 border-dashed rounded-lg\">\n                    <Award className=\"h-12 w-12 mx-auto mb-2 text-gray-300\" />\n                    <p>No criteria added yet. Click \"Add Criterion\" to start.</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-3\">\n                    {formData.criteria\n                      .sort((a, b) => a.display_order - b.display_order)\n                      .map((criterion, index) => (\n                        <Card key={index} className=\"p-4\">\n                          <div className=\"grid grid-cols-12 gap-4 items-center\">\n                            <div className=\"col-span-12 md:col-span-2\">\n                              <Label>Grade Name *</Label>\n                              <Input\n                                value={criterion.grade_name}\n                                onChange={(e) => handleUpdateCriterion(index, 'grade_name', e.target.value)}\n                                placeholder=\"A+\"\n                              />\n                            </div>\n                            <div className=\"col-span-6 md:col-span-2\">\n                              <Label>Min Marks *</Label>\n                              <Input\n                                type=\"number\"\n                                step=\"0.01\"\n                                min=\"0\"\n                                max=\"100\"\n                                value={criterion.min_marks}\n                                onChange={(e) => handleUpdateCriterion(index, 'min_marks', parseFloat(e.target.value) || 0)}\n                              />\n                            </div>\n                            <div className=\"col-span-6 md:col-span-2\">\n                              <Label>Max Marks *</Label>\n                              <Input\n                                type=\"number\"\n                                step=\"0.01\"\n                                min=\"0\"\n                                max=\"100\"\n                                value={criterion.max_marks}\n                                onChange={(e) => handleUpdateCriterion(index, 'max_marks', parseFloat(e.target.value) || 100)}\n                              />\n                            </div>\n                            <div className=\"col-span-6 md:col-span-2\">\n                              <Label>GPA Value</Label>\n                              <Input\n                                type=\"number\"\n                                step=\"0.01\"\n                                min=\"0\"\n                                max=\"4.0\"\n                                value={criterion.gpa_value}\n                                onChange={(e) => handleUpdateCriterion(index, 'gpa_value', parseFloat(e.target.value) || 0)}\n                              />\n                            </div>\n                            <div className=\"col-span-6 md:col-span-2 flex items-end gap-2\">\n                              <label className=\"flex items-center gap-2\">\n                                <input\n                                  type=\"checkbox\"\n                                  checked={criterion.is_passing}\n                                  onChange={(e) => handleUpdateCriterion(index, 'is_passing', e.target.checked)}\n                                  className=\"h-4 w-4\"\n                                />\n                                <span className=\"text-sm\">Passing</span>\n                              </label>\n                            </div>\n                            <div className=\"col-span-12 md:col-span-2 flex gap-2 items-end\">\n                              <Button\n                                type=\"button\"\n                                variant=\"outline\"\n                                size=\"sm\"\n                                onClick={() => handleMoveCriterion(index, 'up')}\n                                disabled={index === 0}\n                                title=\"Move up\"\n                              >\n                                <ArrowUp className=\"h-4 w-4\" />\n                              </Button>\n                              <Button\n                                type=\"button\"\n                                variant=\"outline\"\n                                size=\"sm\"\n                                onClick={() => handleMoveCriterion(index, 'down')}\n                                disabled={index === formData.criteria.length - 1}\n                                title=\"Move down\"\n                              >\n                                <ArrowDown className=\"h-4 w-4\" />\n                              </Button>\n                              <Button\n                                type=\"button\"\n                                variant=\"outline\"\n                                size=\"sm\"\n                                onClick={() => handleRemoveCriterion(index)}\n                                title=\"Remove\"\n                              >\n                                <Trash2 className=\"h-4 w-4 text-red-600\" />\n                              </Button>\n                            </div>\n                          </div>\n                        </Card>\n                      ))}\n                  </div>\n                )}\n              </div>\n\n              {/* Actions */}\n              <div className=\"flex gap-3 justify-end\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => {\n                    setIsCreating(false)\n                    setEditingScheme(null)\n                    resetForm()\n                  }}\n                >\n                  Cancel\n                </Button>\n                <Button\n                  onClick={handleSave}\n                  disabled={createMutation.isPending || updateMutation.isPending || updateCriteriaMutation.isPending}\n                >\n                  <Save className=\"h-4 w-4 mr-2\" />\n                  {isCreating ? 'Create Scheme' : 'Save Changes'}\n                </Button>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Schemes List */}\n        {!isCreating && !editingScheme && (\n          <div className=\"grid gap-4\">\n            {isLoading ? (\n              <div className=\"text-center py-12\">Loading grading schemes...</div>\n            ) : schemes.length === 0 ? (\n              <Card>\n                <CardContent className=\"py-12 text-center text-gray-500\">\n                  <Settings className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n                  <p className=\"text-lg font-medium mb-2\">No Grading Schemes</p>\n                  <p>Create your first grading scheme to customize grade calculations</p>\n                </CardContent>\n              </Card>\n            ) : (\n              schemes.map((scheme) => (\n                <Card key={scheme.id} className={scheme.is_default ? 'border-blue-500 border-2' : ''}>\n                  <CardHeader>\n                    <div className=\"flex justify-between items-start\">\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-2\">\n                          <CardTitle>{scheme.name}</CardTitle>\n                          {scheme.is_default && (\n                            <span className=\"px-2 py-1 text-xs font-semibold bg-blue-100 text-blue-800 rounded\">\n                              Default\n                            </span>\n                          )}\n                          {!scheme.is_active && (\n                            <span className=\"px-2 py-1 text-xs font-semibold bg-gray-100 text-gray-800 rounded\">\n                              Inactive\n                            </span>\n                          )}\n                        </div>\n                        {scheme.description && (\n                          <p className=\"text-sm text-gray-600 mt-1\">{scheme.description}</p>\n                        )}\n                      </div>\n                      <div className=\"flex gap-2\">\n                        {!scheme.is_default && (\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            onClick={() => handleSetDefault(scheme.id)}\n                            title=\"Set as default\"\n                          >\n                            <Check className=\"h-4 w-4\" />\n                          </Button>\n                        )}\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={() => handleStartEdit(scheme)}\n                        >\n                          <Edit className=\"h-4 w-4\" />\n                        </Button>\n                        {!scheme.is_default && (\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            onClick={() => handleDelete(scheme.id)}\n                          >\n                            <Trash2 className=\"h-4 w-4 text-red-600\" />\n                          </Button>\n                        )}\n                      </div>\n                    </div>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"space-y-2\">\n                      <p className=\"text-sm font-semibold mb-3\">Grading Criteria ({scheme.criteria.length} grades):</p>\n                      <div className=\"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-2\">\n                        {scheme.criteria\n                          .sort((a, b) => (b.display_order || 0) - (a.display_order || 0))\n                          .map((criterion) => (\n                            <div\n                              key={criterion.id || criterion.grade_name}\n                              className=\"p-3 border rounded-lg text-center\"\n                            >\n                              <div className=\"font-bold text-lg\">{criterion.grade_name}</div>\n                              <div className=\"text-xs text-gray-600 mt-1\">\n                                {criterion.min_marks}-{criterion.max_marks}%\n                              </div>\n                              <div className=\"text-xs text-gray-500 mt-1\">\n                                GPA: {criterion.gpa_value}\n                              </div>\n                              {!criterion.is_passing && (\n                                <div className=\"text-xs text-red-600 mt-1\">Failing</div>\n                              )}\n                            </div>\n                          ))}\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))\n            )}\n          </div>\n        )}\n      </div>\n    </DashboardLayout>\n  )\n}\n\n\n\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\admin\\papers\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Send' is defined but never used.","line":11,"column":144,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":148},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertCircle' is defined but never used.","line":11,"column":150,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":161},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'PaperCreate' is defined but never used.","line":12,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":42},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":93,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":93,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3710,3713],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3710,3713],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":111,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":111,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4330,4333],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4330,4333],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'filterPapers'. Either include it or remove the dependency array.","line":123,"column":6,"nodeType":"ArrayExpression","endLine":123,"endColumn":78,"suggestions":[{"desc":"Update the dependencies array to be: [papers, searchTerm, classFilter, subjectFilter, termFilter, yearFilter, filterPapers]","fix":{"range":[4529,4601],"text":"[papers, searchTerm, classFilter, subjectFilter, termFilter, yearFilter, filterPapers]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":130,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":130,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4768,4771],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4768,4771],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":142,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":142,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5099,5102],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5099,5102],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":188,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":188,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6584,6587],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6584,6587],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":226,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":226,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7643,7646],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7643,7646],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState, useEffect } from \"react\";\nimport { DashboardLayout } from \"@/components/layout/DashboardLayout\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { FileText, Plus, Search, Filter, Calendar, User, Download, Edit, Trash2, Upload, BookOpen, GraduationCap, CheckCircle, XCircle, Clock, Send, AlertCircle } from \"lucide-react\";\nimport { paperService, Paper, PaperCreate, PaperStats } from \"@/services/paperService\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { toast } from \"@/components/ui/toast\";\nimport { ConfirmDialog } from '@/components/shared/ConfirmDialog'\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Label } from \"@/components/ui/label\";\n\ninterface PaperFormData {\n  class_id: string;\n  class_name: string;\n  subject: string;\n  term: string;\n  year: number;\n  file_url: string;\n  file_name: string;\n  file_type: string;\n  file_size?: number;\n  description?: string;\n}\n\nconst termColors = {\n  first_term: \"bg-blue-100 text-blue-800\",\n  second_term: \"bg-green-100 text-green-800\",\n  third_term: \"bg-purple-100 text-purple-800\",\n};\n\nconst termLabels = {\n  first_term: \"First Term\",\n  second_term: \"Second Term\",\n  third_term: \"Third Term\",\n};\n\nexport default function PapersPage() {\n  const [papers, setPapers] = useState<Paper[]>([]);\n  const [filteredPapers, setFilteredPapers] = useState<Paper[]>([]);\n  const [stats, setStats] = useState<PaperStats | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [classFilter, setClassFilter] = useState(\"all_items\");\n  const [subjectFilter, setSubjectFilter] = useState(\"\");\n  const [termFilter, setTermFilter] = useState(\"all_items\");\n  const [yearFilter, setYearFilter] = useState(\"all_items\");\n  const [isFormOpen, setIsFormOpen] = useState(false);\n  const [editingPaper, setEditingPaper] = useState<Paper | null>(null);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [uploadedFile, setUploadedFile] = useState<File | null>(null);\n  const [showPendingApprovals, setShowPendingApprovals] = useState(false);\n  const [selectedPaperForApproval, setSelectedPaperForApproval] = useState<Paper | null>(null);\n  const [approvalAction, setApprovalAction] = useState<'approve' | 'reject' | null>(null);\n  const [rejectionReason, setRejectionReason] = useState(\"\");\n  const [confirmDialog, setConfirmDialog] = useState<{\n    open: boolean\n    title: string\n    description: string\n    onConfirm: () => void\n  }>({\n    open: false,\n    title: '',\n    description: '',\n    onConfirm: () => {},\n  });\n  const queryClient = useQueryClient();\n\n  // Fetch pending papers\n  const { data: pendingPapersData, refetch: refetchPending } = useQuery({\n    queryKey: ['pending-papers'],\n    queryFn: () => paperService.getPending(),\n  });\n\n  // Approval/Rejection mutations\n  const approveMutation = useMutation({\n    mutationFn: (paperId: string) => paperService.approve(paperId),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['pending-papers'] });\n      queryClient.invalidateQueries({ queryKey: ['papers'] });\n      toast.success('Paper approved successfully!');\n      setSelectedPaperForApproval(null);\n      setApprovalAction(null);\n      refetchPending();\n      fetchPapers();\n    },\n    onError: (error: any) => {\n      toast.error(error?.message || 'Failed to approve paper');\n    }\n  });\n\n  const rejectMutation = useMutation({\n    mutationFn: ({ paperId, reason }: { paperId: string; reason: string }) => \n      paperService.reject(paperId, reason),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['pending-papers'] });\n      queryClient.invalidateQueries({ queryKey: ['papers'] });\n      toast.success('Paper rejected');\n      setSelectedPaperForApproval(null);\n      setApprovalAction(null);\n      setRejectionReason(\"\");\n      refetchPending();\n      fetchPapers();\n    },\n    onError: (error: any) => {\n      toast.error(error?.message || 'Failed to reject paper');\n    }\n  });\n\n  useEffect(() => {\n    fetchPapers();\n    fetchStats();\n  }, []);\n\n  useEffect(() => {\n    filterPapers();\n  }, [papers, searchTerm, classFilter, subjectFilter, termFilter, yearFilter]);\n\n  const fetchPapers = async () => {\n    try {\n      setIsLoading(true);\n      const data = await paperService.getAll();\n      setPapers(data);\n    } catch (error: any) {\n      console.error(\"Failed to fetch papers:\", error);\n      toast.error(error.response?.data?.detail || \"Failed to fetch papers\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const fetchStats = async () => {\n    try {\n      const data = await paperService.getStats();\n      setStats(data);\n    } catch (error: any) {\n      console.error(\"Failed to fetch stats:\", error);\n    }\n  };\n\n  const filterPapers = () => {\n    let filtered = papers;\n\n    if (searchTerm) {\n      filtered = filtered.filter(paper =>\n        paper.subject.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        paper.class_name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        paper.file_name.toLowerCase().includes(searchTerm.toLowerCase())\n      );\n    }\n\n    if (classFilter && classFilter !== \"all_items\") {\n      filtered = filtered.filter(paper => paper.class_name === classFilter);\n    }\n\n    if (subjectFilter) {\n      filtered = filtered.filter(paper => paper.subject.toLowerCase().includes(subjectFilter.toLowerCase()));\n    }\n\n    if (termFilter && termFilter !== \"all_items\") {\n      filtered = filtered.filter(paper => paper.term === termFilter);\n    }\n\n    if (yearFilter && yearFilter !== \"all_items\") {\n      filtered = filtered.filter(paper => paper.year.toString() === yearFilter);\n    }\n\n    setFilteredPapers(filtered);\n  };\n\n  const handleDeletePaper = async (id: string) => {\n    setConfirmDialog({\n      open: true,\n      title: 'Delete Paper',\n      description: 'Are you sure you want to delete this paper? This action cannot be undone.',\n      onConfirm: async () => {\n        try {\n          await paperService.delete(id);\n          setPapers(papers.filter(p => p.id !== id));\n          toast.success(\"Paper deleted successfully\");\n          fetchStats();\n        } catch (error: any) {\n          console.error(\"Failed to delete paper:\", error);\n          toast.error(error.response?.data?.detail || \"Failed to delete paper\");\n        }\n      },\n    });\n  };\n\n  const handleCreatePaper = () => {\n    setEditingPaper(null);\n    setUploadedFile(null);\n    setIsFormOpen(true);\n  };\n\n  const handleEditPaper = (paper: Paper) => {\n    setEditingPaper(paper);\n    setUploadedFile(null);\n    setIsFormOpen(true);\n  };\n\n  const handleFormSubmit = async (data: PaperFormData) => {\n    try {\n      setIsSubmitting(true);\n\n      if (editingPaper) {\n        const updated = await paperService.update(editingPaper.id, data);\n        setPapers(papers.map(p => p.id === updated.id ? updated : p));\n        toast.success(\"Paper updated successfully\");\n      } else {\n        const created = await paperService.create(data);\n        setPapers([created, ...papers]);\n        toast.success(\"Paper uploaded successfully\");\n      }\n\n      setIsFormOpen(false);\n      setEditingPaper(null);\n      setUploadedFile(null);\n      fetchStats();\n    } catch (error: any) {\n      console.error(\"Failed to save paper:\", error);\n      toast.error(error.response?.data?.detail || \"Failed to save paper\");\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const handleDownload = (paper: Paper) => {\n    window.open(paper.file_url, '_blank');\n  };\n\n  // Get unique values for filters\n  const uniqueClasses = Array.from(new Set(papers.map(p => p.class_name))).sort();\n  const uniqueYears = Array.from(new Set(papers.map(p => p.year.toString()))).sort().reverse();\n\n  return (\n    <DashboardLayout allowedRoles={['admin', 'principal', 'teacher']}>\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-3xl font-bold text-gray-900\">Paper Management</h1>\n          <p className=\"text-gray-600 mt-1\">\n            Manage and organize exam papers for all classes\n          </p>\n        </div>\n        <div className=\"flex gap-3\">\n          {pendingPapersData && pendingPapersData.count > 0 && (\n            <Button\n              variant=\"outline\"\n              className=\"border-yellow-500 text-yellow-700 hover:bg-yellow-50\"\n              onClick={() => setShowPendingApprovals(true)}\n            >\n              <Clock className=\"h-4 w-4 mr-2\" />\n              Pending Approvals ({pendingPapersData.count})\n            </Button>\n          )}\n          <Button\n            className=\"bg-blue-600 hover:bg-blue-700 text-white\"\n            onClick={handleCreatePaper}\n          >\n            <Plus className=\"h-4 w-4 mr-2\" />\n            Upload Paper\n          </Button>\n        </div>\n      </div>\n\n      {/* Statistics */}\n      {stats && (\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center\">\n                <FileText className=\"h-8 w-8 text-blue-600\" />\n                <div className=\"ml-4\">\n                  <p className=\"text-sm font-medium text-gray-600\">Total Papers</p>\n                  <p className=\"text-2xl font-bold text-gray-900\">{stats.total_papers}</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center\">\n                <Upload className=\"h-8 w-8 text-green-600\" />\n                <div className=\"ml-4\">\n                  <p className=\"text-sm font-medium text-gray-600\">Recent Uploads</p>\n                  <p className=\"text-2xl font-bold text-gray-900\">{stats.recent_uploads}</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center\">\n                <GraduationCap className=\"h-8 w-8 text-purple-600\" />\n                <div className=\"ml-4\">\n                  <p className=\"text-sm font-medium text-gray-600\">Classes</p>\n                  <p className=\"text-2xl font-bold text-gray-900\">\n                    {Object.keys(stats.papers_by_class).length}\n                  </p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center\">\n                <BookOpen className=\"h-8 w-8 text-orange-600\" />\n                <div className=\"ml-4\">\n                  <p className=\"text-sm font-medium text-gray-600\">Subjects</p>\n                  <p className=\"text-2xl font-bold text-gray-900\">\n                    {Object.keys(stats.papers_by_subject).length}\n                  </p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      )}\n\n      {/* Filters */}\n      <Card>\n        <CardContent className=\"p-6\">\n          <div className=\"grid grid-cols-1 md:grid-cols-6 gap-4\">\n            <div className=\"relative\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4\" />\n              <Input\n                placeholder=\"Search papers...\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"pl-10\"\n              />\n            </div>\n\n            <Select value={classFilter} onValueChange={setClassFilter}>\n              <SelectTrigger>\n                <SelectValue placeholder=\"All Classes\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all_items\">All Classes</SelectItem>\n                {uniqueClasses.map(cls => (\n                  <SelectItem key={cls} value={cls}>{cls}</SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n\n            <Input\n              placeholder=\"Subject...\"\n              value={subjectFilter}\n              onChange={(e) => setSubjectFilter(e.target.value)}\n            />\n\n            <Select value={termFilter} onValueChange={setTermFilter}>\n              <SelectTrigger>\n                <SelectValue placeholder=\"All Terms\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all_items\">All Terms</SelectItem>\n                <SelectItem value=\"first_term\">First Term</SelectItem>\n                <SelectItem value=\"second_term\">Second Term</SelectItem>\n                <SelectItem value=\"third_term\">Third Term</SelectItem>\n              </SelectContent>\n            </Select>\n\n            <Select value={yearFilter} onValueChange={setYearFilter}>\n              <SelectTrigger>\n                <SelectValue placeholder=\"All Years\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all_items\">All Years</SelectItem>\n                {uniqueYears.map(year => (\n                  <SelectItem key={year} value={year}>{year}</SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n\n            <Button\n              variant=\"outline\"\n              onClick={() => {\n                setSearchTerm(\"\");\n                setClassFilter(\"all_items\");\n                setSubjectFilter(\"\");\n                setTermFilter(\"all_items\");\n                setYearFilter(\"all_items\");\n              }}\n              className=\"flex items-center gap-2\"\n            >\n              <Filter className=\"h-4 w-4\" />\n              Clear\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Papers List */}\n      <div className=\"space-y-4\">\n        {isLoading ? (\n          <div className=\"flex justify-center items-center py-12\">\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          </div>\n        ) : filteredPapers.length === 0 ? (\n          <Card>\n            <CardContent className=\"p-12 text-center\">\n              <FileText className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n              <h3 className=\"text-lg font-medium text-gray-900 mb-2\">No papers found</h3>\n              <p className=\"text-gray-600\">\n                {searchTerm || classFilter || subjectFilter || termFilter || yearFilter\n                  ? \"Try adjusting your filters to see more results.\"\n                  : \"Upload your first exam paper to get started.\"}\n              </p>\n            </CardContent>\n          </Card>\n        ) : (\n          filteredPapers.map((paper) => (\n            <Card key={paper.id} className=\"hover:shadow-lg transition-shadow\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex justify-between items-start\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center gap-3 mb-2\">\n                      <FileText className=\"h-5 w-5 text-blue-600\" />\n                      <h3 className=\"text-lg font-semibold text-gray-900\">\n                        {paper.subject}\n                      </h3>\n                      <Badge className={termColors[paper.term as keyof typeof termColors]}>\n                        {termLabels[paper.term as keyof typeof termLabels]}\n                      </Badge>\n                      <Badge className=\"bg-gray-100 text-gray-800\">\n                        {paper.year}\n                      </Badge>\n                    </div>\n\n                    <div className=\"flex items-center gap-4 text-sm text-gray-600 mb-2\">\n                      <div className=\"flex items-center gap-1\">\n                        <GraduationCap className=\"h-4 w-4\" />\n                        <span>{paper.class_name}</span>\n                      </div>\n                      <div className=\"flex items-center gap-1\">\n                        <User className=\"h-4 w-4\" />\n                        <span>{paper.uploaded_by_name || 'Unknown'}</span>\n                      </div>\n                      <div className=\"flex items-center gap-1\">\n                        <Calendar className=\"h-4 w-4\" />\n                        <span>{new Date(paper.upload_date).toLocaleDateString()}</span>\n                      </div>\n                    </div>\n\n                    <div className=\"text-sm text-gray-700\">\n                      <span className=\"font-medium\">File:</span> {paper.file_name}\n                      {paper.file_size && (\n                        <span className=\"ml-2 text-gray-500\">\n                          ({(paper.file_size / 1024 / 1024).toFixed(2)} MB)\n                        </span>\n                      )}\n                    </div>\n\n                    {paper.description && (\n                      <p className=\"text-sm text-gray-600 mt-2\">{paper.description}</p>\n                    )}\n                  </div>\n\n                  <div className=\"flex items-center gap-2 ml-4\">\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => handleDownload(paper)}\n                      className=\"text-green-600 hover:text-green-700\"\n                    >\n                      <Download className=\"h-4 w-4\" />\n                    </Button>\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => handleEditPaper(paper)}\n                    >\n                      <Edit className=\"h-4 w-4\" />\n                    </Button>\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => handleDeletePaper(paper.id)}\n                      className=\"text-red-600 hover:text-red-700\"\n                    >\n                      <Trash2 className=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          ))\n        )}\n      </div>\n\n      {/* Pending Approvals Dialog */}\n      <Dialog open={showPendingApprovals} onOpenChange={setShowPendingApprovals}>\n        <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>Papers Pending Approval</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            {pendingPapersData && pendingPapersData.papers.length > 0 ? (\n              pendingPapersData.papers.map((paper: Paper) => (\n                <Card key={paper.id} className=\"border-l-4 border-l-yellow-400\">\n                  <CardContent className=\"p-4\">\n                    <div className=\"flex justify-between items-start\">\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-3 mb-2\">\n                          <FileText className=\"h-5 w-5 text-blue-600\" />\n                          <h3 className=\"font-semibold\">{paper.file_name}</h3>\n                          <Badge className=\"bg-yellow-100 text-yellow-800\">\n                            <Clock className=\"h-3 w-3 mr-1\" />Pending\n                          </Badge>\n                        </div>\n                        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm text-gray-600 mb-3\">\n                          <div><span className=\"font-medium\">Subject:</span> {paper.subject}</div>\n                          <div><span className=\"font-medium\">Class:</span> {paper.class_name}</div>\n                          <div><span className=\"font-medium\">Term:</span> {paper.term}</div>\n                          <div><span className=\"font-medium\">Year:</span> {paper.year}</div>\n                        </div>\n                        <div className=\"text-sm text-gray-500\">\n                          Uploaded by: {paper.uploaded_by_name || 'Unknown'}\n                          {paper.submitted_for_approval_at && (\n                            <span className=\"ml-4\">\n                              Submitted: {new Date(paper.submitted_for_approval_at).toLocaleString()}\n                            </span>\n                          )}\n                        </div>\n                      </div>\n                      <div className=\"flex gap-2 ml-4\">\n                        <Button\n                          size=\"sm\"\n                          className=\"bg-green-600 hover:bg-green-700\"\n                          onClick={() => {\n                            setSelectedPaperForApproval(paper);\n                            setApprovalAction('approve');\n                          }}\n                        >\n                          <CheckCircle className=\"h-4 w-4 mr-1\" />\n                          Approve\n                        </Button>\n                        <Button\n                          size=\"sm\"\n                          variant=\"outline\"\n                          className=\"border-red-500 text-red-600 hover:bg-red-50\"\n                          onClick={() => {\n                            setSelectedPaperForApproval(paper);\n                            setApprovalAction('reject');\n                          }}\n                        >\n                          <XCircle className=\"h-4 w-4 mr-1\" />\n                          Reject\n                        </Button>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))\n            ) : (\n              <div className=\"text-center py-12 text-gray-500\">\n                <FileText className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n                <p className=\"text-lg font-medium mb-2\">No Pending Papers</p>\n                <p>All papers have been reviewed</p>\n              </div>\n            )}\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Approval/Rejection Dialog */}\n      <Dialog open={!!approvalAction} onOpenChange={() => {\n        setApprovalAction(null);\n        setSelectedPaperForApproval(null);\n        setRejectionReason(\"\");\n      }}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>\n              {approvalAction === 'approve' ? 'Approve Paper' : 'Reject Paper'}\n            </DialogTitle>\n          </DialogHeader>\n          {selectedPaperForApproval && (\n            <div className=\"space-y-4\">\n              <div>\n                <p className=\"text-sm text-gray-600 mb-2\">\n                  <strong>Paper:</strong> {selectedPaperForApproval.file_name}\n                </p>\n                <p className=\"text-sm text-gray-600\">\n                  <strong>Subject:</strong> {selectedPaperForApproval.subject} | \n                  <strong> Class:</strong> {selectedPaperForApproval.class_name}\n                </p>\n              </div>\n              {approvalAction === 'reject' && (\n                <div>\n                  <Label>Rejection Reason *</Label>\n                  <Textarea\n                    value={rejectionReason}\n                    onChange={(e) => setRejectionReason(e.target.value)}\n                    placeholder=\"Please provide a reason for rejection...\"\n                    rows={4}\n                    className=\"mt-2\"\n                  />\n                </div>\n              )}\n              <div className=\"flex justify-end gap-3\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => {\n                    setApprovalAction(null);\n                    setSelectedPaperForApproval(null);\n                    setRejectionReason(\"\");\n                  }}\n                >\n                  Cancel\n                </Button>\n                <Button\n                  className={approvalAction === 'approve' ? 'bg-green-600 hover:bg-green-700' : 'bg-red-600 hover:bg-red-700'}\n                  onClick={() => {\n                    if (approvalAction === 'approve') {\n                      approveMutation.mutate(selectedPaperForApproval.id);\n                    } else {\n                      if (!rejectionReason.trim()) {\n                        toast.error('Please provide a rejection reason');\n                        return;\n                      }\n                      rejectMutation.mutate({\n                        paperId: selectedPaperForApproval.id,\n                        reason: rejectionReason\n                      });\n                    }\n                  }}\n                  disabled={approveMutation.isPending || rejectMutation.isPending}\n                >\n                  {approvalAction === 'approve' ? 'Approve' : 'Reject'}\n                </Button>\n              </div>\n            </div>\n          )}\n        </DialogContent>\n      </Dialog>\n\n      {/* Paper Form Dialog */}\n      <Dialog open={isFormOpen} onOpenChange={setIsFormOpen}>\n        <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>\n              {editingPaper ? \"Edit Paper\" : \"Upload New Paper\"}\n            </DialogTitle>\n          </DialogHeader>\n          <PaperFormDialog\n            onSubmit={handleFormSubmit}\n            initialData={editingPaper ? {\n              class_id: editingPaper.class_id,\n              class_name: editingPaper.class_name,\n              subject: editingPaper.subject,\n              term: editingPaper.term,\n              year: editingPaper.year,\n              file_url: editingPaper.file_url,\n              file_name: editingPaper.file_name,\n              file_type: editingPaper.file_type,\n              file_size: editingPaper.file_size,\n              description: editingPaper.description,\n            } : undefined}\n            isLoading={isSubmitting}\n            mode={editingPaper ? \"edit\" : \"create\"}\n            uploadedFile={uploadedFile}\n            setUploadedFile={setUploadedFile}\n          />\n        </DialogContent>\n      </Dialog>\n\n      {/* Confirm Dialog */}\n      <ConfirmDialog\n        open={confirmDialog.open}\n        onOpenChange={(open) => setConfirmDialog({ ...confirmDialog, open })}\n        title={confirmDialog.title}\n        description={confirmDialog.description}\n        onConfirm={confirmDialog.onConfirm}\n        variant=\"destructive\"\n      />\n    </div>\n    </DashboardLayout>\n  );\n}\n\n// Paper form component\nfunction PaperFormDialog({\n  onSubmit,\n  initialData,\n  isLoading,\n  mode,\n  uploadedFile,\n  setUploadedFile,\n}: {\n  onSubmit: (data: PaperFormData) => Promise<void>;\n  initialData?: Partial<PaperFormData>;\n  isLoading?: boolean;\n  mode?: \"create\" | \"edit\";\n  uploadedFile: File | null;\n  setUploadedFile: (file: File | null) => void;\n}) {\n  const [formData, setFormData] = useState<PaperFormData>({\n    class_id: initialData?.class_id || \"\",\n    class_name: initialData?.class_name || \"\",\n    subject: initialData?.subject || \"\",\n    term: initialData?.term || \"first_term\",\n    year: initialData?.year || new Date().getFullYear(),\n    file_url: initialData?.file_url || \"\",\n    file_name: initialData?.file_name || \"\",\n    file_type: initialData?.file_type || \"\",\n    file_size: initialData?.file_size,\n    description: initialData?.description || \"\",\n  });\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isUploading, setIsUploading] = useState(false);\n\n  const validate = () => {\n    const newErrors: Record<string, string> = {};\n\n    if (!formData.class_name.trim()) {\n      newErrors.class_name = \"Class name is required\";\n    }\n    if (!formData.subject.trim()) {\n      newErrors.subject = \"Subject is required\";\n    }\n    if (!formData.year) {\n      newErrors.year = \"Year is required\";\n    }\n    if (!formData.file_url && !uploadedFile) {\n      newErrors.file = \"Please upload a file\";\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      // Check file type\n      const allowedTypes = [\n        'application/pdf',\n        'application/msword',\n        'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n        'image/jpeg',\n        'image/png',\n        'image/jpg'\n      ];\n\n      if (!allowedTypes.includes(file.type)) {\n        alert(\"Please upload PDF, Word, or Image files only\");\n        return;\n      }\n\n      // Check file size (max 10MB)\n      if (file.size > 10 * 1024 * 1024) {\n        toast.error(\"File size must be less than 10MB\");\n        return;\n      }\n\n      setUploadedFile(file);\n      setFormData({\n        ...formData,\n        file_name: file.name,\n        file_type: file.type,\n        file_size: file.size,\n      });\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validate()) {\n      return;\n    }\n\n    // If there's a new file, simulate upload (in real app, upload to storage)\n    const finalFormData = { ...formData };\n    \n    if (uploadedFile) {\n      setIsUploading(true);\n      try {\n        // Simulate file upload - in real app, upload to Supabase storage\n        // For now, create a mock URL\n        const mockUrl = `/uploads/papers/${Date.now()}_${uploadedFile.name}`;\n        finalFormData.file_url = mockUrl;\n      } catch (error) {\n        toast.error(\"Failed to upload file\");\n        setIsUploading(false);\n        return;\n      }\n      setIsUploading(false);\n    }\n\n    await onSubmit(finalFormData);\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\n      <div className=\"grid grid-cols-2 gap-4\">\n        <div className=\"space-y-2\">\n          <label className=\"text-sm font-medium\">Class Name *</label>\n          <Input\n            value={formData.class_name}\n            onChange={(e) => setFormData({ ...formData, class_name: e.target.value, class_id: e.target.value.toLowerCase().replace(/\\s+/g, '-') })}\n            placeholder=\"e.g., Class 10-A\"\n            className={errors.class_name ? \"border-red-500\" : \"\"}\n          />\n          {errors.class_name && <p className=\"text-sm text-red-600\">{errors.class_name}</p>}\n        </div>\n\n        <div className=\"space-y-2\">\n          <label className=\"text-sm font-medium\">Subject *</label>\n          <Input\n            value={formData.subject}\n            onChange={(e) => setFormData({ ...formData, subject: e.target.value })}\n            placeholder=\"e.g., Mathematics\"\n            className={errors.subject ? \"border-red-500\" : \"\"}\n          />\n          {errors.subject && <p className=\"text-sm text-red-600\">{errors.subject}</p>}\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-2 gap-4\">\n        <div className=\"space-y-2\">\n          <label className=\"text-sm font-medium\">Term *</label>\n          <Select\n            value={formData.term}\n            onValueChange={(value) => setFormData({ ...formData, term: value })}\n          >\n            <SelectTrigger>\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"first_term\">First Term</SelectItem>\n              <SelectItem value=\"second_term\">Second Term</SelectItem>\n              <SelectItem value=\"third_term\">Third Term</SelectItem>\n            </SelectContent>\n          </Select>\n        </div>\n\n        <div className=\"space-y-2\">\n          <label className=\"text-sm font-medium\">Year *</label>\n          <Input\n            type=\"number\"\n            value={formData.year}\n            onChange={(e) => setFormData({ ...formData, year: parseInt(e.target.value) })}\n            min={2020}\n            max={2100}\n            className={errors.year ? \"border-red-500\" : \"\"}\n          />\n          {errors.year && <p className=\"text-sm text-red-600\">{errors.year}</p>}\n        </div>\n      </div>\n\n      <div className=\"space-y-2\">\n        <label className=\"text-sm font-medium\">Upload File * (PDF, Word, or Image)</label>\n        <Input\n          type=\"file\"\n          onChange={handleFileChange}\n          accept=\".pdf,.doc,.docx,.jpg,.jpeg,.png\"\n          className={errors.file ? \"border-red-500\" : \"\"}\n        />\n        {uploadedFile && (\n          <p className=\"text-sm text-green-600\">\n            Selected: {uploadedFile.name} ({(uploadedFile.size / 1024 / 1024).toFixed(2)} MB)\n          </p>\n        )}\n        {formData.file_name && !uploadedFile && (\n          <p className=\"text-sm text-gray-600\">\n            Current file: {formData.file_name}\n          </p>\n        )}\n        {errors.file && <p className=\"text-sm text-red-600\">{errors.file}</p>}\n      </div>\n\n      <div className=\"space-y-2\">\n        <label className=\"text-sm font-medium\">Description (Optional)</label>\n        <textarea\n          value={formData.description}\n          onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n          placeholder=\"Add any additional notes about this paper...\"\n          rows={3}\n          className=\"w-full rounded-md border px-3 py-2 text-sm border-gray-300\"\n        />\n      </div>\n\n      <div className=\"flex justify-end space-x-4 pt-4\">\n        <Button\n          type=\"button\"\n          variant=\"outline\"\n          onClick={() => window.location.reload()}\n        >\n          Cancel\n        </Button>\n        <Button\n          type=\"submit\"\n          disabled={isLoading || isUploading}\n          className=\"bg-blue-600 hover:bg-blue-700 text-white\"\n        >\n          {isLoading || isUploading ? \"Processing...\" : mode === \"create\" ? \"Upload Paper\" : \"Update Paper\"}\n        </Button>\n      </div>\n    </form>\n  );\n}\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\admin\\reports\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Input' is defined but never used.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Target' is defined but never used.","line":16,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'formatDate' is defined but never used.","line":18,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ReportData' is defined but never used.","line":29,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":29,"endColumn":21},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":35,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1547,1550],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1547,1550],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'dateFrom' is assigned a value but never used.","line":102,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":102,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setDateFrom' is assigned a value but never used.","line":102,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":102,"endColumn":31},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'dateTo' is assigned a value but never used.","line":103,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":103,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setDateTo' is assigned a value but never used.","line":103,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":103,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'studentIds' is assigned a value but never used.","line":174,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":174,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'id' is defined but never used. Allowed unused args must match /^_/u.","line":256,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":256,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useMemo } from 'react'\nimport { useSearchParams } from 'next/navigation'\nimport { useQuery } from '@tanstack/react-query'\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { toast } from '@/components/ui/toast'\nimport { \n  BarChart3, FileText, Download, Calendar, Users, \n  TrendingUp, Award, Clock, BookOpen, DollarSign,\n  PieChart, Activity, Target, CheckCircle\n} from 'lucide-react'\nimport { formatDate } from '@/lib/utils'\nimport { gradeService } from '@/services/gradeService'\nimport { attendanceService } from '@/services/attendanceService'\nimport { financeService } from '@/services/financeService'\nimport { studentService } from '@/services/studentService'\nimport { teacherService } from '@/services/teacherService'\nimport { classService } from '@/services/classService'\nimport { useSettings } from '@/contexts/SettingsContext'\nimport { ReportCardModal } from '@/components/shared/ReportCardModal'\nimport { Grade, Attendance, Expense, Donation, Student, Class } from '@/types'\n\ninterface ReportData {\n  id: string\n  title: string\n  type: 'academic' | 'attendance' | 'financial' | 'inventory' | 'performance'\n  period: string\n  generated_at: string\n  data: any\n}\n\ninterface AcademicReport {\n  totalStudents: number\n  totalTeachers: number\n  totalClasses: number\n  passPercentage: number\n  failPercentage: number\n  averageGrade: string\n  topPerformers: Array<{\n    name: string\n    grade: string\n    percentage: number\n  }>\n  classWiseStats: Array<{\n    className: string\n    totalStudents: number\n    passPercentage: number\n    averageGrade: string\n  }>\n}\n\ninterface AttendanceReport {\n  totalDays: number\n  averageAttendance: number\n  presentStudents: number\n  absentStudents: number\n  classWiseAttendance: Array<{\n    className: string\n    averageAttendance: number\n    totalPresent: number\n    totalAbsent: number\n  }>\n  monthlyTrend: Array<{\n    month: string\n    attendance: number\n  }>\n}\n\ninterface FinancialReport {\n  totalRevenue: number\n  totalExpenses: number\n  netProfit: number\n  monthlyBreakdown: Array<{\n    month: string\n    revenue: number\n    expenses: number\n    profit: number\n  }>\n  categoryWiseExpenses: Array<{\n    category: string\n    amount: number\n    percentage: number\n  }>\n}\n\nexport default function ReportsPage() {\n  const { schoolName, currentAcademicYear } = useSettings()\n  const searchParams = useSearchParams()\n  const [selectedReportType, setSelectedReportType] = useState<string>(\n    searchParams.get('type') || 'academic'\n  )\n  const [selectedPeriod, setSelectedPeriod] = useState<string>('current_month')\n  const [selectedClassId, setSelectedClassId] = useState<string>(\n    searchParams.get('class_id') || 'all'\n  )\n  const [dateFrom, setDateFrom] = useState<string>('')\n  const [dateTo, setDateTo] = useState<string>('')\n  const [isGenerating, setIsGenerating] = useState(false)\n  const [showReportCard, setShowReportCard] = useState(false)\n  const [selectedStudentForReport, setSelectedStudentForReport] = useState<{ student: Student; grades: Grade[] } | null>(null)\n\n  // Calculate date range based on period\n  const dateRange = useMemo(() => {\n    const today = new Date()\n    let from = new Date()\n    let to = new Date()\n\n    switch (selectedPeriod) {\n      case 'current_month':\n        from = new Date(today.getFullYear(), today.getMonth(), 1)\n        to = today\n        break\n      case 'last_month':\n        from = new Date(today.getFullYear(), today.getMonth() - 1, 1)\n        to = new Date(today.getFullYear(), today.getMonth(), 0)\n        break\n      case 'current_quarter':\n        const quarter = Math.floor(today.getMonth() / 3)\n        from = new Date(today.getFullYear(), quarter * 3, 1)\n        to = today\n        break\n      case 'current_year':\n        from = new Date(today.getFullYear(), 0, 1)\n        to = today\n        break\n      default:\n        from = new Date(today.getFullYear(), today.getMonth(), 1)\n        to = today\n    }\n\n    return {\n      from: from.toISOString().split('T')[0],\n      to: to.toISOString().split('T')[0]\n    }\n  }, [selectedPeriod])\n\n  // Fetch all required data\n  const { data: students = [] } = useQuery({\n    queryKey: ['students', selectedClassId],\n    queryFn: () => studentService.getStudents({\n      class_id: selectedClassId !== 'all' ? selectedClassId : undefined,\n      limit: 1000\n    })\n  })\n\n  const { data: teachers = [] } = useQuery({\n    queryKey: ['teachers'],\n    queryFn: () => teacherService.getTeachers({ limit: 1000 })\n  })\n\n  const { data: classes = [] } = useQuery({\n    queryKey: ['classes'],\n    queryFn: () => classService.getClasses({ limit: 1000 })\n  })\n\n  const { data: grades = [] } = useQuery({\n    queryKey: ['grades', selectedClassId, dateRange],\n    queryFn: () => gradeService.getGrades({\n      class_id: selectedClassId !== 'all' ? selectedClassId : undefined,\n      academic_year: new Date().getFullYear().toString(),\n      limit: 1000\n    })\n  })\n\n  const { data: attendanceRecords = [] } = useQuery({\n    queryKey: ['attendance', dateRange.from, dateRange.to, selectedClassId],\n    queryFn: () => {\n      const studentIds = selectedClassId !== 'all' && students.length > 0\n        ? students.map((s: Student) => s.user_id).filter(Boolean)\n        : undefined\n      \n      // Note: API doesn't support multiple user_ids, so we'll fetch all and filter client-side\n      return attendanceService.getAttendance({\n        date_from: dateRange.from,\n        date_to: dateRange.to,\n        limit: 1000\n      })\n    },\n    enabled: selectedReportType === 'attendance' || selectedReportType === 'academic'\n  })\n\n  const { data: expenses = [] } = useQuery({\n    queryKey: ['expenses', dateRange.from, dateRange.to],\n    queryFn: () => financeService.getExpenses({\n      date_from: dateRange.from,\n      date_to: dateRange.to\n    }),\n    enabled: selectedReportType === 'financial'\n  })\n\n  const { data: donations = [] } = useQuery({\n    queryKey: ['donations', dateRange.from, dateRange.to],\n    queryFn: () => financeService.getDonations({\n      date_from: dateRange.from,\n      date_to: dateRange.to\n    }),\n    enabled: selectedReportType === 'financial'\n  })\n\n  // Calculate academic report data\n  const academicReportData = useMemo((): AcademicReport => {\n    if (!grades.length) {\n      return {\n        totalStudents: students.length,\n        totalTeachers: teachers.length,\n        totalClasses: classes.length,\n        passPercentage: 0,\n        failPercentage: 0,\n        averageGrade: 'N/A',\n        topPerformers: [],\n        classWiseStats: []\n      }\n    }\n\n    const totalGrades = grades.length\n    const passingGrades = grades.filter((g: Grade) => Number(g.marks) >= 50).length\n    const passPercentage = totalGrades > 0 ? (passingGrades / totalGrades) * 100 : 0\n    const failPercentage = 100 - passPercentage\n\n    // Calculate average marks\n    const avgMarks = grades.reduce((sum: number, g: Grade) => sum + Number(g.marks), 0) / totalGrades\n    const calculateGradeFromMarks = (marks: number): string => {\n      if (marks >= 90) return 'A+'\n      if (marks >= 80) return 'A'\n      if (marks >= 70) return 'B+'\n      if (marks >= 60) return 'B'\n      if (marks >= 50) return 'C+'\n      if (marks >= 40) return 'C'\n      if (marks >= 33) return 'D'\n      return 'F'\n    }\n\n    // Get top performers (students with highest average marks)\n    const studentAverages: Record<string, { total: number; count: number; name: string }> = {}\n    grades.forEach((g: Grade) => {\n      const studentId = g.student_id\n      if (!studentAverages[studentId]) {\n        const student = students.find((s: Student) => s.id === studentId)\n        studentAverages[studentId] = {\n          total: 0,\n          count: 0,\n          name: student?.user?.full_name || 'Unknown'\n        }\n      }\n      studentAverages[studentId].total += Number(g.marks)\n      studentAverages[studentId].count += 1\n    })\n\n    const topPerformers = Object.entries(studentAverages)\n      .map(([id, data]) => ({\n        name: data.name,\n        percentage: (data.total / data.count),\n        grade: calculateGradeFromMarks(data.total / data.count)\n      }))\n      .sort((a, b) => b.percentage - a.percentage)\n      .slice(0, 10)\n\n    // Class-wise stats\n    const classStats: Record<string, { grades: Grade[]; students: Set<string> }> = {}\n    grades.forEach((g: Grade) => {\n      const classId = g.class_id\n      if (!classStats[classId]) {\n        classStats[classId] = { grades: [], students: new Set() }\n      }\n      classStats[classId].grades.push(g)\n      classStats[classId].students.add(g.student_id)\n    })\n\n    const classWiseStats = Object.entries(classStats).map(([classId, data]) => {\n      const classInfo = classes.find((c: Class) => c.id === classId)\n      const className = classInfo ? `${classInfo.name} - ${classInfo.section}` : 'Unknown'\n      const classGrades = data.grades\n      const classPassing = classGrades.filter((g: Grade) => Number(g.marks) >= 50).length\n      const classPassPercentage = classGrades.length > 0\n        ? (classPassing / classGrades.length) * 100\n        : 0\n      const classAvgMarks = classGrades.length > 0\n        ? classGrades.reduce((sum: number, g: Grade) => sum + Number(g.marks), 0) / classGrades.length\n        : 0\n\n      return {\n        className,\n        totalStudents: data.students.size,\n        passPercentage: Math.round(classPassPercentage * 10) / 10,\n        averageGrade: calculateGradeFromMarks(classAvgMarks)\n      }\n    })\n\n    return {\n      totalStudents: students.length,\n      totalTeachers: teachers.length,\n      totalClasses: classes.length,\n      passPercentage: Math.round(passPercentage * 10) / 10,\n      failPercentage: Math.round(failPercentage * 10) / 10,\n      averageGrade: calculateGradeFromMarks(avgMarks),\n      topPerformers,\n      classWiseStats\n    }\n  }, [grades, students, teachers, classes])\n\n  // Calculate attendance report data\n  const attendanceReportData = useMemo((): AttendanceReport => {\n    if (!attendanceRecords.length) {\n      return {\n        totalDays: 0,\n        averageAttendance: 0,\n        presentStudents: 0,\n        absentStudents: 0,\n        classWiseAttendance: [],\n        monthlyTrend: []\n      }\n    }\n\n    // Filter by class if selected\n    const filteredAttendance = selectedClassId !== 'all'\n      ? attendanceRecords.filter((a: Attendance) => {\n          const student = students.find((s: Student) => s.user_id === a.user_id)\n          return student?.class_id === selectedClassId\n        })\n      : attendanceRecords\n\n    const uniqueDates = new Set(filteredAttendance.map((a: Attendance) => a.date.split('T')[0]))\n    const presentCount = filteredAttendance.filter((a: Attendance) => a.status === 'present').length\n    const absentCount = filteredAttendance.filter((a: Attendance) => a.status === 'absent').length\n\n    const avgAttendance = filteredAttendance.length > 0\n      ? (presentCount / filteredAttendance.length) * 100\n      : 0\n\n    // Class-wise attendance\n    const classAttendance: Record<string, { present: number; absent: number; total: number }> = {}\n    filteredAttendance.forEach((a: Attendance) => {\n      const student = students.find((s: Student) => s.user_id === a.user_id)\n      if (student?.class_id) {\n        if (!classAttendance[student.class_id]) {\n          classAttendance[student.class_id] = { present: 0, absent: 0, total: 0 }\n        }\n        classAttendance[student.class_id].total++\n        if (a.status === 'present') {\n          classAttendance[student.class_id].present++\n        } else if (a.status === 'absent') {\n          classAttendance[student.class_id].absent++\n        }\n      }\n    })\n\n    const classWiseAttendance = Object.entries(classAttendance).map(([classId, data]) => {\n      const classInfo = classes.find((c: Class) => c.id === classId)\n      const className = classInfo ? `${classInfo.name} - ${classInfo.section}` : 'Unknown'\n      const avgClassAttendance = data.total > 0 ? (data.present / data.total) * 100 : 0\n\n      return {\n        className,\n        averageAttendance: Math.round(avgClassAttendance * 10) / 10,\n        totalPresent: data.present,\n        totalAbsent: data.absent\n      }\n    })\n\n    return {\n      totalDays: uniqueDates.size,\n      averageAttendance: Math.round(avgAttendance * 10) / 10,\n      presentStudents: presentCount,\n      absentStudents: absentCount,\n      classWiseAttendance,\n      monthlyTrend: [] // Can be enhanced with date grouping\n    }\n  }, [attendanceRecords, students, classes, selectedClassId])\n\n  // Calculate financial report data\n  const financialReportData = useMemo((): FinancialReport => {\n    const totalExpenses = expenses.reduce((sum: number, e: Expense) => sum + Number(e.amount), 0)\n    const totalRevenue = donations.reduce((sum: number, d: Donation) => sum + Number(d.amount), 0)\n    const netProfit = totalRevenue - totalExpenses\n\n    // Category-wise expenses\n    const categoryExpenses: Record<string, number> = {}\n    expenses.forEach((e: Expense) => {\n      const category = e.category || 'Others'\n      categoryExpenses[category] = (categoryExpenses[category] || 0) + Number(e.amount)\n    })\n\n    const categoryWiseExpenses = Object.entries(categoryExpenses).map(([category, amount]) => ({\n      category,\n      amount,\n      percentage: totalExpenses > 0 ? Math.round((amount / totalExpenses) * 100 * 10) / 10 : 0\n    })).sort((a, b) => b.amount - a.amount)\n\n    return {\n      totalRevenue,\n      totalExpenses,\n      netProfit,\n      monthlyBreakdown: [], // Can be enhanced with date grouping\n      categoryWiseExpenses\n    }\n  }, [expenses, donations])\n\n  const handleGenerateReport = async () => {\n    setIsGenerating(true)\n    setTimeout(() => {\n      setIsGenerating(false)\n      toast.success('Report generated successfully!')\n    }, 1000)\n  }\n\n  const handleDownloadReport = (type: string) => {\n    // Trigger browser print or PDF download\n    window.print()\n    toast.success(`${type} report download initiated`)\n  }\n\n  const renderAcademicReport = () => (\n    <div className=\"space-y-6\">\n      {/* Summary Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n        <Card>\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-gray-600\">Total Students</p>\n                <p className=\"text-3xl font-bold text-gray-900\">{academicReportData.totalStudents}</p>\n              </div>\n              <Users className=\"h-12 w-12 text-blue-600\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-gray-600\">Pass Percentage</p>\n                <p className=\"text-3xl font-bold text-green-600\">{academicReportData.passPercentage}%</p>\n              </div>\n              <CheckCircle className=\"h-12 w-12 text-green-600\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-gray-600\">Average Grade</p>\n                <p className=\"text-3xl font-bold text-purple-600\">{academicReportData.averageGrade}</p>\n              </div>\n              <Award className=\"h-12 w-12 text-purple-600\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-gray-600\">Total Classes</p>\n                <p className=\"text-3xl font-bold text-orange-600\">{academicReportData.totalClasses}</p>\n              </div>\n              <BookOpen className=\"h-12 w-12 text-orange-600\" />\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Top Performers */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Award className=\"h-5 w-5 text-yellow-600\" />\n            Top Performers\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-4\">\n            {academicReportData.topPerformers.map((performer, index) => {\n              const student = students.find((s: Student) => s.user?.full_name === performer.name)\n              const studentGrades = student ? grades.filter((g: Grade) => g.student_id === student.id) : []\n              \n              return (\n                <div key={index} className=\"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50\">\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center\">\n                      <span className=\"text-yellow-600 font-bold\">{index + 1}</span>\n                    </div>\n                    <div>\n                      <p className=\"font-medium text-gray-900\">{performer.name}</p>\n                      <p className=\"text-sm text-gray-500\">Grade: {performer.grade}</p>\n                    </div>\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <div className=\"text-right\">\n                      <p className=\"font-bold text-green-600\">{performer.percentage.toFixed(1)}%</p>\n                    </div>\n                    {student && studentGrades.length > 0 && (\n                      <Button\n                        size=\"sm\"\n                        variant=\"outline\"\n                        onClick={() => {\n                          setSelectedStudentForReport({ student, grades: studentGrades })\n                          setShowReportCard(true)\n                        }}\n                      >\n                        <FileText className=\"h-4 w-4 mr-1\" />\n                        Report Card\n                      </Button>\n                    )}\n                  </div>\n                </div>\n              )\n            })}\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Class-wise Statistics */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <BarChart3 className=\"h-5 w-5 text-blue-600\" />\n            Class-wise Performance\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full\">\n              <thead>\n                <tr className=\"border-b\">\n                  <th className=\"text-left p-3 font-medium text-gray-900\">Class</th>\n                  <th className=\"text-left p-3 font-medium text-gray-900\">Students</th>\n                  <th className=\"text-left p-3 font-medium text-gray-900\">Pass %</th>\n                  <th className=\"text-left p-3 font-medium text-gray-900\">Avg Grade</th>\n                </tr>\n              </thead>\n              <tbody>\n                {academicReportData.classWiseStats.map((stat, index) => (\n                  <tr key={index} className=\"border-b\">\n                    <td className=\"p-3 font-medium\">{stat.className}</td>\n                    <td className=\"p-3\">{stat.totalStudents}</td>\n                    <td className=\"p-3\">\n                      <span className={`px-2 py-1 rounded-full text-xs font-medium ${\n                        stat.passPercentage >= 90 ? 'bg-green-100 text-green-800' :\n                        stat.passPercentage >= 80 ? 'bg-blue-100 text-blue-800' :\n                        stat.passPercentage >= 70 ? 'bg-yellow-100 text-yellow-800' :\n                        'bg-red-100 text-red-800'\n                      }`}>\n                        {stat.passPercentage}%\n                      </span>\n                    </td>\n                    <td className=\"p-3\">{stat.averageGrade}</td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  )\n\n  const renderAttendanceReport = () => (\n    <div className=\"space-y-6\">\n      {/* Summary Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n        <Card>\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-gray-600\">Average Attendance</p>\n                <p className=\"text-3xl font-bold text-blue-600\">{attendanceReportData.averageAttendance}%</p>\n              </div>\n              <TrendingUp className=\"h-12 w-12 text-blue-600\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-gray-600\">Present Students</p>\n                <p className=\"text-3xl font-bold text-green-600\">{attendanceReportData.presentStudents}</p>\n              </div>\n              <CheckCircle className=\"h-12 w-12 text-green-600\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-gray-600\">Absent Students</p>\n                <p className=\"text-3xl font-bold text-red-600\">{attendanceReportData.absentStudents}</p>\n              </div>\n              <Clock className=\"h-12 w-12 text-red-600\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-gray-600\">Total Days</p>\n                <p className=\"text-3xl font-bold text-gray-600\">{attendanceReportData.totalDays}</p>\n              </div>\n              <Calendar className=\"h-12 w-12 text-gray-600\" />\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Class-wise Attendance */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Users className=\"h-5 w-5 text-green-600\" />\n            Class-wise Attendance\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-4\">\n            {attendanceReportData.classWiseAttendance.map((attendance, index) => (\n              <div key={index} className=\"p-4 border rounded-lg\">\n                <div className=\"flex justify-between items-center mb-2\">\n                  <h4 className=\"font-medium text-gray-900\">{attendance.className}</h4>\n                  <span className=\"text-lg font-bold text-blue-600\">{attendance.averageAttendance}%</span>\n                </div>\n                <div className=\"flex justify-between text-sm text-gray-600\">\n                  <span>Present: {attendance.totalPresent}</span>\n                  <span>Absent: {attendance.totalAbsent}</span>\n                </div>\n                <div className=\"mt-2 w-full bg-gray-200 rounded-full h-2\">\n                  <div \n                    className=\"bg-blue-600 h-2 rounded-full\" \n                    style={{ width: `${attendance.averageAttendance}%` }}\n                  ></div>\n                </div>\n              </div>\n            ))}\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  )\n\n  const renderFinancialReport = () => (\n    <div className=\"space-y-6\">\n      {/* Summary Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n        <Card>\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-gray-600\">Total Revenue</p>\n                <p className=\"text-3xl font-bold text-green-600\">PKR {financialReportData.totalRevenue.toLocaleString()}</p>\n              </div>\n              <TrendingUp className=\"h-12 w-12 text-green-600\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-gray-600\">Total Expenses</p>\n                <p className=\"text-3xl font-bold text-red-600\">PKR {financialReportData.totalExpenses.toLocaleString()}</p>\n              </div>\n              <DollarSign className=\"h-12 w-12 text-red-600\" />\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardContent className=\"p-6\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-sm font-medium text-gray-600\">Net Profit</p>\n                <p className=\"text-3xl font-bold text-blue-600\">PKR {financialReportData.netProfit.toLocaleString()}</p>\n              </div>\n              <Activity className=\"h-12 w-12 text-blue-600\" />\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Category-wise Expenses */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <PieChart className=\"h-5 w-5 text-purple-600\" />\n            Category-wise Expenses\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-4\">\n            {financialReportData.categoryWiseExpenses.map((expense, index) => (\n              <div key={index} className=\"flex items-center justify-between p-4 border rounded-lg\">\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"w-4 h-4 bg-blue-500 rounded-full\"></div>\n                  <div>\n                    <p className=\"font-medium text-gray-900\">{expense.category}</p>\n                    <p className=\"text-sm text-gray-500\">{expense.percentage}%</p>\n                  </div>\n                </div>\n                <div className=\"text-right\">\n                  <p className=\"font-bold text-gray-900\">PKR {expense.amount.toLocaleString()}</p>\n                </div>\n              </div>\n            ))}\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Monthly Breakdown */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <BarChart3 className=\"h-5 w-5 text-green-600\" />\n            Monthly Financial Breakdown\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full\">\n              <thead>\n                <tr className=\"border-b\">\n                  <th className=\"text-left p-3 font-medium text-gray-900\">Month</th>\n                  <th className=\"text-left p-3 font-medium text-gray-900\">Revenue</th>\n                  <th className=\"text-left p-3 font-medium text-gray-900\">Expenses</th>\n                  <th className=\"text-left p-3 font-medium text-gray-900\">Profit</th>\n                </tr>\n              </thead>\n              <tbody>\n                {financialReportData.monthlyBreakdown.map((month, index) => (\n                  <tr key={index} className=\"border-b\">\n                    <td className=\"p-3 font-medium\">{month.month}</td>\n                    <td className=\"p-3 text-green-600\">PKR {month.revenue.toLocaleString()}</td>\n                    <td className=\"p-3 text-red-600\">PKR {month.expenses.toLocaleString()}</td>\n                    <td className=\"p-3 text-blue-600 font-bold\">PKR {month.profit.toLocaleString()}</td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  )\n\n  const renderCurrentReport = () => {\n    switch (selectedReportType) {\n      case 'academic':\n        return renderAcademicReport()\n      case 'attendance':\n        return renderAttendanceReport()\n      case 'financial':\n        return renderFinancialReport()\n      default:\n        return renderAcademicReport()\n    }\n  }\n\n  return (\n    <DashboardLayout allowedRoles={['admin', 'principal']}>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900\">Reports - {schoolName}</h1>\n            <p className=\"text-gray-600 mt-1\">\n              Generate and view comprehensive school reports\n              {currentAcademicYear && (\n                <span className=\"ml-2\">({currentAcademicYear.year_name})</span>\n              )}\n            </p>\n          </div>\n          <div className=\"flex gap-3\">\n            <Button\n              onClick={() => handleDownloadReport(selectedReportType)}\n              variant=\"outline\"\n              className=\"flex items-center gap-2\"\n            >\n              <Download className=\"h-4 w-4\" />\n              Download PDF\n            </Button>\n            <Button\n              onClick={handleGenerateReport}\n              disabled={isGenerating}\n              className=\"flex items-center gap-2\"\n            >\n              {isGenerating ? (\n                <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white\"></div>\n              ) : (\n                <FileText className=\"h-4 w-4\" />\n              )}\n              {isGenerating ? 'Generating...' : 'Generate Report'}\n            </Button>\n          </div>\n        </div>\n\n        {/* Report Filters */}\n        <Card>\n          <CardContent className=\"p-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n              <div>\n                <Label htmlFor=\"report-type\">Report Type</Label>\n                <Select value={selectedReportType} onValueChange={setSelectedReportType}>\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"Select report type\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"academic\">Academic Performance</SelectItem>\n                    <SelectItem value=\"attendance\">Attendance Report</SelectItem>\n                    <SelectItem value=\"financial\">Financial Report</SelectItem>\n                    <SelectItem value=\"inventory\">Inventory Report</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div>\n                <Label htmlFor=\"period\">Period</Label>\n                <Select value={selectedPeriod} onValueChange={setSelectedPeriod}>\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"Select period\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"current_month\">Current Month</SelectItem>\n                    <SelectItem value=\"last_month\">Last Month</SelectItem>\n                    <SelectItem value=\"current_quarter\">Current Quarter</SelectItem>\n                    <SelectItem value=\"current_year\">Current Year</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div>\n                <Label htmlFor=\"class\">Class</Label>\n                <Select value={selectedClassId || \"all\"} onValueChange={(value) => setSelectedClassId(value === \"all\" ? '' : value)}>\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"Select class\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">All Classes</SelectItem>\n                    {classes.map((cls: Class) => (\n                      <SelectItem key={cls.id} value={cls.id}>\n                        {cls.name} - {cls.section}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div className=\"flex items-end\">\n                <Button onClick={handleGenerateReport} className=\"w-full\">\n                  Apply Filters\n                </Button>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Report Content */}\n        <div className=\"space-y-6\">\n          {renderCurrentReport()}\n        </div>\n\n        {/* Report Card Modal */}\n        {showReportCard && selectedStudentForReport && (\n          <ReportCardModal\n            student={selectedStudentForReport.student}\n            grades={selectedStudentForReport.grades}\n            classInfo={classes.find((c: Class) => c.id === selectedStudentForReport.student.class_id)}\n            term={selectedStudentForReport.grades[0]?.term || 'annual'}\n            academicYear={selectedStudentForReport.grades[0]?.academic_year || currentAcademicYear?.year_name || new Date().getFullYear().toString()}\n            isOpen={showReportCard}\n            onClose={() => {\n              setShowReportCard(false)\n              setSelectedStudentForReport(null)\n            }}\n            onExport={handleDownloadReport.bind(null, 'report-card')}\n          />\n        )}\n      </div>\n    </DashboardLayout>\n  )\n}\n\n\n\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\admin\\results\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ConfirmDialog' is defined but never used.","line":13,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Filter' is defined but never used.","line":16,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Download' is defined but never used.","line":16,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":34},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Edit' is defined but never used.","line":16,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":40},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Search' is defined but never used.","line":16,"column":50,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":56},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Users' is defined but never used.","line":17,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Award' is defined but never used.","line":17,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'StatsSkeleton' is defined but never used.","line":23,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'classesMap' is assigned a value but never used.","line":40,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":40,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1789,1792],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1789,1792],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":53,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":53,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2179,2182],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2179,2182],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":72,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":72,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2862,2865],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2862,2865],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":192,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":192,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7510,7513],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7510,7513],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":213,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":213,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8319,8322],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8319,8322],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":14,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { Badge } from '@/components/ui/badge'\nimport { toast } from '@/components/ui/toast'\nimport { ConfirmDialog } from '@/components/shared/ConfirmDialog'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { \n  Eye, FileText, Filter, Download, Edit, Trash2, Search,\n  TrendingUp, Users, Award, CheckCircle, XCircle, AlertCircle\n} from 'lucide-react'\nimport { resultService } from '@/services/resultService'\nimport { examService } from '@/services/examService'\nimport { classService } from '@/services/classService'\nimport { ExamResult, ResultStatus } from '@/types'\nimport { StatsSkeleton, TableSkeleton } from '@/components/shared/LoadingSkeleton'\nimport { ErrorBoundary } from '@/components/shared/ErrorBoundary'\n\nexport default function AdminResultsPage() {\n  const router = useRouter()\n  const queryClient = useQueryClient()\n  const [selectedExam, setSelectedExam] = useState<string>('all')\n  const [selectedClass, setSelectedClass] = useState<string>('all')\n  const [searchTerm, setSearchTerm] = useState('')\n\n  // Fetch all classes\n  const { data: classes = [] } = useQuery({\n    queryKey: ['all-classes'],\n    queryFn: () => classService.getClasses({ limit: 1000 }),\n  })\n\n  // Create classes map for quick lookup\n  const classesMap = new Map(classes.map((cls: any) => [cls.id, cls]))\n\n  // Fetch exams for selected class\n  const { data: exams = [] } = useQuery({\n    queryKey: ['exams', selectedClass],\n    queryFn: () => examService.getExams({ \n      class_id: selectedClass === 'all' ? undefined : selectedClass,\n      limit: 1000 \n    }),\n    enabled: true,\n  })\n\n  // Create exams map for quick lookup\n  const examsMap = new Map(exams.map((exam: any) => [exam.id, exam]))\n\n  // Fetch results\n  const { data: results = [], isLoading } = useQuery({\n    queryKey: ['all-results', selectedExam, selectedClass],\n    queryFn: () => resultService.getResults({ \n      exam_id: selectedExam === 'all' ? undefined : selectedExam,\n      class_id: selectedClass === 'all' ? undefined : selectedClass,\n      limit: 1000 \n    }),\n  })\n\n  // Delete result mutation\n  const deleteResultMutation = useMutation({\n    mutationFn: (id: string) => resultService.deleteResult(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['all-results'] })\n      toast.success('Result deleted successfully!')\n    },\n    onError: (error: any) => {\n      toast.error(error?.message || 'Failed to delete result')\n    }\n  })\n\n  const getStatusBadge = (status: ResultStatus) => {\n    switch (status) {\n      case 'active':\n        return <Badge className=\"bg-green-100 text-green-800\"><CheckCircle className=\"h-3 w-3 mr-1\" />Active</Badge>\n      case 'absent':\n        return <Badge className=\"bg-red-100 text-red-800\"><XCircle className=\"h-3 w-3 mr-1\" />Absent</Badge>\n      case 'absent_with_excuse':\n        return <Badge className=\"bg-yellow-100 text-yellow-800\"><AlertCircle className=\"h-3 w-3 mr-1\" />Absent (Excuse)</Badge>\n      case 'incomplete':\n        return <Badge variant=\"outline\">Incomplete</Badge>\n      default:\n        return <Badge variant=\"outline\">{status}</Badge>\n    }\n  }\n\n  const filteredResults = results.filter((result: ExamResult) => {\n    if (searchTerm) {\n      const searchLower = searchTerm.toLowerCase()\n      return (\n        result.student_name?.toLowerCase().includes(searchLower) ||\n        result.admission_number?.toLowerCase().includes(searchLower)\n      )\n    }\n    return true\n  })\n\n  // Calculate statistics\n  const stats = {\n    total: filteredResults.length,\n    passed: filteredResults.filter((r: ExamResult) => r.percentage >= 50).length,\n    failed: filteredResults.filter((r: ExamResult) => r.percentage < 50).length,\n    average: filteredResults.length > 0\n      ? (filteredResults.reduce((sum: number, r: ExamResult) => sum + r.percentage, 0) / filteredResults.length).toFixed(1)\n      : 0\n  }\n\n  return (\n    <DashboardLayout allowedRoles={['admin', 'principal']}>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900\">Exam Results</h1>\n            <p className=\"text-gray-600 mt-1\">View and manage all exam results across the school</p>\n          </div>\n        </div>\n\n        {/* Statistics */}\n        <ErrorBoundary>\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n              <Card>\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center\">\n                    <FileText className=\"h-8 w-8 text-blue-600\" />\n                    <div className=\"ml-4\">\n                      <p className=\"text-sm font-medium text-gray-600\">Total Results</p>\n                      <p className=\"text-2xl font-bold text-gray-900\">{stats.total}</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center\">\n                <CheckCircle className=\"h-8 w-8 text-green-600\" />\n                <div className=\"ml-4\">\n                  <p className=\"text-sm font-medium text-gray-600\">Passed</p>\n                  <p className=\"text-2xl font-bold text-gray-900\">{stats.passed}</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center\">\n                <XCircle className=\"h-8 w-8 text-red-600\" />\n                <div className=\"ml-4\">\n                  <p className=\"text-sm font-medium text-gray-600\">Failed</p>\n                  <p className=\"text-2xl font-bold text-gray-900\">{stats.failed}</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center\">\n                <TrendingUp className=\"h-8 w-8 text-purple-600\" />\n                <div className=\"ml-4\">\n                  <p className=\"text-sm font-medium text-gray-600\">Average %</p>\n                  <p className=\"text-2xl font-bold text-gray-900\">{stats.average}%</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n        </ErrorBoundary>\n\n        {/* Filters */}\n        <Card>\n          <CardContent className=\"p-6\">\n            <div className=\"grid gap-4 md:grid-cols-4\">\n              <div>\n                <Label>Filter by Class</Label>\n                <Select value={selectedClass} onValueChange={(value) => {\n                  setSelectedClass(value)\n                  setSelectedExam('all')\n                }}>\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"All Classes\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">All Classes</SelectItem>\n                    {classes.map((cls: any) => (\n                      <SelectItem key={cls.id} value={cls.id}>\n                        {cls.name} - {cls.section}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div>\n                <Label>Filter by Exam</Label>\n                <Select \n                  value={selectedExam} \n                  onValueChange={setSelectedExam}\n                  disabled={selectedClass === 'all' && classes.length > 0}\n                >\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"All Exams\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">All Exams</SelectItem>\n                    {exams.map((exam: any) => (\n                      <SelectItem key={exam.id} value={exam.id}>\n                        {exam.exam_name} - {exam.subject}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div>\n                <Label>Search Student</Label>\n                <Input\n                  placeholder=\"Search by name or admission number...\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                />\n              </div>\n\n              <div className=\"flex items-end\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => {\n                    setSelectedClass('all')\n                    setSelectedExam('all')\n                    setSearchTerm('')\n                  }}\n                >\n                  Clear Filters\n                </Button>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Results Table */}\n        <ErrorBoundary>\n          {isLoading ? (\n            <TableSkeleton rows={8} columns={10} />\n          ) : filteredResults.length === 0 ? (\n            <Card>\n              <CardContent className=\"p-12 text-center text-gray-500\">\n                <FileText className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n                <p className=\"text-lg font-medium mb-2\">No Results Found</p>\n                <p className=\"mb-4\">No results match your filters. Try adjusting your search criteria.</p>\n                <Button\n                  variant=\"outline\"\n                  onClick={() => {\n                    setSelectedClass('all')\n                    setSelectedExam('all')\n                    setSearchTerm('')\n                  }}\n                >\n                  Clear All Filters\n                </Button>\n              </CardContent>\n            </Card>\n          ) : (\n          <Card>\n            <CardHeader>\n              <CardTitle>Results ({filteredResults.length})</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full\">\n                  <thead>\n                    <tr className=\"border-b\">\n                      <th className=\"text-left py-3 px-4\">Student</th>\n                      <th className=\"text-center py-3 px-4\">Admission No.</th>\n                      <th className=\"text-left py-3 px-4\">Exam</th>\n                      <th className=\"text-center py-3 px-4\">Marks Obtained</th>\n                      <th className=\"text-center py-3 px-4\">Total Marks</th>\n                      <th className=\"text-center py-3 px-4\">Percentage</th>\n                      <th className=\"text-center py-3 px-4\">Grade</th>\n                      <th className=\"text-center py-3 px-4\">Status</th>\n                      <th className=\"text-center py-3 px-4\">Uploaded By</th>\n                      <th className=\"text-center py-3 px-4\">Actions</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {filteredResults.map((result: ExamResult) => {\n                      const exam = examsMap.get(result.exam_id)\n                      return (\n                        <tr key={result.id} className=\"border-b hover:bg-gray-50\">\n                          <td className=\"py-3 px-4\">{result.student_name || 'Unknown'}</td>\n                          <td className=\"py-3 px-4 text-center\">{result.admission_number || '-'}</td>\n                          <td className=\"py-3 px-4\">\n                            <div className=\"text-sm\">\n                              <div className=\"font-medium\">{exam?.exam_name || 'Unknown Exam'}</div>\n                              <div className=\"text-gray-500\">{exam?.subject || ''}</div>\n                            </div>\n                          </td>\n                          <td className=\"py-3 px-4 text-center font-semibold\">{result.marks_obtained}</td>\n                        <td className=\"py-3 px-4 text-center\">{result.total_marks}</td>\n                        <td className=\"py-3 px-4 text-center\">\n                          <span className={result.percentage >= 50 ? 'text-green-600 font-semibold' : 'text-red-600 font-semibold'}>\n                            {result.percentage.toFixed(1)}%\n                          </span>\n                        </td>\n                        <td className=\"py-3 px-4 text-center\">\n                          <Badge variant=\"outline\">{result.grade || '-'}</Badge>\n                        </td>\n                        <td className=\"py-3 px-4 text-center\">\n                          {getStatusBadge(result.status)}\n                        </td>\n                        <td className=\"py-3 px-4 text-center text-sm text-gray-600\">\n                          {result.uploaded_by_name || 'Unknown'}\n                        </td>\n                        <td className=\"py-3 px-4 text-center\">\n                          <div className=\"flex justify-center gap-2\">\n                            <Button \n                              size=\"sm\" \n                              variant=\"ghost\"\n                              onClick={() => router.push(`/teacher/results?exam_id=${result.exam_id}&result_id=${result.id}`)}\n                            >\n                              <Eye className=\"h-4 w-4\" />\n                            </Button>\n                            <Button\n                              size=\"sm\"\n                              variant=\"ghost\"\n                              onClick={() => {\n                                if (confirm('Are you sure you want to delete this result?')) {\n                                  deleteResultMutation.mutate(result.id)\n                                }\n                              }}\n                              disabled={deleteResultMutation.isPending}\n                              className=\"text-red-600 hover:text-red-700\"\n                            >\n                              <Trash2 className=\"h-4 w-4\" />\n                            </Button>\n                          </div>\n                        </td>\n                      </tr>\n                      )\n                    })}\n                  </tbody>\n                </table>\n              </div>\n            </CardContent>\n          </Card>\n          )}\n        </ErrorBoundary>\n      </div>\n    </DashboardLayout>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\admin\\settings\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FeeStructure' is defined but never used.","line":11,"column":58,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":70},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AcademicYear' is defined but never used.","line":11,"column":72,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":84},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Settings' is defined but never used.","line":13,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Users' is defined but never used.","line":13,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":41},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Check' is defined but never used.","line":14,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":35},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":14,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":38},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":60,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":60,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2300,2303],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2300,2303],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":464,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":464,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[18924,18927],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[18924,18927],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState } from 'react'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { toast } from '@/components/ui/toast'\nimport { settingsService, SystemSetting, RolePermission, FeeStructure, AcademicYear } from '@/services/settingsService'\nimport {\n  Settings, Building2, DollarSign, Users, Shield, Bell, Palette, GraduationCap,\n  Save, Plus, Edit2, Trash2, Check, X, Download\n} from 'lucide-react'\n\ntype TabId = 'general' | 'academic' | 'financial' | 'permissions' | 'appearance' | 'notifications'\n\nexport default function SettingsPage() {\n  const queryClient = useQueryClient()\n  const [activeTab, setActiveTab] = useState<TabId>('general')\n  const [editingSettings, setEditingSettings] = useState<Record<string, string>>({})\n\n  // Fetch all settings\n  const { data: allSettings = [] } = useQuery({\n    queryKey: ['settings'],\n    queryFn: () => settingsService.getSystemSettings()\n  })\n\n  const { data: permissions = [] } = useQuery({\n    queryKey: ['permissions'],\n    queryFn: () => settingsService.getRolePermissions()\n  })\n\n  const { data: feeStructures = [] } = useQuery({\n    queryKey: ['fee-structures'],\n    queryFn: () => settingsService.getFeeStructure()\n  })\n\n  const { data: academicYears = [] } = useQuery({\n    queryKey: ['academic-years'],\n    queryFn: () => settingsService.getAcademicYears()\n  })\n\n  // Group settings by category\n  const settingsByCategory = allSettings.reduce((acc: Record<string, SystemSetting[]>, setting) => {\n    if (!acc[setting.category]) acc[setting.category] = []\n    acc[setting.category].push(setting)\n    return acc\n  }, {})\n\n  // Bulk update mutation\n  const bulkUpdateMutation = useMutation({\n    mutationFn: (settings: Record<string, string>) => settingsService.bulkUpdateSettings(settings),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['settings'] })\n      toast.success('Settings updated successfully!')\n      setEditingSettings({})\n    },\n    onError: (error: any) => {\n      toast.error(error?.response?.data?.detail || 'Failed to update settings')\n    }\n  })\n\n  const handleInputChange = (key: string, value: string) => {\n    setEditingSettings(prev => ({ ...prev, [key]: value }))\n  }\n\n  const handleSaveCategory = (category: string) => {\n    const categorySettings = settingsByCategory[category] || []\n    const updates: Record<string, string> = {}\n    \n    categorySettings.forEach(setting => {\n      if (editingSettings[setting.setting_key] !== undefined) {\n        updates[setting.setting_key] = editingSettings[setting.setting_key]\n      }\n    })\n\n    if (Object.keys(updates).length > 0) {\n      bulkUpdateMutation.mutate(updates)\n    }\n  }\n\n  const tabs = [\n    { id: 'general' as TabId, name: 'General', icon: Building2 },\n    { id: 'academic' as TabId, name: 'Academic', icon: GraduationCap },\n    { id: 'financial' as TabId, name: 'Financial', icon: DollarSign },\n    { id: 'permissions' as TabId, name: 'Permissions', icon: Shield },\n    { id: 'appearance' as TabId, name: 'Appearance', icon: Palette },\n    { id: 'notifications' as TabId, name: 'Notifications', icon: Bell },\n  ]\n\n  const renderSettingField = (setting: SystemSetting) => {\n    const currentValue = editingSettings[setting.setting_key] ?? setting.setting_value\n\n    if (setting.setting_type === 'boolean') {\n      return (\n        <div className=\"flex items-center space-x-2\">\n          <input\n            type=\"checkbox\"\n            checked={currentValue === 'true'}\n            onChange={(e) => handleInputChange(setting.setting_key, e.target.checked ? 'true' : 'false')}\n            className=\"h-4 w-4 rounded border-gray-300\"\n          />\n          <span className=\"text-sm text-gray-700\">{setting.description}</span>\n        </div>\n      )\n    }\n\n    if (setting.setting_type === 'number') {\n      return (\n        <div>\n          <Label htmlFor={setting.setting_key}>{setting.description || setting.setting_key}</Label>\n          <Input\n            type=\"number\"\n            id={setting.setting_key}\n            value={currentValue}\n            onChange={(e) => handleInputChange(setting.setting_key, e.target.value)}\n            className=\"mt-1\"\n          />\n        </div>\n      )\n    }\n\n    return (\n      <div>\n        <Label htmlFor={setting.setting_key}>{setting.description || setting.setting_key}</Label>\n        <Input\n          type=\"text\"\n          id={setting.setting_key}\n          value={currentValue}\n          onChange={(e) => handleInputChange(setting.setting_key, e.target.value)}\n          className=\"mt-1\"\n          placeholder={setting.setting_value}\n        />\n      </div>\n    )\n  }\n\n  return (\n    <DashboardLayout allowedRoles={['admin']}>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900\">System Settings</h1>\n            <p className=\"text-gray-600 mt-1\">Manage your school system configuration and preferences</p>\n          </div>\n          <Button variant=\"outline\">\n            <Download className=\"h-4 w-4 mr-2\" />\n            Export Settings\n          </Button>\n        </div>\n\n        {/* Tab Navigation */}\n        <div className=\"border-b border-gray-200\">\n          <nav className=\"-mb-px flex space-x-8\" aria-label=\"Tabs\">\n            {tabs.map((tab) => {\n              const Icon = tab.icon\n              return (\n                <button\n                  key={tab.id}\n                  onClick={() => setActiveTab(tab.id)}\n                  className={`\n                    ${activeTab === tab.id\n                      ? 'border-blue-500 text-blue-600'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n                    }\n                    whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2\n                  `}\n                >\n                  <Icon className=\"h-5 w-5\" />\n                  {tab.name}\n                </button>\n              )\n            })}\n          </nav>\n        </div>\n\n        {/* Tab Content */}\n        <div className=\"mt-6\">\n          {/* General Settings */}\n          {activeTab === 'general' && (\n            <Card>\n              <CardHeader>\n                <CardTitle>General Settings</CardTitle>\n                <CardDescription>Basic information about your school</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid gap-6 md:grid-cols-2\">\n                  {(settingsByCategory['general'] || []).map((setting) => (\n                    <div key={setting.id}>\n                      {renderSettingField(setting)}\n                    </div>\n                  ))}\n                </div>\n                <div className=\"mt-6\">\n                  <Button onClick={() => handleSaveCategory('general')} disabled={bulkUpdateMutation.isPending}>\n                    <Save className=\"h-4 w-4 mr-2\" />\n                    {bulkUpdateMutation.isPending ? 'Saving...' : 'Save Changes'}\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          {/* Academic Settings */}\n          {activeTab === 'academic' && (\n            <div className=\"space-y-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle>Academic Settings</CardTitle>\n                  <CardDescription>Configure academic year, terms, and grading</CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"grid gap-6 md:grid-cols-2\">\n                    {(settingsByCategory['academic'] || []).map((setting) => (\n                      <div key={setting.id}>\n                        {renderSettingField(setting)}\n                      </div>\n                    ))}\n                  </div>\n                  <div className=\"mt-6\">\n                    <Button onClick={() => handleSaveCategory('academic')} disabled={bulkUpdateMutation.isPending}>\n                      <Save className=\"h-4 w-4 mr-2\" />\n                      {bulkUpdateMutation.isPending ? 'Saving...' : 'Save Changes'}\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Academic Years */}\n              <Card>\n                <CardHeader>\n                  <div className=\"flex justify-between items-center\">\n                    <div>\n                      <CardTitle>Academic Years</CardTitle>\n                      <CardDescription>Manage academic year periods</CardDescription>\n                    </div>\n                    <Button size=\"sm\">\n                      <Plus className=\"h-4 w-4 mr-2\" />\n                      Add Academic Year\n                    </Button>\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-2\">\n                    {academicYears.map((year) => (\n                      <div\n                        key={year.id}\n                        className=\"flex items-center justify-between p-4 border rounded-lg hover:border-blue-500 transition-colors\"\n                      >\n                        <div className=\"flex items-center gap-4\">\n                          <div>\n                            <div className=\"font-medium\">{year.year_name}</div>\n                            <div className=\"text-sm text-gray-600\">\n                              {new Date(year.start_date).toLocaleDateString()} - {new Date(year.end_date).toLocaleDateString()}\n                            </div>\n                          </div>\n                          {year.is_current && (\n                            <span className=\"px-2 py-1 text-xs font-medium text-green-700 bg-green-50 rounded-full\">\n                              Current\n                            </span>\n                          )}\n                        </div>\n                        <div className=\"flex gap-2\">\n                          <Button size=\"sm\" variant=\"outline\">\n                            <Edit2 className=\"h-4 w-4\" />\n                          </Button>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          )}\n\n          {/* Financial Settings */}\n          {activeTab === 'financial' && (\n            <div className=\"space-y-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle>Financial Settings</CardTitle>\n                  <CardDescription>Configure currency, pricing, and billing</CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"grid gap-6 md:grid-cols-2\">\n                    {(settingsByCategory['financial'] || []).map((setting) => (\n                      <div key={setting.id}>\n                        {renderSettingField(setting)}\n                      </div>\n                    ))}\n                  </div>\n                  <div className=\"mt-6\">\n                    <Button onClick={() => handleSaveCategory('financial')} disabled={bulkUpdateMutation.isPending}>\n                      <Save className=\"h-4 w-4 mr-2\" />\n                      {bulkUpdateMutation.isPending ? 'Saving...' : 'Save Changes'}\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Fee Structure */}\n              <Card>\n                <CardHeader>\n                  <div className=\"flex justify-between items-center\">\n                    <div>\n                      <CardTitle>Fee Structure</CardTitle>\n                      <CardDescription>Manage class fees and charges</CardDescription>\n                    </div>\n                    <Button size=\"sm\">\n                      <Plus className=\"h-4 w-4 mr-2\" />\n                      Add Fee\n                    </Button>\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"overflow-x-auto\">\n                    <table className=\"w-full\">\n                      <thead>\n                        <tr className=\"border-b\">\n                          <th className=\"text-left py-3 px-4\">Class Level</th>\n                          <th className=\"text-left py-3 px-4\">Fee Type</th>\n                          <th className=\"text-right py-3 px-4\">Amount</th>\n                          <th className=\"text-left py-3 px-4\">Academic Year</th>\n                          <th className=\"text-center py-3 px-4\">Status</th>\n                          <th className=\"text-center py-3 px-4\">Actions</th>\n                        </tr>\n                      </thead>\n                      <tbody>\n                        {feeStructures.map((fee) => (\n                          <tr key={fee.id} className=\"border-b hover:bg-gray-50\">\n                            <td className=\"py-3 px-4\">{fee.class_level}</td>\n                            <td className=\"py-3 px-4 capitalize\">{fee.fee_type}</td>\n                            <td className=\"py-3 px-4 text-right font-medium\">\n                              {fee.currency} {fee.amount.toFixed(2)}\n                            </td>\n                            <td className=\"py-3 px-4\">{fee.academic_year}</td>\n                            <td className=\"py-3 px-4 text-center\">\n                              <span className={`px-2 py-1 text-xs font-medium rounded-full ${\n                                fee.is_active\n                                  ? 'text-green-700 bg-green-50'\n                                  : 'text-gray-700 bg-gray-100'\n                              }`}>\n                                {fee.is_active ? 'Active' : 'Inactive'}\n                              </span>\n                            </td>\n                            <td className=\"py-3 px-4 text-center\">\n                              <div className=\"flex justify-center gap-2\">\n                                <Button size=\"sm\" variant=\"outline\">\n                                  <Edit2 className=\"h-4 w-4\" />\n                                </Button>\n                                <Button size=\"sm\" variant=\"outline\">\n                                  <Trash2 className=\"h-4 w-4 text-red-600\" />\n                                </Button>\n                              </div>\n                            </td>\n                          </tr>\n                        ))}\n                      </tbody>\n                    </table>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          )}\n\n          {/* Permissions Settings */}\n          {activeTab === 'permissions' && (\n            <Card>\n              <CardHeader>\n                <CardTitle>Role Permissions</CardTitle>\n                <CardDescription>Manage what each user role can access and modify</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <PermissionsTable permissions={permissions} />\n              </CardContent>\n            </Card>\n          )}\n\n          {/* Appearance Settings */}\n          {activeTab === 'appearance' && (\n            <Card>\n              <CardHeader>\n                <CardTitle>Appearance Settings</CardTitle>\n                <CardDescription>Customize the look and feel of your system</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid gap-6 md:grid-cols-2\">\n                  {(settingsByCategory['appearance'] || []).map((setting) => (\n                    <div key={setting.id}>\n                      {renderSettingField(setting)}\n                    </div>\n                  ))}\n                </div>\n                <div className=\"mt-6\">\n                  <Button onClick={() => handleSaveCategory('appearance')} disabled={bulkUpdateMutation.isPending}>\n                    <Save className=\"h-4 w-4 mr-2\" />\n                    {bulkUpdateMutation.isPending ? 'Saving...' : 'Save Changes'}\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          {/* Notifications Settings */}\n          {activeTab === 'notifications' && (\n            <Card>\n              <CardHeader>\n                <CardTitle>Notification Settings</CardTitle>\n                <CardDescription>Configure how and when users receive notifications</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-4\">\n                  {(settingsByCategory['notification'] || []).map((setting) => (\n                    <div key={setting.id} className=\"flex items-center justify-between p-4 border rounded-lg\">\n                      <div>\n                        <div className=\"font-medium\">{setting.description || setting.setting_key}</div>\n                        <div className=\"text-sm text-gray-600 mt-1\">\n                          {setting.setting_key}\n                        </div>\n                      </div>\n                      {renderSettingField(setting)}\n                    </div>\n                  ))}\n                </div>\n                <div className=\"mt-6\">\n                  <Button onClick={() => handleSaveCategory('notification')} disabled={bulkUpdateMutation.isPending}>\n                    <Save className=\"h-4 w-4 mr-2\" />\n                    {bulkUpdateMutation.isPending ? 'Saving...' : 'Save Changes'}\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          )}\n        </div>\n      </div>\n    </DashboardLayout>\n  )\n}\n\n// Permissions Table Component\nfunction PermissionsTable({ permissions }: { permissions: RolePermission[] }) {\n  const queryClient = useQueryClient()\n\n  // Group permissions by role\n  const permissionsByRole = permissions.reduce((acc: Record<string, Record<string, boolean>>, perm) => {\n    if (!acc[perm.role]) acc[perm.role] = {}\n    acc[perm.role][perm.permission_key] = perm.permission_value\n    return acc\n  }, {})\n\n  const permissionKeys = Array.from(new Set(permissions.map(p => p.permission_key)))\n  const roles = ['admin', 'principal', 'teacher', 'student'] as const\n\n  const updatePermissionMutation = useMutation({\n    mutationFn: ({ role, key, value }: { role: string; key: string; value: boolean }) =>\n      settingsService.updateRolePermission(role, key, value),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['permissions'] })\n      toast.success('Permission updated successfully!')\n    },\n    onError: (error: any) => {\n      toast.error(error?.response?.data?.detail || 'Failed to update permission')\n    }\n  })\n\n  return (\n    <div className=\"overflow-x-auto\">\n      <table className=\"w-full\">\n        <thead>\n          <tr className=\"border-b\">\n            <th className=\"text-left py-3 px-4 font-medium\">Permission</th>\n            {roles.map((role) => (\n              <th key={role} className=\"text-center py-3 px-4 font-medium capitalize\">\n                {role}\n              </th>\n            ))}\n          </tr>\n        </thead>\n        <tbody>\n          {permissionKeys.map((key) => (\n            <tr key={key} className=\"border-b hover:bg-gray-50\">\n              <td className=\"py-3 px-4 font-medium capitalize\">\n                {key.replace(/_/g, ' ')}\n              </td>\n              {roles.map((role) => (\n                <td key={`${role}-${key}`} className=\"py-3 px-4 text-center\">\n                  <input\n                    type=\"checkbox\"\n                    checked={permissionsByRole[role]?.[key] || false}\n                    onChange={(e) =>\n                      updatePermissionMutation.mutate({\n                        role,\n                        key,\n                        value: e.target.checked\n                      })\n                    }\n                    disabled={role === 'admin'} // Admin always has all permissions\n                    className=\"h-5 w-5 rounded border-gray-300\"\n                  />\n                </td>\n              ))}\n            </tr>\n          ))}\n        </tbody>\n      </table>\n    </div>\n  )\n}","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\admin\\stationery\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":20,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1008,1011],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1008,1011],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":66,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":66,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2333,2336],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2333,2336],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":76,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":76,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2637,2640],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2637,2640],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":88,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":88,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3032,3035],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3032,3035],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":103,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":103,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3311,3314],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3311,3314],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":138,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":138,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4207,4210],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4207,4210],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":145,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":145,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4462,4465],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4462,4465],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":148,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":148,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4576,4579],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4576,4579],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":151,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":151,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4685,4688],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4685,4688],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":285,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":285,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10222,10225],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10222,10225],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState } from 'react'\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { Plus, Search, Edit, Trash2, X, Package, AlertTriangle } from 'lucide-react'\nimport { financeService } from '@/services/financeService'\nimport { Badge } from '@/components/ui/badge'\nimport { toast } from '@/components/ui/toast'\nimport { ConfirmDialog } from '@/components/shared/ConfirmDialog'\n\nexport default function StationeryPage() {\n  const [search, setSearch] = useState('')\n  const [showForm, setShowForm] = useState(false)\n  const [selectedItem, setSelectedItem] = useState<any>(null)\n  const [categoryFilter, setCategoryFilter] = useState<string>('all')\n  const [confirmDialog, setConfirmDialog] = useState<{\n    open: boolean\n    title: string\n    description: string\n    onConfirm: () => void\n  }>({\n    open: false,\n    title: '',\n    description: '',\n    onConfirm: () => {},\n  })\n  const queryClient = useQueryClient()\n\n  // Form state matching database schema\n  const [formData, setFormData] = useState({\n    name: '',\n    category: '',\n    quantity: '',\n    unit: '',\n    reorder_level: ''\n  })\n\n  // Fetch stationery items from database\n  const { data: stationery = [], isLoading } = useQuery({\n    queryKey: ['stationery', categoryFilter],\n    queryFn: () => financeService.getStationeryItems({\n      category: categoryFilter !== 'all' ? categoryFilter : undefined\n    }),\n  })\n\n  // Create/Update mutation\n  const saveMutation = useMutation({\n    mutationFn: async (data: typeof formData) => {\n      const itemData = {\n        name: data.name,\n        category: data.category,\n        quantity: parseInt(data.quantity),\n        unit: data.unit,\n        reorder_level: parseInt(data.reorder_level)\n      }\n\n      if (selectedItem) {\n        return financeService.updateStationeryItem(selectedItem.id, itemData)\n      } else {\n        return financeService.createStationeryItem(itemData as any)\n      }\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['stationery'] })\n      setShowForm(false)\n      setSelectedItem(null)\n      resetForm()\n      toast.success(selectedItem ? 'Item updated successfully!' : 'Item created successfully!')\n    },\n    onError: (error: any) => {\n      toast.error(error.response?.data?.detail || 'Failed to save item')\n    }\n  })\n\n  // Delete mutation\n  const deleteMutation = useMutation({\n    mutationFn: (id: string) => financeService.deleteStationeryItem(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['stationery'] })\n      toast.success('Item deleted successfully!')\n    },\n    onError: (error: any) => {\n      toast.error(error.response?.data?.detail || 'Failed to delete item')\n    }\n  })\n\n  const resetForm = () => {\n    setFormData({\n      name: '',\n      category: '',\n      quantity: '',\n      unit: '',\n      reorder_level: ''\n    })\n  }\n\n  const handleEdit = (item: any) => {\n    setSelectedItem(item)\n    setFormData({\n      name: item.name,\n      category: item.category,\n      quantity: item.quantity.toString(),\n      unit: item.unit,\n      reorder_level: item.reorder_level.toString()\n    })\n    setShowForm(true)\n  }\n\n  const handleDelete = (id: string) => {\n    setConfirmDialog({\n      open: true,\n      title: 'Delete Stationery Item',\n      description: 'Are you sure you want to delete this item? This action cannot be undone.',\n      onConfirm: () => {\n        deleteMutation.mutate(id)\n      },\n    })\n  }\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault()\n    \n    if (!formData.name || !formData.category || !formData.quantity || !formData.unit) {\n      alert('Please fill all required fields')\n      return\n    }\n\n    saveMutation.mutate(formData)\n  }\n\n  // Filter by search\n  const filteredItems = stationery.filter((item: any) =>\n    item.name?.toLowerCase().includes(search.toLowerCase()) ||\n    item.category?.toLowerCase().includes(search.toLowerCase())\n  )\n\n  // Calculate stats\n  const totalItems = filteredItems.length\n  const lowStockItems = filteredItems.filter((item: any) => \n    item.quantity <= item.reorder_level\n  ).length\n  const outOfStockItems = filteredItems.filter((item: any) => \n    item.quantity === 0\n  ).length\n  const totalQuantity = filteredItems.reduce((sum: number, item: any) => \n    sum + (item.quantity || 0), 0\n  )\n\n  return (\n    <DashboardLayout allowedRoles={['admin', 'principal']}>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-bold\">Stationery Management</h1>\n            <p className=\"text-gray-600\">Manage school inventory and supplies</p>\n          </div>\n          <Button onClick={() => { resetForm(); setShowForm(true); setSelectedItem(null) }}>\n            <Plus className=\"mr-2 h-4 w-4\" />\n            Add Item\n          </Button>\n        </div>\n\n        {/* Stats Cards */}\n        <div className=\"grid gap-6 md:grid-cols-4\">\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Total Items</CardTitle>\n              <Package className=\"h-4 w-4 text-gray-600\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">{totalItems}</div>\n              <p className=\"text-xs text-gray-600\">Different items</p>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Total Quantity</CardTitle>\n              <Package className=\"h-4 w-4 text-blue-600\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-blue-600\">{totalQuantity}</div>\n              <p className=\"text-xs text-gray-600\">All units</p>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Low Stock</CardTitle>\n              <AlertTriangle className=\"h-4 w-4 text-yellow-600\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-yellow-600\">{lowStockItems}</div>\n              <p className=\"text-xs text-gray-600\">Need reorder</p>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Out of Stock</CardTitle>\n              <AlertTriangle className=\"h-4 w-4 text-red-600\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-red-600\">{outOfStockItems}</div>\n              <p className=\"text-xs text-gray-600\">Urgent!</p>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Filters */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Filters</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid gap-4 md:grid-cols-3\">\n              <div className=\"relative\">\n                <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400\" />\n                <Input\n                  placeholder=\"Search items...\"\n                  value={search}\n                  onChange={(e) => setSearch(e.target.value)}\n                  className=\"pl-10\"\n                />\n              </div>\n\n              <Select value={categoryFilter} onValueChange={setCategoryFilter}>\n                <SelectTrigger>\n                  <SelectValue placeholder=\"All Categories\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">All Categories</SelectItem>\n                  <SelectItem value=\"books\">Books</SelectItem>\n                  <SelectItem value=\"supplies\">Supplies</SelectItem>\n                  <SelectItem value=\"equipment\">Equipment</SelectItem>\n                  <SelectItem value=\"uniform\">Uniform</SelectItem>\n                  <SelectItem value=\"other\">Other</SelectItem>\n                </SelectContent>\n              </Select>\n\n              <Button variant=\"outline\" onClick={() => {\n                setSearch('')\n                setCategoryFilter('all')\n              }}>\n                Clear Filters\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Items List */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Inventory ({filteredItems.length})</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <div className=\"text-center py-8\">Loading inventory...</div>\n            ) : filteredItems.length === 0 ? (\n              <div className=\"text-center py-8 text-gray-500\">\n                No items found. Add your first stationery item!\n              </div>\n            ) : (\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full\">\n                  <thead>\n                    <tr className=\"border-b\">\n                      <th className=\"text-left p-3\">Item Name</th>\n                      <th className=\"text-left p-3\">Category</th>\n                      <th className=\"text-left p-3\">Quantity</th>\n                      <th className=\"text-left p-3\">Unit</th>\n                      <th className=\"text-left p-3\">Reorder Level</th>\n                      <th className=\"text-left p-3\">Status</th>\n                      <th className=\"text-right p-3\">Actions</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {filteredItems.map((item: any) => {\n                      const isLowStock = item.quantity <= item.reorder_level\n                      const isOutOfStock = item.quantity === 0\n                      \n                      return (\n                        <tr key={item.id} className=\"border-b hover:bg-gray-50\">\n                          <td className=\"p-3 font-medium\">{item.name}</td>\n                          <td className=\"p-3 capitalize\">{item.category}</td>\n                          <td className=\"p-3\">\n                            <span className={\n                              isOutOfStock ? 'text-red-600 font-semibold' :\n                              isLowStock ? 'text-yellow-600 font-semibold' :\n                              'text-green-600 font-semibold'\n                            }>\n                              {item.quantity}\n                            </span>\n                          </td>\n                          <td className=\"p-3\">{item.unit}</td>\n                          <td className=\"p-3\">{item.reorder_level}</td>\n                          <td className=\"p-3\">\n                            {isOutOfStock ? (\n                              <Badge className=\"bg-red-100 text-red-800\">Out of Stock</Badge>\n                            ) : isLowStock ? (\n                              <Badge className=\"bg-yellow-100 text-yellow-800\">Low Stock</Badge>\n                            ) : (\n                              <Badge className=\"bg-green-100 text-green-800\">Available</Badge>\n                            )}\n                          </td>\n                          <td className=\"p-3\">\n                            <div className=\"flex justify-end gap-2\">\n                              <Button\n                                variant=\"ghost\"\n                                size=\"sm\"\n                                onClick={() => handleEdit(item)}\n                              >\n                                <Edit className=\"h-4 w-4\" />\n                              </Button>\n                              <Button\n                                variant=\"ghost\"\n                                size=\"sm\"\n                                onClick={() => handleDelete(item.id)}\n                                className=\"text-red-600 hover:text-red-700\"\n                              >\n                                <Trash2 className=\"h-4 w-4\" />\n                              </Button>\n                            </div>\n                          </td>\n                        </tr>\n                      )\n                    })}\n                  </tbody>\n                </table>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Add/Edit Form Modal */}\n        {showForm && (\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\n            <Card className=\"w-full max-w-2xl\">\n              <CardHeader>\n                <div className=\"flex items-center justify-between\">\n                  <CardTitle>{selectedItem ? 'Edit Item' : 'Add New Item'}</CardTitle>\n                  <Button variant=\"ghost\" size=\"sm\" onClick={() => { setShowForm(false); setSelectedItem(null); resetForm() }}>\n                    <X className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </CardHeader>\n              <CardContent>\n                <form onSubmit={handleSubmit} className=\"space-y-4\">\n                  <div className=\"grid gap-4 md:grid-cols-2\">\n                    <div className=\"md:col-span-2\">\n                      <Label>Item Name *</Label>\n                      <Input\n                        value={formData.name}\n                        onChange={(e) => setFormData({...formData, name: e.target.value})}\n                        placeholder=\"e.g., Mathematics Textbook\"\n                        required\n                      />\n                    </div>\n\n                    <div>\n                      <Label>Category *</Label>\n                      <Select value={formData.category} onValueChange={(value) => setFormData({...formData, category: value})}>\n                        <SelectTrigger>\n                          <SelectValue placeholder=\"Select category\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"books\">Books</SelectItem>\n                          <SelectItem value=\"supplies\">Supplies</SelectItem>\n                          <SelectItem value=\"equipment\">Equipment</SelectItem>\n                          <SelectItem value=\"uniform\">Uniform</SelectItem>\n                          <SelectItem value=\"other\">Other</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </div>\n\n                    <div>\n                      <Label>Unit *</Label>\n                      <Input\n                        value={formData.unit}\n                        onChange={(e) => setFormData({...formData, unit: e.target.value})}\n                        placeholder=\"e.g., pieces, boxes, packs\"\n                        required\n                      />\n                    </div>\n\n                    <div>\n                      <Label>Quantity *</Label>\n                      <Input\n                        type=\"number\"\n                        min=\"0\"\n                        value={formData.quantity}\n                        onChange={(e) => setFormData({...formData, quantity: e.target.value})}\n                        placeholder=\"e.g., 100\"\n                        required\n                      />\n                    </div>\n\n                    <div>\n                      <Label>Reorder Level *</Label>\n                      <Input\n                        type=\"number\"\n                        min=\"0\"\n                        value={formData.reorder_level}\n                        onChange={(e) => setFormData({...formData, reorder_level: e.target.value})}\n                        placeholder=\"e.g., 10\"\n                        required\n                      />\n                      <p className=\"text-xs text-gray-500 mt-1\">\n                        Alert when quantity falls below this level\n                      </p>\n                    </div>\n                  </div>\n\n                  <div className=\"flex justify-end gap-2 pt-4\">\n                    <Button type=\"button\" variant=\"outline\" onClick={() => { setShowForm(false); setSelectedItem(null); resetForm() }}>\n                      Cancel\n                    </Button>\n                    <Button type=\"submit\" disabled={saveMutation.isPending}>\n                      {saveMutation.isPending ? 'Saving...' : selectedItem ? 'Update Item' : 'Add Item'}\n                    </Button>\n                  </div>\n                </form>\n              </CardContent>\n            </Card>\n          </div>\n        )}\n\n        {/* Confirm Dialog */}\n        <ConfirmDialog\n          open={confirmDialog.open}\n          onOpenChange={(open) => setConfirmDialog({ ...confirmDialog, open })}\n          title={confirmDialog.title}\n          description={confirmDialog.description}\n          onConfirm={confirmDialog.onConfirm}\n          variant=\"destructive\"\n        />\n      </div>\n    </DashboardLayout>\n  )\n}\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\admin\\students\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":10,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BookOpen' is defined but never used.","line":18,"column":96,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":104},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Class' is defined but never used.","line":21,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":43},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'refetch' is assigned a value but never used.","line":46,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":46,"endColumn":50},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":107,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4165,4168],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4165,4168],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useMemo } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Badge } from '@/components/ui/badge'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { studentService } from '@/services/studentService'\nimport { gradeService } from '@/services/gradeService'\nimport { attendanceService } from '@/services/attendanceService'\nimport { classService } from '@/services/classService'\nimport { ReportCardModal } from '@/components/shared/ReportCardModal'\nimport { EntityLink } from '@/components/shared/EntityLink'\nimport { Plus, Search, Edit, Trash2, Eye, X, FileText, Calendar, Award, BarChart3, TrendingUp, BookOpen } from 'lucide-react'\nimport { formatDate } from '@/lib/utils'\nimport { StudentForm } from '@/components/students/StudentForm'\nimport { Student, Grade, Attendance, Class } from '@/types'\nimport { toast } from '@/components/ui/toast'\nimport { ConfirmDialog } from '@/components/shared/ConfirmDialog'\n\nexport default function StudentsPage() {\n  const router = useRouter()\n  const [search, setSearch] = useState('')\n  const [showForm, setShowForm] = useState(false)\n  const [selectedStudent, setSelectedStudent] = useState<Student | null>(null)\n  const [showViewModal, setShowViewModal] = useState(false)\n  const [viewStudent, setViewStudent] = useState<Student | null>(null)\n  const [showReportCardModal, setShowReportCardModal] = useState(false)\n  const [confirmDialog, setConfirmDialog] = useState<{\n    open: boolean\n    title: string\n    description: string\n    onConfirm: () => void\n  }>({\n    open: false,\n    title: '',\n    description: '',\n    onConfirm: () => {},\n  })\n  const queryClient = useQueryClient()\n\n  const { data: students = [], isLoading, refetch } = useQuery({\n    queryKey: ['students', search],\n    queryFn: () => studentService.getStudents({ search, limit: 1000 }),\n  })\n\n  // Fetch grades for selected student\n  const { data: studentGrades = [] } = useQuery({\n    queryKey: ['grades', viewStudent?.id],\n    queryFn: () => gradeService.getGrades({ student_id: viewStudent!.id, limit: 1000 }),\n    enabled: !!viewStudent?.id,\n  })\n\n  // Fetch attendance for selected student\n  const { data: studentAttendance = [] } = useQuery({\n    queryKey: ['attendance', viewStudent?.user_id],\n    queryFn: () => attendanceService.getAttendance({ \n      user_id: viewStudent!.user_id, \n      limit: 1000 \n    }),\n    enabled: !!viewStudent?.user_id,\n  })\n\n  // Fetch class information for selected student\n  const { data: classInfo } = useQuery({\n    queryKey: ['class', viewStudent?.class_id],\n    queryFn: () => classService.getClass(viewStudent!.class_id!),\n    enabled: !!viewStudent?.class_id,\n  })\n\n  // Calculate student statistics\n  const studentStats = useMemo(() => {\n    if (!viewStudent) return null\n    \n    const totalGrades = studentGrades.length\n    const passingGrades = studentGrades.filter((g: Grade) => Number(g.marks) >= 50).length\n    const averageMarks = totalGrades > 0\n      ? (studentGrades.reduce((sum: number, g: Grade) => sum + Number(g.marks), 0) / totalGrades).toFixed(1)\n      : 0\n    \n    const totalAttendance = studentAttendance.length\n    const presentAttendance = studentAttendance.filter((a: Attendance) => a.status === 'present').length\n    const attendanceRate = totalAttendance > 0\n      ? Math.round((presentAttendance / totalAttendance) * 100)\n      : 0\n\n    return {\n      totalGrades,\n      passingGrades,\n      averageMarks,\n      attendanceRate,\n      totalAttendance,\n      presentAttendance,\n    }\n  }, [viewStudent, studentGrades, studentAttendance])\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: string) => studentService.deleteStudent(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['students'] })\n      toast.success('Student deleted successfully')\n    },\n    onError: (error: any) => {\n      toast.error(error.response?.data?.detail || 'Failed to delete student')\n    }\n  })\n\n  const filteredStudents = students.filter(student =>\n    student.admission_number.toLowerCase().includes(search.toLowerCase()) ||\n    student.user?.full_name?.toLowerCase().includes(search.toLowerCase()) ||\n    student.guardian_info.name.toLowerCase().includes(search.toLowerCase())\n  )\n\n  const handleAddStudent = () => {\n    setSelectedStudent(null)\n    setShowForm(true)\n  }\n\n  const handleEditStudent = (student: Student) => {\n    setSelectedStudent(student)\n    setShowForm(true)\n  }\n\n  const handleViewStudent = (student: Student) => {\n    setViewStudent(student)\n    setShowViewModal(true)\n  }\n\n  const handleDeleteStudent = (student: Student) => {\n    setConfirmDialog({\n      open: true,\n      title: 'Delete Student',\n      description: `Are you sure you want to delete ${student.user?.full_name || student.admission_number}? This action cannot be undone.`,\n      onConfirm: () => {\n        deleteMutation.mutate(student.id)\n      },\n    })\n  }\n\n  const handleFormSuccess = () => {\n    queryClient.invalidateQueries({ queryKey: ['students'] })\n    setShowForm(false)\n    setSelectedStudent(null)\n  }\n\n  const handleViewGrades = (student: Student) => {\n    router.push(`/admin/grades?student_id=${student.id}`)\n  }\n\n  const handleViewAttendance = (student: Student) => {\n    router.push(`/admin/attendance?user_id=${student.user_id}`)\n  }\n\n  const handleViewReportCard = (student: Student) => {\n    setViewStudent(student)\n    setShowReportCardModal(true)\n  }\n\n  return (\n    <DashboardLayout allowedRoles={['admin', 'principal']}>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-bold\">Students</h1>\n            <p className=\"text-gray-600\">Manage student records</p>\n          </div>\n          <Button onClick={handleAddStudent}>\n            <Plus className=\"mr-2 h-4 w-4\" />\n            Add Student\n          </Button>\n        </div>\n\n        <Card>\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <CardTitle>All Students</CardTitle>\n              <div className=\"flex items-center gap-2\">\n                <div className=\"relative\">\n                  <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400\" />\n                  <Input\n                    placeholder=\"Search students...\"\n                    value={search}\n                    onChange={(e) => setSearch(e.target.value)}\n                    className=\"pl-10 w-64\"\n                  />\n                </div>\n              </div>\n            </div>\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <div className=\"text-center py-8 text-gray-500\">Loading...</div>\n            ) : filteredStudents.length === 0 ? (\n              <div className=\"text-center py-8 text-gray-500\">\n                No students found\n              </div>\n            ) : (\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full\">\n                  <thead>\n                    <tr className=\"border-b\">\n                      <th className=\"text-left py-3 px-4\">Admission No.</th>\n                      <th className=\"text-left py-3 px-4\">Name</th>\n                      <th className=\"text-left py-3 px-4\">Admission Date</th>\n                      <th className=\"text-left py-3 px-4\">Guardian</th>\n                      <th className=\"text-left py-3 px-4\">Status</th>\n                      <th className=\"text-left py-3 px-4\">Actions</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {filteredStudents.map((student) => (\n                      <tr key={student.id} className=\"border-b hover:bg-gray-50\">\n                        <td className=\"py-3 px-4 font-medium\">\n                          {student.admission_number}\n                        </td>\n                        <td className=\"py-3 px-4\">\n                          {student.user?.full_name || 'N/A'}\n                        </td>\n                        <td className=\"py-3 px-4\">\n                          {formatDate(student.admission_date)}\n                        </td>\n                        <td className=\"py-3 px-4\">\n                          {student.guardian_info.name}\n                        </td>\n                        <td className=\"py-3 px-4\">\n                          <span\n                            className={`inline-flex rounded-full px-2 py-1 text-xs font-semibold ${\n                              student.status === 'active'\n                                ? 'bg-green-100 text-green-800'\n                                : 'bg-gray-100 text-gray-800'\n                            }`}\n                          >\n                            {student.status}\n                          </span>\n                        </td>\n                        <td className=\"py-3 px-4\">\n                          <div className=\"flex items-center gap-1\">\n                            <Button \n                              size=\"sm\" \n                              variant=\"ghost\"\n                              onClick={() => handleViewStudent(student)}\n                              title=\"View Details\"\n                              className=\"h-8 w-8 p-0\"\n                            >\n                              <Eye className=\"h-4 w-4\" />\n                            </Button>\n                            <Button \n                              size=\"sm\" \n                              variant=\"ghost\"\n                              onClick={() => handleViewGrades(student)}\n                              title=\"View Grades\"\n                              className=\"h-8 w-8 p-0\"\n                            >\n                              <FileText className=\"h-4 w-4\" />\n                            </Button>\n                            <Button \n                              size=\"sm\" \n                              variant=\"ghost\"\n                              onClick={() => handleViewAttendance(student)}\n                              title=\"View Attendance\"\n                              className=\"h-8 w-8 p-0\"\n                            >\n                              <Calendar className=\"h-4 w-4\" />\n                            </Button>\n                            <Button \n                              size=\"sm\" \n                              variant=\"ghost\"\n                              onClick={() => handleEditStudent(student)}\n                              title=\"Edit Student\"\n                              className=\"h-8 w-8 p-0\"\n                            >\n                              <Edit className=\"h-4 w-4\" />\n                            </Button>\n                            <Button \n                              size=\"sm\" \n                              variant=\"ghost\"\n                              onClick={() => handleDeleteStudent(student)}\n                              title=\"Delete Student\"\n                              disabled={deleteMutation.isPending}\n                              className=\"h-8 w-8 p-0\"\n                            >\n                              <Trash2 className=\"h-4 w-4 text-red-600\" />\n                            </Button>\n                          </div>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Student Form Modal */}\n        {showForm && (\n          <StudentForm\n            student={selectedStudent || undefined}\n            onClose={() => setShowForm(false)}\n            onSuccess={handleFormSuccess}\n          />\n        )}\n\n        {/* Student View Modal */}\n        {showViewModal && viewStudent && (\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n            <Card className=\"w-full max-w-2xl max-h-[90vh] overflow-y-auto\">\n              <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-4\">\n                <CardTitle>Student Details</CardTitle>\n                <Button variant=\"ghost\" size=\"sm\" onClick={() => setShowViewModal(false)}>\n                  <X className=\"h-4 w-4\" />\n                </Button>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                {/* Student Information */}\n                <div className=\"space-y-4\">\n                  <h3 className=\"text-lg font-semibold\">Student Information</h3>\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <div>\n                      <Label className=\"text-sm font-medium text-gray-600\">Admission Number</Label>\n                      <p className=\"text-sm\">{viewStudent.admission_number}</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-gray-600\">Full Name</Label>\n                      <p className=\"text-sm\">{viewStudent.user?.full_name || 'N/A'}</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-gray-600\">Email</Label>\n                      <p className=\"text-sm\">{viewStudent.user?.email || 'N/A'}</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-gray-600\">Phone</Label>\n                      <p className=\"text-sm\">{viewStudent.user?.phone || 'N/A'}</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-gray-600\">Admission Date</Label>\n                      <p className=\"text-sm\">{formatDate(viewStudent.admission_date)}</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-gray-600\">Class</Label>\n                      {classInfo ? (\n                        <EntityLink \n                          href={`/admin/classes?class_id=${classInfo.id}`}\n                          variant=\"badge\"\n                        >\n                          {classInfo.name} - {classInfo.section}\n                        </EntityLink>\n                      ) : (\n                        <p className=\"text-sm\">Not assigned</p>\n                      )}\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-gray-600\">Status</Label>\n                      <span\n                        className={`inline-flex rounded-full px-2 py-1 text-xs font-semibold ${\n                          viewStudent.status === 'active'\n                            ? 'bg-green-100 text-green-800'\n                            : 'bg-gray-100 text-gray-800'\n                        }`}\n                      >\n                        {viewStudent.status}\n                      </span>\n                    </div>\n                    <div className=\"md:col-span-2\">\n                      <Label className=\"text-sm font-medium text-gray-600\">Address</Label>\n                      <p className=\"text-sm\">{viewStudent.user?.address || 'N/A'}</p>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Guardian Information */}\n                <div className=\"space-y-4\">\n                  <h3 className=\"text-lg font-semibold\">Guardian Information</h3>\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <div>\n                      <Label className=\"text-sm font-medium text-gray-600\">Guardian Name</Label>\n                      <p className=\"text-sm\">{viewStudent.guardian_info.name}</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-gray-600\">Relation</Label>\n                      <p className=\"text-sm capitalize\">{viewStudent.guardian_info.relation}</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-gray-600\">Guardian Phone</Label>\n                      <p className=\"text-sm\">{viewStudent.guardian_info.phone}</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-gray-600\">Guardian Email</Label>\n                      <p className=\"text-sm\">{viewStudent.guardian_info.email || 'N/A'}</p>\n                    </div>\n                    <div className=\"md:col-span-2\">\n                      <Label className=\"text-sm font-medium text-gray-600\">Guardian Address</Label>\n                      <p className=\"text-sm\">{viewStudent.guardian_info.address || 'N/A'}</p>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Quick Stats */}\n                {studentStats && (\n                  <div className=\"space-y-4\">\n                    <h3 className=\"text-lg font-semibold\">Quick Statistics</h3>\n                    <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                      <Card>\n                        <CardContent className=\"p-4\">\n                          <div className=\"flex items-center justify-between\">\n                            <div>\n                              <p className=\"text-xs text-gray-600\">Average Marks</p>\n                              <p className=\"text-2xl font-bold text-blue-600\">{studentStats.averageMarks}%</p>\n                            </div>\n                            <Award className=\"h-8 w-8 text-blue-600 opacity-50\" />\n                          </div>\n                        </CardContent>\n                      </Card>\n                      <Card>\n                        <CardContent className=\"p-4\">\n                          <div className=\"flex items-center justify-between\">\n                            <div>\n                              <p className=\"text-xs text-gray-600\">Total Grades</p>\n                              <p className=\"text-2xl font-bold text-purple-600\">{studentStats.totalGrades}</p>\n                            </div>\n                            <FileText className=\"h-8 w-8 text-purple-600 opacity-50\" />\n                          </div>\n                        </CardContent>\n                      </Card>\n                      <Card>\n                        <CardContent className=\"p-4\">\n                          <div className=\"flex items-center justify-between\">\n                            <div>\n                              <p className=\"text-xs text-gray-600\">Attendance Rate</p>\n                              <p className=\"text-2xl font-bold text-green-600\">{studentStats.attendanceRate}%</p>\n                            </div>\n                            <Calendar className=\"h-8 w-8 text-green-600 opacity-50\" />\n                          </div>\n                        </CardContent>\n                      </Card>\n                      <Card>\n                        <CardContent className=\"p-4\">\n                          <div className=\"flex items-center justify-between\">\n                            <div>\n                              <p className=\"text-xs text-gray-600\">Passing Grades</p>\n                              <p className=\"text-2xl font-bold text-orange-600\">{studentStats.passingGrades}/{studentStats.totalGrades}</p>\n                            </div>\n                            <TrendingUp className=\"h-8 w-8 text-orange-600 opacity-50\" />\n                          </div>\n                        </CardContent>\n                      </Card>\n                    </div>\n                  </div>\n                )}\n\n                {/* Quick Actions */}\n                <div className=\"space-y-4\">\n                  <h3 className=\"text-lg font-semibold\">Quick Actions</h3>\n                  <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\n                    <Button \n                      variant=\"outline\" \n                      onClick={() => {\n                        setShowViewModal(false)\n                        handleViewGrades(viewStudent)\n                      }}\n                      className=\"flex items-center gap-2\"\n                    >\n                      <FileText className=\"h-4 w-4\" />\n                      View Grades\n                    </Button>\n                    <Button \n                      variant=\"outline\" \n                      onClick={() => {\n                        setShowViewModal(false)\n                        handleViewAttendance(viewStudent)\n                      }}\n                      className=\"flex items-center gap-2\"\n                    >\n                      <Calendar className=\"h-4 w-4\" />\n                      View Attendance\n                    </Button>\n                    <Button \n                      variant=\"outline\" \n                      onClick={() => {\n                        setShowViewModal(false)\n                        handleViewReportCard(viewStudent)\n                      }}\n                      className=\"flex items-center gap-2\"\n                    >\n                      <Award className=\"h-4 w-4\" />\n                      Report Card\n                    </Button>\n                    <Button \n                      variant=\"outline\" \n                      onClick={() => {\n                        setShowViewModal(false)\n                        router.push(`/admin/reports?student_id=${viewStudent.id}&type=academic`)\n                      }}\n                      className=\"flex items-center gap-2\"\n                    >\n                      <BarChart3 className=\"h-4 w-4\" />\n                      Generate Report\n                    </Button>\n                  </div>\n                </div>\n\n                {/* Actions */}\n                <div className=\"flex justify-end space-x-2 pt-4 border-t\">\n                  <Button variant=\"outline\" onClick={() => setShowViewModal(false)}>\n                    Close\n                  </Button>\n                  <Button onClick={() => {\n                    setShowViewModal(false)\n                    handleEditStudent(viewStudent)\n                  }}>\n                    Edit Student\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        )}\n\n        {/* Report Card Modal */}\n        {showReportCardModal && viewStudent && studentGrades.length > 0 && (\n          <ReportCardModal\n            student={viewStudent}\n            grades={studentGrades}\n            classInfo={classInfo || undefined}\n            term=\"First Term\"\n            academicYear={new Date().getFullYear().toString()}\n            isOpen={showReportCardModal}\n            onClose={() => setShowReportCardModal(false)}\n          />\n        )}\n\n        {/* Confirm Dialog */}\n        <ConfirmDialog\n          open={confirmDialog.open}\n          onOpenChange={(open) => setConfirmDialog({ ...confirmDialog, open })}\n          title={confirmDialog.title}\n          description={confirmDialog.description}\n          onConfirm={confirmDialog.onConfirm}\n          variant=\"destructive\"\n        />\n      </div>\n    </DashboardLayout>\n  )\n}\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\admin\\teachers\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'studentService' is defined but never used.","line":13,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'attendanceService' is defined but never used.","line":14,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'gradeService' is defined but never used.","line":15,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FileText' is defined but never used.","line":17,"column":84,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":92},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":95,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3735,3738],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3735,3738],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useMemo } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { teacherService } from '@/services/teacherService'\nimport { classService } from '@/services/classService'\nimport { studentService } from '@/services/studentService'\nimport { attendanceService } from '@/services/attendanceService'\nimport { gradeService } from '@/services/gradeService'\nimport { EntityLink } from '@/components/shared/EntityLink'\nimport { Plus, Search, Edit, Trash2, Eye, X, BookOpen, Users, Calendar, BarChart3, FileText, Award } from 'lucide-react'\nimport { formatDate } from '@/lib/utils'\nimport { TeacherForm } from '@/components/teachers/TeacherForm'\nimport { Teacher, Class, Student } from '@/types'\nimport { toast } from '@/components/ui/toast'\nimport { ConfirmDialog } from '@/components/shared/ConfirmDialog'\n\nexport default function TeachersPage() {\n  const router = useRouter()\n  const [search, setSearch] = useState('')\n  const [showForm, setShowForm] = useState(false)\n  const [selectedTeacher, setSelectedTeacher] = useState<Teacher | null>(null)\n  const [showViewModal, setShowViewModal] = useState(false)\n  const [viewTeacher, setViewTeacher] = useState<Teacher | null>(null)\n  const [confirmDialog, setConfirmDialog] = useState<{\n    open: boolean\n    title: string\n    description: string\n    onConfirm: () => void\n  }>({\n    open: false,\n    title: '',\n    description: '',\n    onConfirm: () => {},\n  })\n  const queryClient = useQueryClient()\n\n  const { data: teachers = [], isLoading } = useQuery({\n    queryKey: ['teachers', search],\n    queryFn: () => teacherService.getTeachers({ search, limit: 1000 }),\n  })\n\n  // Fetch classes for selected teacher\n  const { data: teacherClasses = [] } = useQuery({\n    queryKey: ['classes', viewTeacher?.id],\n    queryFn: () => classService.getClasses({ teacher_id: viewTeacher!.id, limit: 1000 }),\n    enabled: !!viewTeacher?.id,\n  })\n\n  // Fetch all classes for students count\n  const { data: allClasses = [] } = useQuery({\n    queryKey: ['classes'],\n    queryFn: () => classService.getClasses({ limit: 1000 }),\n  })\n\n  // Fetch students in teacher's classes\n  const { data: teacherStudents = [] } = useQuery({\n    queryKey: ['teacher-students', viewTeacher?.id],\n    queryFn: async () => {\n      const classes = await classService.getClasses({ teacher_id: viewTeacher!.id, limit: 1000 })\n      const allStudents: Student[] = []\n      for (const cls of classes) {\n        const students = await classService.getClassStudents(cls.id)\n        allStudents.push(...students)\n      }\n      return allStudents\n    },\n    enabled: !!viewTeacher?.id && teacherClasses.length > 0,\n  })\n\n  // Get students count for teacher's classes\n  const teacherStats = useMemo(() => {\n    if (!viewTeacher) return null\n    \n    const assignedClasses = allClasses.filter((cls: Class) => cls.teacher_id === viewTeacher.id)\n    \n    return {\n      assignedClasses: assignedClasses.length,\n      classNames: assignedClasses.map((cls: Class) => `${cls.name} - ${cls.section}`).join(', ') || 'None',\n    }\n  }, [viewTeacher, allClasses])\n\n  const deleteMutation = useMutation({\n    mutationFn: (id: string) => teacherService.deleteTeacher(id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['teachers'] })\n      toast.success('Teacher deleted successfully')\n    },\n    onError: (error: any) => {\n      toast.error(error.response?.data?.detail || 'Failed to delete teacher')\n    }\n  })\n\n  const filteredTeachers = teachers.filter(teacher =>\n    teacher.employee_id.toLowerCase().includes(search.toLowerCase()) ||\n    teacher.user?.full_name?.toLowerCase().includes(search.toLowerCase()) ||\n    teacher.qualification.toLowerCase().includes(search.toLowerCase())\n  )\n\n  const handleAddTeacher = () => {\n    setSelectedTeacher(null)\n    setShowForm(true)\n  }\n\n  const handleEditTeacher = (teacher: Teacher) => {\n    setSelectedTeacher(teacher)\n    setShowForm(true)\n  }\n\n  const handleViewTeacher = (teacher: Teacher) => {\n    setViewTeacher(teacher)\n    setShowViewModal(true)\n  }\n\n  const handleDeleteTeacher = (teacher: Teacher) => {\n    setConfirmDialog({\n      open: true,\n      title: 'Delete Teacher',\n      description: `Are you sure you want to delete ${teacher.user?.full_name || teacher.employee_id}? This action cannot be undone.`,\n      onConfirm: () => {\n        deleteMutation.mutate(teacher.id)\n      },\n    })\n  }\n\n  const handleFormSuccess = () => {\n    queryClient.invalidateQueries({ queryKey: ['teachers'] })\n    setShowForm(false)\n    setSelectedTeacher(null)\n  }\n\n  const handleViewClasses = (teacher: Teacher) => {\n    router.push(`/admin/classes?teacher_id=${teacher.id}`)\n  }\n\n  const handleMarkAttendance = (teacher: Teacher) => {\n    router.push(`/admin/attendance?user_id=${teacher.user_id}&tab=teachers`)\n  }\n\n  return (\n    <DashboardLayout allowedRoles={['admin', 'principal']}>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-bold\">Teachers</h1>\n            <p className=\"text-gray-600\">Manage teacher records</p>\n          </div>\n          <Button onClick={handleAddTeacher}>\n            <Plus className=\"mr-2 h-4 w-4\" />\n            Add Teacher\n          </Button>\n        </div>\n\n        <Card>\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <CardTitle>All Teachers</CardTitle>\n              <div className=\"flex items-center gap-2\">\n                <div className=\"relative\">\n                  <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400\" />\n                  <Input\n                    placeholder=\"Search teachers...\"\n                    value={search}\n                    onChange={(e) => setSearch(e.target.value)}\n                    className=\"pl-10 w-64\"\n                  />\n                </div>\n              </div>\n            </div>\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <div className=\"text-center py-8 text-gray-500\">Loading...</div>\n            ) : filteredTeachers.length === 0 ? (\n              <div className=\"text-center py-8 text-gray-500\">\n                No teachers found\n              </div>\n            ) : (\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full\">\n                  <thead>\n                    <tr className=\"border-b\">\n                      <th className=\"text-left py-3 px-4\">Employee ID</th>\n                      <th className=\"text-left py-3 px-4\">Name</th>\n                      <th className=\"text-left py-3 px-4\">Join Date</th>\n                      <th className=\"text-left py-3 px-4\">Qualification</th>\n                      <th className=\"text-left py-3 px-4\">Subjects</th>\n                      <th className=\"text-left py-3 px-4\">Status</th>\n                      <th className=\"text-left py-3 px-4\">Actions</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {filteredTeachers.map((teacher) => (\n                      <tr key={teacher.id} className=\"border-b hover:bg-gray-50\">\n                        <td className=\"py-3 px-4 font-medium\">\n                          {teacher.employee_id}\n                        </td>\n                        <td className=\"py-3 px-4\">\n                          {teacher.user?.full_name || 'N/A'}\n                        </td>\n                        <td className=\"py-3 px-4\">\n                          {formatDate(teacher.join_date)}\n                        </td>\n                        <td className=\"py-3 px-4\">{teacher.qualification}</td>\n                        <td className=\"py-3 px-4\">\n                          <div className=\"flex flex-wrap gap-1\">\n                            {teacher.subjects.slice(0, 2).map((subject) => (\n                              <span\n                                key={subject}\n                                className=\"inline-flex rounded-full bg-blue-100 px-2 py-1 text-xs font-semibold text-blue-800\"\n                              >\n                                {subject}\n                              </span>\n                            ))}\n                            {teacher.subjects.length > 2 && (\n                              <span className=\"inline-flex rounded-full bg-gray-100 px-2 py-1 text-xs font-semibold text-gray-800\">\n                                +{teacher.subjects.length - 2}\n                              </span>\n                            )}\n                          </div>\n                        </td>\n                        <td className=\"py-3 px-4\">\n                          <span\n                            className={`inline-flex rounded-full px-2 py-1 text-xs font-semibold ${\n                              teacher.status === 'active'\n                                ? 'bg-green-100 text-green-800'\n                                : 'bg-gray-100 text-gray-800'\n                            }`}\n                          >\n                            {teacher.status}\n                          </span>\n                        </td>\n                        <td className=\"py-3 px-4\">\n                          <div className=\"flex items-center gap-1\">\n                            <Button \n                              size=\"sm\" \n                              variant=\"ghost\"\n                              onClick={() => handleViewTeacher(teacher)}\n                              title=\"View Details\"\n                              className=\"h-8 w-8 p-0\"\n                            >\n                              <Eye className=\"h-4 w-4\" />\n                            </Button>\n                            <Button \n                              size=\"sm\" \n                              variant=\"ghost\"\n                              onClick={() => handleViewClasses(teacher)}\n                              title=\"View Classes\"\n                              className=\"h-8 w-8 p-0\"\n                            >\n                              <BookOpen className=\"h-4 w-4\" />\n                            </Button>\n                            <Button \n                              size=\"sm\" \n                              variant=\"ghost\"\n                              onClick={() => handleMarkAttendance(teacher)}\n                              title=\"Mark Attendance\"\n                              className=\"h-8 w-8 p-0\"\n                            >\n                              <Calendar className=\"h-4 w-4\" />\n                            </Button>\n                            <Button \n                              size=\"sm\" \n                              variant=\"ghost\"\n                              onClick={() => handleEditTeacher(teacher)}\n                              title=\"Edit Teacher\"\n                              className=\"h-8 w-8 p-0\"\n                            >\n                              <Edit className=\"h-4 w-4\" />\n                            </Button>\n                            <Button \n                              size=\"sm\" \n                              variant=\"ghost\"\n                              onClick={() => handleDeleteTeacher(teacher)}\n                              title=\"Delete Teacher\"\n                              disabled={deleteMutation.isPending}\n                              className=\"h-8 w-8 p-0\"\n                            >\n                              <Trash2 className=\"h-4 w-4 text-red-600\" />\n                            </Button>\n                          </div>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Teacher Form Modal */}\n        {showForm && (\n          <TeacherForm\n            teacher={selectedTeacher || undefined}\n            onClose={() => setShowForm(false)}\n            onSuccess={handleFormSuccess}\n          />\n        )}\n\n        {/* Teacher View Modal */}\n        {showViewModal && viewTeacher && (\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n            <Card className=\"w-full max-w-3xl max-h-[90vh] overflow-y-auto\">\n              <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-4\">\n                <CardTitle>Teacher Details</CardTitle>\n                <Button variant=\"ghost\" size=\"sm\" onClick={() => setShowViewModal(false)}>\n                  <X className=\"h-4 w-4\" />\n                </Button>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                {/* Teacher Information */}\n                <div className=\"space-y-4\">\n                  <h3 className=\"text-lg font-semibold\">Teacher Information</h3>\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <div>\n                      <Label className=\"text-sm font-medium text-gray-600\">Employee ID</Label>\n                      <p className=\"text-sm\">{viewTeacher.employee_id}</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-gray-600\">Full Name</Label>\n                      <p className=\"text-sm\">{viewTeacher.user?.full_name || 'N/A'}</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-gray-600\">Email</Label>\n                      <p className=\"text-sm\">{viewTeacher.user?.email || 'N/A'}</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-gray-600\">Phone</Label>\n                      <p className=\"text-sm\">{viewTeacher.user?.phone || 'N/A'}</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-gray-600\">Join Date</Label>\n                      <p className=\"text-sm\">{formatDate(viewTeacher.join_date)}</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-gray-600\">Qualification</Label>\n                      <p className=\"text-sm\">{viewTeacher.qualification}</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-gray-600\">Status</Label>\n                      <span\n                        className={`inline-flex rounded-full px-2 py-1 text-xs font-semibold ${\n                          viewTeacher.status === 'active'\n                            ? 'bg-green-100 text-green-800'\n                            : 'bg-gray-100 text-gray-800'\n                        }`}\n                      >\n                        {viewTeacher.status}\n                      </span>\n                    </div>\n                    <div className=\"md:col-span-2\">\n                      <Label className=\"text-sm font-medium text-gray-600\">Address</Label>\n                      <p className=\"text-sm\">{viewTeacher.user?.address || 'N/A'}</p>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Subjects */}\n                <div className=\"space-y-4\">\n                  <h3 className=\"text-lg font-semibold\">Subjects</h3>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {viewTeacher.subjects.map((subject) => (\n                      <span\n                        key={subject}\n                        className=\"inline-flex rounded-full bg-blue-100 px-3 py-1 text-sm font-semibold text-blue-800\"\n                      >\n                        {subject}\n                      </span>\n                    ))}\n                  </div>\n                </div>\n\n                {/* Salary Information */}\n                <div className=\"space-y-4\">\n                  <h3 className=\"text-lg font-semibold\">Salary Information</h3>\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                    <div>\n                      <Label className=\"text-sm font-medium text-gray-600\">Basic Salary</Label>\n                      <p className=\"text-sm\">{viewTeacher.salary_info.currency} {viewTeacher.salary_info.basic_salary}</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-gray-600\">Allowances</Label>\n                      <p className=\"text-sm\">{viewTeacher.salary_info.currency} {viewTeacher.salary_info.allowances || 0}</p>\n                    </div>\n                    <div>\n                      <Label className=\"text-sm font-medium text-gray-600\">Total Salary</Label>\n                      <p className=\"text-sm font-semibold text-green-600\">\n                        {viewTeacher.salary_info.currency} {(viewTeacher.salary_info.basic_salary + (viewTeacher.salary_info.allowances || 0))}\n                      </p>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Assigned Classes & Stats */}\n                {teacherStats && (\n                  <div className=\"space-y-4\">\n                    <h3 className=\"text-lg font-semibold\">Assigned Classes</h3>\n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                      <Card>\n                        <CardContent className=\"p-4\">\n                          <div className=\"flex items-center justify-between\">\n                            <div>\n                              <p className=\"text-xs text-gray-600\">Total Classes</p>\n                              <p className=\"text-2xl font-bold text-blue-600\">{teacherStats.assignedClasses}</p>\n                            </div>\n                            <BookOpen className=\"h-8 w-8 text-blue-600 opacity-50\" />\n                          </div>\n                        </CardContent>\n                      </Card>\n                      <Card>\n                        <CardContent className=\"p-4\">\n                          <div className=\"flex items-center justify-between\">\n                            <div>\n                              <p className=\"text-xs text-gray-600\">Total Students</p>\n                              <p className=\"text-2xl font-bold text-green-600\">{teacherStudents.length}</p>\n                            </div>\n                            <Users className=\"h-8 w-8 text-green-600 opacity-50\" />\n                          </div>\n                        </CardContent>\n                      </Card>\n                      <Card>\n                        <CardContent className=\"p-4\">\n                          <div>\n                            <p className=\"text-xs text-gray-600 mb-2\">Class Names</p>\n                            <div className=\"flex flex-wrap gap-2\">\n                              {teacherClasses.length > 0 ? (\n                                teacherClasses.map((cls: Class) => (\n                                  <EntityLink\n                                    key={cls.id}\n                                    href={`/admin/classes?class_id=${cls.id}`}\n                                    variant=\"badge\"\n                                  >\n                                    {cls.name} - {cls.section}\n                                  </EntityLink>\n                                ))\n                              ) : (\n                                <p className=\"text-sm font-medium\">No classes assigned</p>\n                              )}\n                            </div>\n                          </div>\n                        </CardContent>\n                      </Card>\n                    </div>\n                  </div>\n                )}\n\n                {/* Quick Actions */}\n                <div className=\"space-y-4\">\n                  <h3 className=\"text-lg font-semibold\">Quick Actions</h3>\n                  <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\n                    <Button \n                      variant=\"outline\" \n                      onClick={() => {\n                        setShowViewModal(false)\n                        handleViewClasses(viewTeacher)\n                      }}\n                      className=\"flex items-center gap-2\"\n                    >\n                      <BookOpen className=\"h-4 w-4\" />\n                      View Classes\n                    </Button>\n                    <Button \n                      variant=\"outline\" \n                      onClick={() => {\n                        if (teacherClasses.length > 0) {\n                          const firstClass = teacherClasses[0]\n                          router.push(`/admin/classes?class_id=${firstClass.id}&view=students`)\n                        } else {\n                          router.push('/admin/classes')\n                        }\n                      }}\n                      className=\"flex items-center gap-2\"\n                      disabled={!teacherClasses.length}\n                    >\n                      <Users className=\"h-4 w-4\" />\n                      View Students ({teacherStudents.length})\n                    </Button>\n                    <Button \n                      variant=\"outline\" \n                      onClick={() => {\n                        if (teacherClasses.length > 0) {\n                          const firstClass = teacherClasses[0]\n                          router.push(`/admin/grades?class_id=${firstClass.id}`)\n                        }\n                      }}\n                      className=\"flex items-center gap-2\"\n                      disabled={!teacherClasses.length}\n                    >\n                      <Award className=\"h-4 w-4\" />\n                      View Grades\n                    </Button>\n                    <Button \n                      variant=\"outline\" \n                      onClick={() => {\n                        setShowViewModal(false)\n                        handleMarkAttendance(viewTeacher)\n                      }}\n                      className=\"flex items-center gap-2\"\n                    >\n                      <Calendar className=\"h-4 w-4\" />\n                      Mark Attendance\n                    </Button>\n                    <Button \n                      variant=\"outline\" \n                      onClick={() => {\n                        setShowViewModal(false)\n                        router.push(`/admin/reports?teacher_id=${viewTeacher.id}&type=academic`)\n                      }}\n                      className=\"flex items-center gap-2\"\n                    >\n                      <BarChart3 className=\"h-4 w-4\" />\n                      Performance\n                    </Button>\n                  </div>\n                </div>\n\n                {/* Actions */}\n                <div className=\"flex justify-end space-x-2 pt-4 border-t\">\n                  <Button variant=\"outline\" onClick={() => setShowViewModal(false)}>\n                    Close\n                  </Button>\n                  <Button onClick={() => {\n                    setShowViewModal(false)\n                    handleEditTeacher(viewTeacher)\n                  }}>\n                    Edit Teacher\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        )}\n\n        {/* Confirm Dialog */}\n        <ConfirmDialog\n          open={confirmDialog.open}\n          onOpenChange={(open) => setConfirmDialog({ ...confirmDialog, open })}\n          title={confirmDialog.title}\n          description={confirmDialog.description}\n          onConfirm={confirmDialog.onConfirm}\n          variant=\"destructive\"\n        />\n      </div>\n    </DashboardLayout>\n  )\n}\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\login\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'authLoading' is assigned a value but never used.","line":11,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":40},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":25,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[840,843],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[840,843],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState } from 'react'\nimport { useAuth } from '@/contexts/AuthContext'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\n\nexport default function LoginPage() {\n  const { login, isLoading: authLoading } = useAuth()\n  const [email, setEmail] = useState('')\n  const [password, setPassword] = useState('')\n  const [error, setError] = useState('')\n  const [loading, setLoading] = useState(false)\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setError('')\n    setLoading(true)\n\n    try {\n      await login(email, password)\n      // AuthContext handles the redirect automatically\n    } catch (err: any) {\n      console.error('Login error:', err)\n      \n      // User-friendly error messages\n      if (err.response) {\n        const status = err.response.status\n        const data = err.response.data\n        // Handle both old format (detail) and new format (message/error)\n        const detail = data?.detail || data?.message || (data?.error ? data.message : null)\n        \n        if (status === 401) {\n          setError(detail || 'Invalid email or password. Please check your credentials.')\n        } else if (status === 403) {\n          setError(detail || 'Your account has been disabled. Please contact administrator.')\n        } else if (status === 500) {\n          setError(detail || 'Server error. Please try again later.')\n        } else if (status === 422) {\n          setError(detail || 'Validation error. Please check your input.')\n        } else {\n          setError(detail || 'Login failed. Please try again.')\n        }\n      } else if (err.message?.includes('Network') || err.message?.includes('fetch') || err.code === 'ECONNREFUSED') {\n        setError('Cannot connect to server. Please ensure the backend is running at http://localhost:8000')\n      } else {\n        setError(err.message || 'An unexpected error occurred. Please try again.')\n      }\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"space-y-1\">\n          <CardTitle className=\"text-3xl font-bold text-center\">\n            School Management System\n          </CardTitle>\n          <CardDescription className=\"text-center\">\n            Enter your credentials to access your account\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"email\">Email</Label>\n              <Input\n                id=\"email\"\n                type=\"email\"\n                placeholder=\"Enter your email\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                required\n                disabled={loading}\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"password\">Password</Label>\n              <Input\n                id=\"password\"\n                type=\"password\"\n                placeholder=\"Enter your password\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                required\n                disabled={loading}\n              />\n            </div>\n            {error && (\n              <div className=\"text-sm text-red-600 bg-red-50 p-3 rounded-md\">\n                {error}\n              </div>\n            )}\n            <Button\n              type=\"submit\"\n              className=\"w-full\"\n              disabled={loading}\n            >\n              {loading ? 'Signing in...' : 'Sign In'}\n            </Button>\n          </form>\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\principal\\dashboard\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useState' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'toast' is defined but never used.","line":24,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'PrincipalProfile' is defined but never used.","line":26,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":27},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":155,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":155,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4401,4404],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4401,4404],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":156,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":156,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4484,4487],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4484,4487],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":160,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":160,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4639,4642],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4639,4642],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":165,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":165,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4892,4895],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4892,4895],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":169,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":169,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5107,5110],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5107,5110],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":170,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":170,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5206,5209],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5206,5209],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":182,"column":85,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":182,"endColumn":88,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5561,5564],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5561,5564],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":191,"column":74,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":191,"endColumn":77,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5875,5878],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5875,5878],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":1,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":276,"column":82,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[8574,8615],"text":"! Here&apos;s your school overview.\n          "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[8574,8615],"text":"! Here&lsquo;s your school overview.\n          "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[8574,8615],"text":"! Here&#39;s your school overview.\n          "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[8574,8615],"text":"! Here&rsquo;s your school overview.\n          "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState } from 'react'\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { useQuery } from '@tanstack/react-query'\nimport { teacherService } from '@/services/teacherService'\nimport { studentService } from '@/services/studentService'\nimport { classService } from '@/services/classService'\nimport { gradeService } from '@/services/gradeService'\nimport { attendanceService } from '@/services/attendanceService'\nimport { financeService } from '@/services/financeService'\nimport { announcementService } from '@/services/announcementService'\nimport { eventService } from '@/services/eventService'\nimport { useAuth } from '@/contexts/AuthContext'\nimport { \n  User, Users, GraduationCap, BookOpen, TrendingUp, \n  CheckCircle, AlertTriangle, Award, Calendar, Clock,\n  BarChart3, Target, Bell, DollarSign, Activity\n} from 'lucide-react'\nimport { formatDate } from '@/lib/utils'\nimport { toast } from '@/components/ui/toast'\n\ninterface PrincipalProfile {\n  id: string\n  name: string\n  employee_id: string\n  qualification: string\n  join_date: string\n  salary: number\n  status: string\n  phone: string\n  address: string\n}\n\ninterface SchoolStats {\n  totalStudents: number\n  totalTeachers: number\n  totalClasses: number\n  averageAttendance: number\n  passPercentage: number\n  totalRevenue: number\n  monthlyExpenses: number\n}\n\ninterface RecentAnnouncement {\n  id: string\n  title: string\n  content: string\n  priority: 'high' | 'medium' | 'low'\n  created_at: string\n  status: 'active' | 'inactive'\n}\n\ninterface UpcomingEvent {\n  id: string\n  title: string\n  date: string\n  time: string\n  location: string\n  type: string\n}\n\ninterface PerformanceMetric {\n  metric: string\n  value: number\n  target: number\n  trend: 'up' | 'down' | 'stable'\n  percentage: number\n}\n\ninterface PendingApproval {\n  id: string\n  type: string\n  title: string\n  submitted_by: string\n  submitted_at: string\n  status: 'pending' | 'approved' | 'rejected'\n}\n\nexport default function PrincipalDashboard() {\n  const { user } = useAuth()\n\n  // Fetch all data\n  const { data: students = [] } = useQuery({\n    queryKey: ['students'],\n    queryFn: () => studentService.getStudents({ limit: 1000 }),\n  })\n\n  const { data: teachers = [] } = useQuery({\n    queryKey: ['teachers'],\n    queryFn: () => teacherService.getTeachers({ limit: 1000 }),\n  })\n\n  const { data: classes = [] } = useQuery({\n    queryKey: ['classes'],\n    queryFn: () => classService.getClasses({ limit: 1000 }),\n  })\n\n  const { data: grades = [] } = useQuery({\n    queryKey: ['grades'],\n    queryFn: () => gradeService.getGrades({ limit: 1000 }),\n  })\n\n  const { data: attendanceRecords = [] } = useQuery({\n    queryKey: ['attendance'],\n    queryFn: () => attendanceService.getAttendance({ limit: 1000 }),\n  })\n\n  const { data: expenses = [] } = useQuery({\n    queryKey: ['expenses'],\n    queryFn: () => financeService.getExpenses({}),\n  })\n\n  const { data: donations = [] } = useQuery({\n    queryKey: ['donations'],\n    queryFn: () => financeService.getDonations({}),\n  })\n\n  const { data: announcementsData = [] } = useQuery({\n    queryKey: ['announcements'],\n    queryFn: () => announcementService.getAll({ is_active: true, limit: 5 }),\n  })\n\n  const { data: eventsData = [] } = useQuery({\n    queryKey: ['events'],\n    queryFn: () => eventService.getEvents({ limit: 5 }),\n  })\n\n  // Fetch principal profile (teacher with principal role)\n  const { data: principalProfile } = useQuery({\n    queryKey: ['principal-profile'],\n    queryFn: () => teacherService.getMyProfile(),\n    enabled: !!user && user.role === 'principal',\n  })\n\n  const isLoading = false // All queries handle their own loading\n\n  // Transform data\n  const profile = principalProfile ? {\n    id: principalProfile.id,\n    name: principalProfile.user?.full_name || 'N/A',\n    employee_id: principalProfile.employee_id,\n    qualification: principalProfile.qualification,\n    join_date: principalProfile.join_date,\n    salary: principalProfile.salary_info?.basic_salary || 0,\n    status: principalProfile.status,\n    phone: principalProfile.user?.phone || 'N/A',\n    address: principalProfile.user?.address || 'N/A'\n  } : null\n\n  // Calculate statistics\n  const activeStudents = students.filter((s: any) => s.status === 'active').length\n  const activeTeachers = teachers.filter((t: any) => t.status === 'active').length\n  const totalClassesCount = classes.length\n\n  // Attendance rate\n  const presentCount = attendanceRecords.filter((a: any) => a.status === 'present').length\n  const totalAttendance = attendanceRecords.length\n  const averageAttendance = totalAttendance > 0 ? Math.round((presentCount / totalAttendance) * 100) : 0\n\n  // Pass rate\n  const passingGrades = grades.filter((g: any) => Number(g.marks) >= 50).length\n  const passPercentage = grades.length > 0 ? Math.round((passingGrades / grades.length) * 100) : 0\n\n  // Financial data\n  const totalRevenue = donations.reduce((sum: number, d: any) => sum + Number(d.amount || 0), 0)\n  const monthlyExpenses = expenses.reduce((sum: number, e: any) => sum + Number(e.amount || 0), 0)\n\n  const schoolStats: SchoolStats = {\n    totalStudents: activeStudents,\n    totalTeachers: activeTeachers,\n    totalClasses: totalClassesCount,\n    averageAttendance,\n    passPercentage,\n    totalRevenue,\n    monthlyExpenses\n  }\n\n  const announcements: RecentAnnouncement[] = announcementsData.slice(0, 5).map((a: any) => ({\n    id: a.id,\n    title: a.title,\n    content: a.content || '',\n    priority: (a.priority || 'medium') as 'high' | 'medium' | 'low',\n    created_at: a.created_at,\n    status: (a.status || 'active') as 'active' | 'inactive'\n  }))\n\n  const upcomingEvents: UpcomingEvent[] = eventsData.slice(0, 5).map((e: any) => ({\n    id: e.id,\n    title: e.title,\n    date: e.event_date || e.date || '',\n    time: e.event_time || e.time || '',\n    location: e.location || '',\n    type: e.event_type || e.type || ''\n  }))\n\n  const performanceMetrics: PerformanceMetric[] = [\n    {\n      metric: 'Student Enrollment',\n      value: activeStudents,\n      target: 500,\n      trend: activeStudents >= 450 ? 'up' : 'down',\n      percentage: (activeStudents / 500) * 100\n    },\n    {\n      metric: 'Teacher Retention',\n      value: activeTeachers,\n      target: 50,\n      trend: activeTeachers >= 45 ? 'up' : 'down',\n      percentage: (activeTeachers / 50) * 100\n    },\n    {\n      metric: 'Pass Rate',\n      value: passPercentage,\n      target: 85,\n      trend: passPercentage >= 85 ? 'up' : 'down',\n      percentage: (passPercentage / 85) * 100\n    },\n    {\n      metric: 'Attendance Rate',\n      value: averageAttendance,\n      target: 90,\n      trend: averageAttendance >= 90 ? 'up' : 'down',\n      percentage: (averageAttendance / 90) * 100\n    }\n  ]\n\n  // Pending approvals - placeholder (would need approval API)\n  const pendingApprovals: PendingApproval[] = []\n\n  const getPriorityColor = (priority: string) => {\n    switch (priority) {\n      case 'high': return 'bg-red-100 text-red-800'\n      case 'medium': return 'bg-yellow-100 text-yellow-800'\n      case 'low': return 'bg-green-100 text-green-800'\n      default: return 'bg-gray-100 text-gray-800'\n    }\n  }\n\n  const getTrendIcon = (trend: string) => {\n    switch (trend) {\n      case 'up': return <TrendingUp className=\"h-4 w-4 text-green-600\" />\n      case 'down': return <TrendingUp className=\"h-4 w-4 text-red-600 rotate-180\" />\n      case 'stable': return <Activity className=\"h-4 w-4 text-blue-600\" />\n      default: return <Activity className=\"h-4 w-4 text-gray-600\" />\n    }\n  }\n\n  const getApprovalStatusColor = (status: string) => {\n    switch (status) {\n      case 'pending': return 'bg-yellow-100 text-yellow-800'\n      case 'approved': return 'bg-green-100 text-green-800'\n      case 'rejected': return 'bg-red-100 text-red-800'\n      default: return 'bg-gray-100 text-gray-800'\n    }\n  }\n\n  if (isLoading) {\n    return (\n      <div className=\"flex justify-center items-center min-h-[400px]\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\n      </div>\n    )\n  }\n\n  return (\n    <DashboardLayout allowedRoles={['principal']}>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div>\n          <h1 className=\"text-3xl font-bold text-gray-900\">Principal Dashboard</h1>\n          <p className=\"text-gray-600 mt-1\">\n            Welcome back, {profile?.name || user?.full_name || 'Principal'}! Here's your school overview.\n          </p>\n        </div>\n\n        {/* Profile Card */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <User className=\"h-5 w-5 text-blue-600\" />\n              Principal Profile\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              <div className=\"space-y-4\">\n                <div>\n                  <h3 className=\"text-xl font-semibold text-gray-900\">{profile?.name}</h3>\n                  <p className=\"text-gray-600\">Employee ID: {profile?.employee_id}</p>\n                  <p className=\"text-gray-600\">Qualification: {profile?.qualification}</p>\n                </div>\n                <div>\n                  <h4 className=\"font-medium text-gray-900 mb-2\">Contact Information</h4>\n                  <p className=\"text-gray-600\">{profile?.phone}</p>\n                  <p className=\"text-gray-600\">{profile?.address}</p>\n                </div>\n              </div>\n              <div className=\"space-y-4\">\n                <div>\n                  <h4 className=\"font-medium text-gray-900 mb-2\">Employment Details</h4>\n                  <p className=\"text-gray-600\">Join Date: {formatDate(profile?.join_date || '')}</p>\n                  <p className=\"text-gray-600\">Salary: ${profile?.salary?.toLocaleString()}</p>\n                  <Badge className=\"bg-green-100 text-green-800\">\n                    {profile?.status}\n                  </Badge>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* School Statistics */}\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-gray-600\">Total Students</p>\n                  <p className=\"text-3xl font-bold text-blue-600\">{schoolStats?.totalStudents}</p>\n                </div>\n                <Users className=\"h-12 w-12 text-blue-600\" />\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-gray-600\">Total Teachers</p>\n                  <p className=\"text-3xl font-bold text-green-600\">{schoolStats?.totalTeachers}</p>\n                </div>\n                <GraduationCap className=\"h-12 w-12 text-green-600\" />\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-gray-600\">Attendance Rate</p>\n                  <p className=\"text-3xl font-bold text-purple-600\">{schoolStats?.averageAttendance}%</p>\n                </div>\n                <CheckCircle className=\"h-12 w-12 text-purple-600\" />\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-gray-600\">Pass Rate</p>\n                  <p className=\"text-3xl font-bold text-orange-600\">{schoolStats?.passPercentage}%</p>\n                </div>\n                <Award className=\"h-12 w-12 text-orange-600\" />\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Performance Metrics */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <BarChart3 className=\"h-5 w-5 text-blue-600\" />\n              Performance Metrics\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              {performanceMetrics.map((metric, index) => (\n                <div key={index} className=\"p-4 border rounded-lg\">\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <h4 className=\"font-medium text-gray-900\">{metric.metric}</h4>\n                    {getTrendIcon(metric.trend)}\n                  </div>\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <span className=\"text-2xl font-bold text-blue-600\">{metric.value}</span>\n                    <span className=\"text-sm text-gray-600\">Target: {metric.target}</span>\n                  </div>\n                  <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                    <div \n                      className=\"bg-blue-600 h-2 rounded-full\" \n                      style={{ width: `${Math.min(metric.percentage, 100)}%` }}\n                    ></div>\n                  </div>\n                  <p className=\"text-sm text-gray-600 mt-1\">{metric.percentage.toFixed(1)}% of target</p>\n                </div>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n          {/* Recent Announcements */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Bell className=\"h-5 w-5 text-yellow-600\" />\n                Recent Announcements\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-4\">\n                {announcements.length > 0 ? (\n                  announcements.map((announcement) => (\n                    <div key={announcement.id} className=\"p-4 border rounded-lg\">\n                      <div className=\"flex items-start justify-between mb-2\">\n                        <h4 className=\"font-medium text-gray-900\">{announcement.title}</h4>\n                        <Badge className={getPriorityColor(announcement.priority)}>\n                          {announcement.priority}\n                        </Badge>\n                      </div>\n                      <p className=\"text-sm text-gray-600 mb-2\">{announcement.content}</p>\n                      <p className=\"text-xs text-gray-500\">{formatDate(announcement.created_at)}</p>\n                    </div>\n                  ))\n                ) : (\n                  <p className=\"text-center text-gray-500 py-4\">No announcements available</p>\n                )}\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Upcoming Events */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Calendar className=\"h-5 w-5 text-green-600\" />\n                Upcoming Events\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-4\">\n                {upcomingEvents.length > 0 ? (\n                  upcomingEvents.map((event) => (\n                    <div key={event.id} className=\"p-4 border rounded-lg\">\n                      <h4 className=\"font-medium text-gray-900 mb-2\">{event.title}</h4>\n                      <div className=\"grid grid-cols-2 gap-2 text-sm text-gray-600\">\n                        <div className=\"flex items-center gap-1\">\n                          <Calendar className=\"h-4 w-4\" />\n                          {formatDate(event.date)}\n                        </div>\n                        <div className=\"flex items-center gap-1\">\n                          <Clock className=\"h-4 w-4\" />\n                          {event.time}\n                        </div>\n                        <div className=\"flex items-center gap-1\">\n                          <Target className=\"h-4 w-4\" />\n                          {event.location}\n                        </div>\n                        <div className=\"flex items-center gap-1\">\n                          <BookOpen className=\"h-4 w-4\" />\n                          {event.type}\n                        </div>\n                      </div>\n                    </div>\n                  ))\n                ) : (\n                  <p className=\"text-center text-gray-500 py-4\">No upcoming events</p>\n                )}\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Pending Approvals */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <AlertTriangle className=\"h-5 w-5 text-orange-600\" />\n              Pending Approvals\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-4\">\n              {pendingApprovals.length > 0 ? (\n                pendingApprovals.map((approval) => (\n                  <div key={approval.id} className=\"flex items-center justify-between p-4 border rounded-lg\">\n                    <div className=\"flex-1\">\n                      <h4 className=\"font-medium text-gray-900\">{approval.title}</h4>\n                      <p className=\"text-sm text-gray-500\">\n                        Submitted by: {approval.submitted_by} • {formatDate(approval.submitted_at)}\n                      </p>\n                    </div>\n                    <div className=\"flex items-center gap-3\">\n                      <Badge className={getApprovalStatusColor(approval.status)}>\n                        {approval.status}\n                      </Badge>\n                      <div className=\"flex gap-2\">\n                        <Button size=\"sm\" variant=\"outline\" className=\"text-green-600\">\n                          Approve\n                        </Button>\n                        <Button size=\"sm\" variant=\"outline\" className=\"text-red-600\">\n                          Reject\n                        </Button>\n                      </div>\n                    </div>\n                  </div>\n                ))\n              ) : (\n                <p className=\"text-center text-gray-500 py-4\">No pending approvals</p>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Financial Overview */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <DollarSign className=\"h-5 w-5 text-green-600\" />\n              Financial Overview\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n              <div className=\"text-center p-4 border rounded-lg\">\n                <h4 className=\"font-medium text-gray-900 mb-2\">Total Revenue</h4>\n                <p className=\"text-3xl font-bold text-green-600\">\n                  ${schoolStats?.totalRevenue?.toLocaleString()}\n                </p>\n              </div>\n              <div className=\"text-center p-4 border rounded-lg\">\n                <h4 className=\"font-medium text-gray-900 mb-2\">Monthly Expenses</h4>\n                <p className=\"text-3xl font-bold text-red-600\">\n                  ${schoolStats?.monthlyExpenses?.toLocaleString()}\n                </p>\n              </div>\n              <div className=\"text-center p-4 border rounded-lg\">\n                <h4 className=\"font-medium text-gray-900 mb-2\">Net Profit</h4>\n                <p className=\"text-3xl font-bold text-blue-600\">\n                  ${((schoolStats?.totalRevenue || 0) - (schoolStats?.monthlyExpenses || 0)).toLocaleString()}\n                </p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </DashboardLayout>\n  )\n}","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\principal\\finance\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\principal\\reports\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useState' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardHeader' is defined but never used.","line":6,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":39},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CardTitle' is defined but never used.","line":6,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":50},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendingUp' is defined but never used.","line":8,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":41}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { useRouter } from 'next/navigation'\r\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Button } from '@/components/ui/button'\r\nimport { BarChart3, FileText, TrendingUp, Users, Calendar, DollarSign } from 'lucide-react'\r\n\r\nexport default function PrincipalReportsPage() {\r\n  const router = useRouter()\r\n\r\n  return (\r\n    <DashboardLayout allowedRoles={['principal']}>\r\n      <div className=\"space-y-6\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold\">Reports</h1>\r\n          <p className=\"text-gray-600 mt-1\">Comprehensive reports dashboard</p>\r\n        </div>\r\n\r\n        <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\r\n          <Card className=\"hover:shadow-lg transition-shadow cursor-pointer\"\r\n            onClick={() => router.push('/admin/reports?type=academic')}\r\n          >\r\n            <CardContent className=\"p-6\">\r\n              <div className=\"flex items-center gap-4\">\r\n                <div className=\"p-3 bg-blue-100 rounded-lg\">\r\n                  <FileText className=\"h-8 w-8 text-blue-600\" />\r\n                </div>\r\n                <div>\r\n                  <h3 className=\"font-semibold text-lg\">Academic Reports</h3>\r\n                  <p className=\"text-sm text-gray-600\">Performance & grades</p>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card className=\"hover:shadow-lg transition-shadow cursor-pointer\"\r\n            onClick={() => router.push('/admin/reports?type=attendance')}\r\n          >\r\n            <CardContent className=\"p-6\">\r\n              <div className=\"flex items-center gap-4\">\r\n                <div className=\"p-3 bg-green-100 rounded-lg\">\r\n                  <Calendar className=\"h-8 w-8 text-green-600\" />\r\n                </div>\r\n                <div>\r\n                  <h3 className=\"font-semibold text-lg\">Attendance Reports</h3>\r\n                  <p className=\"text-sm text-gray-600\">Student & teacher attendance</p>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card className=\"hover:shadow-lg transition-shadow cursor-pointer\"\r\n            onClick={() => router.push('/admin/reports?type=financial')}\r\n          >\r\n            <CardContent className=\"p-6\">\r\n              <div className=\"flex items-center gap-4\">\r\n                <div className=\"p-3 bg-yellow-100 rounded-lg\">\r\n                  <DollarSign className=\"h-8 w-8 text-yellow-600\" />\r\n                </div>\r\n                <div>\r\n                  <h3 className=\"font-semibold text-lg\">Financial Reports</h3>\r\n                  <p className=\"text-sm text-gray-600\">Revenue & expenses</p>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card className=\"hover:shadow-lg transition-shadow cursor-pointer\"\r\n            onClick={() => router.push('/admin/reports?type=students')}\r\n          >\r\n            <CardContent className=\"p-6\">\r\n              <div className=\"flex items-center gap-4\">\r\n                <div className=\"p-3 bg-purple-100 rounded-lg\">\r\n                  <Users className=\"h-8 w-8 text-purple-600\" />\r\n                </div>\r\n                <div>\r\n                  <h3 className=\"font-semibold text-lg\">Student Reports</h3>\r\n                  <p className=\"text-sm text-gray-600\">Student analytics</p>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card className=\"hover:shadow-lg transition-shadow cursor-pointer\"\r\n            onClick={() => router.push('/admin/reports')}\r\n          >\r\n            <CardContent className=\"p-6\">\r\n              <div className=\"flex items-center gap-4\">\r\n                <div className=\"p-3 bg-orange-100 rounded-lg\">\r\n                  <BarChart3 className=\"h-8 w-8 text-orange-600\" />\r\n                </div>\r\n                <div>\r\n                  <h3 className=\"font-semibold text-lg\">All Reports</h3>\r\n                  <p className=\"text-sm text-gray-600\">View all available reports</p>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n      </div>\r\n    </DashboardLayout>\r\n  )\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\principal\\students\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Users' is defined but never used.","line":10,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState } from 'react'\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { useQuery } from '@tanstack/react-query'\nimport { studentService } from '@/services/studentService'\nimport { Search, Users, Eye, X } from 'lucide-react'\nimport { formatDate } from '@/lib/utils'\nimport { Student } from '@/types'\n\nexport default function PrincipalStudentsPage() {\n  const [search, setSearch] = useState('')\n  const [selectedStudent, setSelectedStudent] = useState<Student | null>(null)\n\n  const { data: students = [], isLoading } = useQuery({\n    queryKey: ['students', search],\n    queryFn: () => studentService.getStudents({ search, limit: 1000 }),\n  })\n\n  const filteredStudents = students.filter(student =>\n    student.admission_number.toLowerCase().includes(search.toLowerCase()) ||\n    student.user?.full_name?.toLowerCase().includes(search.toLowerCase())\n  )\n\n  return (\n    <DashboardLayout allowedRoles={['principal']}>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-bold\">Students</h1>\n            <p className=\"text-gray-600\">View student information and analytics</p>\n          </div>\n        </div>\n\n        <Card>\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <CardTitle>All Students</CardTitle>\n              <div className=\"relative\">\n                <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400\" />\n                <Input\n                  placeholder=\"Search students...\"\n                  value={search}\n                  onChange={(e) => setSearch(e.target.value)}\n                  className=\"pl-10 w-64\"\n                />\n              </div>\n            </div>\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <div className=\"text-center py-8 text-gray-500\">Loading...</div>\n            ) : filteredStudents.length === 0 ? (\n              <div className=\"text-center py-8 text-gray-500\">No students found</div>\n            ) : (\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full\">\n                  <thead>\n                    <tr className=\"border-b\">\n                      <th className=\"text-left py-3 px-4\">Admission No.</th>\n                      <th className=\"text-left py-3 px-4\">Name</th>\n                      <th className=\"text-left py-3 px-4\">Class</th>\n                      <th className=\"text-left py-3 px-4\">Guardian</th>\n                      <th className=\"text-left py-3 px-4\">Status</th>\n                      <th className=\"text-left py-3 px-4\">Actions</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {filteredStudents.map((student: Student) => (\n                      <tr key={student.id} className=\"border-b hover:bg-gray-50\">\n                        <td className=\"py-3 px-4\">{student.admission_number}</td>\n                        <td className=\"py-3 px-4 font-medium\">{student.user?.full_name || 'Unknown'}</td>\n                        <td className=\"py-3 px-4\">{student.class_id ? 'Assigned' : 'Not assigned'}</td>\n                        <td className=\"py-3 px-4\">{student.guardian_info?.name || 'N/A'}</td>\n                        <td className=\"py-3 px-4\">\n                          <span className={`px-2 py-1 rounded-full text-xs ${\n                            student.status === 'active' \n                              ? 'bg-green-100 text-green-800' \n                              : 'bg-gray-100 text-gray-800'\n                          }`}>\n                            {student.status}\n                          </span>\n                        </td>\n                        <td className=\"py-3 px-4\">\n                          <Button\n                            size=\"sm\"\n                            variant=\"ghost\"\n                            onClick={() => setSelectedStudent(student)}\n                          >\n                            <Eye className=\"h-4 w-4\" />\n                          </Button>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {selectedStudent && (\n          <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4\">\n            <Card className=\"w-full max-w-2xl max-h-[90vh] overflow-y-auto\">\n              <CardHeader className=\"flex justify-between items-center\">\n                <CardTitle>Student Details</CardTitle>\n                <Button variant=\"ghost\" size=\"sm\" onClick={() => setSelectedStudent(null)}>\n                  <X className=\"h-4 w-4\" />\n                </Button>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <p className=\"text-sm text-gray-600\">Admission Number</p>\n                    <p className=\"font-semibold\">{selectedStudent.admission_number}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-600\">Name</p>\n                    <p className=\"font-semibold\">{selectedStudent.user?.full_name}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-600\">Email</p>\n                    <p className=\"font-semibold\">{selectedStudent.user?.email}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-600\">Admission Date</p>\n                    <p className=\"font-semibold\">{formatDate(selectedStudent.admission_date)}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-600\">Guardian</p>\n                    <p className=\"font-semibold\">{selectedStudent.guardian_info?.name}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-600\">Guardian Phone</p>\n                    <p className=\"font-semibold\">{selectedStudent.guardian_info?.phone}</p>\n                  </div>\n                </div>\n                <div className=\"pt-4 border-t\">\n                  <Button variant=\"outline\" className=\"w-full\" onClick={() => setSelectedStudent(null)}>\n                    Close\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        )}\n      </div>\n    </DashboardLayout>\n  )\n}\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\principal\\teachers\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Users' is defined but never used.","line":10,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":23}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState } from 'react'\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { useQuery } from '@tanstack/react-query'\nimport { teacherService } from '@/services/teacherService'\nimport { Search, Users, GraduationCap, Eye, X } from 'lucide-react'\nimport { formatDate } from '@/lib/utils'\nimport { Teacher } from '@/types'\n\nexport default function PrincipalTeachersPage() {\n  const [search, setSearch] = useState('')\n  const [selectedTeacher, setSelectedTeacher] = useState<Teacher | null>(null)\n\n  const { data: teachers = [], isLoading } = useQuery({\n    queryKey: ['teachers', search],\n    queryFn: () => teacherService.getTeachers({ search, limit: 1000 }),\n  })\n\n  const filteredTeachers = teachers.filter(teacher =>\n    teacher.employee_id.toLowerCase().includes(search.toLowerCase()) ||\n    teacher.user?.full_name?.toLowerCase().includes(search.toLowerCase())\n  )\n\n  return (\n    <DashboardLayout allowedRoles={['principal']}>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-bold\">Teachers</h1>\n            <p className=\"text-gray-600\">View teacher information and performance</p>\n          </div>\n        </div>\n\n        <Card>\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <CardTitle>All Teachers</CardTitle>\n              <div className=\"relative\">\n                <Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400\" />\n                <Input\n                  placeholder=\"Search teachers...\"\n                  value={search}\n                  onChange={(e) => setSearch(e.target.value)}\n                  className=\"pl-10 w-64\"\n                />\n              </div>\n            </div>\n          </CardHeader>\n          <CardContent>\n            {isLoading ? (\n              <div className=\"text-center py-8 text-gray-500\">Loading...</div>\n            ) : filteredTeachers.length === 0 ? (\n              <div className=\"text-center py-8 text-gray-500\">No teachers found</div>\n            ) : (\n              <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\n                {filteredTeachers.map((teacher: Teacher) => (\n                  <Card key={teacher.id}>\n                    <CardContent className=\"p-6\">\n                      <div className=\"flex items-start justify-between mb-4\">\n                        <div className=\"flex items-center gap-3\">\n                          <div className=\"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center\">\n                            <GraduationCap className=\"h-6 w-6 text-green-600\" />\n                          </div>\n                          <div>\n                            <h4 className=\"font-semibold\">{teacher.user?.full_name || 'Unknown'}</h4>\n                            <p className=\"text-sm text-gray-600\">{teacher.employee_id}</p>\n                          </div>\n                        </div>\n                        <Button\n                          size=\"sm\"\n                          variant=\"ghost\"\n                          onClick={() => setSelectedTeacher(teacher)}\n                        >\n                          <Eye className=\"h-4 w-4\" />\n                        </Button>\n                      </div>\n                      <div className=\"space-y-2 text-sm\">\n                        <div className=\"flex justify-between\">\n                          <span className=\"text-gray-600\">Qualification:</span>\n                          <span className=\"font-medium\">{teacher.qualification}</span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                          <span className=\"text-gray-600\">Status:</span>\n                          <span className={`px-2 py-1 rounded-full text-xs ${\n                            teacher.status === 'active' \n                              ? 'bg-green-100 text-green-800' \n                              : 'bg-gray-100 text-gray-800'\n                          }`}>\n                            {teacher.status}\n                          </span>\n                        </div>\n                        <div className=\"pt-2 border-t\">\n                          <p className=\"text-xs text-gray-600 mb-1\">Subjects:</p>\n                          <div className=\"flex flex-wrap gap-1\">\n                            {teacher.subjects.slice(0, 3).map((subject) => (\n                              <span key={subject} className=\"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded\">\n                                {subject}\n                              </span>\n                            ))}\n                            {teacher.subjects.length > 3 && (\n                              <span className=\"text-xs text-gray-500\">+{teacher.subjects.length - 3} more</span>\n                            )}\n                          </div>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Teacher Detail Modal */}\n        {selectedTeacher && (\n          <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4\">\n            <Card className=\"w-full max-w-2xl max-h-[90vh] overflow-y-auto\">\n              <CardHeader className=\"flex justify-between items-center\">\n                <CardTitle>Teacher Details</CardTitle>\n                <Button variant=\"ghost\" size=\"sm\" onClick={() => setSelectedTeacher(null)}>\n                  <X className=\"h-4 w-4\" />\n                </Button>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <div>\n                    <p className=\"text-sm text-gray-600\">Employee ID</p>\n                    <p className=\"font-semibold\">{selectedTeacher.employee_id}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-600\">Name</p>\n                    <p className=\"font-semibold\">{selectedTeacher.user?.full_name}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-600\">Email</p>\n                    <p className=\"font-semibold\">{selectedTeacher.user?.email}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-600\">Join Date</p>\n                    <p className=\"font-semibold\">{formatDate(selectedTeacher.join_date)}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-600\">Qualification</p>\n                    <p className=\"font-semibold\">{selectedTeacher.qualification}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-600\">Status</p>\n                    <span className={`px-2 py-1 rounded-full text-xs ${\n                      selectedTeacher.status === 'active' \n                        ? 'bg-green-100 text-green-800' \n                        : 'bg-gray-100 text-gray-800'\n                    }`}>\n                      {selectedTeacher.status}\n                    </span>\n                  </div>\n                </div>\n                <div>\n                  <p className=\"text-sm text-gray-600 mb-2\">Subjects</p>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {selectedTeacher.subjects.map((subject) => (\n                      <span key={subject} className=\"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm\">\n                        {subject}\n                      </span>\n                    ))}\n                  </div>\n                </div>\n                <div className=\"pt-4 border-t\">\n                  <Button variant=\"outline\" className=\"w-full\" onClick={() => setSelectedTeacher(null)}>\n                    Close\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        )}\n      </div>\n    </DashboardLayout>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\student\\attendance\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendingUp' is defined but never used.","line":14,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendingDown' is defined but never used.","line":14,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BarChart3' is defined but never used.","line":14,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":46}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useMemo } from 'react'\r\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Label } from '@/components/ui/label'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { useQuery } from '@tanstack/react-query'\r\nimport { studentService } from '@/services/studentService'\r\nimport { \r\n  Calendar, CheckCircle, XCircle, AlertCircle, Clock,\r\n  TrendingUp, TrendingDown, Target, BarChart3\r\n} from 'lucide-react'\r\nimport { Attendance } from '@/types'\r\nimport { formatDate } from '@/lib/utils'\r\n\r\nexport default function StudentAttendancePage() {\r\n  const today = new Date()\r\n  const firstDayOfMonth = new Date(today.getFullYear(), today.getMonth(), 1)\r\n  const [dateFrom, setDateFrom] = useState(firstDayOfMonth.toISOString().split('T')[0])\r\n  const [dateTo, setDateTo] = useState(today.toISOString().split('T')[0])\r\n\r\n  // Fetch student attendance\r\n  const { data: attendanceRecords = [] } = useQuery({\r\n    queryKey: ['my-attendance', dateFrom, dateTo],\r\n    queryFn: () => studentService.getMyAttendance({\r\n      date_from: dateFrom,\r\n      date_to: dateTo,\r\n    }),\r\n  })\r\n\r\n  // Calculate statistics\r\n  const stats = useMemo(() => {\r\n    const totalDays = attendanceRecords.length\r\n    const presentDays = attendanceRecords.filter((a: Attendance) => a.status === 'present').length\r\n    const absentDays = attendanceRecords.filter((a: Attendance) => a.status === 'absent').length\r\n    const lateDays = attendanceRecords.filter((a: Attendance) => a.status === 'late').length\r\n    const excusedDays = attendanceRecords.filter((a: Attendance) => a.status === 'excused').length\r\n    const attendanceRate = totalDays > 0 ? Math.round((presentDays / totalDays) * 100) : 0\r\n\r\n    return {\r\n      totalDays,\r\n      presentDays,\r\n      absentDays,\r\n      lateDays,\r\n      excusedDays,\r\n      attendanceRate,\r\n    }\r\n  }, [attendanceRecords])\r\n\r\n  const getStatusIcon = (status: string) => {\r\n    switch (status) {\r\n      case 'present':\r\n        return <CheckCircle className=\"h-5 w-5 text-green-600\" />\r\n      case 'absent':\r\n        return <XCircle className=\"h-5 w-5 text-red-600\" />\r\n      case 'late':\r\n        return <AlertCircle className=\"h-5 w-5 text-yellow-600\" />\r\n      case 'excused':\r\n        return <Clock className=\"h-5 w-5 text-blue-600\" />\r\n      default:\r\n        return <Clock className=\"h-5 w-5 text-gray-600\" />\r\n    }\r\n  }\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'present':\r\n        return 'bg-green-100 text-green-800'\r\n      case 'absent':\r\n        return 'bg-red-100 text-red-800'\r\n      case 'late':\r\n        return 'bg-yellow-100 text-yellow-800'\r\n      case 'excused':\r\n        return 'bg-blue-100 text-blue-800'\r\n      default:\r\n        return 'bg-gray-100 text-gray-800'\r\n    }\r\n  }\r\n\r\n  return (\r\n    <DashboardLayout allowedRoles={['student']}>\r\n      <div className=\"space-y-6\">\r\n        {/* Header */}\r\n        <div className=\"flex justify-between items-center\">\r\n          <div>\r\n            <h1 className=\"text-3xl font-bold text-gray-900\">My Attendance</h1>\r\n            <p className=\"text-gray-600 mt-1\">View your attendance history and statistics</p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Quick Stats */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\r\n          <Card>\r\n            <CardContent className=\"p-6\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <p className=\"text-sm font-medium text-gray-600\">Attendance Rate</p>\r\n                  <p className=\"text-3xl font-bold text-blue-600\">{stats.attendanceRate}%</p>\r\n                </div>\r\n                <div className=\"p-3 bg-blue-100 rounded-full\">\r\n                  <Target className=\"h-6 w-6 text-blue-600\" />\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card>\r\n            <CardContent className=\"p-6\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <p className=\"text-sm font-medium text-gray-600\">Present Days</p>\r\n                  <p className=\"text-3xl font-bold text-green-600\">{stats.presentDays}</p>\r\n                </div>\r\n                <div className=\"p-3 bg-green-100 rounded-full\">\r\n                  <CheckCircle className=\"h-6 w-6 text-green-600\" />\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card>\r\n            <CardContent className=\"p-6\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <p className=\"text-sm font-medium text-gray-600\">Absent Days</p>\r\n                  <p className=\"text-3xl font-bold text-red-600\">{stats.absentDays}</p>\r\n                </div>\r\n                <div className=\"p-3 bg-red-100 rounded-full\">\r\n                  <XCircle className=\"h-6 w-6 text-red-600\" />\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card>\r\n            <CardContent className=\"p-6\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <p className=\"text-sm font-medium text-gray-600\">Total Days</p>\r\n                  <p className=\"text-3xl font-bold text-gray-600\">{stats.totalDays}</p>\r\n                </div>\r\n                <div className=\"p-3 bg-gray-100 rounded-full\">\r\n                  <Calendar className=\"h-6 w-6 text-gray-600\" />\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n\r\n        {/* Filters */}\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"grid gap-4 md:grid-cols-3\">\r\n              <div>\r\n                <Label htmlFor=\"date-from\">From Date</Label>\r\n                <Input\r\n                  type=\"date\"\r\n                  id=\"date-from\"\r\n                  value={dateFrom}\r\n                  onChange={(e) => setDateFrom(e.target.value)}\r\n                />\r\n              </div>\r\n              <div>\r\n                <Label htmlFor=\"date-to\">To Date</Label>\r\n                <Input\r\n                  type=\"date\"\r\n                  id=\"date-to\"\r\n                  value={dateTo}\r\n                  onChange={(e) => setDateTo(e.target.value)}\r\n                />\r\n              </div>\r\n              <div className=\"flex items-end\">\r\n                <Button \r\n                  variant=\"outline\" \r\n                  className=\"w-full\"\r\n                  onClick={() => {\r\n                    const today = new Date()\r\n                    const firstDay = new Date(today.getFullYear(), today.getMonth(), 1)\r\n                    setDateFrom(firstDay.toISOString().split('T')[0])\r\n                    setDateTo(today.toISOString().split('T')[0])\r\n                  }}\r\n                >\r\n                  This Month\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Attendance Records */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Attendance History</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            {attendanceRecords.length === 0 ? (\r\n              <div className=\"text-center py-12 text-gray-500\">\r\n                <Calendar className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\r\n                <p className=\"text-lg font-medium mb-2\">No attendance records</p>\r\n                <p>Attendance records will appear here once marked by your teachers</p>\r\n              </div>\r\n            ) : (\r\n              <div className=\"overflow-x-auto\">\r\n                <table className=\"w-full\">\r\n                  <thead>\r\n                    <tr className=\"border-b\">\r\n                      <th className=\"text-left py-3 px-4 font-medium text-gray-900\">Date</th>\r\n                      <th className=\"text-center py-3 px-4 font-medium text-gray-900\">Status</th>\r\n                      <th className=\"text-left py-3 px-4 font-medium text-gray-900\">Remarks</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {attendanceRecords.map((record: Attendance) => (\r\n                      <tr key={record.id} className=\"border-b hover:bg-gray-50\">\r\n                        <td className=\"py-3 px-4\">\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <Calendar className=\"h-4 w-4 text-gray-400\" />\r\n                            <span>{formatDate(record.date)}</span>\r\n                          </div>\r\n                        </td>\r\n                        <td className=\"py-3 px-4 text-center\">\r\n                          <div className=\"flex items-center justify-center gap-2\">\r\n                            {getStatusIcon(record.status)}\r\n                            <Badge className={getStatusColor(record.status)}>\r\n                              {record.status}\r\n                            </Badge>\r\n                          </div>\r\n                        </td>\r\n                        <td className=\"py-3 px-4 text-sm text-gray-600\">\r\n                          {record.remarks || '-'}\r\n                        </td>\r\n                      </tr>\r\n                    ))}\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    </DashboardLayout>\r\n  )\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\student\\dashboard\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useState' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":15,"column":36,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":41},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'toast' is defined but never used.","line":19,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'StudentProfile' is defined but never used.","line":21,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":25},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":107,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3207,3210],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3207,3210],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":117,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":117,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3595,3598],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3595,3598],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":133,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":133,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4071,4074],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4071,4074],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":1,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":198,"column":48,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[6567,6610],"text":"! Here&apos;s your academic overview.\n          "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[6567,6610],"text":"! Here&lsquo;s your academic overview.\n          "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[6567,6610],"text":"! Here&#39;s your academic overview.\n          "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[6567,6610],"text":"! Here&rsquo;s your academic overview.\n          "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState } from 'react'\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { useQuery } from '@tanstack/react-query'\nimport { studentService } from '@/services/studentService'\nimport { gradeService } from '@/services/gradeService'\nimport { attendanceService } from '@/services/attendanceService'\nimport { announcementService } from '@/services/announcementService'\nimport { useAuth } from '@/contexts/AuthContext'\nimport { \n  User, BookOpen, Award, Calendar, Clock, TrendingUp,\n  CheckCircle, AlertTriangle, Star, Target, Bell\n} from 'lucide-react'\nimport { formatDate } from '@/lib/utils'\nimport { toast } from '@/components/ui/toast'\n\ninterface StudentProfile {\n  id: string\n  name: string\n  roll: string\n  class: string\n  admission_date: string\n  guardian_name: string\n  guardian_phone: string\n  address: string\n  status: string\n}\n\ninterface StudentGrade {\n  subject: string\n  term: number\n  marks: number\n  max_marks: number\n  grade: string\n  status: string\n  exam_date: string\n}\n\ninterface AttendanceRecord {\n  date: string\n  status: 'present' | 'absent' | 'late'\n  subject: string\n  teacher: string\n}\n\ninterface RecentActivity {\n  id: string\n  type: string\n  title: string\n  description: string\n  date: string\n  status: string\n}\n\nexport default function StudentDashboard() {\n  const { user } = useAuth()\n\n  // Fetch student profile\n  const { data: studentProfile, isLoading: profileLoading } = useQuery({\n    queryKey: ['student-profile'],\n    queryFn: () => studentService.getMyProfile(),\n    enabled: !!user,\n  })\n\n  // Fetch grades\n  const { data: gradesData = [], isLoading: gradesLoading } = useQuery({\n    queryKey: ['student-grades'],\n    queryFn: () => gradeService.getGrades({ student_id: studentProfile?.id }),\n    enabled: !!studentProfile?.id,\n  })\n\n  // Fetch recent attendance\n  const { data: attendanceData = [], isLoading: attendanceLoading } = useQuery({\n    queryKey: ['student-attendance'],\n    queryFn: () => attendanceService.getAttendance({ \n      user_id: studentProfile?.user_id,\n      limit: 10 \n    }),\n    enabled: !!studentProfile?.user_id,\n  })\n\n  // Fetch recent announcements\n  const { data: announcements = [], isLoading: announcementsLoading } = useQuery({\n    queryKey: ['announcements-recent'],\n    queryFn: () => announcementService.getAll({ is_active: true, limit: 5 }),\n  })\n\n  const isLoading = profileLoading || gradesLoading || attendanceLoading || announcementsLoading\n\n  // Transform data for display\n  const profile = studentProfile ? {\n    id: studentProfile.id,\n    name: studentProfile.user?.full_name || 'N/A',\n    roll: studentProfile.admission_number,\n    class: studentProfile.class_id || 'N/A',\n    admission_date: studentProfile.admission_date,\n    guardian_name: studentProfile.guardian_info?.name || 'N/A',\n    guardian_phone: studentProfile.guardian_info?.phone || 'N/A',\n    address: studentProfile.user?.address || 'N/A',\n    status: studentProfile.status\n  } : null\n\n  const grades: StudentGrade[] = gradesData.map((g: any) => ({\n    subject: g.subject,\n    term: g.term === 'Final' || g.term === 'Annual' ? 3 : g.term === 'Second Term' ? 2 : 1,\n    marks: Number(g.marks),\n    max_marks: 100,\n    grade: g.grade,\n    status: Number(g.marks) >= 50 ? 'pass' : 'fail',\n    exam_date: g.created_at || new Date().toISOString()\n  }))\n\n  const attendance: AttendanceRecord[] = attendanceData.slice(0, 10).map((a: any) => ({\n    date: a.date,\n    status: a.status as 'present' | 'absent' | 'late',\n    subject: 'General',\n    teacher: 'N/A'\n  }))\n\n  const recentActivities: RecentActivity[] = [\n    ...grades.slice(0, 3).map((g, idx) => ({\n      id: `grade-${idx}`,\n      type: 'grade',\n      title: 'New Grade Posted',\n      description: `${g.subject} Result: ${g.grade} (${g.marks}/100)`,\n      date: g.exam_date,\n      status: 'success'\n    })),\n    ...announcements.slice(0, 2).map((a: any) => ({\n      id: a.id,\n      type: 'announcement',\n      title: a.title,\n      description: a.content?.substring(0, 50) || '',\n      date: a.created_at,\n      status: 'info'\n    }))\n  ].sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime()).slice(0, 5)\n\n  const getGradeColor = (grade: string) => {\n    switch (grade) {\n      case 'A+': return 'bg-green-100 text-green-800'\n      case 'A': return 'bg-blue-100 text-blue-800'\n      case 'B+': return 'bg-yellow-100 text-yellow-800'\n      case 'B': return 'bg-orange-100 text-orange-800'\n      case 'C': return 'bg-red-100 text-red-800'\n      case 'D': return 'bg-gray-100 text-gray-800'\n      case 'F': return 'bg-gray-100 text-gray-800'\n      default: return 'bg-gray-100 text-gray-800'\n    }\n  }\n\n  const getAttendanceColor = (status: string) => {\n    switch (status) {\n      case 'present': return 'bg-green-100 text-green-800'\n      case 'absent': return 'bg-red-100 text-red-800'\n      case 'late': return 'bg-yellow-100 text-yellow-800'\n      default: return 'bg-gray-100 text-gray-800'\n    }\n  }\n\n  const getActivityIcon = (type: string) => {\n    switch (type) {\n      case 'grade': return <Award className=\"h-4 w-4 text-green-600\" />\n      case 'attendance': return <CheckCircle className=\"h-4 w-4 text-blue-600\" />\n      case 'announcement': return <Bell className=\"h-4 w-4 text-yellow-600\" />\n      default: return <AlertTriangle className=\"h-4 w-4 text-gray-600\" />\n    }\n  }\n\n  // Calculate statistics\n  const totalSubjects = grades.length\n  const averageMarks = grades.length > 0 ? Math.round(grades.reduce((sum, grade) => sum + grade.marks, 0) / grades.length) : 0\n  const attendancePercentage = attendance.length > 0 ? Math.round((attendance.filter(a => a.status === 'present').length / attendance.length) * 100) : 0\n  const excellentGrades = grades.filter(grade => {\n    const gradeUpper = grade.grade?.toUpperCase() || ''\n    return gradeUpper === 'A+' || gradeUpper === 'A'\n  }).length\n\n  if (isLoading) {\n    return (\n      <div className=\"flex justify-center items-center min-h-[400px]\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\n      </div>\n    )\n  }\n\n  return (\n    <DashboardLayout allowedRoles={['student']}>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div>\n          <h1 className=\"text-3xl font-bold text-gray-900\">Student Dashboard</h1>\n          <p className=\"text-gray-600 mt-1\">\n            Welcome back, {profile?.name}! Here's your academic overview.\n          </p>\n        </div>\n\n        {/* Profile Card */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <User className=\"h-5 w-5 text-blue-600\" />\n              Student Profile\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              <div className=\"space-y-4\">\n                <div>\n                  <h3 className=\"text-xl font-semibold text-gray-900\">{profile?.name}</h3>\n                  <p className=\"text-gray-600\">Roll Number: {profile?.roll}</p>\n                  <p className=\"text-gray-600\">Class: {profile?.class}</p>\n                </div>\n                <div>\n                  <h4 className=\"font-medium text-gray-900 mb-2\">Guardian Information</h4>\n                  <p className=\"text-gray-600\">{profile?.guardian_name}</p>\n                  <p className=\"text-gray-600\">{profile?.guardian_phone}</p>\n                </div>\n              </div>\n              <div className=\"space-y-4\">\n                <div>\n                  <h4 className=\"font-medium text-gray-900 mb-2\">Admission Details</h4>\n                  <p className=\"text-gray-600\">Admission Date: {formatDate(profile?.admission_date || '')}</p>\n                  <Badge className=\"bg-green-100 text-green-800\">\n                    {profile?.status}\n                  </Badge>\n                </div>\n                <div>\n                  <h4 className=\"font-medium text-gray-900 mb-2\">Address</h4>\n                  <p className=\"text-gray-600\">{profile?.address}</p>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Statistics */}\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-gray-600\">Average Marks</p>\n                  <p className=\"text-3xl font-bold text-blue-600\">{averageMarks}</p>\n                </div>\n                <TrendingUp className=\"h-12 w-12 text-blue-600\" />\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-gray-600\">Attendance</p>\n                  <p className=\"text-3xl font-bold text-green-600\">{attendancePercentage}%</p>\n                </div>\n                <CheckCircle className=\"h-12 w-12 text-green-600\" />\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-gray-600\">Excellent Grades</p>\n                  <p className=\"text-3xl font-bold text-purple-600\">{excellentGrades}</p>\n                </div>\n                <Star className=\"h-12 w-12 text-purple-600\" />\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-gray-600\">Total Subjects</p>\n                  <p className=\"text-3xl font-bold text-orange-600\">{totalSubjects}</p>\n                </div>\n                <BookOpen className=\"h-12 w-12 text-orange-600\" />\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n          {/* Recent Grades */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Award className=\"h-5 w-5 text-green-600\" />\n                Recent Grades\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-4\">\n                {grades.map((grade, index) => (\n                  <div key={index} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                    <div>\n                      <p className=\"font-medium text-gray-900\">{grade.subject}</p>\n                      <p className=\"text-sm text-gray-500\">Term {grade.term} • {formatDate(grade.exam_date)}</p>\n                    </div>\n                    <div className=\"text-right\">\n                      <p className=\"font-bold text-gray-900\">{grade.marks}/{grade.max_marks}</p>\n                      <Badge className={getGradeColor(grade.grade)}>\n                        {grade.grade}\n                      </Badge>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Recent Attendance */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Calendar className=\"h-5 w-5 text-blue-600\" />\n                Recent Attendance\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-4\">\n                {attendance.length > 0 ? (\n                  attendance.map((record, index) => (\n                    <div key={index} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-gray-900\">{record.subject}</p>\n                        <p className=\"text-sm text-gray-500\">{record.teacher} • {formatDate(record.date)}</p>\n                      </div>\n                      <Badge className={getAttendanceColor(record.status)}>\n                        {record.status}\n                      </Badge>\n                    </div>\n                  ))\n                ) : (\n                  <p className=\"text-center text-gray-500 py-4\">No attendance records available</p>\n                )}\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Recent Activities */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Target className=\"h-5 w-5 text-purple-600\" />\n              Recent Activities\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-4\">\n              {recentActivities.length > 0 ? (\n                recentActivities.map((activity) => (\n                  <div key={activity.id} className=\"flex items-start gap-3 p-3 border rounded-lg\">\n                    {getActivityIcon(activity.type)}\n                    <div className=\"flex-1\">\n                      <h4 className=\"font-medium text-gray-900\">{activity.title}</h4>\n                      <p className=\"text-sm text-gray-600\">{activity.description}</p>\n                      <p className=\"text-xs text-gray-500 mt-1\">{formatDate(activity.date)}</p>\n                    </div>\n                  </div>\n                ))\n              ) : (\n                <p className=\"text-center text-gray-500 py-4\">No recent activities</p>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </DashboardLayout>\n  )\n}","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\student\\grades\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Download' is defined but never used.","line":15,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":37},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Calendar' is defined but never used.","line":15,"column":65,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":73},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'BarChart3' is defined but never used.","line":16,"column":47,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":56},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'gradesBySubject' is assigned a value but never used.","line":118,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":118,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useMemo } from 'react'\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { Badge } from '@/components/ui/badge'\nimport { useQuery } from '@tanstack/react-query'\nimport { studentService } from '@/services/studentService'\nimport { gradeService } from '@/services/gradeService'\nimport { classService } from '@/services/classService'\nimport { useSettings } from '@/contexts/SettingsContext'\nimport { \n  FileText, Award, Printer, Download, TrendingUp, TrendingDown, Calendar,\n  CheckCircle, AlertCircle, BookOpen, Target, BarChart3, X, Trophy, Medal\n} from 'lucide-react'\nimport { Grade } from '@/types'\n\nexport default function StudentGradesPage() {\n  const { schoolName } = useSettings()\n  const [selectedTerm, setSelectedTerm] = useState<string>('First Term')\n  const [selectedYear, setSelectedYear] = useState<string>(new Date().getFullYear().toString())\n  const [showReportCard, setShowReportCard] = useState(false)\n\n  // Fetch student profile\n  const { data: studentProfile } = useQuery({\n    queryKey: ['student-profile'],\n    queryFn: () => studentService.getMyProfile(),\n  })\n\n  // Fetch student grades\n  const { data: grades = [] } = useQuery({\n    queryKey: ['my-grades', selectedTerm, selectedYear],\n    queryFn: () => studentService.getMyGrades({\n      term: selectedTerm,\n      academic_year: selectedYear,\n    }),\n  })\n\n  // Fetch class info\n  const { data: classInfo } = useQuery({\n    queryKey: ['my-class', studentProfile?.class_id],\n    queryFn: () => classService.getClass(studentProfile!.class_id!),\n    enabled: !!studentProfile?.class_id,\n  })\n\n  // Fetch positions to show student's position\n  const { data: positionsData } = useQuery({\n    queryKey: ['positions', studentProfile?.class_id, selectedTerm, selectedYear],\n    queryFn: () => {\n      if (!studentProfile?.class_id || !selectedTerm || !selectedYear) return null\n      return gradeService.getPositions({\n        class_id: studentProfile.class_id,\n        term: selectedTerm,\n        academic_year: selectedYear,\n        top_n: 10 // Get more to find student's position\n      })\n    },\n    enabled: !!studentProfile?.class_id && !!selectedTerm && !!selectedYear,\n  })\n\n  // Find student's position\n  const myPosition = useMemo(() => {\n    if (!positionsData || !studentProfile?.id) return null\n    return positionsData.positions.find(p => p.student_id === studentProfile.id)\n  }, [positionsData, studentProfile])\n\n  // Calculate statistics\n  const stats = useMemo(() => {\n    const totalGrades = grades.length\n    const passingGrades = grades.filter((g: Grade) => Number(g.marks) >= 50).length\n    const averageMarks = totalGrades > 0\n      ? (grades.reduce((sum: number, g: Grade) => sum + Number(g.marks), 0) / totalGrades).toFixed(1)\n      : 0\n    const passRate = totalGrades > 0 ? Math.round((passingGrades / totalGrades) * 100) : 0\n\n    // Get unique subjects\n    const subjects = [...new Set(grades.map((g: Grade) => g.subject))]\n\n    return {\n      totalGrades,\n      passingGrades,\n      averageMarks,\n      passRate,\n      subjects,\n    }\n  }, [grades])\n\n  // Calculate grade letter from marks\n  const calculateGrade = (marks: number): string => {\n    if (marks >= 90) return 'A+'\n    if (marks >= 80) return 'A'\n    if (marks >= 70) return 'B+'\n    if (marks >= 60) return 'B'\n    if (marks >= 50) return 'C+'\n    if (marks >= 40) return 'C'\n    if (marks >= 33) return 'D'\n    return 'F'\n  }\n\n  // Get grade color\n  const getGradeColor = (grade: string) => {\n    switch (grade) {\n      case 'A+': return 'bg-green-100 text-green-800 border-green-200'\n      case 'A': return 'bg-green-100 text-green-800 border-green-200'\n      case 'B+': return 'bg-blue-100 text-blue-800 border-blue-200'\n      case 'B': return 'bg-blue-100 text-blue-800 border-blue-200'\n      case 'C+': return 'bg-yellow-100 text-yellow-800 border-yellow-200'\n      case 'C': return 'bg-yellow-100 text-yellow-800 border-yellow-200'\n      case 'D': return 'bg-orange-100 text-orange-800 border-orange-200'\n      case 'F': return 'bg-red-100 text-red-800 border-red-200'\n      default: return 'bg-gray-100 text-gray-800 border-gray-200'\n    }\n  }\n\n  // Organize grades by subject\n  const gradesBySubject = useMemo(() => {\n    const organized: Record<string, Grade> = {}\n    grades.forEach((grade: Grade) => {\n      organized[grade.subject] = grade\n    })\n    return organized\n  }, [grades])\n\n  const handlePrintReportCard = () => {\n    window.print()\n  }\n\n  return (\n    <DashboardLayout allowedRoles={['student']}>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900\">My Grades</h1>\n            <p className=\"text-gray-600 mt-1\">View your academic performance</p>\n          </div>\n          <div className=\"flex gap-3\">\n            <Button variant=\"outline\" onClick={() => setShowReportCard(true)}>\n              <FileText className=\"h-4 w-4 mr-2\" />\n              View Report Card\n            </Button>\n            <Button variant=\"outline\" onClick={handlePrintReportCard}>\n              <Printer className=\"h-4 w-4 mr-2\" />\n              Print\n            </Button>\n          </div>\n        </div>\n\n        {/* Quick Stats */}\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-gray-600\">Average Marks</p>\n                  <p className=\"text-3xl font-bold text-blue-600\">{stats.averageMarks}%</p>\n                </div>\n                <div className=\"p-3 bg-blue-100 rounded-full\">\n                  <Target className=\"h-6 w-6 text-blue-600\" />\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-gray-600\">Class Position</p>\n                  <p className=\"text-3xl font-bold text-purple-600\">\n                    {myPosition ? (\n                      <span className=\"flex items-center gap-2\">\n                        {myPosition.position === 1 && <Trophy className=\"h-6 w-6 text-yellow-500\" />}\n                        {myPosition.position === 2 && <Medal className=\"h-6 w-6 text-gray-500\" />}\n                        {myPosition.position === 3 && <Medal className=\"h-6 w-6 text-orange-500\" />}\n                        {myPosition.position}\n                        {myPosition.position <= 3 && <span className=\"text-sm\">({myPosition.position === 1 ? '1st' : myPosition.position === 2 ? '2nd' : '3rd'})</span>}\n                      </span>\n                    ) : (\n                      'N/A'\n                    )}\n                  </p>\n                </div>\n                <div className=\"p-3 bg-purple-100 rounded-full\">\n                  <Award className=\"h-6 w-6 text-purple-600\" />\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-gray-600\">Total Subjects</p>\n                  <p className=\"text-3xl font-bold text-green-600\">{stats.subjects.length}</p>\n                </div>\n                <div className=\"p-3 bg-green-100 rounded-full\">\n                  <BookOpen className=\"h-6 w-6 text-green-600\" />\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-gray-600\">Passing Grades</p>\n                  <p className=\"text-3xl font-bold text-green-600\">{stats.passingGrades}/{stats.totalGrades}</p>\n                </div>\n                <div className=\"p-3 bg-green-100 rounded-full\">\n                  <CheckCircle className=\"h-6 w-6 text-green-600\" />\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-gray-600\">Pass Rate</p>\n                  <p className=\"text-3xl font-bold text-orange-600\">{stats.passRate}%</p>\n                </div>\n                <div className=\"p-3 bg-orange-100 rounded-full\">\n                  <TrendingUp className=\"h-6 w-6 text-orange-600\" />\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Filters */}\n        <Card>\n          <CardContent className=\"p-6\">\n            <div className=\"grid gap-4 md:grid-cols-3\">\n              <div>\n                <label className=\"text-sm font-medium mb-2 block\">Term</label>\n                <Select value={selectedTerm} onValueChange={setSelectedTerm}>\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"Select Term\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"First Term\">First Term</SelectItem>\n                    <SelectItem value=\"Second Term\">Second Term</SelectItem>\n                    <SelectItem value=\"Third Term\">Third Term</SelectItem>\n                    <SelectItem value=\"Final\">Final</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div>\n                <label className=\"text-sm font-medium mb-2 block\">Academic Year</label>\n                <input\n                  type=\"text\"\n                  value={selectedYear}\n                  onChange={(e) => setSelectedYear(e.target.value)}\n                  className=\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm\"\n                  placeholder=\"Academic Year\"\n                />\n              </div>\n\n              <div className=\"flex items-end\">\n                <Button \n                  variant=\"outline\" \n                  className=\"w-full\"\n                  onClick={() => setShowReportCard(true)}\n                >\n                  <Award className=\"h-4 w-4 mr-2\" />\n                  Generate Report Card\n                </Button>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Position and Class Comparison */}\n        {positionsData && myPosition && (\n          <Card className=\"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Award className=\"h-5 w-5 text-blue-600\" />\n                Your Performance Summary\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                <div className=\"text-center p-4 bg-white rounded-lg\">\n                  <p className=\"text-sm text-gray-600 mb-2\">Your Position</p>\n                  <div className=\"flex items-center justify-center gap-2\">\n                    {myPosition.position === 1 && <Trophy className=\"h-8 w-8 text-yellow-500\" />}\n                    {myPosition.position === 2 && <Medal className=\"h-8 w-8 text-gray-500\" />}\n                    {myPosition.position === 3 && <Medal className=\"h-8 w-8 text-orange-500\" />}\n                    <p className=\"text-4xl font-bold text-blue-600\">{myPosition.position}</p>\n                    <span className=\"text-lg text-gray-500\">\n                      {myPosition.position === 1 ? 'st' : myPosition.position === 2 ? 'nd' : myPosition.position === 3 ? 'rd' : 'th'}\n                    </span>\n                  </div>\n                  <p className=\"text-xs text-gray-500 mt-2\">in {classInfo?.name} - {classInfo?.section}</p>\n                </div>\n                <div className=\"text-center p-4 bg-white rounded-lg\">\n                  <p className=\"text-sm text-gray-600 mb-2\">Your Average</p>\n                  <p className=\"text-4xl font-bold text-green-600\">{myPosition.average_marks.toFixed(1)}%</p>\n                  <p className=\"text-xs text-gray-500 mt-2\">\n                    {myPosition.passed_subjects}/{myPosition.total_subjects} subjects passed\n                  </p>\n                </div>\n                <div className=\"text-center p-4 bg-white rounded-lg\">\n                  <p className=\"text-sm text-gray-600 mb-2\">Class Average</p>\n                  <p className=\"text-4xl font-bold text-purple-600\">{positionsData.class_average.toFixed(1)}%</p>\n                  <p className=\"text-xs mt-2\">\n                    {myPosition.average_marks >= positionsData.class_average ? (\n                      <span className=\"text-green-600 flex items-center justify-center gap-1\">\n                        <TrendingUp className=\"h-4 w-4\" /> Above average\n                      </span>\n                    ) : (\n                      <span className=\"text-orange-600 flex items-center justify-center gap-1\">\n                        <TrendingDown className=\"h-4 w-4\" /> Below average\n                      </span>\n                    )}\n                  </p>\n                  <p className=\"text-xs text-gray-500 mt-1\">\n                    {Math.abs(myPosition.average_marks - positionsData.class_average).toFixed(1)}% difference\n                  </p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Grades Table */}\n        <Card>\n          <CardHeader>\n            <CardTitle>Subject-wise Grades</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {grades.length === 0 ? (\n              <div className=\"text-center py-12 text-gray-500\">\n                <FileText className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n                <p className=\"text-lg font-medium mb-2\">No grades available</p>\n                <p>Grades will appear here once they are entered by your teachers</p>\n              </div>\n            ) : (\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full\">\n                  <thead>\n                    <tr className=\"border-b\">\n                      <th className=\"text-left py-3 px-4 font-medium text-gray-900\">Subject</th>\n                      <th className=\"text-center py-3 px-4 font-medium text-gray-900\">Marks</th>\n                      <th className=\"text-center py-3 px-4 font-medium text-gray-900\">Grade</th>\n                      <th className=\"text-center py-3 px-4 font-medium text-gray-900\">Status</th>\n                      <th className=\"text-left py-3 px-4 font-medium text-gray-900\">Remarks</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {grades.map((grade: Grade) => (\n                      <tr key={grade.id} className=\"border-b hover:bg-gray-50\">\n                        <td className=\"py-3 px-4 font-medium\">{grade.subject}</td>\n                        <td className=\"py-3 px-4 text-center font-semibold\">{grade.marks}/100</td>\n                        <td className=\"py-3 px-4 text-center\">\n                          <Badge className={getGradeColor(grade.grade)}>\n                            {grade.grade}\n                          </Badge>\n                        </td>\n                        <td className=\"py-3 px-4 text-center\">\n                          {Number(grade.marks) >= 50 ? (\n                            <div className=\"flex items-center justify-center gap-1\">\n                              <CheckCircle className=\"h-4 w-4 text-green-600\" />\n                              <span className=\"text-sm text-green-600\">Pass</span>\n                            </div>\n                          ) : (\n                            <div className=\"flex items-center justify-center gap-1\">\n                              <AlertCircle className=\"h-4 w-4 text-red-600\" />\n                              <span className=\"text-sm text-red-600\">Fail</span>\n                            </div>\n                          )}\n                        </td>\n                        <td className=\"py-3 px-4 text-sm text-gray-600\">{grade.remarks || '-'}</td>\n                      </tr>\n                    ))}\n                  </tbody>\n                  <tfoot className=\"bg-gray-50 font-semibold\">\n                    <tr>\n                      <td className=\"py-3 px-4\">Overall</td>\n                      <td className=\"py-3 px-4 text-center\">{stats.averageMarks}%</td>\n                      <td className=\"py-3 px-4 text-center\">\n                        <Badge className={getGradeColor(calculateGrade(Number(stats.averageMarks)))}>\n                          {calculateGrade(Number(stats.averageMarks))}\n                        </Badge>\n                      </td>\n                      <td className=\"py-3 px-4 text-center\">\n                        {stats.passRate >= 50 ? (\n                          <span className=\"text-green-600\">Passed</span>\n                        ) : (\n                          <span className=\"text-red-600\">Failed</span>\n                        )}\n                      </td>\n                      <td className=\"py-3 px-4\">{stats.passingGrades}/{stats.totalGrades} subjects passed</td>\n                    </tr>\n                  </tfoot>\n                </table>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Report Card Modal */}\n        {showReportCard && studentProfile && (\n          <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4\">\n            <div className=\"w-full max-w-4xl bg-white rounded-lg shadow-xl max-h-[90vh] overflow-auto print:shadow-none print:max-h-none\">\n              {/* Report Card Header */}\n              <div className=\"p-6 border-b print:border-b-2 print:border-gray-900\">\n                <div className=\"flex justify-between items-start mb-4 print:mb-6\">\n                  <div>\n                    <h2 className=\"text-3xl font-bold print:text-4xl\">ACADEMIC REPORT CARD</h2>\n                    <p className=\"text-lg text-gray-600 print:text-xl\">{schoolName}</p>\n                  </div>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => setShowReportCard(false)}\n                    className=\"print:hidden\"\n                  >\n                    <X className=\"h-5 w-5\" />\n                  </Button>\n                </div>\n                \n                {/* Student Info */}\n                <div className=\"grid grid-cols-2 gap-4 print:gap-6 mb-4\">\n                  <div>\n                    <p className=\"text-sm text-gray-600 print:text-base\">Student Name:</p>\n                    <p className=\"font-semibold text-lg print:text-xl\">\n                      {studentProfile.user?.full_name || 'Unknown'}\n                    </p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-600 print:text-base\">Admission Number:</p>\n                    <p className=\"font-semibold text-lg print:text-xl\">\n                      {studentProfile.admission_number}\n                    </p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-600 print:text-base\">Class:</p>\n                    <p className=\"font-semibold text-lg print:text-xl\">\n                      {classInfo?.name} - {classInfo?.section || 'N/A'}\n                    </p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-gray-600 print:text-base\">Term & Year:</p>\n                    <p className=\"font-semibold text-lg print:text-xl\">\n                      {selectedTerm} {selectedYear}\n                    </p>\n                  </div>\n                </div>\n              </div>\n\n              {/* Grades Table */}\n              <div className=\"p-6\">\n                <table className=\"w-full border-collapse print:border-2 print:border-gray-900\">\n                  <thead>\n                    <tr className=\"bg-gray-50 print:bg-gray-200\">\n                      <th className=\"border py-3 px-4 text-left font-semibold print:border-gray-900\">Subject</th>\n                      <th className=\"border py-3 px-4 text-center font-semibold print:border-gray-900\">Marks</th>\n                      <th className=\"border py-3 px-4 text-center font-semibold print:border-gray-900\">Grade</th>\n                      <th className=\"border py-3 px-4 text-center font-semibold print:border-gray-900\">Remarks</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {grades.map((grade: Grade, index) => (\n                      <tr key={grade.id} className={index % 2 === 0 ? 'bg-white' : 'bg-gray-50'}>\n                        <td className=\"border py-3 px-4 font-medium print:border-gray-900\">{grade.subject}</td>\n                        <td className=\"border py-3 px-4 text-center print:border-gray-900\">{grade.marks}/100</td>\n                        <td className=\"border py-3 px-4 text-center print:border-gray-900\">\n                          <Badge className={getGradeColor(grade.grade)}>\n                            {grade.grade}\n                          </Badge>\n                        </td>\n                        <td className=\"border py-3 px-4 text-center text-sm print:border-gray-900\">\n                          {grade.remarks || '-'}\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                  <tfoot className=\"bg-gray-50 print:bg-gray-200 font-semibold\">\n                    <tr>\n                      <td className=\"border py-3 px-4 print:border-gray-900\">Overall</td>\n                      <td className=\"border py-3 px-4 text-center print:border-gray-900\">\n                        {stats.averageMarks}%\n                      </td>\n                      <td className=\"border py-3 px-4 text-center print:border-gray-900\">\n                        {calculateGrade(Number(stats.averageMarks))}\n                      </td>\n                      <td className=\"border py-3 px-4 text-center print:border-gray-900\">\n                        {stats.passingGrades}/{stats.totalGrades} Passed\n                      </td>\n                    </tr>\n                  </tfoot>\n                </table>\n\n                {/* Summary */}\n                <div className=\"mt-6 p-4 bg-blue-50 print:bg-gray-100 rounded-lg print:rounded-none\">\n                  <h3 className=\"font-semibold mb-2 print:text-lg\">Performance Summary</h3>\n                  <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm print:text-base\">\n                    <div>\n                      <p className=\"text-gray-600\">Total Subjects</p>\n                      <p className=\"font-semibold text-lg\">{stats.subjects.length}</p>\n                    </div>\n                    <div>\n                      <p className=\"text-gray-600\">Passed</p>\n                      <p className=\"font-semibold text-lg text-green-600\">\n                        {stats.passingGrades}\n                      </p>\n                    </div>\n                    <div>\n                      <p className=\"text-gray-600\">Overall GPA</p>\n                      <p className=\"font-semibold text-lg text-blue-600\">\n                        {stats.averageMarks}%\n                      </p>\n                    </div>\n                    <div>\n                      <p className=\"text-gray-600\">Status</p>\n                      <p className=\"font-semibold text-lg\">\n                        {stats.passRate >= 50 ? 'Passed' : 'In Progress'}\n                      </p>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Action Buttons */}\n              <div className=\"p-6 border-t flex justify-end gap-3 print:hidden\">\n                <Button variant=\"outline\" onClick={handlePrintReportCard}>\n                  <Printer className=\"h-4 w-4 mr-2\" />\n                  Print\n                </Button>\n                <Button onClick={() => setShowReportCard(false)}>\n                  Close\n                </Button>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </DashboardLayout>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\student\\profile\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'User' is defined but never used.","line":13,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":14},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":19,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[909,912],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[909,912],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":36,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1447,1450],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1447,1450],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":42,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":42,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1718,1721],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1718,1721],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Label } from '@/components/ui/label'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\r\nimport { studentService } from '@/services/studentService'\r\nimport { classService } from '@/services/classService'\r\nimport { User, Edit, Save, X, Mail, Phone, MapPin, Calendar } from 'lucide-react'\r\nimport { formatDate } from '@/lib/utils'\r\nimport { toast } from '@/components/ui/toast'\r\n\r\nexport default function StudentProfilePage() {\r\n  const [isEditing, setIsEditing] = useState(false)\r\n  const [editedData, setEditedData] = useState<any>(null)\r\n  const queryClient = useQueryClient()\r\n\r\n  // Fetch student profile\r\n  const { data: studentProfile, isLoading } = useQuery({\r\n    queryKey: ['student-profile'],\r\n    queryFn: () => studentService.getMyProfile(),\r\n  })\r\n\r\n  // Fetch class info\r\n  const { data: classInfo } = useQuery({\r\n    queryKey: ['my-class', studentProfile?.class_id],\r\n    queryFn: () => classService.getClass(studentProfile!.class_id!),\r\n    enabled: !!studentProfile?.class_id,\r\n  })\r\n\r\n  const updateMutation = useMutation({\r\n    mutationFn: (data: any) => studentService.updateStudent(studentProfile!.id, data),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['student-profile'] })\r\n      toast.success('Profile updated successfully!')\r\n      setIsEditing(false)\r\n    },\r\n    onError: (error: any) => {\r\n      toast.error(error?.response?.data?.detail || 'Failed to update profile')\r\n    }\r\n  })\r\n\r\n  const handleStartEdit = () => {\r\n    if (studentProfile) {\r\n      setEditedData({\r\n        phone: studentProfile.user?.phone || '',\r\n        address: studentProfile.user?.address || '',\r\n        guardian_name: studentProfile.guardian_info.name,\r\n        guardian_phone: studentProfile.guardian_info.phone,\r\n        guardian_email: studentProfile.guardian_info.email || '',\r\n        guardian_address: studentProfile.guardian_info.address || '',\r\n      })\r\n      setIsEditing(true)\r\n    }\r\n  }\r\n\r\n  const handleSave = () => {\r\n    if (editedData) {\r\n      updateMutation.mutate({\r\n        phone: editedData.phone,\r\n        address: editedData.address,\r\n        guardian_info: {\r\n          name: editedData.guardian_name,\r\n          phone: editedData.guardian_phone,\r\n          email: editedData.guardian_email,\r\n          address: editedData.guardian_address,\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <DashboardLayout allowedRoles={['student']}>\r\n        <div className=\"text-center py-12 text-gray-500\">Loading profile...</div>\r\n      </DashboardLayout>\r\n    )\r\n  }\r\n\r\n  if (!studentProfile) {\r\n    return (\r\n      <DashboardLayout allowedRoles={['student']}>\r\n        <div className=\"text-center py-12 text-gray-500\">Profile not found</div>\r\n      </DashboardLayout>\r\n    )\r\n  }\r\n\r\n  const data = isEditing ? editedData : {\r\n    phone: studentProfile.user?.phone || '',\r\n    address: studentProfile.user?.address || '',\r\n    guardian_name: studentProfile.guardian_info.name,\r\n    guardian_phone: studentProfile.guardian_info.phone,\r\n    guardian_email: studentProfile.guardian_info.email || '',\r\n    guardian_address: studentProfile.guardian_info.address || '',\r\n  }\r\n\r\n  return (\r\n    <DashboardLayout allowedRoles={['student']}>\r\n      <div className=\"space-y-6\">\r\n        {/* Header */}\r\n        <div className=\"flex justify-between items-center\">\r\n          <div>\r\n            <h1 className=\"text-3xl font-bold text-gray-900\">My Profile</h1>\r\n            <p className=\"text-gray-600 mt-1\">View and update your profile information</p>\r\n          </div>\r\n          {!isEditing && (\r\n            <Button onClick={handleStartEdit}>\r\n              <Edit className=\"h-4 w-4 mr-2\" />\r\n              Edit Profile\r\n            </Button>\r\n          )}\r\n        </div>\r\n\r\n        {/* Student Information */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Student Information</CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div>\r\n                <Label className=\"text-sm font-medium text-gray-600\">Full Name</Label>\r\n                <p className=\"text-sm font-semibold mt-1\">\r\n                  {studentProfile.user?.full_name || 'N/A'}\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <Label className=\"text-sm font-medium text-gray-600\">Admission Number</Label>\r\n                <p className=\"text-sm font-semibold mt-1\">{studentProfile.admission_number}</p>\r\n              </div>\r\n              <div>\r\n                <Label className=\"text-sm font-medium text-gray-600\">Email</Label>\r\n                <div className=\"flex items-center gap-2 mt-1\">\r\n                  <Mail className=\"h-4 w-4 text-gray-400\" />\r\n                  <p className=\"text-sm\">{studentProfile.user?.email || 'N/A'}</p>\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <Label className=\"text-sm font-medium text-gray-600\">Phone</Label>\r\n                {isEditing ? (\r\n                  <Input\r\n                    value={data.phone}\r\n                    onChange={(e) => setEditedData({ ...data, phone: e.target.value })}\r\n                    className=\"mt-1\"\r\n                  />\r\n                ) : (\r\n                  <div className=\"flex items-center gap-2 mt-1\">\r\n                    <Phone className=\"h-4 w-4 text-gray-400\" />\r\n                    <p className=\"text-sm\">{data.phone || 'N/A'}</p>\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div>\r\n                <Label className=\"text-sm font-medium text-gray-600\">Class</Label>\r\n                <p className=\"text-sm font-semibold mt-1\">\r\n                  {classInfo ? `${classInfo.name} - ${classInfo.section}` : 'Not assigned'}\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <Label className=\"text-sm font-medium text-gray-600\">Admission Date</Label>\r\n                <div className=\"flex items-center gap-2 mt-1\">\r\n                  <Calendar className=\"h-4 w-4 text-gray-400\" />\r\n                  <p className=\"text-sm\">{formatDate(studentProfile.admission_date)}</p>\r\n                </div>\r\n              </div>\r\n              <div className=\"md:col-span-2\">\r\n                <Label className=\"text-sm font-medium text-gray-600\">Address</Label>\r\n                {isEditing ? (\r\n                  <Input\r\n                    value={data.address}\r\n                    onChange={(e) => setEditedData({ ...data, address: e.target.value })}\r\n                    className=\"mt-1\"\r\n                  />\r\n                ) : (\r\n                  <div className=\"flex items-center gap-2 mt-1\">\r\n                    <MapPin className=\"h-4 w-4 text-gray-400\" />\r\n                    <p className=\"text-sm\">{data.address || 'N/A'}</p>\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div>\r\n                <Label className=\"text-sm font-medium text-gray-600\">Status</Label>\r\n                <div className=\"mt-1\">\r\n                  <Badge className={\r\n                    studentProfile.status === 'active' \r\n                      ? 'bg-green-100 text-green-800' \r\n                      : 'bg-gray-100 text-gray-800'\r\n                  }>\r\n                    {studentProfile.status}\r\n                  </Badge>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Guardian Information */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Guardian Information</CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div>\r\n                <Label className=\"text-sm font-medium text-gray-600\">Guardian Name</Label>\r\n                {isEditing ? (\r\n                  <Input\r\n                    value={data.guardian_name}\r\n                    onChange={(e) => setEditedData({ ...data, guardian_name: e.target.value })}\r\n                    className=\"mt-1\"\r\n                  />\r\n                ) : (\r\n                  <p className=\"text-sm font-semibold mt-1\">{data.guardian_name}</p>\r\n                )}\r\n              </div>\r\n              <div>\r\n                <Label className=\"text-sm font-medium text-gray-600\">Relation</Label>\r\n                <p className=\"text-sm capitalize mt-1\">\r\n                  {studentProfile.guardian_info.relation}\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <Label className=\"text-sm font-medium text-gray-600\">Guardian Phone</Label>\r\n                {isEditing ? (\r\n                  <Input\r\n                    value={data.guardian_phone}\r\n                    onChange={(e) => setEditedData({ ...data, guardian_phone: e.target.value })}\r\n                    className=\"mt-1\"\r\n                  />\r\n                ) : (\r\n                  <div className=\"flex items-center gap-2 mt-1\">\r\n                    <Phone className=\"h-4 w-4 text-gray-400\" />\r\n                    <p className=\"text-sm\">{data.guardian_phone}</p>\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div>\r\n                <Label className=\"text-sm font-medium text-gray-600\">Guardian Email</Label>\r\n                {isEditing ? (\r\n                  <Input\r\n                    type=\"email\"\r\n                    value={data.guardian_email}\r\n                    onChange={(e) => setEditedData({ ...data, guardian_email: e.target.value })}\r\n                    className=\"mt-1\"\r\n                  />\r\n                ) : (\r\n                  <div className=\"flex items-center gap-2 mt-1\">\r\n                    <Mail className=\"h-4 w-4 text-gray-400\" />\r\n                    <p className=\"text-sm\">{data.guardian_email || 'N/A'}</p>\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div className=\"md:col-span-2\">\r\n                <Label className=\"text-sm font-medium text-gray-600\">Guardian Address</Label>\r\n                {isEditing ? (\r\n                  <Input\r\n                    value={data.guardian_address}\r\n                    onChange={(e) => setEditedData({ ...data, guardian_address: e.target.value })}\r\n                    className=\"mt-1\"\r\n                  />\r\n                ) : (\r\n                  <div className=\"flex items-center gap-2 mt-1\">\r\n                    <MapPin className=\"h-4 w-4 text-gray-400\" />\r\n                    <p className=\"text-sm\">{data.guardian_address || 'N/A'}</p>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            {isEditing && (\r\n              <div className=\"flex justify-end gap-2 pt-4 border-t\">\r\n                <Button variant=\"outline\" onClick={() => setIsEditing(false)}>\r\n                  <X className=\"h-4 w-4 mr-2\" />\r\n                  Cancel\r\n                </Button>\r\n                <Button onClick={handleSave} disabled={updateMutation.isPending}>\r\n                  <Save className=\"h-4 w-4 mr-2\" />\r\n                  {updateMutation.isPending ? 'Saving...' : 'Save Changes'}\r\n                </Button>\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    </DashboardLayout>\r\n  )\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\student\\stationery\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Calendar' is defined but never used.","line":8,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":27},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":44,"column":77,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":44,"endColumn":80,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1875,1878],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1875,1878],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { useQuery } from '@tanstack/react-query'\r\nimport { studentService } from '@/services/studentService'\r\nimport { Package, Calendar } from 'lucide-react'\r\nimport { StationeryDistribution } from '@/types'\r\nimport { formatDate } from '@/lib/utils'\r\n\r\nexport default function StudentStationeryPage() {\r\n  // Fetch student stationery distributions\r\n  const { data: distributions = [], isLoading } = useQuery({\r\n    queryKey: ['my-stationery'],\r\n    queryFn: () => studentService.getMyStationery(),\r\n  })\r\n\r\n  return (\r\n    <DashboardLayout allowedRoles={['student']}>\r\n      <div className=\"space-y-6\">\r\n        {/* Header */}\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold text-gray-900\">My Stationery</h1>\r\n          <p className=\"text-gray-600 mt-1\">View your distributed stationery items</p>\r\n        </div>\r\n\r\n        {/* Stationery Items */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Distributed Items</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            {isLoading ? (\r\n              <div className=\"text-center py-8 text-gray-500\">Loading...</div>\r\n            ) : distributions.length === 0 ? (\r\n              <div className=\"text-center py-12 text-gray-500\">\r\n                <Package className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\r\n                <p className=\"text-lg font-medium mb-2\">No stationery items distributed</p>\r\n                <p>Distributed stationery items will appear here</p>\r\n              </div>\r\n            ) : (\r\n              <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\r\n                {distributions.map((dist: StationeryDistribution & { item?: any }) => (\r\n                  <Card key={dist.id}>\r\n                    <CardContent className=\"p-6\">\r\n                      <div className=\"flex items-start justify-between mb-4\">\r\n                        <div className=\"flex items-center gap-3\">\r\n                          <div className=\"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center\">\r\n                            <Package className=\"h-6 w-6 text-blue-600\" />\r\n                          </div>\r\n                          <div>\r\n                            <h4 className=\"font-semibold\">{dist.item?.name || 'Stationery Item'}</h4>\r\n                            <p className=\"text-sm text-gray-600\">{dist.item?.category || 'General'}</p>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"space-y-2\">\r\n                        <div className=\"flex justify-between text-sm\">\r\n                          <span className=\"text-gray-600\">Quantity:</span>\r\n                          <span className=\"font-semibold\">{dist.quantity} {dist.item?.unit || 'units'}</span>\r\n                        </div>\r\n                        <div className=\"flex justify-between text-sm\">\r\n                          <span className=\"text-gray-600\">Distributed:</span>\r\n                          <span className=\"font-semibold\">{formatDate(dist.distributed_date)}</span>\r\n                        </div>\r\n                      </div>\r\n                    </CardContent>\r\n                  </Card>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    </DashboardLayout>\r\n  )\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\teacher\\attendance\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'studentService' is defined but never used.","line":16,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used.","line":19,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'XCircle' is defined but never used.","line":19,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":33},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertCircle' is defined but never used.","line":19,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":46},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":19,"column":48,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":53},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Plus' is defined but never used.","line":20,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'router' is assigned a value but never used.","line":25,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":67,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":67,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2733,2736],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2733,2736],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":131,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":131,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5009,5012],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5009,5012],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":172,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":172,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6625,6628],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6625,6628],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":173,"column":76,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":173,"endColumn":79,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6711,6714],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6711,6714],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { useRouter, useSearchParams } from 'next/navigation'\r\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Label } from '@/components/ui/label'\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { toast } from '@/components/ui/toast'\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\r\nimport { teacherService } from '@/services/teacherService'\r\nimport { classService } from '@/services/classService'\r\nimport { studentService } from '@/services/studentService'\r\nimport { attendanceService } from '@/services/attendanceService'\r\nimport { \r\n  Calendar, CheckCircle, XCircle, AlertCircle, Clock, Users,\r\n  Save, Plus\r\n} from 'lucide-react'\r\nimport { AttendanceStatus } from '@/types'\r\n\r\nexport default function TeacherAttendancePage() {\r\n  const router = useRouter()\r\n  const searchParams = useSearchParams()\r\n  const queryClient = useQueryClient()\r\n  const [selectedDate, setSelectedDate] = useState(new Date().toISOString().split('T')[0])\r\n  const [selectedClassId, setSelectedClassId] = useState<string>(searchParams.get('class_id') || '')\r\n  const [attendanceData, setAttendanceData] = useState<Record<string, AttendanceStatus>>({})\r\n\r\n  // Fetch teacher's classes\r\n  const { data: classes = [] } = useQuery({\r\n    queryKey: ['my-classes'],\r\n    queryFn: () => teacherService.getMyClasses(),\r\n  })\r\n\r\n  // Fetch students for selected class\r\n  const { data: students = [] } = useQuery({\r\n    queryKey: ['class-students', selectedClassId],\r\n    queryFn: () => classService.getClassStudents(selectedClassId),\r\n    enabled: !!selectedClassId,\r\n  })\r\n\r\n  // Fetch existing attendance\r\n  const { data: existingAttendance = [] } = useQuery({\r\n    queryKey: ['attendance', selectedDate, selectedClassId],\r\n    queryFn: () => attendanceService.getAttendance({\r\n      date_from: selectedDate,\r\n      date_to: selectedDate,\r\n      limit: 1000,\r\n    }),\r\n    enabled: !!selectedDate && !!selectedClassId,\r\n  })\r\n\r\n  // Mark attendance mutation\r\n  const markAttendanceMutation = useMutation({\r\n    mutationFn: (attendances: Array<{\r\n      user_id: string\r\n      date: string\r\n      status: AttendanceStatus\r\n    }>) => attendanceService.markBulkAttendance(attendances),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['attendance'] })\r\n      toast.success('Attendance marked successfully!')\r\n    },\r\n    onError: (error: any) => {\r\n      toast.error(error?.response?.data?.detail || 'Failed to mark attendance')\r\n    }\r\n  })\r\n\r\n  const handleStatusChange = (userId: string, status: AttendanceStatus) => {\r\n    setAttendanceData(prev => ({ ...prev, [userId]: status }))\r\n  }\r\n\r\n  const handleSaveAttendance = () => {\r\n    const attendances = Object.entries(attendanceData).map(([user_id, status]) => ({\r\n      user_id,\r\n      date: selectedDate,\r\n      status,\r\n    }))\r\n\r\n    if (attendances.length === 0) {\r\n      toast.error('Please mark attendance for at least one student')\r\n      return\r\n    }\r\n\r\n    markAttendanceMutation.mutate(attendances)\r\n  }\r\n\r\n  const getStatusColor = (status: AttendanceStatus) => {\r\n    switch (status) {\r\n      case 'present': return 'bg-green-100 text-green-800'\r\n      case 'absent': return 'bg-red-100 text-red-800'\r\n      case 'late': return 'bg-yellow-100 text-yellow-800'\r\n      case 'excused': return 'bg-blue-100 text-blue-800'\r\n      default: return 'bg-gray-100 text-gray-800'\r\n    }\r\n  }\r\n\r\n  return (\r\n    <DashboardLayout allowedRoles={['teacher']}>\r\n      <div className=\"space-y-6\">\r\n        {/* Header */}\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold text-gray-900\">Mark Attendance</h1>\r\n          <p className=\"text-gray-600 mt-1\">Mark attendance for your assigned classes</p>\r\n        </div>\r\n\r\n        {/* Filters */}\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"grid gap-4 md:grid-cols-2\">\r\n              <div>\r\n                <Label htmlFor=\"date\">Date</Label>\r\n                <Input\r\n                  type=\"date\"\r\n                  id=\"date\"\r\n                  value={selectedDate}\r\n                  onChange={(e) => setSelectedDate(e.target.value)}\r\n                />\r\n              </div>\r\n              <div>\r\n                <Label htmlFor=\"class\">Class</Label>\r\n                <Select value={selectedClassId || \"all\"} onValueChange={(value) => setSelectedClassId(value === \"all\" ? '' : value)}>\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder=\"Select Class\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"all\">All Classes</SelectItem>\r\n                    {classes.map((cls: any) => (\r\n                      <SelectItem key={cls.id} value={cls.id}>\r\n                        {cls.name} - {cls.section}\r\n                      </SelectItem>\r\n                    ))}\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Attendance Table */}\r\n        {selectedClassId ? (\r\n          <Card>\r\n            <CardHeader>\r\n              <div className=\"flex justify-between items-center\">\r\n                <CardTitle>Student Attendance</CardTitle>\r\n                <Button \r\n                  onClick={handleSaveAttendance}\r\n                  disabled={markAttendanceMutation.isPending}\r\n                >\r\n                  <Save className=\"h-4 w-4 mr-2\" />\r\n                  Save Attendance\r\n                </Button>\r\n              </div>\r\n            </CardHeader>\r\n            <CardContent>\r\n              {students.length === 0 ? (\r\n                <div className=\"text-center py-8 text-gray-500\">No students in this class</div>\r\n              ) : (\r\n                <div className=\"overflow-x-auto\">\r\n                  <table className=\"w-full\">\r\n                    <thead>\r\n                      <tr className=\"border-b\">\r\n                        <th className=\"text-left py-3 px-4\">Student</th>\r\n                        <th className=\"text-center py-3 px-4\">Status</th>\r\n                        <th className=\"text-center py-3 px-4\">Actions</th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      {students.map((student: any) => {\r\n                        const existingRecord = existingAttendance.find((a: any) => a.user_id === student.user_id)\r\n                        const currentStatus = attendanceData[student.user_id] || existingRecord?.status || 'present'\r\n                        \r\n                        return (\r\n                          <tr key={student.id} className=\"border-b hover:bg-gray-50\">\r\n                            <td className=\"py-3 px-4\">\r\n                              <div className=\"flex items-center gap-3\">\r\n                                <div className=\"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center\">\r\n                                  <Users className=\"h-4 w-4 text-blue-600\" />\r\n                                </div>\r\n                                <div>\r\n                                  <div className=\"font-medium\">{student.user?.full_name || 'Unknown'}</div>\r\n                                  <div className=\"text-sm text-gray-600\">{student.admission_number}</div>\r\n                                </div>\r\n                              </div>\r\n                            </td>\r\n                            <td className=\"py-3 px-4 text-center\">\r\n                              <Badge className={getStatusColor(currentStatus)}>\r\n                                {currentStatus}\r\n                              </Badge>\r\n                            </td>\r\n                            <td className=\"py-3 px-4 text-center\">\r\n                              <div className=\"flex justify-center gap-1\">\r\n                                <Button\r\n                                  size=\"sm\"\r\n                                  variant={currentStatus === 'present' ? 'default' : 'outline'}\r\n                                  onClick={() => handleStatusChange(student.user_id, 'present')}\r\n                                  className=\"h-8\"\r\n                                >\r\n                                  Present\r\n                                </Button>\r\n                                <Button\r\n                                  size=\"sm\"\r\n                                  variant={currentStatus === 'absent' ? 'default' : 'outline'}\r\n                                  onClick={() => handleStatusChange(student.user_id, 'absent')}\r\n                                  className=\"h-8\"\r\n                                >\r\n                                  Absent\r\n                                </Button>\r\n                                <Button\r\n                                  size=\"sm\"\r\n                                  variant={currentStatus === 'late' ? 'default' : 'outline'}\r\n                                  onClick={() => handleStatusChange(student.user_id, 'late')}\r\n                                  className=\"h-8\"\r\n                                >\r\n                                  Late\r\n                                </Button>\r\n                              </div>\r\n                            </td>\r\n                          </tr>\r\n                        )\r\n                      })}\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              )}\r\n            </CardContent>\r\n          </Card>\r\n        ) : (\r\n          <Card>\r\n            <CardContent className=\"p-12 text-center\">\r\n              <Calendar className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\r\n              <p className=\"text-lg font-medium text-gray-600 mb-2\">Select a Class</p>\r\n              <p className=\"text-gray-500\">Choose a class to mark attendance</p>\r\n            </CardContent>\r\n          </Card>\r\n        )}\r\n      </div>\r\n    </DashboardLayout>\r\n  )\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\teacher\\classes\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'studentService' is defined but never used.","line":11,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":24},{"ruleId":"react/no-unescaped-entities","severity":1,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":50,"column":29,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[2104,2148],"text":"You haven&apos;t been assigned to any classes yet"},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[2104,2148],"text":"You haven&lsquo;t been assigned to any classes yet"},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[2104,2148],"text":"You haven&#39;t been assigned to any classes yet"},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[2104,2148],"text":"You haven&rsquo;t been assigned to any classes yet"},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { useRouter } from 'next/navigation'\r\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Button } from '@/components/ui/button'\r\nimport { useQuery } from '@tanstack/react-query'\r\nimport { teacherService } from '@/services/teacherService'\r\nimport { classService } from '@/services/classService'\r\nimport { studentService } from '@/services/studentService'\r\nimport { BookOpen, Users, Calendar, FileText, BarChart3 } from 'lucide-react'\r\nimport { Class, Student } from '@/types'\r\n\r\nexport default function TeacherClassesPage() {\r\n  const router = useRouter()\r\n  const [selectedClass, setSelectedClass] = useState<Class | null>(null)\r\n\r\n  // Fetch teacher's classes\r\n  const { data: classes = [], isLoading } = useQuery({\r\n    queryKey: ['my-classes'],\r\n    queryFn: () => teacherService.getMyClasses(),\r\n  })\r\n\r\n  // Fetch students for selected class\r\n  const { data: students = [] } = useQuery({\r\n    queryKey: ['class-students', selectedClass?.id],\r\n    queryFn: () => classService.getClassStudents(selectedClass!.id),\r\n    enabled: !!selectedClass?.id,\r\n  })\r\n\r\n  return (\r\n    <DashboardLayout allowedRoles={['teacher']}>\r\n      <div className=\"space-y-6\">\r\n        {/* Header */}\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold text-gray-900\">My Classes</h1>\r\n          <p className=\"text-gray-600 mt-1\">View and manage your assigned classes</p>\r\n        </div>\r\n\r\n        {!selectedClass ? (\r\n          /* Classes List */\r\n          <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\r\n            {isLoading ? (\r\n              <div className=\"text-center py-8 text-gray-500 col-span-full\">Loading classes...</div>\r\n            ) : classes.length === 0 ? (\r\n              <div className=\"text-center py-12 text-gray-500 col-span-full\">\r\n                <BookOpen className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\r\n                <p className=\"text-lg font-medium mb-2\">No classes assigned</p>\r\n                <p>You haven't been assigned to any classes yet</p>\r\n              </div>\r\n            ) : (\r\n              classes.map((cls: Class) => (\r\n                <Card key={cls.id} className=\"hover:shadow-lg transition-shadow cursor-pointer\"\r\n                  onClick={() => setSelectedClass(cls)}\r\n                >\r\n                  <CardHeader>\r\n                    <CardTitle className=\"flex items-center gap-2\">\r\n                      <BookOpen className=\"h-5 w-5 text-blue-600\" />\r\n                      {cls.name} - {cls.section}\r\n                    </CardTitle>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <div className=\"space-y-2 text-sm\">\r\n                      <div className=\"flex justify-between\">\r\n                        <span className=\"text-gray-600\">Academic Year:</span>\r\n                        <span className=\"font-medium\">{cls.academic_year}</span>\r\n                      </div>\r\n                      <div className=\"pt-3 border-t\">\r\n                        <Button \r\n                          size=\"sm\" \r\n                          className=\"w-full\"\r\n                          onClick={(e) => {\r\n                            e.stopPropagation()\r\n                            setSelectedClass(cls)\r\n                          }}\r\n                        >\r\n                          View Details\r\n                        </Button>\r\n                      </div>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              ))\r\n            )}\r\n          </div>\r\n        ) : (\r\n          /* Class Details */\r\n          <div className=\"space-y-6\">\r\n            <Card>\r\n              <CardHeader>\r\n                <div className=\"flex justify-between items-center\">\r\n                  <div>\r\n                    <CardTitle>{selectedClass.name} - {selectedClass.section}</CardTitle>\r\n                    <p className=\"text-sm text-gray-600 mt-1\">Academic Year: {selectedClass.academic_year}</p>\r\n                  </div>\r\n                  <Button variant=\"outline\" onClick={() => setSelectedClass(null)}>\r\n                    Back to Classes\r\n                  </Button>\r\n                </div>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6\">\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    onClick={() => router.push(`/teacher/attendance?class_id=${selectedClass.id}`)}\r\n                    className=\"flex flex-col items-center gap-2 h-auto p-4\"\r\n                  >\r\n                    <Calendar className=\"h-6 w-6\" />\r\n                    <span>Mark Attendance</span>\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    onClick={() => router.push(`/teacher/grades?class_id=${selectedClass.id}`)}\r\n                    className=\"flex flex-col items-center gap-2 h-auto p-4\"\r\n                  >\r\n                    <FileText className=\"h-6 w-6\" />\r\n                    <span>Enter Grades</span>\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    onClick={() => router.push(`/teacher/attendance?class_id=${selectedClass.id}`)}\r\n                    className=\"flex flex-col items-center gap-2 h-auto p-4\"\r\n                  >\r\n                    <Users className=\"h-6 w-6\" />\r\n                    <span>View Students</span>\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    onClick={() => router.push(`/teacher/grades?class_id=${selectedClass.id}`)}\r\n                    className=\"flex flex-col items-center gap-2 h-auto p-4\"\r\n                  >\r\n                    <BarChart3 className=\"h-6 w-6\" />\r\n                    <span>Performance</span>\r\n                  </Button>\r\n                </div>\r\n\r\n                {/* Students List */}\r\n                <div>\r\n                  <h3 className=\"font-semibold mb-4\">Students ({students.length})</h3>\r\n                  <div className=\"overflow-x-auto\">\r\n                    <table className=\"w-full\">\r\n                      <thead>\r\n                        <tr className=\"border-b\">\r\n                          <th className=\"text-left py-2 px-4\">Admission No.</th>\r\n                          <th className=\"text-left py-2 px-4\">Name</th>\r\n                          <th className=\"text-center py-2 px-4\">Actions</th>\r\n                        </tr>\r\n                      </thead>\r\n                      <tbody>\r\n                        {students.map((student: Student) => (\r\n                          <tr key={student.id} className=\"border-b hover:bg-gray-50\">\r\n                            <td className=\"py-2 px-4\">{student.admission_number}</td>\r\n                            <td className=\"py-2 px-4\">{student.user?.full_name || 'Unknown'}</td>\r\n                            <td className=\"py-2 px-4 text-center\">\r\n                              <div className=\"flex justify-center gap-2\">\r\n                                <Button\r\n                                  size=\"sm\"\r\n                                  variant=\"ghost\"\r\n                                  onClick={() => router.push(`/teacher/attendance?class_id=${selectedClass.id}&student_id=${student.id}`)}\r\n                                >\r\n                                  <Calendar className=\"h-4 w-4\" />\r\n                                </Button>\r\n                                <Button\r\n                                  size=\"sm\"\r\n                                  variant=\"ghost\"\r\n                                  onClick={() => router.push(`/teacher/grades?class_id=${selectedClass.id}&student_id=${student.id}`)}\r\n                                >\r\n                                  <FileText className=\"h-4 w-4\" />\r\n                                </Button>\r\n                              </div>\r\n                            </td>\r\n                          </tr>\r\n                        ))}\r\n                      </tbody>\r\n                    </table>\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </DashboardLayout>\r\n  )\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\teacher\\dashboard\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useState' is defined but never used.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'classService' is defined but never used.","line":10,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":15,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":48},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendingUp' is defined but never used.","line":16,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":41},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Bell' is defined but never used.","line":16,"column":51,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":55},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'toast' is defined but never used.","line":20,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TeacherProfile' is defined but never used.","line":22,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":25},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":116,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":116,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3333,3336],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3333,3336],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":129,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":129,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3763,3766],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3763,3766],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":129,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":129,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3801,3804],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3801,3804],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":140,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":140,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4203,4206],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4203,4206],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":148,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":148,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4490,4493],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4490,4493],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":1,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":206,"column":80,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[6743,6786],"text":"! Here&apos;s your teaching overview.\n          "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[6743,6786],"text":"! Here&lsquo;s your teaching overview.\n          "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[6743,6786],"text":"! Here&#39;s your teaching overview.\n          "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[6743,6786],"text":"! Here&rsquo;s your teaching overview.\n          "},"desc":"Replace with `&rsquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":1,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":313,"column":22,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[11123,11171],"text":"\n                Today&apos;s Schedule\n              "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[11123,11171],"text":"\n                Today&lsquo;s Schedule\n              "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[11123,11171],"text":"\n                Today&#39;s Schedule\n              "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[11123,11171],"text":"\n                Today&rsquo;s Schedule\n              "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":14,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState } from 'react'\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { useQuery } from '@tanstack/react-query'\nimport { teacherService } from '@/services/teacherService'\nimport { classService } from '@/services/classService'\nimport { gradeService } from '@/services/gradeService'\nimport { attendanceService } from '@/services/attendanceService'\nimport { useAuth } from '@/contexts/AuthContext'\nimport { \n  User, BookOpen, Users, Award, Calendar, Clock, \n  CheckCircle, AlertTriangle, TrendingUp, Target, Bell,\n  GraduationCap, BarChart3\n} from 'lucide-react'\nimport { formatDate } from '@/lib/utils'\nimport { toast } from '@/components/ui/toast'\n\ninterface TeacherProfile {\n  id: string\n  name: string\n  employee_id: string\n  qualification: string\n  subjects: string[]\n  join_date: string\n  salary: number\n  status: string\n  phone: string\n  address: string\n}\n\ninterface AssignedClass {\n  id: string\n  name: string\n  section: string\n  total_students: number\n  subjects: string[]\n}\n\ninterface TodaySchedule {\n  id: string\n  time: string\n  subject: string\n  class: string\n  room: string\n}\n\ninterface PendingTask {\n  id: string\n  title: string\n  type: 'grade' | 'attendance' | 'assignment' | 'meeting'\n  due_date: string\n  priority: 'high' | 'medium' | 'low'\n  status: 'pending' | 'in_progress' | 'completed'\n}\n\ninterface RecentActivity {\n  id: string\n  type: string\n  title: string\n  description: string\n  date: string\n  status: string\n}\n\nexport default function TeacherDashboard() {\n  const { user } = useAuth()\n\n  // Fetch teacher profile\n  const { data: teacherProfile, isLoading: profileLoading } = useQuery({\n    queryKey: ['teacher-profile'],\n    queryFn: () => teacherService.getMyProfile(),\n    enabled: !!user,\n  })\n\n  // Fetch assigned classes\n  const { data: classesData = [], isLoading: classesLoading } = useQuery({\n    queryKey: ['teacher-classes'],\n    queryFn: () => teacherService.getMyClasses(),\n    enabled: !!user,\n  })\n\n  // Fetch recent grades\n  const { data: recentGrades = [], isLoading: gradesLoading } = useQuery({\n    queryKey: ['teacher-recent-grades'],\n    queryFn: () => gradeService.getGrades({ limit: 10 }),\n    enabled: !!user,\n  })\n\n  // Fetch recent attendance\n  const { data: recentAttendance = [], isLoading: attendanceLoading } = useQuery({\n    queryKey: ['teacher-recent-attendance'],\n    queryFn: () => attendanceService.getAttendance({ limit: 10 }),\n    enabled: !!user,\n  })\n\n  const isLoading = profileLoading || classesLoading || gradesLoading || attendanceLoading\n\n  // Transform data for display\n  const profile = teacherProfile ? {\n    id: teacherProfile.id,\n    name: teacherProfile.user?.full_name || 'N/A',\n    employee_id: teacherProfile.employee_id,\n    qualification: teacherProfile.qualification,\n    subjects: teacherProfile.subjects || [],\n    join_date: teacherProfile.join_date,\n    salary: teacherProfile.salary_info?.basic_salary || 0,\n    status: teacherProfile.status,\n    phone: teacherProfile.user?.phone || 'N/A',\n    address: teacherProfile.user?.address || 'N/A'\n  } : null\n\n  const assignedClasses: AssignedClass[] = classesData.map((cls: any) => ({\n    id: cls.id,\n    name: cls.name,\n    section: cls.section || '',\n    total_students: 0, // Will be fetched separately if needed\n    subjects: [] // Will be populated from teacher subjects\n  }))\n\n  // Today's schedule - placeholder (would need timetable API)\n  const todaySchedule: TodaySchedule[] = []\n\n  // Pending tasks - calculated from data\n  const pendingTasks: PendingTask[] = [\n    ...recentGrades.filter((g: any) => !g.grade).slice(0, 3).map((g: any, idx: number) => ({\n      id: `grade-${idx}`,\n      title: `Grade ${g.subject} for ${g.class_id || 'Class'}`,\n      type: 'grade' as const,\n      due_date: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],\n      priority: 'high' as const,\n      status: 'pending' as const\n    }))\n  ]\n\n  const recentActivities: RecentActivity[] = [\n    ...recentGrades.slice(0, 3).map((g: any, idx: number) => ({\n      id: `grade-${idx}`,\n      type: 'grade',\n      title: 'Grade Submitted',\n      description: `${g.subject} grade for student`,\n      date: g.created_at || new Date().toISOString(),\n      status: 'success'\n    })),\n    ...recentAttendance.slice(0, 2).map((a: any, idx: number) => ({\n      id: `attendance-${idx}`,\n      type: 'attendance',\n      title: 'Attendance Marked',\n      description: `Attendance marked for ${a.date}`,\n      date: a.date || a.created_at || new Date().toISOString(),\n      status: 'success'\n    }))\n  ].sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime()).slice(0, 5)\n\n  const getTaskPriorityColor = (priority: string) => {\n    switch (priority) {\n      case 'high': return 'bg-red-100 text-red-800'\n      case 'medium': return 'bg-yellow-100 text-yellow-800'\n      case 'low': return 'bg-green-100 text-green-800'\n      default: return 'bg-gray-100 text-gray-800'\n    }\n  }\n\n  const getTaskStatusColor = (status: string) => {\n    switch (status) {\n      case 'pending': return 'bg-yellow-100 text-yellow-800'\n      case 'in_progress': return 'bg-blue-100 text-blue-800'\n      case 'completed': return 'bg-green-100 text-green-800'\n      default: return 'bg-gray-100 text-gray-800'\n    }\n  }\n\n  const getActivityIcon = (type: string) => {\n    switch (type) {\n      case 'grade': return <Award className=\"h-4 w-4 text-green-600\" />\n      case 'attendance': return <CheckCircle className=\"h-4 w-4 text-blue-600\" />\n      case 'meeting': return <Users className=\"h-4 w-4 text-purple-600\" />\n      default: return <AlertTriangle className=\"h-4 w-4 text-gray-600\" />\n    }\n  }\n\n  // Calculate statistics\n  const totalStudents = assignedClasses.reduce((sum, cls) => sum + cls.total_students, 0)\n  const totalClasses = assignedClasses.length\n  const completedTasks = pendingTasks.filter(task => task.status === 'completed').length\n  const pendingTasksCount = pendingTasks.filter(task => task.status === 'pending').length\n\n  if (isLoading) {\n    return (\n      <div className=\"flex justify-center items-center min-h-[400px]\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600\"></div>\n      </div>\n    )\n  }\n\n  return (\n    <DashboardLayout allowedRoles={['teacher']}>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div>\n          <h1 className=\"text-3xl font-bold text-gray-900\">Teacher Dashboard</h1>\n          <p className=\"text-gray-600 mt-1\">\n            Welcome back, {profile?.name || user?.full_name || 'Teacher'}! Here's your teaching overview.\n          </p>\n        </div>\n\n        {/* Profile Card */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <User className=\"h-5 w-5 text-blue-600\" />\n              Teacher Profile\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              <div className=\"space-y-4\">\n                <div>\n                  <h3 className=\"text-xl font-semibold text-gray-900\">{profile?.name}</h3>\n                  <p className=\"text-gray-600\">Employee ID: {profile?.employee_id}</p>\n                  <p className=\"text-gray-600\">Qualification: {profile?.qualification}</p>\n                </div>\n                <div>\n                  <h4 className=\"font-medium text-gray-900 mb-2\">Teaching Subjects</h4>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {profile?.subjects.map((subject, index) => (\n                      <Badge key={index} className=\"bg-blue-100 text-blue-800\">\n                        {subject}\n                      </Badge>\n                    ))}\n                  </div>\n                </div>\n              </div>\n              <div className=\"space-y-4\">\n                <div>\n                  <h4 className=\"font-medium text-gray-900 mb-2\">Employment Details</h4>\n                  <p className=\"text-gray-600\">Join Date: {formatDate(profile?.join_date || '')}</p>\n                  <p className=\"text-gray-600\">Salary: ${profile?.salary?.toLocaleString()}</p>\n                  <Badge className=\"bg-green-100 text-green-800\">\n                    {profile?.status}\n                  </Badge>\n                </div>\n                <div>\n                  <h4 className=\"font-medium text-gray-900 mb-2\">Contact</h4>\n                  <p className=\"text-gray-600\">{profile?.phone}</p>\n                  <p className=\"text-gray-600\">{profile?.address}</p>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Statistics */}\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-gray-600\">Total Students</p>\n                  <p className=\"text-3xl font-bold text-blue-600\">{totalStudents}</p>\n                </div>\n                <Users className=\"h-12 w-12 text-blue-600\" />\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-gray-600\">Assigned Classes</p>\n                  <p className=\"text-3xl font-bold text-green-600\">{totalClasses}</p>\n                </div>\n                <BookOpen className=\"h-12 w-12 text-green-600\" />\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-gray-600\">Completed Tasks</p>\n                  <p className=\"text-3xl font-bold text-purple-600\">{completedTasks}</p>\n                </div>\n                <CheckCircle className=\"h-12 w-12 text-purple-600\" />\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm font-medium text-gray-600\">Pending Tasks</p>\n                  <p className=\"text-3xl font-bold text-orange-600\">{pendingTasksCount}</p>\n                </div>\n                <AlertTriangle className=\"h-12 w-12 text-orange-600\" />\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n          {/* Today's Schedule */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Calendar className=\"h-5 w-5 text-blue-600\" />\n                Today's Schedule\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-4\">\n                {todaySchedule.length > 0 ? (\n                  todaySchedule.map((schedule) => (\n                    <div key={schedule.id} className=\"flex items-center justify-between p-3 border rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-gray-900\">{schedule.subject}</p>\n                        <p className=\"text-sm text-gray-500\">{schedule.class} • {schedule.room}</p>\n                      </div>\n                      <div className=\"text-right\">\n                        <p className=\"font-bold text-blue-600\">{schedule.time}</p>\n                      </div>\n                    </div>\n                  ))\n                ) : (\n                  <p className=\"text-center text-gray-500 py-4\">No schedule available for today</p>\n                )}\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Assigned Classes */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <GraduationCap className=\"h-5 w-5 text-green-600\" />\n                Assigned Classes\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-4\">\n                {assignedClasses.length > 0 ? (\n                  assignedClasses.map((cls) => (\n                    <div key={cls.id} className=\"p-4 border rounded-lg\">\n                      <div className=\"flex justify-between items-center mb-2\">\n                        <h4 className=\"font-medium text-gray-900\">{cls.name} {cls.section}</h4>\n                        <span className=\"text-lg font-bold text-blue-600\">{cls.total_students || 0} students</span>\n                      </div>\n                      <div className=\"flex flex-wrap gap-2\">\n                        {profile?.subjects && profile.subjects.length > 0 ? (\n                          profile.subjects.slice(0, 3).map((subject, index) => (\n                            <Badge key={index} className=\"bg-blue-100 text-blue-800\">\n                              {subject}\n                            </Badge>\n                          ))\n                        ) : (\n                          <Badge className=\"bg-gray-100 text-gray-800\">No subjects assigned</Badge>\n                        )}\n                      </div>\n                    </div>\n                  ))\n                ) : (\n                  <p className=\"text-center text-gray-500 py-4\">No classes assigned yet</p>\n                )}\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Pending Tasks */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Target className=\"h-5 w-5 text-orange-600\" />\n              Pending Tasks\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-4\">\n              {pendingTasks.length > 0 ? (\n                pendingTasks.map((task) => (\n                  <div key={task.id} className=\"flex items-center justify-between p-4 border rounded-lg\">\n                    <div className=\"flex-1\">\n                      <h4 className=\"font-medium text-gray-900\">{task.title}</h4>\n                      <p className=\"text-sm text-gray-500\">Due: {formatDate(task.due_date)}</p>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <Badge className={getTaskPriorityColor(task.priority)}>\n                        {task.priority}\n                      </Badge>\n                      <Badge className={getTaskStatusColor(task.status)}>\n                        {task.status}\n                      </Badge>\n                      <Button size=\"sm\" variant=\"outline\">\n                        View\n                      </Button>\n                    </div>\n                  </div>\n                ))\n              ) : (\n                <p className=\"text-center text-gray-500 py-4\">No pending tasks</p>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Recent Activities */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <BarChart3 className=\"h-5 w-5 text-purple-600\" />\n              Recent Activities\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-4\">\n              {recentActivities.length > 0 ? (\n                recentActivities.map((activity) => (\n                  <div key={activity.id} className=\"flex items-start gap-3 p-3 border rounded-lg\">\n                    {getActivityIcon(activity.type)}\n                    <div className=\"flex-1\">\n                      <h4 className=\"font-medium text-gray-900\">{activity.title}</h4>\n                      <p className=\"text-sm text-gray-600\">{activity.description}</p>\n                      <p className=\"text-xs text-gray-500 mt-1\">{formatDate(activity.date)}</p>\n                    </div>\n                  </div>\n                ))\n              ) : (\n                <p className=\"text-center text-gray-500 py-4\">No recent activities</p>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </DashboardLayout>\n  )\n}","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\teacher\\exams\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ConfirmDialog' is defined but never used.","line":14,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Trash2' is defined but never used.","line":17,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertCircle' is defined but never used.","line":18,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":38},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Calendar' is defined but never used.","line":18,"column":50,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":58},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'classService' is defined but never used.","line":23,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":22},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isCreatingExam' is assigned a value but never used.","line":33,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":33,"endColumn":24},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":38,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1701,1704],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1701,1704],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":72,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":72,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2609,2612],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2609,2612],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":82,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":82,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2887,2890],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2887,2890],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":101,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":101,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3467,3470],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3467,3470],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":113,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":113,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3899,3902],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3899,3902],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":202,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":202,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7544,7547],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7544,7547],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":420,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":420,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16875,16878],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16875,16878],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":524,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":524,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[22314,22317],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[22314,22317],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":14,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { Badge } from '@/components/ui/badge'\nimport { Textarea } from '@/components/ui/textarea'\nimport { toast } from '@/components/ui/toast'\nimport { ConfirmDialog } from '@/components/shared/ConfirmDialog'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { \n  Plus, Edit, Trash2, Eye, Upload, FileText, CheckCircle, XCircle,\n  Clock, Send, FileCheck, AlertCircle, BookOpen, Calendar\n} from 'lucide-react'\nimport { examService } from '@/services/examService'\nimport { paperService } from '@/services/paperService'\nimport { teacherService } from '@/services/teacherService'\nimport { classService } from '@/services/classService'\nimport { Exam, ApprovalStatus } from '@/types'\n\ntype TabId = 'create-exam' | 'upload-paper' | 'my-exams' | 'pending-approval'\n\nexport default function TeacherExamsPage() {\n  const router = useRouter()\n  const queryClient = useQueryClient()\n  const [activeTab, setActiveTab] = useState<TabId>('my-exams')\n  const [selectedClass, setSelectedClass] = useState<string>('all')\n  const [isCreatingExam, setIsCreatingExam] = useState(false)\n\n  // Exam form state\n  const [examForm, setExamForm] = useState({\n    exam_name: '',\n    exam_type: 'term_exam' as any,\n    term: 'First Term',\n    academic_year: new Date().getFullYear().toString(),\n    class_id: '',\n    subject: '',\n    total_marks: 100,\n    passing_marks: 50,\n    exam_date: '',\n    duration_minutes: '',\n    instructions: ''\n  })\n\n  // Fetch teacher's classes\n  const { data: classes = [] } = useQuery({\n    queryKey: ['my-classes'],\n    queryFn: () => teacherService.getMyClasses(),\n  })\n\n  // Fetch teacher profile for subjects\n  const { data: teacherProfile } = useQuery({\n    queryKey: ['teacher-profile'],\n    queryFn: () => teacherService.getMyProfile(),\n  })\n\n  // Fetch exams\n  const { data: exams = [] } = useQuery({\n    queryKey: ['my-exams', selectedClass],\n    queryFn: () => examService.getExams({ \n      class_id: selectedClass === 'all' ? undefined : selectedClass,\n      limit: 1000 \n    }),\n  })\n\n  // Create classes map for quick lookup\n  const classesMap = new Map(classes.map((cls: any) => [cls.id, cls]))\n\n  // Fetch pending papers\n  const { data: pendingPapersData } = useQuery({\n    queryKey: ['pending-papers'],\n    queryFn: () => paperService.getPending(),\n  })\n\n  // Create exam mutation\n  const createExamMutation = useMutation({\n    mutationFn: (data: any) => examService.createExam(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['my-exams'] })\n      toast.success('Exam created successfully!')\n      setIsCreatingExam(false)\n      setExamForm({\n        exam_name: '',\n        exam_type: 'term_exam',\n        term: 'First Term',\n        academic_year: new Date().getFullYear().toString(),\n        class_id: '',\n        subject: '',\n        total_marks: 100,\n        passing_marks: 50,\n        exam_date: '',\n        duration_minutes: '',\n        instructions: ''\n      })\n    },\n    onError: (error: any) => {\n      toast.error(error?.message || 'Failed to create exam')\n    }\n  })\n\n  // Submit paper for approval mutation\n  const submitPaperMutation = useMutation({\n    mutationFn: (paperId: string) => paperService.submitForApproval(paperId),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['pending-papers'] })\n      toast.success('Paper submitted for approval successfully!')\n    },\n    onError: (error: any) => {\n      toast.error(error?.message || 'Failed to submit paper')\n    }\n  })\n\n  const subjects = teacherProfile?.subjects || []\n\n  const tabs = [\n    { id: 'create-exam' as TabId, name: 'Create Exam', icon: Plus },\n    { id: 'upload-paper' as TabId, name: 'Upload Paper', icon: Upload },\n    { id: 'my-exams' as TabId, name: 'My Exams', icon: BookOpen },\n    { id: 'pending-approval' as TabId, name: 'Pending Approval', icon: Clock },\n  ]\n\n  const getApprovalBadge = (status: ApprovalStatus) => {\n    switch (status) {\n      case 'approved':\n        return <Badge className=\"bg-green-100 text-green-800\"><CheckCircle className=\"h-3 w-3 mr-1\" />Approved</Badge>\n      case 'pending':\n        return <Badge className=\"bg-yellow-100 text-yellow-800\"><Clock className=\"h-3 w-3 mr-1\" />Pending</Badge>\n      case 'rejected':\n        return <Badge className=\"bg-red-100 text-red-800\"><XCircle className=\"h-3 w-3 mr-1\" />Rejected</Badge>\n      default:\n        return <Badge variant=\"outline\">Draft</Badge>\n    }\n  }\n\n  return (\n    <DashboardLayout allowedRoles={['teacher', 'admin', 'principal']}>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900\">Exam Management</h1>\n            <p className=\"text-gray-600 mt-1\">Create exams and manage exam papers for your classes</p>\n          </div>\n        </div>\n\n        {/* Tab Navigation */}\n        <div className=\"border-b border-gray-200\">\n          <nav className=\"-mb-px flex space-x-8\" aria-label=\"Tabs\">\n            {tabs.map((tab) => {\n              const Icon = tab.icon\n              const pendingCount = tab.id === 'pending-approval' && pendingPapersData?.count ? pendingPapersData.count : 0\n              return (\n                <button\n                  key={tab.id}\n                  onClick={() => setActiveTab(tab.id)}\n                  className={`\n                    ${activeTab === tab.id\n                      ? 'border-blue-500 text-blue-600'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n                    }\n                    whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2\n                  `}\n                >\n                  <Icon className=\"h-5 w-5\" />\n                  {tab.name}\n                  {pendingCount > 0 && (\n                    <Badge className=\"ml-2 bg-yellow-100 text-yellow-800\">{pendingCount}</Badge>\n                  )}\n                </button>\n              )\n            })}\n          </nav>\n        </div>\n\n        {/* Tab Content */}\n        <div className=\"mt-6\">\n          {/* Create Exam Tab */}\n          {activeTab === 'create-exam' && (\n            <Card>\n              <CardHeader>\n                <CardTitle>Create New Exam</CardTitle>\n                <p className=\"text-sm text-gray-600\">Define exam details for your class</p>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-6\">\n                  <div className=\"grid gap-4 md:grid-cols-2\">\n                    <div>\n                      <Label>Class *</Label>\n                      <Select \n                        value={examForm.class_id} \n                        onValueChange={(value) => setExamForm({...examForm, class_id: value})}\n                      >\n                        <SelectTrigger>\n                          <SelectValue placeholder=\"Select Class\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          {classes.map((cls: any) => (\n                            <SelectItem key={cls.id} value={cls.id}>\n                              {cls.name} - {cls.section}\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                    </div>\n\n                    <div>\n                      <Label>Subject *</Label>\n                      <Select \n                        value={examForm.subject} \n                        onValueChange={(value) => setExamForm({...examForm, subject: value})}\n                      >\n                        <SelectTrigger>\n                          <SelectValue placeholder=\"Select Subject\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          {subjects.map((subject: string) => (\n                            <SelectItem key={subject} value={subject}>\n                              {subject}\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                    </div>\n\n                    <div>\n                      <Label>Exam Name *</Label>\n                      <Input\n                        value={examForm.exam_name}\n                        onChange={(e) => setExamForm({...examForm, exam_name: e.target.value})}\n                        placeholder=\"e.g., First Term Examination\"\n                      />\n                    </div>\n\n                    <div>\n                      <Label>Exam Type *</Label>\n                      <Select \n                        value={examForm.exam_type} \n                        onValueChange={(value) => setExamForm({...examForm, exam_type: value})}\n                      >\n                        <SelectTrigger>\n                          <SelectValue />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"term_exam\">Term Exam</SelectItem>\n                          <SelectItem value=\"mid_term\">Mid Term</SelectItem>\n                          <SelectItem value=\"final\">Final Exam</SelectItem>\n                          <SelectItem value=\"quiz\">Quiz</SelectItem>\n                          <SelectItem value=\"assignment\">Assignment</SelectItem>\n                          <SelectItem value=\"annual\">Annual</SelectItem>\n                          <SelectItem value=\"custom\">Custom</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </div>\n\n                    <div>\n                      <Label>Term *</Label>\n                      <Select \n                        value={examForm.term} \n                        onValueChange={(value) => setExamForm({...examForm, term: value})}\n                      >\n                        <SelectTrigger>\n                          <SelectValue />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"First Term\">First Term</SelectItem>\n                          <SelectItem value=\"Second Term\">Second Term</SelectItem>\n                          <SelectItem value=\"Third Term\">Third Term</SelectItem>\n                          <SelectItem value=\"Final\">Final / Annual</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </div>\n\n                    <div>\n                      <Label>Academic Year *</Label>\n                      <Input\n                        type=\"text\"\n                        value={examForm.academic_year}\n                        onChange={(e) => setExamForm({...examForm, academic_year: e.target.value})}\n                        placeholder=\"e.g., 2024-2025\"\n                      />\n                    </div>\n\n                    <div>\n                      <Label>Total Marks *</Label>\n                      <Input\n                        type=\"number\"\n                        value={examForm.total_marks}\n                        onChange={(e) => setExamForm({...examForm, total_marks: parseFloat(e.target.value) || 0})}\n                        min=\"1\"\n                      />\n                    </div>\n\n                    <div>\n                      <Label>Passing Marks *</Label>\n                      <Input\n                        type=\"number\"\n                        value={examForm.passing_marks}\n                        onChange={(e) => setExamForm({...examForm, passing_marks: parseFloat(e.target.value) || 0})}\n                        min=\"0\"\n                        max={examForm.total_marks}\n                      />\n                    </div>\n\n                    <div>\n                      <Label>Exam Date</Label>\n                      <Input\n                        type=\"date\"\n                        value={examForm.exam_date}\n                        onChange={(e) => setExamForm({...examForm, exam_date: e.target.value})}\n                      />\n                    </div>\n\n                    <div>\n                      <Label>Duration (minutes)</Label>\n                      <Input\n                        type=\"number\"\n                        value={examForm.duration_minutes}\n                        onChange={(e) => setExamForm({...examForm, duration_minutes: e.target.value})}\n                        placeholder=\"e.g., 120\"\n                        min=\"1\"\n                      />\n                    </div>\n\n                    <div className=\"md:col-span-2\">\n                      <Label>Instructions</Label>\n                      <Textarea\n                        value={examForm.instructions}\n                        onChange={(e) => setExamForm({...examForm, instructions: e.target.value})}\n                        placeholder=\"Exam instructions or guidelines...\"\n                        rows={4}\n                      />\n                    </div>\n                  </div>\n\n                  <div className=\"flex justify-end gap-3\">\n                    <Button\n                      variant=\"outline\"\n                      onClick={() => {\n                        setIsCreatingExam(false)\n                        setExamForm({\n                          exam_name: '',\n                          exam_type: 'term_exam',\n                          term: 'First Term',\n                          academic_year: new Date().getFullYear().toString(),\n                          class_id: '',\n                          subject: '',\n                          total_marks: 100,\n                          passing_marks: 50,\n                          exam_date: '',\n                          duration_minutes: '',\n                          instructions: ''\n                        })\n                      }}\n                    >\n                      Cancel\n                    </Button>\n                    <Button\n                      onClick={() => {\n                        if (!examForm.exam_name || !examForm.class_id || !examForm.subject) {\n                          toast.error('Please fill all required fields')\n                          return\n                        }\n                        createExamMutation.mutate(examForm)\n                      }}\n                      disabled={createExamMutation.isPending}\n                    >\n                      {createExamMutation.isPending ? 'Creating...' : 'Create Exam'}\n                    </Button>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          {/* Upload Paper Tab */}\n          {activeTab === 'upload-paper' && (\n            <Card>\n              <CardHeader>\n                <CardTitle>Upload Exam Paper</CardTitle>\n                <p className=\"text-sm text-gray-600\">Upload exam papers and submit for approval</p>\n              </CardHeader>\n              <CardContent>\n                <div className=\"text-center py-12 text-gray-500\">\n                  <Upload className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n                  <p className=\"text-lg font-medium mb-2\">Paper Upload</p>\n                  <p>Paper upload functionality will be integrated with the Papers page</p>\n                  <Button \n                    variant=\"outline\" \n                    className=\"mt-4\"\n                    onClick={() => router.push('/admin/papers')}\n                  >\n                    Go to Papers Page\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          {/* My Exams Tab */}\n          {activeTab === 'my-exams' && (\n            <Card>\n              <CardHeader>\n                <CardTitle>My Exams</CardTitle>\n                <p className=\"text-sm text-gray-600\">View and manage your created exams</p>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-4\">\n                  <div className=\"flex justify-between items-center\">\n                    <Select value={selectedClass} onValueChange={setSelectedClass}>\n                      <SelectTrigger className=\"w-64\">\n                        <SelectValue placeholder=\"Filter by Class\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"all\">All Classes</SelectItem>\n                        {classes.map((cls: any) => (\n                          <SelectItem key={cls.id} value={cls.id}>\n                            {cls.name} - {cls.section}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                    <Button onClick={() => setActiveTab('create-exam')}>\n                      <Plus className=\"h-4 w-4 mr-2\" />\n                      Create Exam\n                    </Button>\n                  </div>\n\n                  {exams.length === 0 ? (\n                    <div className=\"text-center py-12 text-gray-500\">\n                      <BookOpen className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n                      <p className=\"text-lg font-medium mb-2\">No Exams Found</p>\n                      <p>Create your first exam to get started</p>\n                    </div>\n                  ) : (\n                    <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\n                      {exams.map((exam: Exam) => (\n                        <Card key={exam.id} className=\"hover:shadow-lg transition-shadow\">\n                          <CardHeader>\n                            <div className=\"flex justify-between items-start\">\n                              <CardTitle className=\"text-lg\">{exam.exam_name}</CardTitle>\n                              <Badge variant=\"outline\">{exam.status}</Badge>\n                            </div>\n                            <p className=\"text-sm text-gray-600\">{exam.subject}</p>\n                          </CardHeader>\n                          <CardContent>\n                            <div className=\"space-y-2 text-sm\">\n                              <div className=\"flex justify-between\">\n                                <span className=\"text-gray-600\">Class:</span>\n                                <span className=\"font-medium\">\n                                  {classesMap.get(exam.class_id) \n                                    ? `${classesMap.get(exam.class_id)!.name} - ${classesMap.get(exam.class_id)!.section}`\n                                    : exam.class_id}\n                                </span>\n                              </div>\n                              <div className=\"flex justify-between\">\n                                <span className=\"text-gray-600\">Term:</span>\n                                <span className=\"font-medium\">{exam.term}</span>\n                              </div>\n                              <div className=\"flex justify-between\">\n                                <span className=\"text-gray-600\">Total Marks:</span>\n                                <span className=\"font-medium\">{exam.total_marks}</span>\n                              </div>\n                              {exam.exam_date && (\n                                <div className=\"flex justify-between\">\n                                  <span className=\"text-gray-600\">Date:</span>\n                                  <span className=\"font-medium\">{new Date(exam.exam_date).toLocaleDateString()}</span>\n                                </div>\n                              )}\n                            </div>\n                            <div className=\"mt-4 flex gap-2\">\n                              <Button\n                                size=\"sm\"\n                                variant=\"outline\"\n                                className=\"flex-1\"\n                                onClick={() => router.push(`/teacher/results?exam_id=${exam.id}`)}\n                              >\n                                <Eye className=\"h-4 w-4 mr-1\" />\n                                View Results\n                              </Button>\n                              {exam.status === 'draft' && (\n                                <Button\n                                  size=\"sm\"\n                                  variant=\"outline\"\n                                  onClick={() => {\n                                    // Navigate to results page to upload results\n                                    router.push(`/teacher/results?exam_id=${exam.id}`)\n                                  }}\n                                >\n                                  <Upload className=\"h-4 w-4\" />\n                                </Button>\n                              )}\n                            </div>\n                          </CardContent>\n                        </Card>\n                      ))}\n                    </div>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          {/* Pending Approval Tab */}\n          {activeTab === 'pending-approval' && (\n            <Card>\n              <CardHeader>\n                <CardTitle>Papers Pending Approval</CardTitle>\n                <p className=\"text-sm text-gray-600\">Track status of submitted papers</p>\n              </CardHeader>\n              <CardContent>\n                {!pendingPapersData || pendingPapersData.papers.length === 0 ? (\n                  <div className=\"text-center py-12 text-gray-500\">\n                    <FileCheck className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n                    <p className=\"text-lg font-medium mb-2\">No Pending Papers</p>\n                    <p>All your papers have been reviewed</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-4\">\n                    {pendingPapersData.papers.map((paper: any) => (\n                      <Card key={paper.id} className=\"border-l-4 border-l-yellow-400\">\n                        <CardContent className=\"p-4\">\n                          <div className=\"flex justify-between items-start\">\n                            <div className=\"flex-1\">\n                              <div className=\"flex items-center gap-3 mb-2\">\n                                <FileText className=\"h-5 w-5 text-blue-600\" />\n                                <h3 className=\"font-semibold\">{paper.file_name}</h3>\n                                {getApprovalBadge(paper.approval_status)}\n                              </div>\n                              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm text-gray-600\">\n                                <div>\n                                  <span className=\"font-medium\">Subject:</span> {paper.subject}\n                                </div>\n                                <div>\n                                  <span className=\"font-medium\">Class:</span> {paper.class_name}\n                                </div>\n                                <div>\n                                  <span className=\"font-medium\">Term:</span> {paper.term}\n                                </div>\n                                <div>\n                                  <span className=\"font-medium\">Year:</span> {paper.year}\n                                </div>\n                              </div>\n                              {paper.rejection_reason && (\n                                <div className=\"mt-2 p-2 bg-red-50 border border-red-200 rounded text-sm text-red-700\">\n                                  <strong>Rejection Reason:</strong> {paper.rejection_reason}\n                                </div>\n                              )}\n                            </div>\n                            <div className=\"flex gap-2\">\n                              {paper.approval_status === 'pending' && (\n                                <Button\n                                  size=\"sm\"\n                                  variant=\"outline\"\n                                  onClick={() => {\n                                    if (confirm('Submit this paper for approval?')) {\n                                      submitPaperMutation.mutate(paper.id)\n                                    }\n                                  }}\n                                  disabled={submitPaperMutation.isPending}\n                                >\n                                  <Send className=\"h-4 w-4 mr-1\" />\n                                  Submit\n                                </Button>\n                              )}\n                              {paper.approval_status === 'rejected' && (\n                                <Button\n                                  size=\"sm\"\n                                  variant=\"outline\"\n                                  onClick={() => router.push('/admin/papers')}\n                                >\n                                  <Edit className=\"h-4 w-4 mr-1\" />\n                                  Edit & Resubmit\n                                </Button>\n                              )}\n                            </div>\n                          </div>\n                        </CardContent>\n                      </Card>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          )}\n        </div>\n      </div>\n    </DashboardLayout>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\teacher\\grades\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useMemo' is defined but never used.","line":3,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'studentService' is defined but never used.","line":16,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Trash2' is defined but never used.","line":19,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":47},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Award' is defined but never used.","line":19,"column":49,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":54},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Medal' is defined but never used.","line":19,"column":64,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":69},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'router' is assigned a value but never used.","line":24,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":96,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":96,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3762,3765],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3762,3765],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":102,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":102,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3956,3959],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3956,3959],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":108,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":108,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4194,4197],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4194,4197],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":192,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":192,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6786,6789],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6786,6789],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useMemo } from 'react'\nimport { useRouter, useSearchParams } from 'next/navigation'\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { Badge } from '@/components/ui/badge'\nimport { toast } from '@/components/ui/toast'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { teacherService } from '@/services/teacherService'\nimport { classService } from '@/services/classService'\nimport { studentService } from '@/services/studentService'\nimport { gradeService } from '@/services/gradeService'\nimport { \n  FileText, Users, Plus, Save, X, Edit, Trash2, Award, Trophy, Medal\n} from 'lucide-react'\nimport { Grade, Student } from '@/types'\n\nexport default function TeacherGradesPage() {\n  const router = useRouter()\n  const searchParams = useSearchParams()\n  const queryClient = useQueryClient()\n  const [selectedClassId, setSelectedClassId] = useState<string>(searchParams.get('class_id') || '')\n  const [selectedSubject, setSelectedSubject] = useState<string>('')\n  const [selectedTerm, setSelectedTerm] = useState<string>('First Term')\n  const [selectedYear, setSelectedYear] = useState<string>(new Date().getFullYear().toString())\n  const [editingGrade, setEditingGrade] = useState<{ studentId: string; subject: string; grade?: Grade } | null>(null)\n  const [gradeData, setGradeData] = useState<Record<string, { marks: number | ''; grade: string }>>({})\n\n  // Fetch teacher's classes\n  const { data: classes = [] } = useQuery({\n    queryKey: ['my-classes'],\n    queryFn: () => teacherService.getMyClasses(),\n  })\n\n  // Fetch teacher profile for subjects\n  const { data: teacherProfile } = useQuery({\n    queryKey: ['teacher-profile'],\n    queryFn: () => teacherService.getMyProfile(),\n  })\n\n  // Fetch students for selected class\n  const { data: students = [] } = useQuery({\n    queryKey: ['class-students', selectedClassId],\n    queryFn: () => classService.getClassStudents(selectedClassId),\n    enabled: !!selectedClassId,\n  })\n\n  // Fetch existing grades\n  const { data: existingGrades = [] } = useQuery({\n    queryKey: ['grades', selectedClassId, selectedSubject, selectedTerm, selectedYear],\n    queryFn: () => gradeService.getGrades({\n      class_id: selectedClassId || undefined,\n      subject: selectedSubject || undefined,\n      term: selectedTerm || undefined,\n      academic_year: selectedYear || undefined,\n      limit: 1000,\n    }),\n    enabled: !!selectedClassId && !!selectedSubject,\n  })\n\n  // Fetch positions\n  const { data: positionsData } = useQuery({\n    queryKey: ['positions', selectedClassId, selectedTerm, selectedYear],\n    queryFn: () => {\n      if (!selectedClassId || !selectedTerm || !selectedYear) return null\n      return gradeService.getPositions({\n        class_id: selectedClassId,\n        term: selectedTerm,\n        academic_year: selectedYear,\n        top_n: 3\n      })\n    },\n    enabled: !!selectedClassId && !!selectedTerm && !!selectedYear,\n  })\n\n  const createGradeMutation = useMutation({\n    mutationFn: (data: {\n      student_id: string\n      class_id: string\n      subject: string\n      marks: number\n      grade: string\n      term: string\n      academic_year: string\n    }) => gradeService.createGrade(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['grades'] })\n      toast.success('Grade created successfully!')\n      setEditingGrade(null)\n    },\n    onError: (error: any) => {\n      toast.error(error?.response?.data?.detail || 'Failed to create grade')\n    }\n  })\n\n  const updateGradeMutation = useMutation({\n    mutationFn: ({ id, data }: { id: string; data: any }) => gradeService.updateGrade(id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['grades'] })\n      toast.success('Grade updated successfully!')\n      setEditingGrade(null)\n    },\n    onError: (error: any) => {\n      toast.error(error?.response?.data?.detail || 'Failed to update grade')\n    }\n  })\n\n  const calculateGrade = (marks: number): string => {\n    if (marks >= 90) return 'A+'\n    if (marks >= 80) return 'A'\n    if (marks >= 70) return 'B+'\n    if (marks >= 60) return 'B'\n    if (marks >= 50) return 'C+'\n    if (marks >= 40) return 'C'\n    if (marks >= 33) return 'D'\n    return 'F'\n  }\n\n  const getGradeColor = (grade: string) => {\n    switch (grade) {\n      case 'A+': case 'A': return 'bg-green-100 text-green-800'\n      case 'B+': case 'B': return 'bg-blue-100 text-blue-800'\n      case 'C+': case 'C': return 'bg-yellow-100 text-yellow-800'\n      case 'D': return 'bg-orange-100 text-orange-800'\n      case 'F': return 'bg-red-100 text-red-800'\n      default: return 'bg-gray-100 text-gray-800'\n    }\n  }\n\n  const handleSaveGrade = (studentId: string) => {\n    const data = gradeData[studentId]\n    if (!data || data.marks === '') {\n      toast.error('Please enter marks')\n      return\n    }\n\n    const marks = Number(data.marks)\n    if (marks < 0 || marks > 100) {\n      toast.error('Marks must be between 0 and 100')\n      return\n    }\n\n    const grade = calculateGrade(marks)\n    const gradeEntry = editingGrade?.grade\n\n    if (gradeEntry) {\n      updateGradeMutation.mutate({\n        id: gradeEntry.id,\n        data: { marks, grade }\n      })\n    } else {\n      createGradeMutation.mutate({\n        student_id: studentId,\n        class_id: selectedClassId,\n        subject: selectedSubject,\n        marks,\n        grade,\n        term: selectedTerm,\n        academic_year: selectedYear,\n      })\n    }\n  }\n\n  const subjects = teacherProfile?.subjects || []\n\n  return (\n    <DashboardLayout allowedRoles={['teacher']}>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div>\n          <h1 className=\"text-3xl font-bold text-gray-900\">Enter Grades</h1>\n          <p className=\"text-gray-600 mt-1\">Enter and manage grades for your classes</p>\n        </div>\n\n        {/* Filters */}\n        <Card>\n          <CardContent className=\"p-6\">\n            <div className=\"grid gap-4 md:grid-cols-4\">\n              <div>\n                <Label>Class</Label>\n                <Select value={selectedClassId || \"all\"} onValueChange={(value) => setSelectedClassId(value === \"all\" ? '' : value)}>\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"Select Class\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">Select Class</SelectItem>\n                    {classes.map((cls: any) => (\n                      <SelectItem key={cls.id} value={cls.id}>\n                        {cls.name} - {cls.section}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n              <div>\n                <Label>Subject</Label>\n                <Select value={selectedSubject || \"all\"} onValueChange={(value) => setSelectedSubject(value === \"all\" ? '' : value)}>\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"Select Subject\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">Select Subject</SelectItem>\n                    {subjects.map((subject: string) => (\n                      <SelectItem key={subject} value={subject}>\n                        {subject}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n              <div>\n                <Label>Term</Label>\n                <Select value={selectedTerm} onValueChange={setSelectedTerm}>\n                  <SelectTrigger>\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"First Term\">First Term</SelectItem>\n                    <SelectItem value=\"Second Term\">Second Term</SelectItem>\n                    <SelectItem value=\"Third Term\">Third Term</SelectItem>\n                    <SelectItem value=\"Final\">Final</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n              <div>\n                <Label>Academic Year</Label>\n                <Input\n                  type=\"text\"\n                  value={selectedYear}\n                  onChange={(e) => setSelectedYear(e.target.value)}\n                  placeholder=\"Year\"\n                />\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Top Positions Section */}\n        {positionsData && positionsData.positions.length > 0 && selectedClassId && (\n          <Card className=\"bg-gradient-to-r from-yellow-50 to-amber-50 border-yellow-200\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Trophy className=\"h-5 w-5 text-yellow-600\" />\n                Top 3 Positions - {selectedTerm}\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                {positionsData.positions.map((pos, index) => {\n                  const medalColors = [\n                    { bg: 'bg-yellow-100', border: 'border-yellow-400', text: 'text-yellow-800', icon: 'text-yellow-600' },\n                    { bg: 'bg-gray-100', border: 'border-gray-400', text: 'text-gray-800', icon: 'text-gray-600' },\n                    { bg: 'bg-orange-100', border: 'border-orange-400', text: 'text-orange-800', icon: 'text-orange-600' }\n                  ]\n                  const colors = medalColors[index] || medalColors[2]\n                  const positionLabels = ['1st', '2nd', '3rd']\n                  \n                  return (\n                    <div\n                      key={pos.student_id}\n                      className={`${colors.bg} ${colors.border} border-2 rounded-lg p-4`}\n                    >\n                      <div className=\"flex items-center gap-3 mb-2\">\n                        <div className={`${colors.bg} ${colors.border} border-2 rounded-full w-10 h-10 flex items-center justify-center font-bold ${colors.text}`}>\n                          {positionLabels[index] || pos.position}\n                        </div>\n                        <div className=\"flex-1\">\n                          <h4 className=\"font-bold text-lg\">{pos.student_name}</h4>\n                          <p className=\"text-sm opacity-75\">{pos.admission_number}</p>\n                        </div>\n                      </div>\n                      <div className=\"space-y-1 mt-3\">\n                        <div className=\"flex justify-between text-sm\">\n                          <span className=\"opacity-75\">Average:</span>\n                          <span className={`font-bold ${colors.text}`}>{pos.average_marks.toFixed(1)}%</span>\n                        </div>\n                        <div className=\"flex justify-between text-sm\">\n                          <span className=\"opacity-75\">Subjects:</span>\n                          <span>{pos.passed_subjects}/{pos.total_subjects} Passed</span>\n                        </div>\n                      </div>\n                    </div>\n                  )\n                })}\n              </div>\n              {positionsData.class_average && (\n                <div className=\"mt-4 pt-4 border-t border-yellow-300\">\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"font-medium\">Class Average:</span>\n                    <span className=\"font-bold text-lg\">{positionsData.class_average.toFixed(1)}%</span>\n                  </div>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Grades Table */}\n        {selectedClassId && selectedSubject ? (\n          <Card>\n            <CardHeader>\n              <CardTitle>Enter Grades - {selectedSubject}</CardTitle>\n            </CardHeader>\n            <CardContent>\n              {students.length === 0 ? (\n                <div className=\"text-center py-8 text-gray-500\">No students in this class</div>\n              ) : (\n                <div className=\"overflow-x-auto\">\n                  <table className=\"w-full\">\n                    <thead>\n                      <tr className=\"border-b\">\n                        <th className=\"text-left py-3 px-4\">Student</th>\n                        <th className=\"text-center py-3 px-4\">Marks</th>\n                        <th className=\"text-center py-3 px-4\">Grade</th>\n                        <th className=\"text-center py-3 px-4\">Actions</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {students.map((student: Student) => {\n                        const existingGrade = existingGrades.find((g: Grade) => g.student_id === student.id)\n                        const isEditing = editingGrade?.studentId === student.id && editingGrade?.subject === selectedSubject\n                        \n                        return (\n                          <tr key={student.id} className=\"border-b hover:bg-gray-50\">\n                            <td className=\"py-3 px-4\">\n                              <div className=\"flex items-center gap-3\">\n                                <Users className=\"h-4 w-4 text-blue-600\" />\n                                <div>\n                                  <div className=\"font-medium\">{student.user?.full_name || 'Unknown'}</div>\n                                  <div className=\"text-sm text-gray-600\">{student.admission_number}</div>\n                                </div>\n                              </div>\n                            </td>\n                            <td className=\"py-3 px-4 text-center\">\n                              {isEditing ? (\n                                <Input\n                                  type=\"number\"\n                                  min=\"0\"\n                                  max=\"100\"\n                                  value={gradeData[student.id]?.marks || existingGrade?.marks || ''}\n                                  onChange={(e) => {\n                                    const marks = e.target.value === '' ? '' : Number(e.target.value)\n                                    const grade = marks !== '' ? calculateGrade(Number(marks)) : ''\n                                    setGradeData(prev => ({\n                                      ...prev,\n                                      [student.id]: { marks, grade }\n                                    }))\n                                  }}\n                                  className=\"w-20 text-center mx-auto\"\n                                  autoFocus\n                                />\n                              ) : (\n                                <span className=\"font-medium\">\n                                  {existingGrade ? `${existingGrade.marks}/100` : '-'}\n                                </span>\n                              )}\n                            </td>\n                            <td className=\"py-3 px-4 text-center\">\n                              {isEditing ? (\n                                <Badge className={getGradeColor(gradeData[student.id]?.grade || 'F')}>\n                                  {gradeData[student.id]?.grade || '-'}\n                                </Badge>\n                              ) : existingGrade ? (\n                                <Badge className={getGradeColor(existingGrade.grade)}>\n                                  {existingGrade.grade}\n                                </Badge>\n                              ) : (\n                                '-'\n                              )}\n                            </td>\n                            <td className=\"py-3 px-4 text-center\">\n                              {isEditing ? (\n                                <div className=\"flex justify-center gap-1\">\n                                  <Button\n                                    size=\"sm\"\n                                    onClick={() => handleSaveGrade(student.id)}\n                                    disabled={createGradeMutation.isPending || updateGradeMutation.isPending}\n                                  >\n                                    <Save className=\"h-4 w-4\" />\n                                  </Button>\n                                  <Button\n                                    size=\"sm\"\n                                    variant=\"outline\"\n                                    onClick={() => {\n                                      setEditingGrade(null)\n                                      setGradeData(prev => {\n                                        const newData = { ...prev }\n                                        delete newData[student.id]\n                                        return newData\n                                      })\n                                    }}\n                                  >\n                                    <X className=\"h-4 w-4\" />\n                                  </Button>\n                                </div>\n                              ) : (\n                                <Button\n                                  size=\"sm\"\n                                  variant=\"outline\"\n                                  onClick={() => {\n                                    setEditingGrade({ studentId: student.id, subject: selectedSubject, grade: existingGrade })\n                                    if (existingGrade) {\n                                      setGradeData(prev => ({\n                                        ...prev,\n                                        [student.id]: { marks: existingGrade.marks, grade: existingGrade.grade }\n                                      }))\n                                    }\n                                  }}\n                                >\n                                  {existingGrade ? <Edit className=\"h-4 w-4\" /> : <Plus className=\"h-4 w-4\" />}\n                                </Button>\n                              )}\n                            </td>\n                          </tr>\n                        )\n                      })}\n                    </tbody>\n                  </table>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        ) : (\n          <Card>\n            <CardContent className=\"p-12 text-center\">\n              <FileText className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n              <p className=\"text-lg font-medium text-gray-600 mb-2\">Select Class and Subject</p>\n              <p className=\"text-gray-500\">Choose a class and subject to enter grades</p>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n    </DashboardLayout>\n  )\n}\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\teacher\\papers\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'PaperCreate' is defined but never used.","line":11,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":42},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'filterPapers'. Either include it or remove the dependency array.","line":71,"column":6,"nodeType":"ArrayExpression","endLine":71,"endColumn":50,"suggestions":[{"desc":"Update the dependencies array to be: [filterPapers, papers, searchTerm, termFilter, yearFilter]","fix":{"range":[2358,2402],"text":"[filterPapers, papers, searchTerm, termFilter, yearFilter]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":79,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":79,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2633,2636],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2633,2636],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":91,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":91,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2964,2967],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2964,2967],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":129,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":129,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4169,4172],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4169,4172],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":167,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":167,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5212,5215],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5212,5215],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\n\nimport React, { useState, useEffect } from \"react\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { FileText, Plus, Search, Filter, Calendar, Download, Edit, Trash2, Upload, BookOpen, GraduationCap } from \"lucide-react\";\nimport { paperService, Paper, PaperCreate, PaperStats } from \"@/services/paperService\";\nimport { toast } from \"@/components/ui/toast\";\nimport { ConfirmDialog } from '@/components/shared/ConfirmDialog';\n\ninterface PaperFormData {\n  class_id: string;\n  class_name: string;\n  subject: string;\n  term: string;\n  year: number;\n  file_url: string;\n  file_name: string;\n  file_type: string;\n  file_size?: number;\n  description?: string;\n}\n\nconst termColors = {\n  first_term: \"bg-blue-100 text-blue-800\",\n  second_term: \"bg-green-100 text-green-800\",\n  third_term: \"bg-purple-100 text-purple-800\",\n};\n\nconst termLabels = {\n  first_term: \"First Term\",\n  second_term: \"Second Term\",\n  third_term: \"Third Term\",\n};\n\nexport default function TeacherPapersPage() {\n  const [papers, setPapers] = useState<Paper[]>([]);\n  const [filteredPapers, setFilteredPapers] = useState<Paper[]>([]);\n  const [stats, setStats] = useState<PaperStats | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [termFilter, setTermFilter] = useState(\"all_items\");\n  const [yearFilter, setYearFilter] = useState(\"all_items\");\n  const [isFormOpen, setIsFormOpen] = useState(false);\n  const [editingPaper, setEditingPaper] = useState<Paper | null>(null);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [uploadedFile, setUploadedFile] = useState<File | null>(null);\n  const [confirmDialog, setConfirmDialog] = useState<{\n    open: boolean\n    title: string\n    description: string\n    onConfirm: () => void\n  }>({\n    open: false,\n    title: '',\n    description: '',\n    onConfirm: () => {},\n  });\n\n  useEffect(() => {\n    fetchPapers();\n    fetchStats();\n  }, []);\n\n  useEffect(() => {\n    filterPapers();\n  }, [papers, searchTerm, termFilter, yearFilter]);\n\n  const fetchPapers = async () => {\n    try {\n      setIsLoading(true);\n      // Teacher endpoint will automatically filter by their ID\n      const data = await paperService.getAll();\n      setPapers(data);\n    } catch (error: any) {\n      console.error(\"Failed to fetch papers:\", error);\n      toast.error(error.response?.data?.detail || \"Failed to fetch papers\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const fetchStats = async () => {\n    try {\n      const data = await paperService.getStats();\n      setStats(data);\n    } catch (error: any) {\n      console.error(\"Failed to fetch stats:\", error);\n    }\n  };\n\n  const filterPapers = () => {\n    let filtered = papers;\n\n    if (searchTerm) {\n      filtered = filtered.filter(paper =>\n        paper.subject.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        paper.class_name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        paper.file_name.toLowerCase().includes(searchTerm.toLowerCase())\n      );\n    }\n\n    if (termFilter && termFilter !== \"all_items\") {\n      filtered = filtered.filter(paper => paper.term === termFilter);\n    }\n\n    if (yearFilter && yearFilter !== \"all_items\") {\n      filtered = filtered.filter(paper => paper.year.toString() === yearFilter);\n    }\n\n    setFilteredPapers(filtered);\n  };\n\n  const handleDeletePaper = async (id: string) => {\n    setConfirmDialog({\n      open: true,\n      title: 'Delete Paper',\n      description: 'Are you sure you want to delete this paper? This action cannot be undone.',\n      onConfirm: async () => {\n        try {\n          await paperService.delete(id);\n          setPapers(papers.filter(p => p.id !== id));\n          toast.success(\"Paper deleted successfully\");\n          fetchStats();\n        } catch (error: any) {\n          console.error(\"Failed to delete paper:\", error);\n          toast.error(error.response?.data?.detail || \"Failed to delete paper\");\n        }\n      },\n    });\n  };\n\n  const handleCreatePaper = () => {\n    setEditingPaper(null);\n    setUploadedFile(null);\n    setIsFormOpen(true);\n  };\n\n  const handleEditPaper = (paper: Paper) => {\n    setEditingPaper(paper);\n    setUploadedFile(null);\n    setIsFormOpen(true);\n  };\n\n  const handleFormSubmit = async (data: PaperFormData) => {\n    try {\n      setIsSubmitting(true);\n\n      if (editingPaper) {\n        const updated = await paperService.update(editingPaper.id, data);\n        setPapers(papers.map(p => p.id === updated.id ? updated : p));\n        alert(\"Paper updated successfully\");\n      } else {\n        const created = await paperService.create(data);\n        setPapers([created, ...papers]);\n        alert(\"Paper uploaded successfully\");\n      }\n\n      setIsFormOpen(false);\n      setEditingPaper(null);\n      setUploadedFile(null);\n      fetchStats();\n    } catch (error: any) {\n      console.error(\"Failed to save paper:\", error);\n      alert(error.response?.data?.detail || \"Failed to save paper\");\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const handleDownload = (paper: Paper) => {\n    window.open(paper.file_url, '_blank');\n  };\n\n  const uniqueYears = Array.from(new Set(papers.map(p => p.year.toString()))).sort().reverse();\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-3xl font-bold text-gray-900\">My Exam Papers</h1>\n          <p className=\"text-gray-600 mt-1\">\n            Upload and manage your exam papers\n          </p>\n        </div>\n        <Button\n          className=\"bg-blue-600 hover:bg-blue-700 text-white\"\n          onClick={handleCreatePaper}\n        >\n          <Plus className=\"h-4 w-4 mr-2\" />\n          Upload Paper\n        </Button>\n      </div>\n\n      {/* Statistics */}\n      {stats && (\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center\">\n                <FileText className=\"h-8 w-8 text-blue-600\" />\n                <div className=\"ml-4\">\n                  <p className=\"text-sm font-medium text-gray-600\">My Papers</p>\n                  <p className=\"text-2xl font-bold text-gray-900\">{stats.total_papers}</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center\">\n                <Upload className=\"h-8 w-8 text-green-600\" />\n                <div className=\"ml-4\">\n                  <p className=\"text-sm font-medium text-gray-600\">Recent Uploads</p>\n                  <p className=\"text-2xl font-bold text-gray-900\">{stats.recent_uploads}</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center\">\n                <BookOpen className=\"h-8 w-8 text-purple-600\" />\n                <div className=\"ml-4\">\n                  <p className=\"text-sm font-medium text-gray-600\">Subjects</p>\n                  <p className=\"text-2xl font-bold text-gray-900\">\n                    {Object.keys(stats.papers_by_subject).length}\n                  </p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      )}\n\n      {/* Filters */}\n      <Card>\n        <CardContent className=\"p-6\">\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n            <div className=\"relative\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4\" />\n              <Input\n                placeholder=\"Search papers...\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"pl-10\"\n              />\n            </div>\n\n            <Select value={termFilter} onValueChange={setTermFilter}>\n              <SelectTrigger>\n                <SelectValue placeholder=\"All Terms\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all_items\">All Terms</SelectItem>\n                <SelectItem value=\"first_term\">First Term</SelectItem>\n                <SelectItem value=\"second_term\">Second Term</SelectItem>\n                <SelectItem value=\"third_term\">Third Term</SelectItem>\n              </SelectContent>\n            </Select>\n\n            <Select value={yearFilter} onValueChange={setYearFilter}>\n              <SelectTrigger>\n                <SelectValue placeholder=\"All Years\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all_items\">All Years</SelectItem>\n                {uniqueYears.map(year => (\n                  <SelectItem key={year} value={year}>{year}</SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n\n            <Button\n              variant=\"outline\"\n              onClick={() => {\n                setSearchTerm(\"\");\n                setTermFilter(\"all_items\");\n                setYearFilter(\"all_items\");\n              }}\n              className=\"flex items-center gap-2\"\n            >\n              <Filter className=\"h-4 w-4\" />\n              Clear\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Papers List */}\n      <div className=\"space-y-4\">\n        {isLoading ? (\n          <div className=\"flex justify-center items-center py-12\">\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          </div>\n        ) : filteredPapers.length === 0 ? (\n          <Card>\n            <CardContent className=\"p-12 text-center\">\n              <FileText className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n              <h3 className=\"text-lg font-medium text-gray-900 mb-2\">No papers found</h3>\n              <p className=\"text-gray-600\">\n                {searchTerm || termFilter || yearFilter\n                  ? \"Try adjusting your filters to see more results.\"\n                  : \"Upload your first exam paper to get started.\"}\n              </p>\n            </CardContent>\n          </Card>\n        ) : (\n          filteredPapers.map((paper) => (\n            <Card key={paper.id} className=\"hover:shadow-lg transition-shadow\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex justify-between items-start\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center gap-3 mb-2\">\n                      <FileText className=\"h-5 w-5 text-blue-600\" />\n                      <h3 className=\"text-lg font-semibold text-gray-900\">\n                        {paper.subject}\n                      </h3>\n                      <Badge className={termColors[paper.term as keyof typeof termColors]}>\n                        {termLabels[paper.term as keyof typeof termLabels]}\n                      </Badge>\n                      <Badge className=\"bg-gray-100 text-gray-800\">\n                        {paper.year}\n                      </Badge>\n                    </div>\n\n                    <div className=\"flex items-center gap-4 text-sm text-gray-600 mb-2\">\n                      <div className=\"flex items-center gap-1\">\n                        <GraduationCap className=\"h-4 w-4\" />\n                        <span>{paper.class_name}</span>\n                      </div>\n                      <div className=\"flex items-center gap-1\">\n                        <Calendar className=\"h-4 w-4\" />\n                        <span>{new Date(paper.upload_date).toLocaleDateString()}</span>\n                      </div>\n                    </div>\n\n                    <div className=\"text-sm text-gray-700\">\n                      <span className=\"font-medium\">File:</span> {paper.file_name}\n                      {paper.file_size && (\n                        <span className=\"ml-2 text-gray-500\">\n                          ({(paper.file_size / 1024 / 1024).toFixed(2)} MB)\n                        </span>\n                      )}\n                    </div>\n\n                    {paper.description && (\n                      <p className=\"text-sm text-gray-600 mt-2\">{paper.description}</p>\n                    )}\n                  </div>\n\n                  <div className=\"flex items-center gap-2 ml-4\">\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => handleDownload(paper)}\n                      className=\"text-green-600 hover:text-green-700\"\n                    >\n                      <Download className=\"h-4 w-4\" />\n                    </Button>\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => handleEditPaper(paper)}\n                    >\n                      <Edit className=\"h-4 w-4\" />\n                    </Button>\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => handleDeletePaper(paper.id)}\n                      className=\"text-red-600 hover:text-red-700\"\n                    >\n                      <Trash2 className=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          ))\n        )}\n      </div>\n\n      {/* Paper Form Dialog */}\n      <Dialog open={isFormOpen} onOpenChange={setIsFormOpen}>\n        <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>\n              {editingPaper ? \"Edit Paper\" : \"Upload New Paper\"}\n            </DialogTitle>\n          </DialogHeader>\n          <PaperFormDialog\n            onSubmit={handleFormSubmit}\n            initialData={editingPaper ? {\n              class_id: editingPaper.class_id,\n              class_name: editingPaper.class_name,\n              subject: editingPaper.subject,\n              term: editingPaper.term,\n              year: editingPaper.year,\n              file_url: editingPaper.file_url,\n              file_name: editingPaper.file_name,\n              file_type: editingPaper.file_type,\n              file_size: editingPaper.file_size,\n              description: editingPaper.description,\n            } : undefined}\n            isLoading={isSubmitting}\n            mode={editingPaper ? \"edit\" : \"create\"}\n            uploadedFile={uploadedFile}\n            setUploadedFile={setUploadedFile}\n          />\n        </DialogContent>\n      </Dialog>\n\n      {/* Confirm Dialog */}\n      <ConfirmDialog\n        open={confirmDialog.open}\n        onOpenChange={(open) => setConfirmDialog({ ...confirmDialog, open })}\n        title={confirmDialog.title}\n        description={confirmDialog.description}\n        onConfirm={confirmDialog.onConfirm}\n        variant=\"destructive\"\n      />\n    </div>\n  );\n}\n\n// Paper form component (reused from admin)\nfunction PaperFormDialog({\n  onSubmit,\n  initialData,\n  isLoading,\n  mode,\n  uploadedFile,\n  setUploadedFile,\n}: {\n  onSubmit: (data: PaperFormData) => Promise<void>;\n  initialData?: Partial<PaperFormData>;\n  isLoading?: boolean;\n  mode?: \"create\" | \"edit\";\n  uploadedFile: File | null;\n  setUploadedFile: (file: File | null) => void;\n}) {\n  const [formData, setFormData] = useState<PaperFormData>({\n    class_id: initialData?.class_id || \"\",\n    class_name: initialData?.class_name || \"\",\n    subject: initialData?.subject || \"\",\n    term: initialData?.term || \"first_term\",\n    year: initialData?.year || new Date().getFullYear(),\n    file_url: initialData?.file_url || \"\",\n    file_name: initialData?.file_name || \"\",\n    file_type: initialData?.file_type || \"\",\n    file_size: initialData?.file_size,\n    description: initialData?.description || \"\",\n  });\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isUploading, setIsUploading] = useState(false);\n\n  const validate = () => {\n    const newErrors: Record<string, string> = {};\n\n    if (!formData.class_name.trim()) {\n      newErrors.class_name = \"Class name is required\";\n    }\n    if (!formData.subject.trim()) {\n      newErrors.subject = \"Subject is required\";\n    }\n    if (!formData.year) {\n      newErrors.year = \"Year is required\";\n    }\n    if (!formData.file_url && !uploadedFile) {\n      newErrors.file = \"Please upload a file\";\n    }\n\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      const allowedTypes = [\n        'application/pdf',\n        'application/msword',\n        'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n        'image/jpeg',\n        'image/png',\n        'image/jpg'\n      ];\n\n      if (!allowedTypes.includes(file.type)) {\n        alert(\"Please upload PDF, Word, or Image files only\");\n        return;\n      }\n\n      if (file.size > 10 * 1024 * 1024) {\n        toast.error(\"File size must be less than 10MB\");\n        return;\n      }\n\n      setUploadedFile(file);\n      setFormData({\n        ...formData,\n        file_name: file.name,\n        file_type: file.type,\n        file_size: file.size,\n      });\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validate()) {\n      return;\n    }\n\n    const finalFormData = { ...formData };\n    \n    if (uploadedFile) {\n      setIsUploading(true);\n      try {\n        const mockUrl = `/uploads/papers/${Date.now()}_${uploadedFile.name}`;\n        finalFormData.file_url = mockUrl;\n      } catch (error) {\n        toast.error(\"Failed to upload file\");\n        setIsUploading(false);\n        return;\n      }\n      setIsUploading(false);\n    }\n\n    await onSubmit(finalFormData);\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\n      <div className=\"grid grid-cols-2 gap-4\">\n        <div className=\"space-y-2\">\n          <label className=\"text-sm font-medium\">Class Name *</label>\n          <Input\n            value={formData.class_name}\n            onChange={(e) => setFormData({ ...formData, class_name: e.target.value, class_id: e.target.value.toLowerCase().replace(/\\s+/g, '-') })}\n            placeholder=\"e.g., Class 10-A\"\n            className={errors.class_name ? \"border-red-500\" : \"\"}\n          />\n          {errors.class_name && <p className=\"text-sm text-red-600\">{errors.class_name}</p>}\n        </div>\n\n        <div className=\"space-y-2\">\n          <label className=\"text-sm font-medium\">Subject *</label>\n          <Input\n            value={formData.subject}\n            onChange={(e) => setFormData({ ...formData, subject: e.target.value })}\n            placeholder=\"e.g., Mathematics\"\n            className={errors.subject ? \"border-red-500\" : \"\"}\n          />\n          {errors.subject && <p className=\"text-sm text-red-600\">{errors.subject}</p>}\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-2 gap-4\">\n        <div className=\"space-y-2\">\n          <label className=\"text-sm font-medium\">Term *</label>\n          <Select\n            value={formData.term}\n            onValueChange={(value) => setFormData({ ...formData, term: value })}\n          >\n            <SelectTrigger>\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"first_term\">First Term</SelectItem>\n              <SelectItem value=\"second_term\">Second Term</SelectItem>\n              <SelectItem value=\"third_term\">Third Term</SelectItem>\n            </SelectContent>\n          </Select>\n        </div>\n\n        <div className=\"space-y-2\">\n          <label className=\"text-sm font-medium\">Year *</label>\n          <Input\n            type=\"number\"\n            value={formData.year}\n            onChange={(e) => setFormData({ ...formData, year: parseInt(e.target.value) })}\n            min={2020}\n            max={2100}\n            className={errors.year ? \"border-red-500\" : \"\"}\n          />\n          {errors.year && <p className=\"text-sm text-red-600\">{errors.year}</p>}\n        </div>\n      </div>\n\n      <div className=\"space-y-2\">\n        <label className=\"text-sm font-medium\">Upload File * (PDF, Word, or Image)</label>\n        <Input\n          type=\"file\"\n          onChange={handleFileChange}\n          accept=\".pdf,.doc,.docx,.jpg,.jpeg,.png\"\n          className={errors.file ? \"border-red-500\" : \"\"}\n        />\n        {uploadedFile && (\n          <p className=\"text-sm text-green-600\">\n            Selected: {uploadedFile.name} ({(uploadedFile.size / 1024 / 1024).toFixed(2)} MB)\n          </p>\n        )}\n        {formData.file_name && !uploadedFile && (\n          <p className=\"text-sm text-gray-600\">\n            Current file: {formData.file_name}\n          </p>\n        )}\n        {errors.file && <p className=\"text-sm text-red-600\">{errors.file}</p>}\n      </div>\n\n      <div className=\"space-y-2\">\n        <label className=\"text-sm font-medium\">Description (Optional)</label>\n        <textarea\n          value={formData.description}\n          onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n          placeholder=\"Add any additional notes about this paper...\"\n          rows={3}\n          className=\"w-full rounded-md border px-3 py-2 text-sm border-gray-300\"\n        />\n      </div>\n\n      <div className=\"flex justify-end space-x-4 pt-4\">\n        <Button\n          type=\"button\"\n          variant=\"outline\"\n          onClick={() => window.location.reload()}\n        >\n          Cancel\n        </Button>\n        <Button\n          type=\"submit\"\n          disabled={isLoading || isUploading}\n          className=\"bg-blue-600 hover:bg-blue-700 text-white\"\n        >\n          {isLoading || isUploading ? \"Processing...\" : mode === \"create\" ? \"Upload Paper\" : \"Update Paper\"}\n        </Button>\n      </div>\n    </form>\n  );\n}\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\teacher\\profile\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'classService' is defined but never used.","line":12,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":22},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":19,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[928,931],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[928,931],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":35,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1390,1393],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1390,1393],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":41,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1661,1664],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1661,1664],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":226,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":226,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8569,8572],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8569,8572],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Label } from '@/components/ui/label'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\r\nimport { teacherService } from '@/services/teacherService'\r\nimport { classService } from '@/services/classService'\r\nimport { Edit, Save, X, Mail, Phone, MapPin, Calendar, GraduationCap, BookOpen } from 'lucide-react'\r\nimport { formatDate } from '@/lib/utils'\r\nimport { toast } from '@/components/ui/toast'\r\n\r\nexport default function TeacherProfilePage() {\r\n  const [isEditing, setIsEditing] = useState(false)\r\n  const [editedData, setEditedData] = useState<any>(null)\r\n  const queryClient = useQueryClient()\r\n\r\n  // Fetch teacher profile\r\n  const { data: teacherProfile, isLoading } = useQuery({\r\n    queryKey: ['teacher-profile'],\r\n    queryFn: () => teacherService.getMyProfile(),\r\n  })\r\n\r\n  // Fetch assigned classes\r\n  const { data: classes = [] } = useQuery({\r\n    queryKey: ['my-classes'],\r\n    queryFn: () => teacherService.getMyClasses(),\r\n  })\r\n\r\n  const updateMutation = useMutation({\r\n    mutationFn: (data: any) => teacherService.updateTeacher(teacherProfile!.id, data),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['teacher-profile'] })\r\n      toast.success('Profile updated successfully!')\r\n      setIsEditing(false)\r\n    },\r\n    onError: (error: any) => {\r\n      toast.error(error?.response?.data?.detail || 'Failed to update profile')\r\n    }\r\n  })\r\n\r\n  const handleStartEdit = () => {\r\n    if (teacherProfile) {\r\n      setEditedData({\r\n        phone: teacherProfile.user?.phone || '',\r\n        address: teacherProfile.user?.address || '',\r\n      })\r\n      setIsEditing(true)\r\n    }\r\n  }\r\n\r\n  const handleSave = () => {\r\n    if (editedData) {\r\n      updateMutation.mutate({\r\n        phone: editedData.phone,\r\n        address: editedData.address,\r\n      })\r\n    }\r\n  }\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <DashboardLayout allowedRoles={['teacher']}>\r\n        <div className=\"text-center py-12 text-gray-500\">Loading profile...</div>\r\n      </DashboardLayout>\r\n    )\r\n  }\r\n\r\n  if (!teacherProfile) {\r\n    return (\r\n      <DashboardLayout allowedRoles={['teacher']}>\r\n        <div className=\"text-center py-12 text-gray-500\">Profile not found</div>\r\n      </DashboardLayout>\r\n    )\r\n  }\r\n\r\n  const data = isEditing ? editedData : {\r\n    phone: teacherProfile.user?.phone || '',\r\n    address: teacherProfile.user?.address || '',\r\n  }\r\n\r\n  return (\r\n    <DashboardLayout allowedRoles={['teacher']}>\r\n      <div className=\"space-y-6\">\r\n        {/* Header */}\r\n        <div className=\"flex justify-between items-center\">\r\n          <div>\r\n            <h1 className=\"text-3xl font-bold text-gray-900\">My Profile</h1>\r\n            <p className=\"text-gray-600 mt-1\">View and update your profile information</p>\r\n          </div>\r\n          {!isEditing && (\r\n            <Button onClick={handleStartEdit}>\r\n              <Edit className=\"h-4 w-4 mr-2\" />\r\n              Edit Profile\r\n            </Button>\r\n          )}\r\n        </div>\r\n\r\n        {/* Teacher Information */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Teacher Information</CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div>\r\n                <Label className=\"text-sm font-medium text-gray-600\">Employee ID</Label>\r\n                <p className=\"text-sm font-semibold mt-1\">{teacherProfile.employee_id}</p>\r\n              </div>\r\n              <div>\r\n                <Label className=\"text-sm font-medium text-gray-600\">Full Name</Label>\r\n                <p className=\"text-sm font-semibold mt-1\">\r\n                  {teacherProfile.user?.full_name || 'N/A'}\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <Label className=\"text-sm font-medium text-gray-600\">Email</Label>\r\n                <div className=\"flex items-center gap-2 mt-1\">\r\n                  <Mail className=\"h-4 w-4 text-gray-400\" />\r\n                  <p className=\"text-sm\">{teacherProfile.user?.email || 'N/A'}</p>\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <Label className=\"text-sm font-medium text-gray-600\">Phone</Label>\r\n                {isEditing ? (\r\n                  <Input\r\n                    value={data.phone}\r\n                    onChange={(e) => setEditedData({ ...data, phone: e.target.value })}\r\n                    className=\"mt-1\"\r\n                  />\r\n                ) : (\r\n                  <div className=\"flex items-center gap-2 mt-1\">\r\n                    <Phone className=\"h-4 w-4 text-gray-400\" />\r\n                    <p className=\"text-sm\">{data.phone || 'N/A'}</p>\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div>\r\n                <Label className=\"text-sm font-medium text-gray-600\">Join Date</Label>\r\n                <div className=\"flex items-center gap-2 mt-1\">\r\n                  <Calendar className=\"h-4 w-4 text-gray-400\" />\r\n                  <p className=\"text-sm\">{formatDate(teacherProfile.join_date)}</p>\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <Label className=\"text-sm font-medium text-gray-600\">Qualification</Label>\r\n                <div className=\"flex items-center gap-2 mt-1\">\r\n                  <GraduationCap className=\"h-4 w-4 text-gray-400\" />\r\n                  <p className=\"text-sm\">{teacherProfile.qualification}</p>\r\n                </div>\r\n              </div>\r\n              <div className=\"md:col-span-2\">\r\n                <Label className=\"text-sm font-medium text-gray-600\">Address</Label>\r\n                {isEditing ? (\r\n                  <Input\r\n                    value={data.address}\r\n                    onChange={(e) => setEditedData({ ...data, address: e.target.value })}\r\n                    className=\"mt-1\"\r\n                  />\r\n                ) : (\r\n                  <div className=\"flex items-center gap-2 mt-1\">\r\n                    <MapPin className=\"h-4 w-4 text-gray-400\" />\r\n                    <p className=\"text-sm\">{data.address || 'N/A'}</p>\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div>\r\n                <Label className=\"text-sm font-medium text-gray-600\">Status</Label>\r\n                <div className=\"mt-1\">\r\n                  <Badge className={\r\n                    teacherProfile.status === 'active' \r\n                      ? 'bg-green-100 text-green-800' \r\n                      : 'bg-gray-100 text-gray-800'\r\n                  }>\r\n                    {teacherProfile.status}\r\n                  </Badge>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {isEditing && (\r\n              <div className=\"flex justify-end gap-2 pt-4 border-t\">\r\n                <Button variant=\"outline\" onClick={() => setIsEditing(false)}>\r\n                  <X className=\"h-4 w-4 mr-2\" />\r\n                  Cancel\r\n                </Button>\r\n                <Button onClick={handleSave} disabled={updateMutation.isPending}>\r\n                  <Save className=\"h-4 w-4 mr-2\" />\r\n                  {updateMutation.isPending ? 'Saving...' : 'Save Changes'}\r\n                </Button>\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Subjects */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Subjects</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"flex flex-wrap gap-2\">\r\n              {teacherProfile.subjects.map((subject: string) => (\r\n                <Badge key={subject} className=\"bg-blue-100 text-blue-800 px-3 py-1\">\r\n                  {subject}\r\n                </Badge>\r\n              ))}\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Assigned Classes */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Assigned Classes</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            {classes.length === 0 ? (\r\n              <p className=\"text-gray-500\">No classes assigned</p>\r\n            ) : (\r\n              <div className=\"grid gap-3 md:grid-cols-2\">\r\n                {classes.map((cls: any) => (\r\n                  <div key={cls.id} className=\"p-4 border rounded-lg\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <BookOpen className=\"h-5 w-5 text-blue-600\" />\r\n                      <div>\r\n                        <p className=\"font-semibold\">{cls.name} - {cls.section}</p>\r\n                        <p className=\"text-sm text-gray-600\">{cls.academic_year}</p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Salary Information */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Salary Information</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n              <div>\r\n                <Label className=\"text-sm font-medium text-gray-600\">Basic Salary</Label>\r\n                <p className=\"text-lg font-semibold mt-1\">\r\n                  {teacherProfile.salary_info.currency} {teacherProfile.salary_info.basic_salary}\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <Label className=\"text-sm font-medium text-gray-600\">Allowances</Label>\r\n                <p className=\"text-lg font-semibold mt-1\">\r\n                  {teacherProfile.salary_info.currency} {teacherProfile.salary_info.allowances || 0}\r\n                </p>\r\n              </div>\r\n              <div>\r\n                <Label className=\"text-sm font-medium text-gray-600\">Total Salary</Label>\r\n                <p className=\"text-lg font-semibold text-green-600 mt-1\">\r\n                  {teacherProfile.salary_info.currency} {\r\n                    teacherProfile.salary_info.basic_salary + (teacherProfile.salary_info.allowances || 0)\r\n                  }\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    </DashboardLayout>\r\n  )\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\app\\teacher\\results\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useMemo' is defined but never used.","line":3,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Trash2' is defined but never used.","line":15,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":49},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Save' is defined but never used.","line":15,"column":51,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":55},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":15,"column":57,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":58},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used.","line":16,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertCircle' is defined but never used.","line":16,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendingUp' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Users' is defined but never used.","line":17,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":20},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Award' is defined but never used.","line":17,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'FileCheck' is defined but never used.","line":17,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":38},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ResultStatus' is defined but never used.","line":23,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":40},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'router' is assigned a value but never used.","line":28,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":34,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1614,1617],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1614,1617],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'students' is assigned a value but never used.","line":55,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":55,"endColumn":25},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":87,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":87,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3283,3286],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3283,3286],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":105,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":105,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3901,3904],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3901,3904],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":121,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":121,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4493,4496],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4493,4496],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":148,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":148,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5321,5324],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5321,5324],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":214,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":214,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7321,7324],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7321,7324],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":19,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useMemo } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { DashboardLayout } from '@/components/layout/DashboardLayout'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { Badge } from '@/components/ui/badge'\nimport { toast } from '@/components/ui/toast'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { \n  Upload, Download, FileText, Plus, Edit, Trash2, Save, X,\n  CheckCircle, AlertCircle, FileSpreadsheet, Eye, RefreshCw,\n  TrendingUp, Users, Award, FileCheck\n} from 'lucide-react'\nimport { examService } from '@/services/examService'\nimport { resultService } from '@/services/resultService'\nimport { classService } from '@/services/classService'\nimport { teacherService } from '@/services/teacherService'\nimport { Exam, ExamResult, ResultStatus } from '@/types'\n\ntype TabId = 'upload' | 'manual-entry' | 'view-results'\n\nexport default function TeacherResultsPage() {\n  const router = useRouter()\n  const queryClient = useQueryClient()\n  const [activeTab, setActiveTab] = useState<TabId>('upload')\n  const [selectedExam, setSelectedExam] = useState<string>('')\n  const [selectedClass, setSelectedClass] = useState<string>('')\n  const [uploadFile, setUploadFile] = useState<File | null>(null)\n  const [uploadErrors, setUploadErrors] = useState<any[]>([])\n  const [isUploading, setIsUploading] = useState(false)\n  const [overwriteExisting, setOverwriteExisting] = useState(false)\n\n  // Fetch teacher's classes\n  const { data: classes = [] } = useQuery({\n    queryKey: ['my-classes'],\n    queryFn: () => teacherService.getMyClasses(),\n  })\n\n  // Fetch exams for selected class\n  const { data: exams = [] } = useQuery({\n    queryKey: ['exams', selectedClass],\n    queryFn: () => examService.getExams({ \n      class_id: selectedClass || undefined,\n      limit: 1000 \n    }),\n    enabled: !!selectedClass,\n  })\n\n  // Fetch students for selected class\n  const { data: students = [] } = useQuery({\n    queryKey: ['class-students', selectedClass],\n    queryFn: () => classService.getClassStudents(selectedClass),\n    enabled: !!selectedClass,\n  })\n\n  // Fetch results for selected exam\n  const { data: results = [] } = useQuery({\n    queryKey: ['results', selectedExam],\n    queryFn: () => resultService.getResults({ \n      exam_id: selectedExam || undefined,\n      limit: 1000 \n    }),\n    enabled: !!selectedExam,\n  })\n\n  // Download template mutation\n  const downloadTemplateMutation = useMutation({\n    mutationFn: async (examId: string) => {\n      const blob = await resultService.downloadTemplate(examId)\n      const url = window.URL.createObjectURL(blob)\n      const a = document.createElement('a')\n      a.href = url\n      a.download = `exam_results_template_${examId}.csv`\n      document.body.appendChild(a)\n      a.click()\n      window.URL.revokeObjectURL(url)\n      document.body.removeChild(a)\n    },\n    onSuccess: () => {\n      toast.success('Template downloaded successfully!')\n    },\n    onError: (error: any) => {\n      toast.error(error?.message || 'Failed to download template')\n    }\n  })\n\n  // Validate upload mutation\n  const validateUploadMutation = useMutation({\n    mutationFn: async ({ examId, file }: { examId: string; file: File }) => {\n      return resultService.validateUpload(examId, file)\n    },\n    onSuccess: (data) => {\n      if (data.valid) {\n        toast.success(`File is valid! ${data.valid_entries} entries ready to upload.`)\n      } else {\n        toast.error(`File validation failed. ${data.invalid_entries} errors found.`)\n        setUploadErrors(data.errors)\n      }\n    },\n    onError: (error: any) => {\n      toast.error(error?.message || 'Failed to validate file')\n    }\n  })\n\n  // Bulk upload mutation\n  const bulkUploadMutation = useMutation({\n    mutationFn: async (data: { examId: string; file: File; overwrite: boolean }) => {\n      // Parse CSV file\n      const text = await data.file.text()\n      const lines = text.split('\\n').filter(line => line.trim())\n      const headers = lines[0].split(',').map(h => h.trim())\n      \n      const results = []\n      for (let i = 1; i < lines.length; i++) {\n        const values = lines[i].split(',').map(v => v.trim())\n        const row: any = {}\n        headers.forEach((header, idx) => {\n          row[header] = values[idx]\n        })\n        \n        if (row.admission_number && row.marks_obtained) {\n          results.push({\n            admission_number: row.admission_number,\n            marks_obtained: parseFloat(row.marks_obtained) || 0,\n            remarks: row.remarks || undefined,\n            status: row.status || 'active'\n          })\n        }\n      }\n      \n      return resultService.bulkUpload({\n        exam_id: data.examId,\n        results,\n        overwrite_existing: data.overwrite\n      })\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['results'] })\n      toast.success(`Successfully uploaded ${data.success_count} results!`)\n      setUploadFile(null)\n      setUploadErrors([])\n    },\n    onError: (error: any) => {\n      toast.error(error?.message || 'Failed to upload results')\n    }\n  })\n\n  const handleFileUpload = async () => {\n    if (!selectedExam || !uploadFile) {\n      toast.error('Please select an exam and upload a file')\n      return\n    }\n\n    setIsUploading(true)\n    try {\n      // First validate\n      const validation = await validateUploadMutation.mutateAsync({\n        examId: selectedExam,\n        file: uploadFile\n      })\n\n      if (!validation.valid) {\n        setUploadErrors(validation.errors)\n        setIsUploading(false)\n        return\n      }\n\n      // Then upload\n      await bulkUploadMutation.mutateAsync({\n        examId: selectedExam,\n        file: uploadFile,\n        overwrite: overwriteExisting\n      })\n    } catch (error) {\n      console.error('Upload error:', error)\n    } finally {\n      setIsUploading(false)\n    }\n  }\n\n  const tabs = [\n    { id: 'upload' as TabId, name: 'Bulk Upload', icon: Upload },\n    { id: 'manual-entry' as TabId, name: 'Manual Entry', icon: Plus },\n    { id: 'view-results' as TabId, name: 'View Results', icon: Eye },\n  ]\n\n  return (\n    <DashboardLayout allowedRoles={['teacher', 'admin', 'principal']}>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900\">Result Management</h1>\n            <p className=\"text-gray-600 mt-1\">Upload and manage exam results for your classes</p>\n          </div>\n        </div>\n\n        {/* Filters */}\n        <Card>\n          <CardContent className=\"p-6\">\n            <div className=\"grid gap-4 md:grid-cols-3\">\n              <div>\n                <Label>Select Class</Label>\n                <Select value={selectedClass} onValueChange={setSelectedClass}>\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"Select Class\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {classes.map((cls: any) => (\n                      <SelectItem key={cls.id} value={cls.id}>\n                        {cls.name} - {cls.section}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div>\n                <Label>Select Exam</Label>\n                <Select \n                  value={selectedExam} \n                  onValueChange={setSelectedExam}\n                  disabled={!selectedClass}\n                >\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"Select Exam\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {exams.map((exam: Exam) => (\n                      <SelectItem key={exam.id} value={exam.id}>\n                        {exam.exam_name} - {exam.subject} ({exam.term})\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              {selectedExam && (\n                <div className=\"flex items-end gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => downloadTemplateMutation.mutate(selectedExam)}\n                    disabled={downloadTemplateMutation.isPending}\n                  >\n                    <Download className=\"h-4 w-4 mr-2\" />\n                    Download Template\n                  </Button>\n                </div>\n              )}\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Tab Navigation */}\n        <div className=\"border-b border-gray-200\">\n          <nav className=\"-mb-px flex space-x-8\" aria-label=\"Tabs\">\n            {tabs.map((tab) => {\n              const Icon = tab.icon\n              return (\n                <button\n                  key={tab.id}\n                  onClick={() => setActiveTab(tab.id)}\n                  className={`\n                    ${activeTab === tab.id\n                      ? 'border-blue-500 text-blue-600'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n                    }\n                    whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2\n                  `}\n                >\n                  <Icon className=\"h-5 w-5\" />\n                  {tab.name}\n                </button>\n              )\n            })}\n          </nav>\n        </div>\n\n        {/* Tab Content */}\n        <div className=\"mt-6\">\n          {/* Bulk Upload Tab */}\n          {activeTab === 'upload' && (\n            <Card>\n              <CardHeader>\n                <CardTitle>Bulk Upload Results</CardTitle>\n                <p className=\"text-sm text-gray-600\">Upload exam results from CSV file</p>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                {!selectedExam ? (\n                  <div className=\"text-center py-12 text-gray-500\">\n                    <FileSpreadsheet className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n                    <p className=\"text-lg font-medium mb-2\">Select an Exam</p>\n                    <p>Choose a class and exam to upload results</p>\n                  </div>\n                ) : (\n                  <>\n                    <div className=\"space-y-4\">\n                      <div>\n                        <Label>Upload CSV File</Label>\n                        <div className=\"mt-2 border-2 border-dashed border-gray-300 rounded-lg p-6 text-center\">\n                          <FileSpreadsheet className=\"h-12 w-12 mx-auto mb-4 text-gray-400\" />\n                          <div className=\"space-y-2\">\n                            <Input\n                              type=\"file\"\n                              accept=\".csv\"\n                              onChange={(e) => {\n                                const file = e.target.files?.[0]\n                                if (file) {\n                                  setUploadFile(file)\n                                  setUploadErrors([])\n                                }\n                              }}\n                              className=\"max-w-xs mx-auto\"\n                            />\n                            {uploadFile && (\n                              <p className=\"text-sm text-gray-600\">\n                                Selected: {uploadFile.name}\n                              </p>\n                            )}\n                          </div>\n                        </div>\n                      </div>\n\n                      <div className=\"flex items-center space-x-2\">\n                        <Input\n                          type=\"checkbox\"\n                          id=\"overwrite\"\n                          checked={overwriteExisting}\n                          onChange={(e) => setOverwriteExisting(e.target.checked)}\n                          className=\"w-4 h-4\"\n                        />\n                        <Label htmlFor=\"overwrite\" className=\"cursor-pointer\">\n                          Overwrite existing results\n                        </Label>\n                      </div>\n\n                      {uploadErrors.length > 0 && (\n                        <Card className=\"bg-red-50 border-red-200\">\n                          <CardHeader>\n                            <CardTitle className=\"text-red-800\">Validation Errors</CardTitle>\n                          </CardHeader>\n                          <CardContent>\n                            <div className=\"space-y-2 max-h-60 overflow-y-auto\">\n                              {uploadErrors.map((error, idx) => (\n                                <div key={idx} className=\"text-sm text-red-700\">\n                                  Row {error.row}: {error.error}\n                                </div>\n                              ))}\n                            </div>\n                          </CardContent>\n                        </Card>\n                      )}\n\n                      <div className=\"flex gap-3\">\n                        <Button\n                          onClick={handleFileUpload}\n                          disabled={!uploadFile || isUploading || bulkUploadMutation.isPending}\n                        >\n                          {isUploading ? (\n                            <>\n                              <RefreshCw className=\"h-4 w-4 mr-2 animate-spin\" />\n                              Uploading...\n                            </>\n                          ) : (\n                            <>\n                              <Upload className=\"h-4 w-4 mr-2\" />\n                              Upload Results\n                            </>\n                          )}\n                        </Button>\n                        <Button\n                          variant=\"outline\"\n                          onClick={() => {\n                            setUploadFile(null)\n                            setUploadErrors([])\n                          }}\n                        >\n                          Clear\n                        </Button>\n                      </div>\n                    </div>\n                  </>\n                )}\n              </CardContent>\n            </Card>\n          )}\n\n          {/* Manual Entry Tab */}\n          {activeTab === 'manual-entry' && (\n            <Card>\n              <CardHeader>\n                <CardTitle>Manual Result Entry</CardTitle>\n                <p className=\"text-sm text-gray-600\">Enter results manually for individual students</p>\n              </CardHeader>\n              <CardContent>\n                {!selectedExam ? (\n                  <div className=\"text-center py-12 text-gray-500\">\n                    <Plus className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n                    <p className=\"text-lg font-medium mb-2\">Select an Exam</p>\n                    <p>Choose an exam to enter results manually</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-4\">\n                    <p className=\"text-sm text-gray-600\">\n                      Manual entry will be implemented in the next phase. Please use bulk upload for now.\n                    </p>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          )}\n\n          {/* View Results Tab */}\n          {activeTab === 'view-results' && (\n            <Card>\n              <CardHeader>\n                <CardTitle>Uploaded Results</CardTitle>\n                <p className=\"text-sm text-gray-600\">View and manage uploaded exam results</p>\n              </CardHeader>\n              <CardContent>\n                {!selectedExam ? (\n                  <div className=\"text-center py-12 text-gray-500\">\n                    <Eye className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n                    <p className=\"text-lg font-medium mb-2\">Select an Exam</p>\n                    <p>Choose an exam to view results</p>\n                  </div>\n                ) : results.length === 0 ? (\n                  <div className=\"text-center py-12 text-gray-500\">\n                    <FileText className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n                    <p className=\"text-lg font-medium mb-2\">No Results Found</p>\n                    <p>No results have been uploaded for this exam yet</p>\n                  </div>\n                ) : (\n                  <div className=\"overflow-x-auto\">\n                    <table className=\"w-full\">\n                      <thead>\n                        <tr className=\"border-b\">\n                          <th className=\"text-left py-3 px-4\">Student</th>\n                          <th className=\"text-center py-3 px-4\">Admission No.</th>\n                          <th className=\"text-center py-3 px-4\">Marks Obtained</th>\n                          <th className=\"text-center py-3 px-4\">Total Marks</th>\n                          <th className=\"text-center py-3 px-4\">Percentage</th>\n                          <th className=\"text-center py-3 px-4\">Grade</th>\n                          <th className=\"text-center py-3 px-4\">Status</th>\n                          <th className=\"text-center py-3 px-4\">Actions</th>\n                        </tr>\n                      </thead>\n                      <tbody>\n                        {results.map((result: ExamResult) => (\n                          <tr key={result.id} className=\"border-b hover:bg-gray-50\">\n                            <td className=\"py-3 px-4\">{result.student_name || 'Unknown'}</td>\n                            <td className=\"py-3 px-4 text-center\">{result.admission_number}</td>\n                            <td className=\"py-3 px-4 text-center font-semibold\">{result.marks_obtained}</td>\n                            <td className=\"py-3 px-4 text-center\">{result.total_marks}</td>\n                            <td className=\"py-3 px-4 text-center\">{result.percentage.toFixed(1)}%</td>\n                            <td className=\"py-3 px-4 text-center\">\n                              <Badge variant=\"outline\">{result.grade || '-'}</Badge>\n                            </td>\n                            <td className=\"py-3 px-4 text-center\">\n                              <Badge variant=\"outline\">{result.status}</Badge>\n                            </td>\n                            <td className=\"py-3 px-4 text-center\">\n                              <div className=\"flex justify-center gap-2\">\n                                <Button size=\"sm\" variant=\"ghost\">\n                                  <Edit className=\"h-4 w-4\" />\n                                </Button>\n                              </div>\n                            </td>\n                          </tr>\n                        ))}\n                      </tbody>\n                    </table>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          )}\n        </div>\n      </div>\n    </DashboardLayout>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\AuthGate.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isPublicRoute' is assigned a value but never used.","line":19,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":22}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"﻿\"use client\"\n\nimport React from 'react'\nimport { useAuth } from '@/contexts/AuthContext'\nimport { useRouter, usePathname } from 'next/navigation'\n\nexport default function AuthGate({ children }: { children: React.ReactNode }) {\n  const { isLoading, isAuthenticated, user } = useAuth()\n  const router = useRouter()\n  const pathname = usePathname()\n\n\n  // Protected routes that require authentication\n  const protectedPrefixes = ['/admin', '/teacher', '/student', '/principal']\n  const isProtectedRoute = protectedPrefixes.some(prefix => pathname.startsWith(prefix))\n\n  // Public routes that anyone can access\n  const publicRoutes = ['/login', '/', '/debug']\n  const isPublicRoute = publicRoutes.includes(pathname)\n\n  // Show loading spinner while checking auth (only on initial load)\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n          <p className=\"text-gray-600 font-medium\">Loading your session...</p>\n        </div>\n      </div>\n    )\n  }\n\n  // Redirect to login ONLY if accessing protected route without auth\n  if (isProtectedRoute && !isAuthenticated && !isLoading) {\n    router.push('/login')\n    return null\n  }\n\n  // Redirect to dashboard if accessing login while authenticated\n  if (pathname === '/login' && isAuthenticated && user) {\n    const dashboardPaths: Record<string, string> = {\n      admin: '/admin/dashboard',\n      principal: '/principal/dashboard',\n      teacher: '/teacher/dashboard',\n      student: '/student/dashboard',\n    }\n    const redirectPath = dashboardPaths[user.role] || '/admin/dashboard'\n    router.push(redirectPath)\n    return null\n  }\n\n  return <>{children}</>\n}\n\n\n\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\SessionManager.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\announcements\\AnnouncementForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\attendance\\AttendanceForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":25,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[803,806],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[803,806],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":73,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":73,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2181,2184],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2181,2184],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":87,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":87,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2655,2658],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2655,2658],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'status' is assigned a value but never used.","line":101,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":101,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":152,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":152,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4997,5000],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4997,5000],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":183,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":183,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6141,6144],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6141,6144],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { useForm } from 'react-hook-form'\r\nimport { useMutation, useQueryClient, useQuery } from '@tanstack/react-query'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Label } from '@/components/ui/label'\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select'\r\nimport { attendanceService } from '@/services/attendanceService'\r\nimport { studentService } from '@/services/studentService'\r\nimport { teacherService } from '@/services/teacherService'\r\nimport { toast } from '@/components/ui/toast'\r\nimport { X } from 'lucide-react'\r\n\r\ninterface AttendanceFormProps {\r\n  onClose: () => void\r\n  onSuccess?: () => void\r\n  initialData?: any\r\n}\r\n\r\ntype AttendanceFormData = {\r\n  user_id: string\r\n  date: string\r\n  status: 'present' | 'absent' | 'late' | 'excused'\r\n  remarks?: string\r\n}\r\n\r\nexport function AttendanceForm({ onClose, onSuccess, initialData }: AttendanceFormProps) {\r\n  const queryClient = useQueryClient()\r\n  const [userType, setUserType] = useState<'student' | 'teacher'>('student')\r\n\r\n  const {\r\n    register,\r\n    handleSubmit,\r\n    watch,\r\n    setValue,\r\n    formState: { errors },\r\n  } = useForm<AttendanceFormData>({\r\n    defaultValues: initialData || {\r\n      date: new Date().toISOString().split('T')[0],\r\n      status: 'present',\r\n    },\r\n  })\r\n\r\n  // Fetch users based on type\r\n  const { data: students = [] } = useQuery({\r\n    queryKey: ['students'],\r\n    queryFn: () => studentService.getStudents({ limit: 1000 }),\r\n    enabled: userType === 'student',\r\n  })\r\n\r\n  const { data: teachers = [] } = useQuery({\r\n    queryKey: ['teachers'],\r\n    queryFn: () => teacherService.getTeachers({ limit: 1000 }),\r\n    enabled: userType === 'teacher',\r\n  })\r\n\r\n  const createMutation = useMutation({\r\n    mutationFn: (data: AttendanceFormData) => attendanceService.markAttendance(data),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['attendance'] })\r\n      toast.success('Attendance marked successfully!')\r\n      onSuccess?.()\r\n      onClose()\r\n    },\r\n    onError: (error: any) => {\r\n      toast.error(error?.response?.data?.detail || 'Failed to mark attendance')\r\n    }\r\n  })\r\n\r\n  const updateMutation = useMutation({\r\n    mutationFn: (data: AttendanceFormData) =>\r\n      attendanceService.updateAttendance(initialData.id, data),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['attendance'] })\r\n      toast.success('Attendance updated successfully!')\r\n      onSuccess?.()\r\n      onClose()\r\n    },\r\n    onError: (error: any) => {\r\n      toast.error(error?.response?.data?.detail || 'Failed to update attendance')\r\n    }\r\n  })\r\n\r\n  const onSubmit = (data: AttendanceFormData) => {\r\n    if (initialData) {\r\n      updateMutation.mutate(data)\r\n    } else {\r\n      createMutation.mutate(data)\r\n    }\r\n  }\r\n\r\n  const users = userType === 'student' ? students : teachers\r\n  const status = watch('status')\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50\">\r\n      <div className=\"w-full max-w-md rounded-lg bg-white p-6 shadow-xl\">\r\n        <div className=\"mb-4 flex items-center justify-between\">\r\n          <h2 className=\"text-2xl font-bold\">\r\n            {initialData ? 'Edit Attendance' : 'Mark Attendance'}\r\n          </h2>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"rounded-full p-1 hover:bg-gray-100\"\r\n          >\r\n            <X className=\"h-5 w-5\" />\r\n          </button>\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-4\">\r\n          {!initialData && (\r\n            <>\r\n              <div className=\"space-y-2\">\r\n                <Label>User Type</Label>\r\n                <Select\r\n                  value={userType}\r\n                  onValueChange={(value: 'student' | 'teacher') => {\r\n                    setUserType(value)\r\n                    setValue('user_id', '')\r\n                  }}\r\n                >\r\n                  <SelectTrigger>\r\n                    <SelectValue />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"student\">Student</SelectItem>\r\n                    <SelectItem value=\"teacher\">Teacher</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"user_id\">\r\n                  {userType === 'student' ? 'Student' : 'Teacher'} *\r\n                </Label>\r\n                <Select\r\n                  value={watch('user_id')}\r\n                  onValueChange={(value) => setValue('user_id', value)}\r\n                >\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder={`Select ${userType}`} />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    {users.map((user: any) => (\r\n                      <SelectItem key={user.user_id} value={user.user_id}>\r\n                        {user.user?.full_name || user.admission_number || user.employee_id}\r\n                      </SelectItem>\r\n                    ))}\r\n                  </SelectContent>\r\n                </Select>\r\n                {errors.user_id && (\r\n                  <p className=\"text-sm text-red-600\">{errors.user_id.message}</p>\r\n                )}\r\n              </div>\r\n            </>\r\n          )}\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"date\">Date *</Label>\r\n            <Input\r\n              type=\"date\"\r\n              id=\"date\"\r\n              {...register('date', { required: 'Date is required' })}\r\n              max={new Date().toISOString().split('T')[0]}\r\n            />\r\n            {errors.date && (\r\n              <p className=\"text-sm text-red-600\">{errors.date.message}</p>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"status\">Status *</Label>\r\n            <Select\r\n              value={watch('status')}\r\n              onValueChange={(value: any) => setValue('status', value)}\r\n            >\r\n              <SelectTrigger>\r\n                <SelectValue />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"present\">\r\n                  <span className=\"flex items-center gap-2\">\r\n                    <span className=\"h-2 w-2 rounded-full bg-green-500\"></span>\r\n                    Present\r\n                  </span>\r\n                </SelectItem>\r\n                <SelectItem value=\"absent\">\r\n                  <span className=\"flex items-center gap-2\">\r\n                    <span className=\"h-2 w-2 rounded-full bg-red-500\"></span>\r\n                    Absent\r\n                  </span>\r\n                </SelectItem>\r\n                <SelectItem value=\"late\">\r\n                  <span className=\"flex items-center gap-2\">\r\n                    <span className=\"h-2 w-2 rounded-full bg-yellow-500\"></span>\r\n                    Late\r\n                  </span>\r\n                </SelectItem>\r\n                <SelectItem value=\"excused\">\r\n                  <span className=\"flex items-center gap-2\">\r\n                    <span className=\"h-2 w-2 rounded-full bg-blue-500\"></span>\r\n                    Excused\r\n                  </span>\r\n                </SelectItem>\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"remarks\">Remarks (Optional)</Label>\r\n            <textarea\r\n              id=\"remarks\"\r\n              {...register('remarks')}\r\n              className=\"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\"\r\n              placeholder=\"Add any remarks...\"\r\n            />\r\n          </div>\r\n\r\n          <div className=\"flex gap-2\">\r\n            <Button\r\n              type=\"submit\"\r\n              className=\"flex-1\"\r\n              disabled={createMutation.isPending || updateMutation.isPending}\r\n            >\r\n              {createMutation.isPending || updateMutation.isPending\r\n                ? 'Saving...'\r\n                : initialData\r\n                ? 'Update Attendance'\r\n                : 'Mark Attendance'}\r\n            </Button>\r\n            <Button type=\"button\" variant=\"outline\" onClick={onClose}>\r\n              Cancel\r\n            </Button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\attendance\\BulkAttendanceForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":53,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":53,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1878,1881],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1878,1881],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":79,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":79,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2732,2735],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2732,2735],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":161,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":161,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5695,5698],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5695,5698],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { useMutation, useQueryClient, useQuery } from '@tanstack/react-query'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Label } from '@/components/ui/label'\r\nimport {\r\n  Select,\r\n  SelectContent,\r\n  SelectItem,\r\n  SelectTrigger,\r\n  SelectValue,\r\n} from '@/components/ui/select'\r\nimport { attendanceService } from '@/services/attendanceService'\r\nimport { classService } from '@/services/classService'\r\nimport { studentService } from '@/services/studentService'\r\nimport { toast } from '@/components/ui/toast'\r\nimport { X, CheckCircle2, XCircle, Clock, AlertCircle } from 'lucide-react'\r\n\r\ninterface BulkAttendanceFormProps {\r\n  onClose: () => void\r\n  onSuccess?: () => void\r\n}\r\n\r\ntype StudentAttendance = {\r\n  user_id: string\r\n  student_name: string\r\n  admission_number: string\r\n  status: 'present' | 'absent' | 'late' | 'excused'\r\n}\r\n\r\nexport function BulkAttendanceForm({ onClose, onSuccess }: BulkAttendanceFormProps) {\r\n  const queryClient = useQueryClient()\r\n  const [selectedClass, setSelectedClass] = useState('')\r\n  const [date, setDate] = useState(new Date().toISOString().split('T')[0])\r\n  const [attendanceData, setAttendanceData] = useState<StudentAttendance[]>([])\r\n\r\n  const { data: classes = [] } = useQuery({\r\n    queryKey: ['classes'],\r\n    queryFn: () => classService.getClasses({ limit: 1000 }),\r\n  })\r\n\r\n  const { data: students = [] } = useQuery({\r\n    queryKey: ['class-students', selectedClass],\r\n    queryFn: () => studentService.getStudents({ class_id: selectedClass, limit: 1000 }),\r\n    enabled: !!selectedClass,\r\n  })\r\n\r\n  // Initialize attendance data when students load\r\n  useEffect(() => {\r\n    if (students.length > 0 && attendanceData.length === 0) {\r\n      const initialData: StudentAttendance[] = students.map((student: any) => ({\r\n        user_id: student.user_id,\r\n        student_name: student.user?.full_name || 'Unknown',\r\n        admission_number: student.admission_number,\r\n        status: 'present' as const,\r\n      }))\r\n      setAttendanceData(initialData)\r\n    }\r\n  }, [students, attendanceData.length])\r\n\r\n  const markAllMutation = useMutation({\r\n    mutationFn: async () => {\r\n      const attendances = attendanceData.map((item) => ({\r\n        user_id: item.user_id,\r\n        date,\r\n        status: item.status,\r\n        remarks: '',\r\n      }))\r\n      return attendanceService.markBulkAttendance(attendances)\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['attendance'] })\r\n      toast.success(`Bulk attendance marked for ${attendanceData.length} students!`)\r\n      onSuccess?.()\r\n      onClose()\r\n    },\r\n    onError: (error: any) => {\r\n      toast.error(error?.response?.data?.detail || 'Failed to mark bulk attendance')\r\n    }\r\n  })\r\n\r\n  const updateStatus = (user_id: string, status: StudentAttendance['status']) => {\r\n    setAttendanceData((prev) =>\r\n      prev.map((item) =>\r\n        item.user_id === user_id ? { ...item, status } : item\r\n      )\r\n    )\r\n  }\r\n\r\n  const setAllStatus = (status: StudentAttendance['status']) => {\r\n    setAttendanceData((prev) => prev.map((item) => ({ ...item, status })))\r\n  }\r\n\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault()\r\n    markAllMutation.mutate()\r\n  }\r\n\r\n  const stats = {\r\n    present: attendanceData.filter((a) => a.status === 'present').length,\r\n    absent: attendanceData.filter((a) => a.status === 'absent').length,\r\n    late: attendanceData.filter((a) => a.status === 'late').length,\r\n    excused: attendanceData.filter((a) => a.status === 'excused').length,\r\n  }\r\n\r\n  const getStatusIcon = (status: string) => {\r\n    switch (status) {\r\n      case 'present':\r\n        return <CheckCircle2 className=\"h-4 w-4 text-green-500\" />\r\n      case 'absent':\r\n        return <XCircle className=\"h-4 w-4 text-red-500\" />\r\n      case 'late':\r\n        return <Clock className=\"h-4 w-4 text-yellow-500\" />\r\n      case 'excused':\r\n        return <AlertCircle className=\"h-4 w-4 text-blue-500\" />\r\n      default:\r\n        return null\r\n    }\r\n  }\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'present':\r\n        return 'bg-green-100 text-green-800 border-green-300'\r\n      case 'absent':\r\n        return 'bg-red-100 text-red-800 border-red-300'\r\n      case 'late':\r\n        return 'bg-yellow-100 text-yellow-800 border-yellow-300'\r\n      case 'excused':\r\n        return 'bg-blue-100 text-blue-800 border-blue-300'\r\n      default:\r\n        return 'bg-gray-100 text-gray-800 border-gray-300'\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4\">\r\n      <div className=\"max-h-[90vh] w-full max-w-4xl overflow-auto rounded-lg bg-white p-6 shadow-xl\">\r\n        <div className=\"mb-4 flex items-center justify-between\">\r\n          <h2 className=\"text-2xl font-bold\">Bulk Attendance Marking</h2>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"rounded-full p-1 hover:bg-gray-100\"\r\n          >\r\n            <X className=\"h-5 w-5\" />\r\n          </button>\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n          {/* Class and Date Selection */}\r\n          <div className=\"grid gap-4 md:grid-cols-2\">\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"class\">Class *</Label>\r\n              <Select value={selectedClass} onValueChange={setSelectedClass}>\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Select class\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  {classes.map((cls: any) => (\r\n                    <SelectItem key={cls.id} value={cls.id}>\r\n                      {cls.name} - {cls.section} ({cls.academic_year})\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"date\">Date *</Label>\r\n              <Input\r\n                type=\"date\"\r\n                id=\"date\"\r\n                value={date}\r\n                onChange={(e) => setDate(e.target.value)}\r\n                max={new Date().toISOString().split('T')[0]}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {/* Quick Actions */}\r\n          {selectedClass && attendanceData.length > 0 && (\r\n            <div className=\"rounded-lg border bg-gray-50 p-4\">\r\n              <Label className=\"mb-2 block\">Quick Mark All As:</Label>\r\n              <div className=\"flex flex-wrap gap-2\">\r\n                <Button\r\n                  type=\"button\"\r\n                  size=\"sm\"\r\n                  variant=\"outline\"\r\n                  onClick={() => setAllStatus('present')}\r\n                  className=\"bg-green-50 hover:bg-green-100\"\r\n                >\r\n                  <CheckCircle2 className=\"mr-2 h-4 w-4 text-green-500\" />\r\n                  All Present\r\n                </Button>\r\n                <Button\r\n                  type=\"button\"\r\n                  size=\"sm\"\r\n                  variant=\"outline\"\r\n                  onClick={() => setAllStatus('absent')}\r\n                  className=\"bg-red-50 hover:bg-red-100\"\r\n                >\r\n                  <XCircle className=\"mr-2 h-4 w-4 text-red-500\" />\r\n                  All Absent\r\n                </Button>\r\n                <Button\r\n                  type=\"button\"\r\n                  size=\"sm\"\r\n                  variant=\"outline\"\r\n                  onClick={() => setAllStatus('late')}\r\n                  className=\"bg-yellow-50 hover:bg-yellow-100\"\r\n                >\r\n                  <Clock className=\"mr-2 h-4 w-4 text-yellow-500\" />\r\n                  All Late\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Statistics */}\r\n          {attendanceData.length > 0 && (\r\n            <div className=\"grid grid-cols-4 gap-4\">\r\n              <div className=\"rounded-lg border border-green-200 bg-green-50 p-3\">\r\n                <p className=\"text-sm text-green-600\">Present</p>\r\n                <p className=\"text-2xl font-bold text-green-700\">{stats.present}</p>\r\n              </div>\r\n              <div className=\"rounded-lg border border-red-200 bg-red-50 p-3\">\r\n                <p className=\"text-sm text-red-600\">Absent</p>\r\n                <p className=\"text-2xl font-bold text-red-700\">{stats.absent}</p>\r\n              </div>\r\n              <div className=\"rounded-lg border border-yellow-200 bg-yellow-50 p-3\">\r\n                <p className=\"text-sm text-yellow-600\">Late</p>\r\n                <p className=\"text-2xl font-bold text-yellow-700\">{stats.late}</p>\r\n              </div>\r\n              <div className=\"rounded-lg border border-blue-200 bg-blue-50 p-3\">\r\n                <p className=\"text-sm text-blue-600\">Excused</p>\r\n                <p className=\"text-2xl font-bold text-blue-700\">{stats.excused}</p>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Student List */}\r\n          {selectedClass && attendanceData.length === 0 && (\r\n            <div className=\"rounded-lg border p-8 text-center\">\r\n              <p className=\"text-gray-600\">No students found in this class.</p>\r\n            </div>\r\n          )}\r\n\r\n          {attendanceData.length > 0 && (\r\n            <div className=\"space-y-2\">\r\n              <Label>Students ({attendanceData.length})</Label>\r\n              <div className=\"max-h-96 space-y-2 overflow-y-auto rounded-lg border p-4\">\r\n                {attendanceData.map((student) => (\r\n                  <div\r\n                    key={student.user_id}\r\n                    className={`flex items-center justify-between rounded-lg border p-3 transition-colors ${getStatusColor(\r\n                      student.status\r\n                    )}`}\r\n                  >\r\n                    <div className=\"flex items-center gap-3\">\r\n                      {getStatusIcon(student.status)}\r\n                      <div>\r\n                        <p className=\"font-medium\">{student.student_name}</p>\r\n                        <p className=\"text-sm opacity-75\">\r\n                          {student.admission_number}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex gap-1\">\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={() => updateStatus(student.user_id, 'present')}\r\n                        className={`rounded px-3 py-1 text-sm font-medium transition-colors ${\r\n                          student.status === 'present'\r\n                            ? 'bg-green-500 text-white'\r\n                            : 'bg-white text-green-600 hover:bg-green-50'\r\n                        }`}\r\n                      >\r\n                        P\r\n                      </button>\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={() => updateStatus(student.user_id, 'absent')}\r\n                        className={`rounded px-3 py-1 text-sm font-medium transition-colors ${\r\n                          student.status === 'absent'\r\n                            ? 'bg-red-500 text-white'\r\n                            : 'bg-white text-red-600 hover:bg-red-50'\r\n                        }`}\r\n                      >\r\n                        A\r\n                      </button>\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={() => updateStatus(student.user_id, 'late')}\r\n                        className={`rounded px-3 py-1 text-sm font-medium transition-colors ${\r\n                          student.status === 'late'\r\n                            ? 'bg-yellow-500 text-white'\r\n                            : 'bg-white text-yellow-600 hover:bg-yellow-50'\r\n                        }`}\r\n                      >\r\n                        L\r\n                      </button>\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={() => updateStatus(student.user_id, 'excused')}\r\n                        className={`rounded px-3 py-1 text-sm font-medium transition-colors ${\r\n                          student.status === 'excused'\r\n                            ? 'bg-blue-500 text-white'\r\n                            : 'bg-white text-blue-600 hover:bg-blue-50'\r\n                        }`}\r\n                      >\r\n                        E\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Submit Button */}\r\n          <div className=\"flex gap-2\">\r\n            <Button\r\n              type=\"submit\"\r\n              className=\"flex-1\"\r\n              disabled={!selectedClass || attendanceData.length === 0 || markAllMutation.isPending}\r\n            >\r\n              {markAllMutation.isPending\r\n                ? 'Saving...'\r\n                : `Mark Attendance (${attendanceData.length} students)`}\r\n            </Button>\r\n            <Button type=\"button\" variant=\"outline\" onClick={onClose}>\r\n              Cancel\r\n            </Button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\classes\\ClassForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Input' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'register' is assigned a value but never used.","line":61,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":61,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'reset' is assigned a value but never used.","line":66,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":66,"endColumn":10},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":110,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":110,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3131,3134],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3131,3134],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useEffect } from 'react'\nimport { useForm } from 'react-hook-form'\nimport { zodResolver } from '@hookform/resolvers/zod'\nimport * as z from 'zod'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { classService } from '@/services/classService'\nimport { teacherService } from '@/services/teacherService'\nimport { useAuth } from '@/contexts/AuthContext'\nimport { Class, Teacher } from '@/types'\nimport { Loader2, X } from 'lucide-react'\nimport { toast } from '@/components/ui/toast'\n\nconst classSchema = z.object({\n  name: z.string().min(1, 'Class name is required'),\n  section: z.string().min(1, 'Section is required'),\n  teacher_id: z.string().optional(),\n  academic_year: z.string().min(1, 'Academic year is required'),\n})\n\ntype ClassFormData = z.infer<typeof classSchema>\n\ninterface ClassFormProps {\n  classData?: Class\n  onClose: () => void\n  onSuccess: () => void\n}\n\nconst ACADEMIC_YEARS = [\n  '2023-2024',\n  '2024-2025',\n  '2025-2026',\n  '2026-2027',\n  '2027-2028'\n]\n\nconst CLASS_NAMES = [\n  'Nursery', 'KG', 'Prep',\n  '1st', '2nd', '3rd', '4th', '5th',\n  '6th', '7th', '8th', '9th', '10th',\n  '11th', '12th'\n]\n\nconst SECTIONS = [\n  'A', 'B', 'C', 'D', 'E', 'F'\n]\n\nexport function ClassForm({ classData, onClose, onSuccess }: ClassFormProps) {\n  const [isLoading, setIsLoading] = useState(false)\n  const [teachers, setTeachers] = useState<Teacher[]>([])\n  const { user } = useAuth()\n  \n  const isEdit = !!classData\n\n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n    setValue,\n    watch,\n    reset\n  } = useForm<ClassFormData>({\n    resolver: zodResolver(classSchema),\n    defaultValues: {\n      name: classData?.name || '',\n      section: classData?.section || '',\n      teacher_id: classData?.teacher_id || '',\n      academic_year: classData?.academic_year || new Date().getFullYear() + '-' + (new Date().getFullYear() + 1),\n    }\n  })\n\n  // Load teachers\n  useEffect(() => {\n    const loadTeachers = async () => {\n      try {\n        const teachersData = await teacherService.getTeachers({ limit: 1000 })\n        setTeachers(teachersData.filter(teacher => teacher.status === 'active'))\n      } catch (error) {\n        console.error('Failed to load teachers:', error)\n      }\n    }\n    loadTeachers()\n  }, [])\n\n  const onSubmit = async (data: ClassFormData) => {\n    if (!user) return\n\n    setIsLoading(true)\n    try {\n      const classPayload = {\n        name: data.name,\n        section: data.section,\n        teacher_id: data.teacher_id || null,\n        academic_year: data.academic_year,\n      }\n\n      if (isEdit && classData) {\n        await classService.updateClass(classData.id, classPayload)\n      } else {\n        await classService.createClass({ ...classPayload, teacher_id: classPayload.teacher_id || undefined })\n      }\n\n      onSuccess()\n      onClose()\n    } catch (error: any) {\n      console.error('Failed to save class:', error)\n      toast.error(error.response?.data?.detail || 'Failed to save class')\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n      <Card className=\"w-full max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-4\">\n          <CardTitle>{isEdit ? 'Edit Class' : 'Create New Class'}</CardTitle>\n          <Button variant=\"ghost\" size=\"sm\" onClick={onClose}>\n            <X className=\"h-4 w-4\" />\n          </Button>\n        </CardHeader>\n        <CardContent>\n          <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-6\">\n            {/* Class Information */}\n            <div className=\"space-y-4\">\n              <h3 className=\"text-lg font-semibold\">Class Information</h3>\n              \n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"name\">Class Name *</Label>\n                  <Select\n                    value={watch('name') || 'placeholder'}\n                    onValueChange={(value) => setValue('name', value === 'placeholder' ? '' : value)}\n                  >\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"Select class\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"placeholder\" disabled>Select class</SelectItem>\n                      {CLASS_NAMES.map((className) => (\n                        <SelectItem key={className} value={className}>\n                          {className}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  {errors.name && (\n                    <p className=\"text-sm text-red-600\">{errors.name.message}</p>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"section\">Section *</Label>\n                  <Select\n                    value={watch('section') || 'placeholder'}\n                    onValueChange={(value) => setValue('section', value === 'placeholder' ? '' : value)}\n                  >\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"Select section\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"placeholder\" disabled>Select section</SelectItem>\n                      {SECTIONS.map((section) => (\n                        <SelectItem key={section} value={section}>\n                          {section}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  {errors.section && (\n                    <p className=\"text-sm text-red-600\">{errors.section.message}</p>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"academic_year\">Academic Year *</Label>\n                  <Select\n                    value={watch('academic_year') || 'placeholder'}\n                    onValueChange={(value) => setValue('academic_year', value === 'placeholder' ? '' : value)}\n                  >\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"Select academic year\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"placeholder\" disabled>Select academic year</SelectItem>\n                      {ACADEMIC_YEARS.map((year) => (\n                        <SelectItem key={year} value={year}>\n                          {year}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  {errors.academic_year && (\n                    <p className=\"text-sm text-red-600\">{errors.academic_year.message}</p>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"teacher_id\">Class Teacher (Optional)</Label>\n                  <Select\n                    value={watch('teacher_id') || 'none'}\n                    onValueChange={(value) => setValue('teacher_id', value === 'none' ? '' : value)}\n                  >\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"Select teacher\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"none\">No teacher assigned</SelectItem>\n                      {teachers.map((teacher) => (\n                        <SelectItem key={teacher.id} value={teacher.id}>\n                          {teacher.user?.full_name} ({teacher.employee_id})\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n            </div>\n\n            {/* Preview */}\n            <div className=\"bg-gray-50 p-4 rounded-lg\">\n              <h4 className=\"font-medium mb-2\">Class Preview</h4>\n              <p className=\"text-lg\">\n                {watch('name') && watch('name') !== 'placeholder' && watch('section') && watch('section') !== 'placeholder' ? (\n                  <>\n                    <span className=\"font-semibold\">{watch('name')} - {watch('section')}</span>\n                    {watch('academic_year') && watch('academic_year') !== 'placeholder' && (\n                      <span className=\"text-gray-600 ml-2\">({watch('academic_year')})</span>\n                    )}\n                  </>\n                ) : (\n                  <span className=\"text-gray-500\">Select class and section to preview</span>\n                )}\n              </p>\n              {watch('teacher_id') && watch('teacher_id') !== '' && watch('teacher_id') !== 'none' && (\n                <p className=\"text-sm text-gray-600 mt-1\">\n                  Class Teacher: {teachers.find(t => t.id === watch('teacher_id'))?.user?.full_name}\n                </p>\n              )}\n            </div>\n\n            {/* Form Actions */}\n            <div className=\"flex justify-end space-x-2 pt-4\">\n              <Button type=\"button\" variant=\"outline\" onClick={onClose}>\n                Cancel\n              </Button>\n              <Button type=\"submit\" disabled={isLoading}>\n                {isLoading && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n                {isEdit ? 'Update Class' : 'Create Class'}\n              </Button>\n            </div>\n          </form>\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\classes\\StudentEnrollment.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":3,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isLoading' is assigned a value but never used.","line":25,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setIsLoading' is assigned a value but never used.","line":25,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":33},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'refetch' is assigned a value but never used.","line":40,"column":67,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":74},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":67,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":67,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2447,2450],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2447,2450],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":80,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":80,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2982,2985],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2982,2985],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useEffect } from 'react'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { studentService } from '@/services/studentService'\nimport { classService } from '@/services/classService'\nimport { Student, Class } from '@/types'\nimport { toast } from '@/components/ui/toast'\nimport { ConfirmDialog } from '@/components/shared/ConfirmDialog'\nimport { Loader2, X, Plus, Users, UserMinus } from 'lucide-react'\n\ninterface StudentEnrollmentProps {\n  classData: Class\n  onClose: () => void\n}\n\nexport function StudentEnrollment({ classData, onClose }: StudentEnrollmentProps) {\n  const [search, setSearch] = useState('')\n  const [selectedStudent, setSelectedStudent] = useState('')\n  const [isLoading, setIsLoading] = useState(false)\n  const [confirmDialog, setConfirmDialog] = useState<{\n    open: boolean\n    title: string\n    description: string\n    onConfirm: () => void\n  }>({\n    open: false,\n    title: '',\n    description: '',\n    onConfirm: () => {},\n  })\n  const queryClient = useQueryClient()\n\n  // Get students in this class\n  const { data: classStudents = [], isLoading: isLoadingStudents, refetch } = useQuery({\n    queryKey: ['classStudents', classData.id],\n    queryFn: () => classService.getClassStudents(classData.id),\n  })\n\n  // Get all students\n  const { data: allStudents = [] } = useQuery({\n    queryKey: ['availableStudents', classData.id],\n    queryFn: () => studentService.getStudents({ \n      limit: 1000\n    }),\n  })\n\n  // Filter out students already in this class\n  const availableStudents = allStudents.filter(\n    student => !classStudents.some(cs => cs.user_id === student.user_id)\n  )\n\n  const addStudentMutation = useMutation({\n    mutationFn: (studentId: string) => \n      classService.addStudents(classData.id, [studentId]),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['classStudents', classData.id] })\n      queryClient.invalidateQueries({ queryKey: ['availableStudents', classData.id] })\n      setSelectedStudent('')\n      toast.success('Student added to class successfully')\n    },\n    onError: (error: any) => {\n      toast.error(error.response?.data?.detail || 'Failed to add student to class')\n    }\n  })\n\n  const removeStudentMutation = useMutation({\n    mutationFn: (studentId: string) => \n      classService.removeStudent(classData.id, studentId),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['classStudents', classData.id] })\n      queryClient.invalidateQueries({ queryKey: ['availableStudents', classData.id] })\n      toast.success('Student removed from class successfully')\n    },\n    onError: (error: any) => {\n      toast.error(error.response?.data?.detail || 'Failed to remove student from class')\n    }\n  })\n\n  const filteredAvailableStudents = availableStudents.filter(student =>\n    student.user?.full_name?.toLowerCase().includes(search.toLowerCase()) ||\n    student.admission_number.toLowerCase().includes(search.toLowerCase())\n  )\n\n  const handleAddStudent = () => {\n    if (selectedStudent) {\n      addStudentMutation.mutate(selectedStudent)\n    }\n  }\n\n  const handleRemoveStudent = (student: Student) => {\n    setConfirmDialog({\n      open: true,\n      title: 'Remove Student from Class',\n      description: `Are you sure you want to remove ${student.user?.full_name || student.admission_number} from this class?`,\n      onConfirm: () => {\n        removeStudentMutation.mutate(student.id)\n      },\n    })\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n      <Card className=\"w-full max-w-4xl max-h-[90vh] overflow-y-auto\">\n        <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-4\">\n          <CardTitle className=\"flex items-center gap-2\">\n            <Users className=\"h-5 w-5\" />\n            Students in {classData.name} - {classData.section}\n          </CardTitle>\n          <Button variant=\"ghost\" size=\"sm\" onClick={onClose}>\n            <X className=\"h-4 w-4\" />\n          </Button>\n        </CardHeader>\n        <CardContent className=\"space-y-6\">\n          {/* Add Student Section */}\n          <div className=\"space-y-4\">\n            <h3 className=\"text-lg font-semibold\">Add Student to Class</h3>\n            <div className=\"flex gap-2\">\n              <div className=\"flex-1\">\n                <Label htmlFor=\"student-search\">Search Students</Label>\n                <Input\n                  id=\"student-search\"\n                  placeholder=\"Search by name or admission number...\"\n                  value={search}\n                  onChange={(e) => setSearch(e.target.value)}\n                />\n              </div>\n              <div className=\"flex-1\">\n                <Label htmlFor=\"select-student\">Select Student</Label>\n                <Select\n                  value={selectedStudent || 'placeholder'}\n                  onValueChange={(value) => setSelectedStudent(value === 'placeholder' ? '' : value)}\n                >\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"Choose a student\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"placeholder\" disabled>Choose a student</SelectItem>\n                    {filteredAvailableStudents.map((student) => (\n                      <SelectItem key={student.id} value={student.id}>\n                        {student.user?.full_name} ({student.admission_number})\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n              <div className=\"flex items-end\">\n                <Button \n                  onClick={handleAddStudent}\n                  disabled={!selectedStudent || addStudentMutation.isPending}\n                >\n                  {addStudentMutation.isPending ? (\n                    <Loader2 className=\"h-4 w-4 animate-spin\" />\n                  ) : (\n                    <Plus className=\"h-4 w-4\" />\n                  )}\n                </Button>\n              </div>\n            </div>\n          </div>\n\n          {/* Current Students */}\n          <div className=\"space-y-4\">\n            <h3 className=\"text-lg font-semibold\">\n              Current Students ({classStudents.length})\n            </h3>\n            \n            {isLoadingStudents ? (\n              <div className=\"text-center py-8 text-gray-500\">Loading students...</div>\n            ) : classStudents.length === 0 ? (\n              <div className=\"text-center py-8 text-gray-500\">\n                No students enrolled in this class\n              </div>\n            ) : (\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full\">\n                  <thead>\n                    <tr className=\"border-b\">\n                      <th className=\"text-left py-3 px-4\">Admission No.</th>\n                      <th className=\"text-left py-3 px-4\">Name</th>\n                      <th className=\"text-left py-3 px-4\">Email</th>\n                      <th className=\"text-left py-3 px-4\">Status</th>\n                      <th className=\"text-left py-3 px-4\">Actions</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {classStudents.map((student) => (\n                      <tr key={student.id} className=\"border-b hover:bg-gray-50\">\n                        <td className=\"py-3 px-4 font-medium\">\n                          {student.admission_number}\n                        </td>\n                        <td className=\"py-3 px-4\">\n                          {student.user?.full_name || 'N/A'}\n                        </td>\n                        <td className=\"py-3 px-4\">\n                          {student.user?.email || 'N/A'}\n                        </td>\n                        <td className=\"py-3 px-4\">\n                          <span\n                            className={`inline-flex rounded-full px-2 py-1 text-xs font-semibold ${\n                              student.status === 'active'\n                                ? 'bg-green-100 text-green-800'\n                                : 'bg-gray-100 text-gray-800'\n                            }`}\n                          >\n                            {student.status}\n                          </span>\n                        </td>\n                        <td className=\"py-3 px-4\">\n                          <Button\n                            size=\"sm\"\n                            variant=\"ghost\"\n                            onClick={() => handleRemoveStudent(student)}\n                            disabled={removeStudentMutation.isPending}\n                            className=\"text-red-600 hover:text-red-800\"\n                          >\n                            <UserMinus className=\"h-4 w-4\" />\n                          </Button>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            )}\n          </div>\n\n          {/* Actions */}\n          <div className=\"flex justify-end space-x-2 pt-4 border-t\">\n            <Button variant=\"outline\" onClick={onClose}>\n              Close\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Confirm Dialog */}\n      <ConfirmDialog\n        open={confirmDialog.open}\n        onOpenChange={(open) => setConfirmDialog({ ...confirmDialog, open })}\n        title={confirmDialog.title}\n        description={confirmDialog.description}\n        onConfirm={confirmDialog.onConfirm}\n        variant=\"destructive\"\n      />\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\finance\\DeductionRulesManager.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Trash2' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertCircle' is defined but never used.","line":20,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ToggleRight' is defined but never used.","line":27,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":14},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":51,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1635,1638],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1635,1638],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":58,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":58,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1928,1931],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1928,1931],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":68,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":68,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2309,2312],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2309,2312],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":77,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":77,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2643,2646],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2643,2646],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":128,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":128,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4084,4087],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4084,4087],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":213,"column":94,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":213,"endColumn":97,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6790,6793],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6790,6793],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":245,"column":99,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":245,"endColumn":102,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8360,8363],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8360,8363],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\r\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Label } from '@/components/ui/label'\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\r\nimport { Textarea } from '@/components/ui/textarea'\r\nimport { Badge } from '@/components/ui/badge'\r\nimport { toast } from '@/components/ui/toast'\r\nimport { attendanceSalaryService, AttendanceRule } from '@/services/attendanceSalaryService'\r\nimport {\r\n  Plus,\r\n  Edit2,\r\n  Trash2,\r\n  Save,\r\n  X,\r\n  AlertCircle,\r\n  CheckCircle,\r\n  Settings,\r\n  Clock,\r\n  DollarSign,\r\n  Percent,\r\n  ToggleLeft,\r\n  ToggleRight,\r\n} from 'lucide-react'\r\n\r\nexport function DeductionRulesManager() {\r\n  const queryClient = useQueryClient()\r\n  const [editingRule, setEditingRule] = useState<AttendanceRule | null>(null)\r\n  const [showForm, setShowForm] = useState(false)\r\n  const [formData, setFormData] = useState<Partial<AttendanceRule>>({\r\n    rule_name: '',\r\n    rule_type: 'absent',\r\n    condition_description: '',\r\n    deduction_type: 'percentage',\r\n    deduction_value: 0,\r\n    grace_minutes: 0,\r\n    max_late_count: 3,\r\n    is_active: true,\r\n  })\r\n\r\n  const { data: rules = [], isLoading } = useQuery({\r\n    queryKey: ['attendance-rules'],\r\n    queryFn: () => attendanceSalaryService.getAttendanceRules(),\r\n  })\r\n\r\n  const createMutation = useMutation({\r\n    mutationFn: (data: any) => attendanceSalaryService.createAttendanceRule(data),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['attendance-rules'] })\r\n      toast.success('Deduction rule created successfully!')\r\n      setShowForm(false)\r\n      resetForm()\r\n    },\r\n    onError: (error: any) => {\r\n      const errorMessage = error?.message || \r\n                          error?.response?.data?.message || \r\n                          error?.response?.data?.detail || \r\n                          'Failed to create deduction rule'\r\n      toast.error(errorMessage)\r\n    }\r\n  })\r\n\r\n  const updateMutation = useMutation({\r\n    mutationFn: ({ id, data }: { id: string; data: any }) =>\r\n      attendanceSalaryService.updateAttendanceRule(id, data),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['attendance-rules'] })\r\n      toast.success('Deduction rule updated successfully!')\r\n      setEditingRule(null)\r\n      setShowForm(false)\r\n      resetForm()\r\n    },\r\n    onError: (error: any) => {\r\n      const errorMessage = error?.message || \r\n                          error?.response?.data?.message || \r\n                          error?.response?.data?.detail || \r\n                          'Failed to update deduction rule'\r\n      toast.error(errorMessage)\r\n    }\r\n  })\r\n\r\n  const resetForm = () => {\r\n    setFormData({\r\n      rule_name: '',\r\n      rule_type: 'absent',\r\n      condition_description: '',\r\n      deduction_type: 'percentage',\r\n      deduction_value: 0,\r\n      grace_minutes: 0,\r\n      max_late_count: 3,\r\n      is_active: true,\r\n    })\r\n  }\r\n\r\n  const handleEdit = (rule: AttendanceRule) => {\r\n    setEditingRule(rule)\r\n    setFormData({\r\n      rule_name: rule.rule_name,\r\n      rule_type: rule.rule_type,\r\n      condition_description: rule.condition_description,\r\n      deduction_type: rule.deduction_type,\r\n      deduction_value: rule.deduction_value,\r\n      grace_minutes: rule.grace_minutes,\r\n      max_late_count: rule.max_late_count,\r\n      is_active: rule.is_active,\r\n    })\r\n    setShowForm(true)\r\n  }\r\n\r\n  const handleSubmit = (e: React.FormEvent) => {\r\n    e.preventDefault()\r\n\r\n    if (!formData.rule_name || !formData.condition_description) {\r\n      toast.error('Please fill in all required fields')\r\n      return\r\n    }\r\n\r\n    if (editingRule) {\r\n      updateMutation.mutate({\r\n        id: editingRule.id,\r\n        data: formData,\r\n      })\r\n    } else {\r\n      createMutation.mutate(formData as any)\r\n    }\r\n  }\r\n\r\n  const handleCancel = () => {\r\n    setEditingRule(null)\r\n    setShowForm(false)\r\n    resetForm()\r\n  }\r\n\r\n  const getRuleTypeLabel = (type: string) => {\r\n    const labels: Record<string, string> = {\r\n      late_coming: 'Late Coming',\r\n      half_day: 'Half Day',\r\n      absent: 'Absent',\r\n      early_departure: 'Early Departure',\r\n    }\r\n    return labels[type] || type\r\n  }\r\n\r\n  const getDeductionTypeLabel = (type: string) => {\r\n    const labels: Record<string, string> = {\r\n      percentage: 'Percentage',\r\n      fixed_amount: 'Fixed Amount',\r\n      full_day: 'Full Day',\r\n      half_day: 'Half Day',\r\n    }\r\n    return labels[type] || type\r\n  }\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <Card>\r\n        <CardContent className=\"pt-6\">\r\n          <div className=\"text-center py-8\">Loading deduction rules...</div>\r\n        </CardContent>\r\n      </Card>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex justify-between items-center\">\r\n        <div>\r\n          <h3 className=\"text-lg font-semibold\">Attendance Deduction Rules</h3>\r\n          <p className=\"text-sm text-gray-600\">\r\n            Configure rules for salary deductions based on attendance violations\r\n          </p>\r\n        </div>\r\n        {!showForm && (\r\n          <Button onClick={() => setShowForm(true)}>\r\n            <Plus className=\"h-4 w-4 mr-2\" />\r\n            Add Rule\r\n          </Button>\r\n        )}\r\n      </div>\r\n\r\n      {showForm && (\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>\r\n              {editingRule ? 'Edit Deduction Rule' : 'Create New Deduction Rule'}\r\n            </CardTitle>\r\n            <CardDescription>\r\n              Define how salary deductions are calculated for attendance violations\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n              <div className=\"grid gap-4 md:grid-cols-2\">\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"rule_name\">Rule Name *</Label>\r\n                  <Input\r\n                    id=\"rule_name\"\r\n                    value={formData.rule_name}\r\n                    onChange={(e) => setFormData({ ...formData, rule_name: e.target.value })}\r\n                    placeholder=\"e.g., Absent Day Deduction\"\r\n                    required\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"rule_type\">Rule Type *</Label>\r\n                  <Select\r\n                    value={formData.rule_type}\r\n                    onValueChange={(value) => setFormData({ ...formData, rule_type: value as any })}\r\n                  >\r\n                    <SelectTrigger>\r\n                      <SelectValue placeholder=\"Select rule type\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"absent\">Absent</SelectItem>\r\n                      <SelectItem value=\"late_coming\">Late Coming</SelectItem>\r\n                      <SelectItem value=\"half_day\">Half Day</SelectItem>\r\n                      <SelectItem value=\"early_departure\">Early Departure</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"condition_description\">Condition Description *</Label>\r\n                <Textarea\r\n                  id=\"condition_description\"\r\n                  value={formData.condition_description}\r\n                  onChange={(e) => setFormData({ ...formData, condition_description: e.target.value })}\r\n                  placeholder=\"Describe when this rule applies (e.g., 'Applies when teacher is absent')\"\r\n                  required\r\n                  rows={3}\r\n                />\r\n              </div>\r\n\r\n              <div className=\"grid gap-4 md:grid-cols-2\">\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"deduction_type\">Deduction Type *</Label>\r\n                  <Select\r\n                    value={formData.deduction_type}\r\n                    onValueChange={(value) => setFormData({ ...formData, deduction_type: value as any })}\r\n                  >\r\n                    <SelectTrigger>\r\n                      <SelectValue placeholder=\"Select deduction type\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      <SelectItem value=\"percentage\">Percentage</SelectItem>\r\n                      <SelectItem value=\"fixed_amount\">Fixed Amount</SelectItem>\r\n                      <SelectItem value=\"full_day\">Full Day Salary</SelectItem>\r\n                      <SelectItem value=\"half_day\">Half Day Salary</SelectItem>\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"deduction_value\">\r\n                    Deduction Value *\r\n                    {formData.deduction_type === 'percentage' && ' (%)'}\r\n                    {formData.deduction_type === 'fixed_amount' && ' (Amount)'}\r\n                  </Label>\r\n                  <Input\r\n                    type=\"number\"\r\n                    step={formData.deduction_type === 'percentage' ? '0.1' : '0.01'}\r\n                    id=\"deduction_value\"\r\n                    value={formData.deduction_value}\r\n                    onChange={(e) =>\r\n                      setFormData({\r\n                        ...formData,\r\n                        deduction_value: parseFloat(e.target.value) || 0,\r\n                      })\r\n                    }\r\n                    placeholder=\"0\"\r\n                    required\r\n                    min={0}\r\n                    max={formData.deduction_type === 'percentage' ? 100 : undefined}\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              {(formData.rule_type === 'late_coming' || formData.rule_type === 'early_departure') && (\r\n                <div className=\"grid gap-4 md:grid-cols-2\">\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"grace_minutes\">Grace Period (Minutes)</Label>\r\n                    <Input\r\n                      type=\"number\"\r\n                      id=\"grace_minutes\"\r\n                      value={formData.grace_minutes}\r\n                      onChange={(e) =>\r\n                        setFormData({\r\n                          ...formData,\r\n                          grace_minutes: parseInt(e.target.value) || 0,\r\n                        })\r\n                      }\r\n                      placeholder=\"5\"\r\n                      min={0}\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"max_late_count\">Max Late Count (Before Deduction)</Label>\r\n                    <Input\r\n                      type=\"number\"\r\n                      id=\"max_late_count\"\r\n                      value={formData.max_late_count}\r\n                      onChange={(e) =>\r\n                        setFormData({\r\n                          ...formData,\r\n                          max_late_count: parseInt(e.target.value) || 3,\r\n                        })\r\n                      }\r\n                      placeholder=\"3\"\r\n                      min={0}\r\n                    />\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              <div className=\"flex items-center gap-2\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  id=\"is_active\"\r\n                  checked={formData.is_active}\r\n                  onChange={(e) => setFormData({ ...formData, is_active: e.target.checked })}\r\n                  className=\"h-4 w-4 rounded border-gray-300\"\r\n                />\r\n                <Label htmlFor=\"is_active\" className=\"cursor-pointer\">\r\n                  Active (Rule will be applied in calculations)\r\n                </Label>\r\n              </div>\r\n\r\n              <div className=\"flex gap-2 pt-4\">\r\n                <Button type=\"submit\" disabled={createMutation.isPending || updateMutation.isPending}>\r\n                  <Save className=\"h-4 w-4 mr-2\" />\r\n                  {editingRule ? 'Update Rule' : 'Create Rule'}\r\n                </Button>\r\n                <Button type=\"button\" variant=\"outline\" onClick={handleCancel}>\r\n                  <X className=\"h-4 w-4 mr-2\" />\r\n                  Cancel\r\n                </Button>\r\n              </div>\r\n            </form>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {/* Rules List */}\r\n      <div className=\"space-y-4\">\r\n        {rules.length === 0 ? (\r\n          <Card>\r\n            <CardContent className=\"pt-6\">\r\n              <div className=\"text-center py-8 text-gray-500\">\r\n                <Settings className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\r\n                <p className=\"text-lg font-medium mb-2\">No deduction rules configured</p>\r\n                <p className=\"text-sm\">Create your first rule to start applying salary deductions</p>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        ) : (\r\n          rules.map((rule) => (\r\n            <Card key={rule.id} className={!rule.is_active ? 'opacity-60' : ''}>\r\n              <CardContent className=\"pt-6\">\r\n                <div className=\"flex justify-between items-start\">\r\n                  <div className=\"flex-1\">\r\n                    <div className=\"flex items-center gap-3 mb-2\">\r\n                      <h4 className=\"font-semibold text-lg\">{rule.rule_name}</h4>\r\n                      <Badge variant={rule.is_active ? 'default' : 'secondary'}>\r\n                        {rule.is_active ? (\r\n                          <><CheckCircle className=\"h-3 w-3 mr-1\" /> Active</>\r\n                        ) : (\r\n                          <><ToggleLeft className=\"h-3 w-3 mr-1\" /> Inactive</>\r\n                        )}\r\n                      </Badge>\r\n                      <Badge variant=\"outline\">{getRuleTypeLabel(rule.rule_type)}</Badge>\r\n                    </div>\r\n                    <p className=\"text-sm text-gray-600 mb-3\">{rule.condition_description}</p>\r\n                    <div className=\"grid gap-3 md:grid-cols-3 text-sm\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <DollarSign className=\"h-4 w-4 text-gray-400\" />\r\n                        <span className=\"text-gray-600\">Type:</span>\r\n                        <span className=\"font-medium\">{getDeductionTypeLabel(rule.deduction_type)}</span>\r\n                      </div>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        {rule.deduction_type === 'percentage' ? (\r\n                          <Percent className=\"h-4 w-4 text-gray-400\" />\r\n                        ) : (\r\n                          <DollarSign className=\"h-4 w-4 text-gray-400\" />\r\n                        )}\r\n                        <span className=\"text-gray-600\">Value:</span>\r\n                        <span className=\"font-medium\">\r\n                          {rule.deduction_value}\r\n                          {rule.deduction_type === 'percentage' ? '%' : ''}\r\n                        </span>\r\n                      </div>\r\n                      {rule.grace_minutes > 0 && (\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <Clock className=\"h-4 w-4 text-gray-400\" />\r\n                          <span className=\"text-gray-600\">Grace:</span>\r\n                          <span className=\"font-medium\">{rule.grace_minutes} min</span>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex gap-2\">\r\n                    <Button\r\n                      variant=\"outline\"\r\n                      size=\"sm\"\r\n                      onClick={() => handleEdit(rule)}\r\n                    >\r\n                      <Edit2 className=\"h-4 w-4\" />\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          ))\r\n        )}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\finance\\DonationForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":15,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[496,499],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[496,499],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":48,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":48,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1330,1333],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1330,1333],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":69,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2060,2063],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2060,2063],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":97,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":97,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3025,3028],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3025,3028],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"﻿'use client'\n\nimport { useForm } from 'react-hook-form'\nimport { useMutation, useQueryClient } from '@tanstack/react-query'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { financeService } from '@/services/financeService'\nimport { toast } from '@/components/ui/toast'\nimport { X } from 'lucide-react'\n\ninterface DonationFormProps {\n  onClose: () => void\n  onSuccess?: () => void\n  initialData?: any\n}\n\ntype DonationFormData = {\n  donor_name: string\n  amount: number\n  date: string\n  purpose?: string\n  receipt_number: string\n}\n\nexport function DonationForm({ onClose, onSuccess, initialData }: DonationFormProps) {\n  const queryClient = useQueryClient()\n\n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n  } = useForm<DonationFormData>({\n    defaultValues: initialData || {\n      date: new Date().toISOString().split('T')[0],\n      receipt_number: `REC-${Date.now()}`,\n    },\n  })\n\n  const createMutation = useMutation({\n    mutationFn: (data: DonationFormData) => financeService.createDonation(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['donations'] })\n      toast.success('Donation recorded successfully!')\n      onSuccess?.()\n      onClose()\n    },\n    onError: (error: any) => {\n      toast.error(error?.response?.data?.detail || 'Failed to record donation')\n    }\n  })\n\n  const updateMutation = useMutation({\n    mutationFn: (data: DonationFormData) => {\n      // CRITICAL: Ensure date is a string and amount is a number\n      const safeData = {\n        ...data,\n        date: typeof data.date === 'string' ? data.date : new Date(data.date).toISOString().split('T')[0],\n        amount: Number(data.amount)\n      };\n      return financeService.updateDonation(initialData.id, safeData);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['donations'] })\n      toast.success('Donation updated successfully!')\n      onSuccess?.()\n      onClose()\n    },\n    onError: (error: any) => {\n      console.error('❌ API Error:', error);\n      toast.error(error?.response?.data?.detail || 'Failed to update donation')\n    }\n  })\n\n  const onSubmit = (data: DonationFormData) => {\n    \n    // Robust date conversion to YYYY-MM-DD format\n    let dateString: string;\n    const dateValue = data.date;\n    \n    if (typeof dateValue === 'string') {\n      // Check if already in YYYY-MM-DD format\n      if (/^\\d{4}-\\d{2}-\\d{2}$/.test(dateValue)) {\n        dateString = dateValue;\n      } else {\n        // Try to parse other formats (MM/DD/YYYY, etc.)\n        const parsed = new Date(dateValue);\n        if (!isNaN(parsed.getTime())) {\n          dateString = parsed.toISOString().split('T')[0];\n        } else {\n          // Fallback to today\n          dateString = new Date().toISOString().split('T')[0];\n        }\n      }\n    } else if (dateValue && typeof dateValue === 'object') {\n      // Check if it's a Date object\n      const dateObj = dateValue as any;\n      if (dateObj instanceof Date) {\n        dateString = dateObj.toISOString().split('T')[0];\n      } else {\n        // Handle Date-like objects\n        const parsed = new Date(dateObj);\n        dateString = parsed.toISOString().split('T')[0];\n      }\n    } else {\n      // Last resort\n      dateString = new Date().toISOString().split('T')[0];\n    }\n    \n    \n    const formattedData = {\n      donor_name: data.donor_name,\n      amount: Number(data.amount),\n      date: dateString,\n      purpose: data.purpose || undefined,\n      receipt_number: data.receipt_number\n    }\n    \n    \n    if (initialData) {\n      updateMutation.mutate(formattedData)\n    } else {\n      createMutation.mutate(formattedData)\n    }\n  }\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50\">\n      <div className=\"w-full max-w-md rounded-lg bg-white p-6 shadow-xl\">\n        <div className=\"mb-4 flex items-center justify-between\">\n          <h2 className=\"text-2xl font-bold\">\n            {initialData ? 'Edit Donation' : 'Record Donation'}\n          </h2>\n          <button\n            onClick={onClose}\n            className=\"rounded-full p-1 hover:bg-gray-100\"\n          >\n            <X className=\"h-5 w-5\" />\n          </button>\n        </div>\n\n        <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-4\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"donor_name\">Donor Name *</Label>\n            <Input\n              id=\"donor_name\"\n              {...register('donor_name', { required: 'Donor name is required' })}\n              placeholder=\"Name of donor or organization\"\n            />\n            {errors.donor_name && (\n              <p className=\"text-sm text-red-600\">{errors.donor_name.message}</p>\n            )}\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"amount\">Amount *</Label>\n            <Input\n              type=\"number\"\n              step=\"0.01\"\n              id=\"amount\"\n              {...register('amount', {\n                required: 'Amount is required',\n                valueAsNumber: true,\n                min: { value: 0.01, message: 'Amount must be greater than 0' },\n              })}\n              placeholder=\"0.00\"\n            />\n            {errors.amount && (\n              <p className=\"text-sm text-red-600\">{errors.amount.message}</p>\n            )}\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"date\">Date *</Label>\n            <Input\n              type=\"date\"\n              id=\"date\"\n              {...register('date', { required: 'Date is required' })}\n              max={new Date().toISOString().split('T')[0]}\n            />\n            {errors.date && (\n              <p className=\"text-sm text-red-600\">{errors.date.message}</p>\n            )}\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"purpose\">Purpose (Optional)</Label>\n            <textarea\n              id=\"purpose\"\n              {...register('purpose')}\n              className=\"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\"\n              placeholder=\"Purpose of donation (e.g., Building fund, Scholarship, General)\"\n            />\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"receipt_number\">Receipt Number *</Label>\n            <Input\n              id=\"receipt_number\"\n              {...register('receipt_number', { required: 'Receipt number is required' })}\n              placeholder=\"Unique receipt number\"\n            />\n            {errors.receipt_number && (\n              <p className=\"text-sm text-red-600\">{errors.receipt_number.message}</p>\n            )}\n            <p className=\"text-xs text-gray-600\">\n              A unique identifier for this donation receipt\n            </p>\n          </div>\n\n          <div className=\"flex gap-2\">\n            <Button\n              type=\"submit\"\n              className=\"flex-1\"\n              disabled={createMutation.isPending || updateMutation.isPending}\n            >\n              {createMutation.isPending || updateMutation.isPending\n                ? 'Saving...'\n                : initialData\n                ? 'Update Donation'\n                : 'Record Donation'}\n            </Button>\n            <Button type=\"button\" variant=\"outline\" onClick={onClose}>\n              Cancel\n            </Button>\n          </div>\n        </form>\n      </div>\n    </div>\n  )\n}\n\n\n\n\n\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\finance\\ExpenseForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":15,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[495,498],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[495,498],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":46,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1251,1254],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1251,1254],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":67,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":67,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1973,1976],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1973,1976],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":95,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2936,2939],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2936,2939],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"﻿'use client'\n\nimport { useForm } from 'react-hook-form'\nimport { useMutation, useQueryClient } from '@tanstack/react-query'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { financeService } from '@/services/financeService'\nimport { toast } from '@/components/ui/toast'\nimport { X } from 'lucide-react'\n\ninterface ExpenseFormProps {\n  onClose: () => void\n  onSuccess?: () => void\n  initialData?: any\n}\n\ntype ExpenseFormData = {\n  category: string\n  amount: number\n  description: string\n  date: string\n}\n\nexport function ExpenseForm({ onClose, onSuccess, initialData }: ExpenseFormProps) {\n  const queryClient = useQueryClient()\n\n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n  } = useForm<ExpenseFormData>({\n    defaultValues: initialData || {\n      date: new Date().toISOString().split('T')[0],\n    },\n  })\n\n  const createMutation = useMutation({\n    mutationFn: (data: ExpenseFormData) => financeService.createExpense(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['expenses'] })\n      toast.success('Expense added successfully!')\n      onSuccess?.()\n      onClose()\n    },\n    onError: (error: any) => {\n      toast.error(error?.response?.data?.detail || 'Failed to add expense')\n    }\n  })\n\n  const updateMutation = useMutation({\n    mutationFn: (data: ExpenseFormData) => {\n      // CRITICAL: Ensure date is a string and amount is a number\n      const safeData = {\n        ...data,\n        date: typeof data.date === 'string' ? data.date : new Date(data.date).toISOString().split('T')[0],\n        amount: Number(data.amount)\n      };\n      return financeService.updateExpense(initialData.id, safeData);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['expenses'] })\n      toast.success('Expense updated successfully!')\n      onSuccess?.()\n      onClose()\n    },\n    onError: (error: any) => {\n      console.error('❌ API Error:', error);\n      toast.error(error?.response?.data?.detail || 'Failed to update expense')\n    }\n  })\n\n  const onSubmit = (data: ExpenseFormData) => {\n    \n    // Robust date conversion to YYYY-MM-DD format\n    let dateString: string;\n    const dateValue = data.date;\n    \n    if (typeof dateValue === 'string') {\n      // Check if already in YYYY-MM-DD format\n      if (/^\\d{4}-\\d{2}-\\d{2}$/.test(dateValue)) {\n        dateString = dateValue;\n      } else {\n        // Try to parse other formats (MM/DD/YYYY, etc.)\n        const parsed = new Date(dateValue);\n        if (!isNaN(parsed.getTime())) {\n          dateString = parsed.toISOString().split('T')[0];\n        } else {\n          // Fallback to today\n          dateString = new Date().toISOString().split('T')[0];\n        }\n      }\n    } else if (dateValue && typeof dateValue === 'object') {\n      // Check if it's a Date object\n      const dateObj = dateValue as any;\n      if (dateObj instanceof Date) {\n        dateString = dateObj.toISOString().split('T')[0];\n      } else {\n        // Handle Date-like objects\n        const parsed = new Date(dateObj);\n        dateString = parsed.toISOString().split('T')[0];\n      }\n    } else {\n      // Last resort\n      dateString = new Date().toISOString().split('T')[0];\n    }\n    \n    \n    const formattedData = {\n      category: data.category,\n      amount: Number(data.amount),\n      description: data.description,\n      date: dateString\n    }\n    \n    \n    if (initialData) {\n      updateMutation.mutate(formattedData)\n    } else {\n      createMutation.mutate(formattedData)\n    }\n  }\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50\">\n      <div className=\"w-full max-w-md rounded-lg bg-white p-6 shadow-xl\">\n        <div className=\"mb-4 flex items-center justify-between\">\n          <h2 className=\"text-2xl font-bold\">\n            {initialData ? 'Edit Expense' : 'Add Expense'}\n          </h2>\n          <button\n            onClick={onClose}\n            className=\"rounded-full p-1 hover:bg-gray-100\"\n          >\n            <X className=\"h-5 w-5\" />\n          </button>\n        </div>\n\n        <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-4\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"category\">Category *</Label>\n            <select\n              id=\"category\"\n              {...register('category', { required: 'Category is required' })}\n              className=\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\"\n            >\n              <option value=\"\">Select category</option>\n              <option value=\"Utilities\">Utilities (Electricity, Water, Gas)</option>\n              <option value=\"Salaries\">Salaries & Wages</option>\n              <option value=\"Maintenance\">Maintenance & Repairs</option>\n              <option value=\"Supplies\">Supplies & Materials</option>\n              <option value=\"Transportation\">Transportation</option>\n              <option value=\"Marketing\">Marketing & Advertising</option>\n              <option value=\"Technology\">Technology & Equipment</option>\n              <option value=\"Events\">Events & Activities</option>\n              <option value=\"Professional Services\">Professional Services</option>\n              <option value=\"Insurance\">Insurance</option>\n              <option value=\"Rent\">Rent</option>\n              <option value=\"Other\">Other</option>\n            </select>\n            {errors.category && (\n              <p className=\"text-sm text-red-600\">{errors.category.message}</p>\n            )}\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"amount\">Amount *</Label>\n            <Input\n              type=\"number\"\n              step=\"0.01\"\n              id=\"amount\"\n              {...register('amount', {\n                required: 'Amount is required',\n                valueAsNumber: true,\n                min: { value: 0.01, message: 'Amount must be greater than 0' },\n              })}\n              placeholder=\"0.00\"\n            />\n            {errors.amount && (\n              <p className=\"text-sm text-red-600\">{errors.amount.message}</p>\n            )}\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"description\">Description *</Label>\n            <textarea\n              id=\"description\"\n              {...register('description', { required: 'Description is required' })}\n              className=\"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\"\n              placeholder=\"Describe the expense...\"\n            />\n            {errors.description && (\n              <p className=\"text-sm text-red-600\">{errors.description.message}</p>\n            )}\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"date\">Date *</Label>\n            <Input\n              type=\"date\"\n              id=\"date\"\n              {...register('date', { required: 'Date is required' })}\n              max={new Date().toISOString().split('T')[0]}\n            />\n            {errors.date && (\n              <p className=\"text-sm text-red-600\">{errors.date.message}</p>\n            )}\n          </div>\n\n          <div className=\"flex gap-2\">\n            <Button\n              type=\"submit\"\n              className=\"flex-1\"\n              disabled={createMutation.isPending || updateMutation.isPending}\n            >\n              {createMutation.isPending || updateMutation.isPending\n                ? 'Saving...'\n                : initialData\n                ? 'Update Expense'\n                : 'Add Expense'}\n            </Button>\n            <Button type=\"button\" variant=\"outline\" onClick={onClose}>\n              Cancel\n            </Button>\n          </div>\n        </form>\n      </div>\n    </div>\n  )\n}\n\n\n\n\n\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\finance\\SalaryCalculator.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'MonthlySalaryCalculation' is defined but never used.","line":13,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":59},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Save' is defined but never used.","line":18,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":7},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Users' is defined but never used.","line":23,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Calendar' is defined but never used.","line":24,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DollarSign' is defined but never used.","line":25,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TrendingDown' is defined but never used.","line":26,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Download' is defined but never used.","line":28,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":11},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":42,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":42,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1579,1582],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1579,1582],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":80,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":80,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2772,2775],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2772,2775],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":96,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":96,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3377,3380],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3377,3380],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":113,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":113,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4007,4010],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4007,4010],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":130,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":130,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4687,4690],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4687,4690],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":147,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":147,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5329,5332],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5329,5332],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":199,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":199,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6746,6749],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6746,6749],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":274,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":274,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9373,9376],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9373,9376],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":381,"column":97,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":381,"endColumn":100,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14006,14009],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14006,14009],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":16,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useMemo } from 'react'\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { Badge } from '@/components/ui/badge'\nimport { toast } from '@/components/ui/toast'\nimport { ConfirmDialog } from '@/components/shared/ConfirmDialog'\nimport { attendanceSalaryService, MonthlySalaryCalculation } from '@/services/attendanceSalaryService'\nimport { teacherService } from '@/services/teacherService'\nimport {\n  Calculator,\n  Eye,\n  Save,\n  CheckCircle,\n  XCircle,\n  AlertCircle,\n  RefreshCw,\n  Users,\n  Calendar,\n  DollarSign,\n  TrendingDown,\n  FileSpreadsheet,\n  Download,\n} from 'lucide-react'\n\nconst monthNames = [\n  'January', 'February', 'March', 'April', 'May', 'June',\n  'July', 'August', 'September', 'October', 'November', 'December'\n]\n\nexport function SalaryCalculator() {\n  const queryClient = useQueryClient()\n  const [selectedMonth, setSelectedMonth] = useState(new Date().getMonth() + 1)\n  const [selectedYear, setSelectedYear] = useState(new Date().getFullYear())\n  const [selectedTeacherIds, setSelectedTeacherIds] = useState<string[]>([])\n  const [previewTeacherId, setPreviewTeacherId] = useState<string | null>(null)\n  const [previewData, setPreviewData] = useState<any>(null)\n  const [confirmDialog, setConfirmDialog] = useState<{\n    open: boolean\n    title: string\n    description: string\n    onConfirm: () => void\n  }>({\n    open: false,\n    title: '',\n    description: '',\n    onConfirm: () => {},\n  })\n\n  // Fetch teachers\n  const { data: teachers = [] } = useQuery({\n    queryKey: ['teachers'],\n    queryFn: () => teacherService.getTeachers({ limit: 1000 }),\n  })\n\n  // Fetch salary calculations\n  const { data: calculations = [], isLoading: isLoadingCalculations } = useQuery({\n    queryKey: ['salary-calculations', selectedMonth, selectedYear],\n    queryFn: () =>\n      attendanceSalaryService.getSalaryCalculations({\n        month: selectedMonth,\n        year: selectedYear,\n      }),\n  })\n\n  // Calculate mutation\n  const calculateMutation = useMutation({\n    mutationFn: (data: { month: number; year: number; teacher_ids?: string[] }) =>\n      attendanceSalaryService.calculateMonthlySalary(data),\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['salary-calculations'] })\n      toast.success(`Calculated salaries for ${data.length} teacher(s) successfully!`)\n      setSelectedTeacherIds([])\n    },\n    onError: (error: any) => {\n      const errorMessage = error?.message || \n                          error?.response?.data?.message || \n                          error?.response?.data?.detail || \n                          'Failed to calculate salaries'\n      toast.error(errorMessage)\n    }\n  })\n\n  // Preview mutation\n  const previewMutation = useMutation({\n    mutationFn: ({ teacher_id, month, year }: { teacher_id: string; month: number; year: number }) =>\n      attendanceSalaryService.previewSalaryCalculation(teacher_id, month, year),\n    onSuccess: (data) => {\n      setPreviewData(data)\n    },\n    onError: (error: any) => {\n      const errorMessage = error?.message || \n                          error?.response?.data?.message || \n                          error?.response?.data?.detail || \n                          'Failed to preview salary'\n      toast.error(errorMessage)\n    }\n  })\n\n  // Approve mutation\n  const approveMutation = useMutation({\n    mutationFn: (calculation_id: string) =>\n      attendanceSalaryService.approveSalaryCalculation(calculation_id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['salary-calculations'] })\n      toast.success('Salary calculation approved!')\n    },\n    onError: (error: any) => {\n      const errorMessage = error?.message || \n                          error?.response?.data?.message || \n                          error?.response?.data?.detail || \n                          'Failed to approve calculation'\n      toast.error(errorMessage)\n    }\n  })\n\n  // Bulk approve mutation\n  const bulkApproveMutation = useMutation({\n    mutationFn: (calculation_ids: string[]) =>\n      attendanceSalaryService.bulkApproveSalaryCalculations(calculation_ids),\n    onSuccess: (result) => {\n      queryClient.invalidateQueries({ queryKey: ['salary-calculations'] })\n      toast.success(`Approved ${result.approved_count} calculation(s)!`)\n    },\n    onError: (error: any) => {\n      const errorMessage = error?.message || \n                          error?.response?.data?.message || \n                          error?.response?.data?.detail || \n                          'Failed to approve calculations'\n      toast.error(errorMessage)\n    }\n  })\n\n  // Recalculate mutation\n  const recalculateMutation = useMutation({\n    mutationFn: (calculation_id: string) =>\n      attendanceSalaryService.recalculateSalary(calculation_id),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['salary-calculations'] })\n      toast.success('Salary recalculated successfully!')\n    },\n    onError: (error: any) => {\n      const errorMessage = error?.message || \n                          error?.response?.data?.message || \n                          error?.response?.data?.detail || \n                          'Failed to recalculate salary'\n      toast.error(errorMessage)\n    }\n  })\n\n  const handleCalculate = () => {\n    if (!selectedMonth || !selectedYear) {\n      toast.error('Please select month and year')\n      return\n    }\n\n    calculateMutation.mutate({\n      month: selectedMonth,\n      year: selectedYear,\n      teacher_ids: selectedTeacherIds.length > 0 ? selectedTeacherIds : undefined,\n    })\n  }\n\n  const handlePreview = (teacher_id: string) => {\n    setPreviewTeacherId(teacher_id)\n    previewMutation.mutate({\n      teacher_id,\n      month: selectedMonth,\n      year: selectedYear,\n    })\n  }\n\n  const handleBulkApprove = () => {\n    const unapprovedIds = calculations\n      .filter((calc) => !calc.is_approved)\n      .map((calc) => calc.id)\n    \n    if (unapprovedIds.length === 0) {\n      toast.info('No unapproved calculations to approve')\n      return\n    }\n\n    if (confirm(`Approve ${unapprovedIds.length} calculation(s)?`)) {\n      bulkApproveMutation.mutate(unapprovedIds)\n    }\n  }\n\n  const pendingApprovals = useMemo(\n    () => calculations.filter((calc) => !calc.is_approved).length,\n    [calculations]\n  )\n\n  const getTeacherName = (teacherId: string) => {\n    const teacher = teachers.find((t: any) => t.id === teacherId)\n    return teacher?.user?.full_name || 'Unknown'\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Calculation Controls */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Calculator className=\"h-5 w-5\" />\n            Salary Calculation\n          </CardTitle>\n          <CardDescription>\n            Calculate teacher salaries based on attendance for a specific month\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid gap-4 md:grid-cols-3\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"month\">Month</Label>\n              <Select\n                value={selectedMonth.toString()}\n                onValueChange={(value) => setSelectedMonth(parseInt(value))}\n              >\n                <SelectTrigger>\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  {monthNames.map((month, index) => (\n                    <SelectItem key={index + 1} value={(index + 1).toString()}>\n                      {month}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"year\">Year</Label>\n              <Input\n                type=\"number\"\n                id=\"year\"\n                value={selectedYear}\n                onChange={(e) => setSelectedYear(parseInt(e.target.value) || new Date().getFullYear())}\n                min={2020}\n                max={2100}\n              />\n            </div>\n\n            <div className=\"flex items-end\">\n              <Button\n                onClick={handleCalculate}\n                disabled={calculateMutation.isPending}\n                className=\"w-full\"\n              >\n                {calculateMutation.isPending ? (\n                  <>\n                    <RefreshCw className=\"h-4 w-4 mr-2 animate-spin\" />\n                    Calculating...\n                  </>\n                ) : (\n                  <>\n                    <Calculator className=\"h-4 w-4 mr-2\" />\n                    Calculate Salaries\n                  </>\n                )}\n              </Button>\n            </div>\n          </div>\n\n          {/* Teacher Selection (Optional) */}\n          <div className=\"mt-4 space-y-2\">\n            <Label>Select Teachers (Optional - Leave empty for all teachers)</Label>\n            <div className=\"max-h-32 overflow-y-auto border rounded-md p-2 space-y-1\">\n              {teachers.map((teacher: any) => (\n                <div key={teacher.id} className=\"flex items-center gap-2\">\n                  <input\n                    type=\"checkbox\"\n                    id={`teacher-${teacher.id}`}\n                    checked={selectedTeacherIds.includes(teacher.id)}\n                    onChange={(e) => {\n                      if (e.target.checked) {\n                        setSelectedTeacherIds([...selectedTeacherIds, teacher.id])\n                      } else {\n                        setSelectedTeacherIds(selectedTeacherIds.filter((id) => id !== teacher.id))\n                      }\n                    }}\n                    className=\"h-4 w-4 rounded border-gray-300\"\n                  />\n                  <label\n                    htmlFor={`teacher-${teacher.id}`}\n                    className=\"text-sm cursor-pointer flex-1\"\n                  >\n                    {teacher.user?.full_name || 'Unknown'} ({teacher.employee_id})\n                  </label>\n                </div>\n              ))}\n            </div>\n          </div>\n\n          {/* Bulk Actions */}\n          {calculations.length > 0 && (\n            <div className=\"mt-4 flex gap-2\">\n              {pendingApprovals > 0 && (\n                <Button\n                  variant=\"outline\"\n                  onClick={handleBulkApprove}\n                  disabled={bulkApproveMutation.isPending}\n                >\n                  <CheckCircle className=\"h-4 w-4 mr-2\" />\n                  Approve All ({pendingApprovals})\n                </Button>\n              )}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Preview Modal */}\n      {previewData && previewTeacherId && (\n        <Card className=\"border-2 border-blue-300\">\n          <CardHeader>\n            <div className=\"flex justify-between items-start\">\n              <div>\n                <CardTitle>Salary Preview</CardTitle>\n                <CardDescription>\n                  {getTeacherName(previewTeacherId)} - {monthNames[selectedMonth - 1]} {selectedYear}\n                </CardDescription>\n              </div>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => {\n                  setPreviewData(null)\n                  setPreviewTeacherId(null)\n                }}\n              >\n                <XCircle className=\"h-4 w-4\" />\n              </Button>\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid gap-4 md:grid-cols-2\">\n              <div className=\"space-y-3\">\n                <div>\n                  <p className=\"text-sm text-gray-600\">Basic Salary</p>\n                  <p className=\"text-lg font-semibold\">${previewData.basic_salary?.toFixed(2) || '0.00'}</p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-gray-600\">Per Day Salary</p>\n                  <p className=\"text-lg font-semibold\">${previewData.per_day_salary?.toFixed(2) || '0.00'}</p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-gray-600\">Total Working Days</p>\n                  <p className=\"text-lg font-semibold\">{previewData.total_working_days || 0}</p>\n                </div>\n              </div>\n              <div className=\"space-y-3\">\n                <div>\n                  <p className=\"text-sm text-gray-600\">Present Days</p>\n                  <p className=\"text-lg font-semibold text-green-600\">{previewData.present_days || 0}</p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-gray-600\">Absent Days</p>\n                  <p className=\"text-lg font-semibold text-red-600\">{previewData.absent_days || 0}</p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-gray-600\">Late Days</p>\n                  <p className=\"text-lg font-semibold text-yellow-600\">{previewData.late_days || 0}</p>\n                </div>\n              </div>\n            </div>\n            <div className=\"mt-4 pt-4 border-t\">\n              <div className=\"flex justify-between items-center mb-2\">\n                <span className=\"text-sm text-gray-600\">Total Deductions</span>\n                <span className=\"text-lg font-semibold text-red-600\">\n                  ${previewData.total_deductions?.toFixed(2) || '0.00'}\n                </span>\n              </div>\n              {previewData.deductions_by_rule && Object.keys(previewData.deductions_by_rule).length > 0 && (\n                <div className=\"mt-2 space-y-1\">\n                  {Object.entries(previewData.deductions_by_rule).map(([rule, amount]: [string, any]) => (\n                    <div key={rule} className=\"flex justify-between text-xs text-gray-500\">\n                      <span>{rule}:</span>\n                      <span>${amount?.toFixed(2) || '0.00'}</span>\n                    </div>\n                  ))}\n                </div>\n              )}\n              <div className=\"mt-4 pt-4 border-t\">\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-lg font-semibold\">Net Salary</span>\n                  <span className=\"text-2xl font-bold text-blue-600\">\n                    ${previewData.net_salary?.toFixed(2) || '0.00'}\n                  </span>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Calculations List */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center justify-between\">\n            <span className=\"flex items-center gap-2\">\n              <FileSpreadsheet className=\"h-5 w-5\" />\n              Calculated Salaries - {monthNames[selectedMonth - 1]} {selectedYear}\n            </span>\n            {calculations.length > 0 && (\n              <Badge variant=\"outline\">\n                {calculations.length} calculation(s)\n              </Badge>\n            )}\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          {isLoadingCalculations ? (\n            <div className=\"text-center py-8\">Loading calculations...</div>\n          ) : calculations.length === 0 ? (\n            <div className=\"text-center py-8 text-gray-500\">\n              <Calculator className=\"h-12 w-12 mx-auto mb-4 text-gray-300\" />\n              <p className=\"text-lg font-medium mb-2\">No calculations found</p>\n              <p className=\"text-sm\">Calculate salaries for the selected month to get started</p>\n            </div>\n          ) : (\n            <div className=\"space-y-4\">\n              {calculations.map((calc) => (\n                <Card key={calc.id} className={calc.is_approved ? 'border-green-300 bg-green-50' : ''}>\n                  <CardContent className=\"pt-6\">\n                    <div className=\"flex justify-between items-start\">\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-3 mb-3\">\n                          <h4 className=\"font-semibold text-lg\">\n                            {getTeacherName(calc.teacher_id)}\n                          </h4>\n                          {calc.is_approved ? (\n                            <Badge className=\"bg-green-600\">\n                              <CheckCircle className=\"h-3 w-3 mr-1\" />\n                              Approved\n                            </Badge>\n                          ) : (\n                            <Badge variant=\"outline\">\n                              <AlertCircle className=\"h-3 w-3 mr-1\" />\n                              Pending\n                            </Badge>\n                          )}\n                        </div>\n                        \n                        <div className=\"grid gap-4 md:grid-cols-4 mb-4\">\n                          <div>\n                            <p className=\"text-xs text-gray-600\">Basic Salary</p>\n                            <p className=\"font-semibold\">${calc.basic_salary.toFixed(2)}</p>\n                          </div>\n                          <div>\n                            <p className=\"text-xs text-gray-600\">Present Days</p>\n                            <p className=\"font-semibold text-green-600\">{calc.present_days}</p>\n                          </div>\n                          <div>\n                            <p className=\"text-xs text-gray-600\">Deductions</p>\n                            <p className=\"font-semibold text-red-600\">${calc.total_deductions.toFixed(2)}</p>\n                          </div>\n                          <div>\n                            <p className=\"text-xs text-gray-600\">Net Salary</p>\n                            <p className=\"font-semibold text-blue-600 text-lg\">${calc.net_salary.toFixed(2)}</p>\n                          </div>\n                        </div>\n\n                        <div className=\"flex gap-2 text-xs text-gray-600\">\n                          <span>Absent: {calc.absent_days}</span>\n                          <span>|</span>\n                          <span>Half Day: {calc.half_days}</span>\n                          <span>|</span>\n                          <span>Late: {calc.late_days}</span>\n                          <span>|</span>\n                          <span>Working Days: {calc.total_working_days}</span>\n                        </div>\n                      </div>\n\n                      <div className=\"flex gap-2\">\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={() => handlePreview(calc.teacher_id)}\n                          disabled={previewMutation.isPending}\n                        >\n                          <Eye className=\"h-4 w-4\" />\n                        </Button>\n                        {!calc.is_approved && (\n                          <>\n                            <Button\n                              variant=\"outline\"\n                              size=\"sm\"\n                              onClick={() => {\n                                if (confirm('Recalculate this salary? This will reset approval status.')) {\n                                  recalculateMutation.mutate(calc.id)\n                                }\n                              }}\n                              disabled={recalculateMutation.isPending}\n                            >\n                              <RefreshCw className=\"h-4 w-4\" />\n                            </Button>\n                            <Button\n                              size=\"sm\"\n                              onClick={() => {\n                                setConfirmDialog({\n                                  open: true,\n                                  title: 'Approve Salary Calculation',\n                                  description: 'Are you sure you want to approve this salary calculation?',\n                                  onConfirm: () => {\n                                    approveMutation.mutate(calc.id)\n                                  },\n                                })\n                              }}\n                              disabled={approveMutation.isPending}\n                            >\n                              <CheckCircle className=\"h-4 w-4\" />\n                            </Button>\n                          </>\n                        )}\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Confirm Dialog */}\n      <ConfirmDialog\n        open={confirmDialog.open}\n        onOpenChange={(open) => setConfirmDialog({ ...confirmDialog, open })}\n        title={confirmDialog.title}\n        description={confirmDialog.description}\n        onConfirm={confirmDialog.onConfirm}\n        variant=\"default\"\n      />\n    </div>\n  )\n}\n\n\n\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\finance\\SalaryConfigForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":20,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[826,829],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[826,829],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":90,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":90,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3050,3053],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3050,3053],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":113,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":113,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4051,4054],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4051,4054],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":177,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":177,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6587,6590],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6587,6590],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport { useState } from 'react'\r\nimport { useForm } from 'react-hook-form'\r\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Input } from '@/components/ui/input'\r\nimport { Label } from '@/components/ui/label'\r\nimport { Textarea } from '@/components/ui/textarea'\r\nimport { attendanceSalaryService } from '@/services/attendanceSalaryService'\r\nimport { teacherService } from '@/services/teacherService'\r\nimport { toast } from '@/components/ui/toast'\r\nimport { X, Calculator, Calendar, DollarSign } from 'lucide-react'\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\r\n\r\ninterface SalaryConfigFormProps {\r\n  onClose: () => void\r\n  onSuccess?: () => void\r\n  teacherId?: string\r\n  initialData?: any\r\n}\r\n\r\ntype SalaryConfigFormData = {\r\n  teacher_id: string\r\n  basic_monthly_salary: number\r\n  per_day_salary: number\r\n  effective_from: string\r\n  effective_to?: string\r\n  is_active?: boolean\r\n}\r\n\r\nexport function SalaryConfigForm({ onClose, onSuccess, teacherId, initialData }: SalaryConfigFormProps) {\r\n  const queryClient = useQueryClient()\r\n  const [adjustmentReason, setAdjustmentReason] = useState('')\r\n  const [autoCalculatePerDay, setAutoCalculatePerDay] = useState(true)\r\n\r\n  const {\r\n    register,\r\n    handleSubmit,\r\n    watch,\r\n    setValue,\r\n    formState: { errors },\r\n  } = useForm<SalaryConfigFormData>({\r\n    defaultValues: initialData || {\r\n      teacher_id: teacherId || '',\r\n      effective_from: new Date().toISOString().split('T')[0],\r\n      is_active: true,\r\n      per_day_salary: 0,\r\n    },\r\n  })\r\n\r\n  const basicSalary = watch('basic_monthly_salary') || 0\r\n  const effectiveFrom = watch('effective_from')\r\n\r\n  // Fetch teachers\r\n  const { data: teachers = [] } = useQuery({\r\n    queryKey: ['teachers'],\r\n    queryFn: () => teacherService.getTeachers({ limit: 1000 }),\r\n    enabled: !teacherId,\r\n  })\r\n\r\n  // Calculate per day salary automatically\r\n  const handleBasicSalaryChange = (value: number) => {\r\n    if (autoCalculatePerDay && value > 0) {\r\n      // Assuming 30 working days per month (can be customized)\r\n      const perDay = value / 30\r\n      setValue('per_day_salary', parseFloat(perDay.toFixed(2)))\r\n    }\r\n  }\r\n\r\n  const createMutation = useMutation({\r\n    mutationFn: (data: SalaryConfigFormData) => \r\n      attendanceSalaryService.createTeacherSalaryConfig(\r\n        {\r\n          teacher_id: data.teacher_id,\r\n          basic_monthly_salary: Number(data.basic_monthly_salary),\r\n          per_day_salary: Number(data.per_day_salary),\r\n          effective_from: data.effective_from,\r\n          effective_to: data.effective_to || undefined,\r\n          is_active: data.is_active ?? true,\r\n        },\r\n        adjustmentReason || undefined\r\n      ),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['teacher-salary-config'] })\r\n      toast.success('Salary configuration created successfully!')\r\n      onSuccess?.()\r\n      onClose()\r\n    },\r\n    onError: (error: any) => {\r\n      const errorMessage = error?.message || \r\n                          error?.response?.data?.message || \r\n                          error?.response?.data?.detail || \r\n                          'Failed to create salary configuration'\r\n      toast.error(errorMessage)\r\n    }\r\n  })\r\n\r\n  const updateMutation = useMutation({\r\n    mutationFn: (data: Partial<SalaryConfigFormData>) =>\r\n      attendanceSalaryService.updateTeacherSalaryConfig(initialData.id, {\r\n        basic_monthly_salary: data.basic_monthly_salary ? Number(data.basic_monthly_salary) : undefined,\r\n        per_day_salary: data.per_day_salary ? Number(data.per_day_salary) : undefined,\r\n        effective_to: data.effective_to || undefined,\r\n        is_active: data.is_active,\r\n      }),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['teacher-salary-config'] })\r\n      toast.success('Salary configuration updated successfully!')\r\n      onSuccess?.()\r\n      onClose()\r\n    },\r\n    onError: (error: any) => {\r\n      const errorMessage = error?.message || \r\n                          error?.response?.data?.message || \r\n                          error?.response?.data?.detail || \r\n                          'Failed to update salary configuration'\r\n      toast.error(errorMessage)\r\n    }\r\n  })\r\n\r\n  const onSubmit = (data: SalaryConfigFormData) => {\r\n    if (!data.teacher_id) {\r\n      toast.error('Please select a teacher')\r\n      return\r\n    }\r\n\r\n    if (data.basic_monthly_salary <= 0) {\r\n      toast.error('Basic salary must be greater than 0')\r\n      return\r\n    }\r\n\r\n    if (data.per_day_salary <= 0) {\r\n      toast.error('Per day salary must be greater than 0')\r\n      return\r\n    }\r\n\r\n    if (initialData) {\r\n      updateMutation.mutate(data)\r\n    } else {\r\n      createMutation.mutate(data)\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4\">\r\n      <div className=\"w-full max-w-2xl rounded-lg bg-white shadow-xl max-h-[90vh] overflow-y-auto\">\r\n        <div className=\"sticky top-0 bg-white border-b p-6 flex items-center justify-between z-10\">\r\n          <div>\r\n            <h2 className=\"text-2xl font-bold flex items-center gap-2\">\r\n              <DollarSign className=\"h-6 w-6\" />\r\n              {initialData ? 'Update Salary Configuration' : 'Set Teacher Salary'}\r\n            </h2>\r\n            <p className=\"text-sm text-gray-600 mt-1\">\r\n              {initialData ? 'Update salary configuration for teacher' : 'Configure monthly and per-day salary'}\r\n            </p>\r\n          </div>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"rounded-full p-1 hover:bg-gray-100\"\r\n          >\r\n            <X className=\"h-5 w-5\" />\r\n          </button>\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit(onSubmit)} className=\"p-6 space-y-6\">\r\n          {/* Teacher Selection - Only for new records */}\r\n          {!initialData && !teacherId && (\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"teacher_id\">Teacher *</Label>\r\n              <select\r\n                id=\"teacher_id\"\r\n                {...register('teacher_id', { required: 'Teacher is required' })}\r\n                className=\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\r\n              >\r\n                <option value=\"\">Select teacher</option>\r\n                {teachers.map((teacher: any) => (\r\n                  <option key={teacher.id} value={teacher.id}>\r\n                    {teacher.user?.full_name || 'Unknown'} - {teacher.employee_id}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n              {errors.teacher_id && (\r\n                <p className=\"text-sm text-red-600\">{errors.teacher_id.message}</p>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"grid gap-6 md:grid-cols-2\">\r\n            {/* Basic Monthly Salary */}\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"basic_monthly_salary\" className=\"flex items-center gap-2\">\r\n                <DollarSign className=\"h-4 w-4\" />\r\n                Basic Monthly Salary *\r\n              </Label>\r\n              <Input\r\n                type=\"number\"\r\n                step=\"0.01\"\r\n                id=\"basic_monthly_salary\"\r\n                {...register('basic_monthly_salary', {\r\n                  required: 'Basic salary is required',\r\n                  valueAsNumber: true,\r\n                  min: { value: 0.01, message: 'Salary must be greater than 0' },\r\n                  onChange: (e) => {\r\n                    const value = parseFloat(e.target.value)\r\n                    if (!isNaN(value)) {\r\n                      handleBasicSalaryChange(value)\r\n                    }\r\n                  }\r\n                })}\r\n                placeholder=\"0.00\"\r\n              />\r\n              {errors.basic_monthly_salary && (\r\n                <p className=\"text-sm text-red-600\">{errors.basic_monthly_salary.message}</p>\r\n              )}\r\n            </div>\r\n\r\n            {/* Per Day Salary */}\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"per_day_salary\" className=\"flex items-center gap-2\">\r\n                <Calculator className=\"h-4 w-4\" />\r\n                Per Day Salary *\r\n              </Label>\r\n              <div className=\"flex gap-2\">\r\n                <Input\r\n                  type=\"number\"\r\n                  step=\"0.01\"\r\n                  id=\"per_day_salary\"\r\n                  {...register('per_day_salary', {\r\n                    required: 'Per day salary is required',\r\n                    valueAsNumber: true,\r\n                    min: { value: 0.01, message: 'Per day salary must be greater than 0' },\r\n                  })}\r\n                  placeholder=\"0.00\"\r\n                  disabled={autoCalculatePerDay && !initialData}\r\n                  className={autoCalculatePerDay && !initialData ? 'bg-gray-100' : ''}\r\n                />\r\n                {!initialData && (\r\n                  <Button\r\n                    type=\"button\"\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    onClick={() => setAutoCalculatePerDay(!autoCalculatePerDay)}\r\n                    className=\"whitespace-nowrap\"\r\n                  >\r\n                    {autoCalculatePerDay ? 'Manual' : 'Auto'}\r\n                  </Button>\r\n                )}\r\n              </div>\r\n              {errors.per_day_salary && (\r\n                <p className=\"text-sm text-red-600\">{errors.per_day_salary.message}</p>\r\n              )}\r\n              {autoCalculatePerDay && !initialData && (\r\n                <p className=\"text-xs text-gray-500\">Auto-calculated as Basic Salary / 30 days</p>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"grid gap-6 md:grid-cols-2\">\r\n            {/* Effective From */}\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"effective_from\" className=\"flex items-center gap-2\">\r\n                <Calendar className=\"h-4 w-4\" />\r\n                Effective From *\r\n              </Label>\r\n              <Input\r\n                type=\"date\"\r\n                id=\"effective_from\"\r\n                {...register('effective_from', { required: 'Effective from date is required' })}\r\n                max={new Date().toISOString().split('T')[0]}\r\n              />\r\n              {errors.effective_from && (\r\n                <p className=\"text-sm text-red-600\">{errors.effective_from.message}</p>\r\n              )}\r\n            </div>\r\n\r\n            {/* Effective To */}\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"effective_to\">Effective To (Optional)</Label>\r\n              <Input\r\n                type=\"date\"\r\n                id=\"effective_to\"\r\n                {...register('effective_to')}\r\n                min={effectiveFrom || undefined}\r\n              />\r\n              <p className=\"text-xs text-gray-500\">Leave empty for indefinite duration</p>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Active Status - Only for updates */}\r\n          {initialData && (\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  id=\"is_active\"\r\n                  {...register('is_active')}\r\n                  className=\"h-4 w-4 rounded border-gray-300\"\r\n                />\r\n                <Label htmlFor=\"is_active\" className=\"cursor-pointer\">\r\n                  Active (Uncheck to deactivate this configuration)\r\n                </Label>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Adjustment Reason - For new records */}\r\n          {!initialData && (\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"adjustment_reason\">Adjustment Reason (Optional)</Label>\r\n              <Textarea\r\n                id=\"adjustment_reason\"\r\n                value={adjustmentReason}\r\n                onChange={(e) => setAdjustmentReason(e.target.value)}\r\n                placeholder=\"Reason for this salary configuration (e.g., 'Annual increment', 'Promotion', etc.)\"\r\n                rows={3}\r\n                className=\"resize-none\"\r\n              />\r\n              <p className=\"text-xs text-gray-500\">\r\n                This helps track salary history and changes\r\n              </p>\r\n            </div>\r\n          )}\r\n\r\n          {/* Salary Summary */}\r\n          {basicSalary > 0 && (\r\n            <Card className=\"bg-blue-50 border-blue-200\">\r\n              <CardHeader className=\"pb-3\">\r\n                <CardTitle className=\"text-sm\">Salary Summary</CardTitle>\r\n              </CardHeader>\r\n              <CardContent className=\"space-y-2 text-sm\">\r\n                <div className=\"flex justify-between\">\r\n                  <span className=\"text-gray-600\">Monthly Salary:</span>\r\n                  <span className=\"font-semibold\">${basicSalary.toFixed(2)}</span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span className=\"text-gray-600\">Per Day Salary:</span>\r\n                  <span className=\"font-semibold\">${watch('per_day_salary')?.toFixed(2) || '0.00'}</span>\r\n                </div>\r\n                <div className=\"flex justify-between pt-2 border-t border-blue-200\">\r\n                  <span className=\"text-gray-600\">Annual Salary:</span>\r\n                  <span className=\"font-bold text-blue-700\">${(basicSalary * 12).toFixed(2)}</span>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          )}\r\n\r\n          <div className=\"flex gap-3 pt-4 border-t\">\r\n            <Button\r\n              type=\"submit\"\r\n              className=\"flex-1\"\r\n              disabled={createMutation.isPending || updateMutation.isPending}\r\n            >\r\n              {createMutation.isPending || updateMutation.isPending\r\n                ? 'Saving...'\r\n                : initialData\r\n                ? 'Update Configuration'\r\n                : 'Save Configuration'}\r\n            </Button>\r\n            <Button type=\"button\" variant=\"outline\" onClick={onClose}>\r\n              Cancel\r\n            </Button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\finance\\SalaryForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":16,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[563,566],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[563,566],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":69,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1967,1970],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1967,1970],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":83,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":83,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2434,2437],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2434,2437],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":95,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2936,2939],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2936,2939],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":102,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":102,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3224,3227],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3224,3227],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":118,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":118,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3668,3671],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3668,3671],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":159,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":159,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5576,5579],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5576,5579],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useForm } from 'react-hook-form'\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { financeService } from '@/services/financeService'\nimport { teacherService } from '@/services/teacherService'\nimport { toast } from '@/components/ui/toast'\nimport { X } from 'lucide-react'\n\ninterface SalaryFormProps {\n  onClose: () => void\n  onSuccess?: () => void\n  initialData?: any\n}\n\ntype SalaryFormData = {\n  teacher_id: string\n  month: number\n  year: number\n  basic_salary: number\n  deductions: number\n  bonuses: number\n  paid_date?: string\n}\n\nexport function SalaryForm({ onClose, onSuccess, initialData }: SalaryFormProps) {\n  const queryClient = useQueryClient()\n  const currentDate = new Date()\n  const currentMonth = currentDate.getMonth() + 1\n  const currentYear = currentDate.getFullYear()\n\n  const {\n    register,\n    handleSubmit,\n    watch,\n    formState: { errors },\n  } = useForm<SalaryFormData>({\n    defaultValues: initialData || {\n      month: currentMonth,\n      year: currentYear,\n      deductions: 0,\n      bonuses: 0,\n    },\n  })\n\n  // Fetch teachers\n  const { data: teachers = [] } = useQuery({\n    queryKey: ['teachers'],\n    queryFn: () => teacherService.getTeachers({ limit: 1000 }),\n  })\n\n  // Watch values for net salary calculation\n  const basicSalary = watch('basic_salary') || 0\n  const deductions = watch('deductions') || 0\n  const bonuses = watch('bonuses') || 0\n  const netSalary = basicSalary + bonuses - deductions\n\n  const createMutation = useMutation({\n    mutationFn: (data: SalaryFormData) => financeService.createSalaryRecord(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['salaries'] })\n      toast.success('Salary record added successfully!')\n      onSuccess?.()\n      onClose()\n    },\n    onError: (error: any) => {\n      toast.error(error?.response?.data?.detail || 'Failed to add salary record')\n    }\n  })\n\n  const updateMutation = useMutation({\n    mutationFn: (data: Partial<SalaryFormData>) =>\n      financeService.updateSalaryRecord(initialData.id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['salaries'] })\n      toast.success('Salary record updated successfully!')\n      onSuccess?.()\n      onClose()\n    },\n    onError: (error: any) => {\n      toast.error(error?.response?.data?.detail || 'Failed to update salary record')\n    }\n  })\n\n  const onSubmit = (data: SalaryFormData) => {\n    // Ensure paid_date is properly formatted if provided\n    let paidDateString: string | undefined = undefined;\n    if (data.paid_date) {\n      if (typeof data.paid_date === 'string') {\n        paidDateString = data.paid_date;\n      } else if (data.paid_date && typeof data.paid_date === 'object') {\n        const paidDateObj = data.paid_date as any;\n        if (paidDateObj instanceof Date) {\n          paidDateString = paidDateObj.toISOString().split('T')[0];\n        } else {\n          paidDateString = new Date(paidDateObj).toISOString().split('T')[0];\n        }\n      } else {\n        paidDateString = new Date(data.paid_date as any).toISOString().split('T')[0];\n      }\n    }\n    \n    const formattedData = {\n      teacher_id: data.teacher_id,\n      month: Number(data.month),\n      year: Number(data.year),\n      basic_salary: Number(data.basic_salary),\n      deductions: Number(data.deductions),\n      bonuses: Number(data.bonuses),\n      paid_date: paidDateString\n    }\n    \n    if (initialData) {\n      // For updates, only send changed fields\n      const updateData: any = {}\n      if (data.deductions !== initialData.deductions) updateData.deductions = Number(data.deductions)\n      if (data.bonuses !== initialData.bonuses) updateData.bonuses = Number(data.bonuses)\n      if (data.paid_date) updateData.paid_date = paidDateString\n      updateMutation.mutate(updateData)\n    } else {\n      createMutation.mutate(formattedData)\n    }\n  }\n\n  const monthNames = [\n    'January', 'February', 'March', 'April', 'May', 'June',\n    'July', 'August', 'September', 'October', 'November', 'December'\n  ]\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50\">\n      <div className=\"w-full max-w-md rounded-lg bg-white p-6 shadow-xl max-h-[90vh] overflow-y-auto\">\n        <div className=\"mb-4 flex items-center justify-between\">\n          <h2 className=\"text-2xl font-bold\">\n            {initialData ? 'Update Salary Record' : 'Add Salary Record'}\n          </h2>\n          <button\n            onClick={onClose}\n            className=\"rounded-full p-1 hover:bg-gray-100\"\n          >\n            <X className=\"h-5 w-5\" />\n          </button>\n        </div>\n\n        <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-4\">\n          {/* Teacher Selection - Only for new records */}\n          {!initialData && (\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"teacher_id\">Teacher *</Label>\n              <select\n                id=\"teacher_id\"\n                {...register('teacher_id', { required: 'Teacher is required' })}\n                className=\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\"\n              >\n                <option value=\"\">Select teacher</option>\n                {teachers.map((teacher: any) => (\n                  <option key={teacher.id} value={teacher.id}>\n                    {teacher.user?.full_name || 'Unknown'} - {teacher.employee_id}\n                  </option>\n                ))}\n              </select>\n              {errors.teacher_id && (\n                <p className=\"text-sm text-red-600\">{errors.teacher_id.message}</p>\n              )}\n            </div>\n          )}\n\n          {/* Month - Only for new records */}\n          {!initialData && (\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"month\">Month *</Label>\n              <select\n                id=\"month\"\n                {...register('month', { \n                  required: 'Month is required',\n                  valueAsNumber: true,\n                  min: { value: 1, message: 'Invalid month' },\n                  max: { value: 12, message: 'Invalid month' }\n                })}\n                className=\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\"\n              >\n                {monthNames.map((month, index) => (\n                  <option key={index + 1} value={index + 1}>\n                    {month}\n                  </option>\n                ))}\n              </select>\n              {errors.month && (\n                <p className=\"text-sm text-red-600\">{errors.month.message}</p>\n              )}\n            </div>\n          )}\n\n          {/* Year - Only for new records */}\n          {!initialData && (\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"year\">Year *</Label>\n              <Input\n                type=\"number\"\n                id=\"year\"\n                {...register('year', {\n                  required: 'Year is required',\n                  valueAsNumber: true,\n                  min: { value: 2020, message: 'Year must be 2020 or later' },\n                  max: { value: 2100, message: 'Year must be before 2100' }\n                })}\n              />\n              {errors.year && (\n                <p className=\"text-sm text-red-600\">{errors.year.message}</p>\n              )}\n            </div>\n          )}\n\n          {/* Basic Salary - Only for new records */}\n          {!initialData && (\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"basic_salary\">Basic Salary *</Label>\n              <Input\n                type=\"number\"\n                step=\"0.01\"\n                id=\"basic_salary\"\n                {...register('basic_salary', {\n                  required: 'Basic salary is required',\n                  valueAsNumber: true,\n                  min: { value: 0, message: 'Salary must be positive' },\n                })}\n                placeholder=\"0.00\"\n              />\n              {errors.basic_salary && (\n                <p className=\"text-sm text-red-600\">{errors.basic_salary.message}</p>\n              )}\n            </div>\n          )}\n\n          {/* Deductions */}\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"deductions\">Deductions</Label>\n            <Input\n              type=\"number\"\n              step=\"0.01\"\n              id=\"deductions\"\n              {...register('deductions', {\n                valueAsNumber: true,\n                min: { value: 0, message: 'Deductions cannot be negative' },\n              })}\n              placeholder=\"0.00\"\n            />\n            {errors.deductions && (\n              <p className=\"text-sm text-red-600\">{errors.deductions.message}</p>\n            )}\n          </div>\n\n          {/* Bonuses */}\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"bonuses\">Bonuses</Label>\n            <Input\n              type=\"number\"\n              step=\"0.01\"\n              id=\"bonuses\"\n              {...register('bonuses', {\n                valueAsNumber: true,\n                min: { value: 0, message: 'Bonuses cannot be negative' },\n              })}\n              placeholder=\"0.00\"\n            />\n            {errors.bonuses && (\n              <p className=\"text-sm text-red-600\">{errors.bonuses.message}</p>\n            )}\n          </div>\n\n          {/* Net Salary Display */}\n          <div className=\"rounded-lg bg-blue-50 p-4\">\n            <div className=\"flex justify-between items-center\">\n              <span className=\"text-sm font-medium text-gray-700\">Net Salary:</span>\n              <span className=\"text-xl font-bold text-blue-600\">\n                ${netSalary.toFixed(2)}\n              </span>\n            </div>\n            <p className=\"text-xs text-gray-500 mt-1\">\n              Basic (${basicSalary.toFixed(2)}) + Bonuses (${bonuses.toFixed(2)}) - Deductions (${deductions.toFixed(2)})\n            </p>\n          </div>\n\n          {/* Paid Date */}\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"paid_date\">Paid Date (Optional)</Label>\n            <Input\n              type=\"date\"\n              id=\"paid_date\"\n              {...register('paid_date')}\n              max={new Date().toISOString().split('T')[0]}\n            />\n            <p className=\"text-xs text-gray-500\">Leave empty if not yet paid</p>\n          </div>\n\n          <div className=\"flex gap-2\">\n            <Button\n              type=\"submit\"\n              className=\"flex-1\"\n              disabled={createMutation.isPending || updateMutation.isPending}\n            >\n              {createMutation.isPending || updateMutation.isPending\n                ? 'Saving...'\n                : initialData\n                ? 'Update Record'\n                : 'Add Salary Record'}\n            </Button>\n            <Button type=\"button\" variant=\"outline\" onClick={onClose}>\n              Cancel\n            </Button>\n          </div>\n        </form>\n      </div>\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\finance\\StationeryItemForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":15,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[502,505],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[502,505],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":48,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":48,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1327,1330],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1327,1330],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":62,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":62,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1807,1810],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1807,1810],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":1,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":179,"column":18,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[6989,7071],"text":"\n              You&apos;ll be alerted when quantity falls below this level\n            "},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[6989,7071],"text":"\n              You&lsquo;ll be alerted when quantity falls below this level\n            "},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[6989,7071],"text":"\n              You&#39;ll be alerted when quantity falls below this level\n            "},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[6989,7071],"text":"\n              You&rsquo;ll be alerted when quantity falls below this level\n            "},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useForm } from 'react-hook-form'\nimport { useMutation, useQueryClient } from '@tanstack/react-query'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { financeService } from '@/services/financeService'\nimport { toast } from '@/components/ui/toast'\nimport { X } from 'lucide-react'\n\ninterface StationeryItemFormProps {\n  onClose: () => void\n  onSuccess?: () => void\n  initialData?: any\n}\n\ntype StationeryItemFormData = {\n  name: string\n  category: string\n  quantity: number\n  unit: string\n  reorder_level: number\n}\n\nexport function StationeryItemForm({ onClose, onSuccess, initialData }: StationeryItemFormProps) {\n  const queryClient = useQueryClient()\n\n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n  } = useForm<StationeryItemFormData>({\n    defaultValues: initialData || {\n      quantity: 0,\n      reorder_level: 10,\n    },\n  })\n\n  const createMutation = useMutation({\n    mutationFn: (data: StationeryItemFormData) => financeService.createStationeryItem(data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['stationery-items'] })\n      toast.success('Stationery item added successfully!')\n      onSuccess?.()\n      onClose()\n    },\n    onError: (error: any) => {\n      toast.error(error?.response?.data?.detail || 'Failed to add stationery item')\n    }\n  })\n\n  const updateMutation = useMutation({\n    mutationFn: (data: StationeryItemFormData) =>\n      financeService.updateStationeryItem(initialData.id, data),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['stationery-items'] })\n      toast.success('Stationery item updated successfully!')\n      onSuccess?.()\n      onClose()\n    },\n    onError: (error: any) => {\n      toast.error(error?.response?.data?.detail || 'Failed to update stationery item')\n    }\n  })\n\n  const onSubmit = (data: StationeryItemFormData) => {\n    if (initialData) {\n      updateMutation.mutate(data)\n    } else {\n      createMutation.mutate(data)\n    }\n  }\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50\">\n      <div className=\"w-full max-w-md rounded-lg bg-white p-6 shadow-xl\">\n        <div className=\"mb-4 flex items-center justify-between\">\n          <h2 className=\"text-2xl font-bold\">\n            {initialData ? 'Edit Stationery Item' : 'Add Stationery Item'}\n          </h2>\n          <button\n            onClick={onClose}\n            className=\"rounded-full p-1 hover:bg-gray-100\"\n          >\n            <X className=\"h-5 w-5\" />\n          </button>\n        </div>\n\n        <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-4\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"name\">Item Name *</Label>\n            <Input\n              id=\"name\"\n              {...register('name', { required: 'Item name is required' })}\n              placeholder=\"e.g., Pencils, Notebooks\"\n            />\n            {errors.name && (\n              <p className=\"text-sm text-red-600\">{errors.name.message}</p>\n            )}\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"category\">Category *</Label>\n            <select\n              id=\"category\"\n              {...register('category', { required: 'Category is required' })}\n              className=\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\"\n            >\n              <option value=\"\">Select category</option>\n              <option value=\"Writing Materials\">Writing Materials</option>\n              <option value=\"Notebooks\">Notebooks</option>\n              <option value=\"Art Supplies\">Art Supplies</option>\n              <option value=\"Science Equipment\">Science Equipment</option>\n              <option value=\"Sports Equipment\">Sports Equipment</option>\n              <option value=\"Cleaning Supplies\">Cleaning Supplies</option>\n              <option value=\"Office Supplies\">Office Supplies</option>\n              <option value=\"Other\">Other</option>\n            </select>\n            {errors.category && (\n              <p className=\"text-sm text-red-600\">{errors.category.message}</p>\n            )}\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"quantity\">Quantity *</Label>\n              <Input\n                type=\"number\"\n                id=\"quantity\"\n                {...register('quantity', {\n                  required: 'Quantity is required',\n                  valueAsNumber: true,\n                  min: { value: 0, message: 'Must be 0 or greater' },\n                })}\n              />\n              {errors.quantity && (\n                <p className=\"text-sm text-red-600\">{errors.quantity.message}</p>\n              )}\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"unit\">Unit *</Label>\n              <select\n                id=\"unit\"\n                {...register('unit', { required: 'Unit is required' })}\n                className=\"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\"\n              >\n                <option value=\"\">Select unit</option>\n                <option value=\"pieces\">Pieces</option>\n                <option value=\"boxes\">Boxes</option>\n                <option value=\"packs\">Packs</option>\n                <option value=\"sets\">Sets</option>\n                <option value=\"reams\">Reams</option>\n                <option value=\"units\">Units</option>\n              </select>\n              {errors.unit && (\n                <p className=\"text-sm text-red-600\">{errors.unit.message}</p>\n              )}\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"reorder_level\">Reorder Level *</Label>\n            <Input\n              type=\"number\"\n              id=\"reorder_level\"\n              {...register('reorder_level', {\n                required: 'Reorder level is required',\n                valueAsNumber: true,\n                min: { value: 1, message: 'Must be at least 1' },\n              })}\n              placeholder=\"Alert when stock falls below this number\"\n            />\n            {errors.reorder_level && (\n              <p className=\"text-sm text-red-600\">{errors.reorder_level.message}</p>\n            )}\n            <p className=\"text-xs text-gray-600\">\n              You'll be alerted when quantity falls below this level\n            </p>\n          </div>\n\n          <div className=\"flex gap-2\">\n            <Button\n              type=\"submit\"\n              className=\"flex-1\"\n              disabled={createMutation.isPending || updateMutation.isPending}\n            >\n              {createMutation.isPending || updateMutation.isPending\n                ? 'Saving...'\n                : initialData\n                ? 'Update Item'\n                : 'Add Item'}\n            </Button>\n            <Button type=\"button\" variant=\"outline\" onClick={onClose}>\n              Cancel\n            </Button>\n          </div>\n        </form>\n      </div>\n    </div>\n  )\n}\n\n\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\grades\\GradeForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":138,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":138,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4468,4471],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4468,4471],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useEffect } from 'react'\nimport { useForm } from 'react-hook-form'\nimport { zodResolver } from '@hookform/resolvers/zod'\nimport * as z from 'zod'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { gradeService } from '@/services/gradeService'\nimport { studentService } from '@/services/studentService'\nimport { classService } from '@/services/classService'\nimport { Grade, Student, Class } from '@/types'\nimport { Loader2, X } from 'lucide-react'\nimport { toast } from '@/components/ui/toast'\n\nconst gradeSchema = z.object({\n  student_id: z.string().min(1, 'Student is required'),\n  class_id: z.string().min(1, 'Class is required'),\n  subject: z.string().min(1, 'Subject is required'),\n  marks: z.number().min(0, 'Marks must be positive').max(100, 'Marks cannot exceed 100'),\n  grade: z.string().min(1, 'Grade is required'),\n  term: z.string().min(1, 'Term is required'),\n  academic_year: z.string().min(1, 'Academic year is required'),\n  remarks: z.string().optional(),\n})\n\ntype GradeFormData = z.infer<typeof gradeSchema>\n\ninterface GradeFormProps {\n  grade?: Grade\n  onClose: () => void\n  onSuccess: () => void\n  prefilledClass?: string\n  prefilledStudent?: string\n}\n\nconst SUBJECTS = [\n  'Mathematics', 'English', 'Science', 'Physics', 'Chemistry', 'Biology',\n  'History', 'Geography', 'Computer Science', 'Islamic Studies', 'Urdu',\n  'Arabic', 'Social Studies', 'Art', 'Physical Education'\n]\n\nconst TERMS = ['Term 1', 'Term 2', 'Term 3', 'Midterm', 'Final']\n\nconst GRADE_SCALE = [\n  { grade: 'A+', min: 90, max: 100 },\n  { grade: 'A', min: 80, max: 89 },\n  { grade: 'B+', min: 70, max: 79 },\n  { grade: 'B', min: 60, max: 69 },\n  { grade: 'C', min: 50, max: 59 },\n  { grade: 'D', min: 40, max: 49 },\n  { grade: 'F', min: 0, max: 39 },\n]\n\nfunction calculateGrade(marks: number): string {\n  const gradeObj = GRADE_SCALE.find(g => marks >= g.min && marks <= g.max)\n  return gradeObj?.grade || 'F'\n}\n\nexport function GradeForm({ grade, onClose, onSuccess, prefilledClass, prefilledStudent }: GradeFormProps) {\n  const [isLoading, setIsLoading] = useState(false)\n  const [students, setStudents] = useState<Student[]>([])\n  const [classes, setClasses] = useState<Class[]>([])\n  \n  const isEdit = !!grade\n\n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n    setValue,\n    watch,\n  } = useForm<GradeFormData>({\n    resolver: zodResolver(gradeSchema),\n    defaultValues: {\n      student_id: grade?.student_id || prefilledStudent || '',\n      class_id: grade?.class_id || prefilledClass || '',\n      subject: grade?.subject || '',\n      marks: grade?.marks || 0,\n      grade: grade?.grade || '',\n      term: grade?.term || 'Term 1',\n      academic_year: grade?.academic_year || new Date().getFullYear() + '-' + (new Date().getFullYear() + 1),\n      remarks: grade?.remarks || '',\n    }\n  })\n\n  const watchedMarks = watch('marks')\n  const watchedClassId = watch('class_id')\n\n  // Auto-calculate grade when marks change\n  useEffect(() => {\n    if (watchedMarks !== undefined) {\n      const calculatedGrade = calculateGrade(watchedMarks)\n      setValue('grade', calculatedGrade)\n    }\n  }, [watchedMarks, setValue])\n\n  // Load classes and students\n  useEffect(() => {\n    const loadData = async () => {\n      try {\n        const [classesData, studentsData] = await Promise.all([\n          classService.getClasses({ limit: 1000 }),\n          studentService.getStudents({ limit: 1000, status: 'active' })\n        ])\n        setClasses(classesData)\n        setStudents(studentsData)\n      } catch (error) {\n        console.error('Failed to load data:', error)\n      }\n    }\n    loadData()\n  }, [])\n\n  // Filter students by selected class\n  const filteredStudents = watchedClassId\n    ? students.filter(s => s.class_id === watchedClassId)\n    : students\n\n  const onSubmit = async (data: GradeFormData) => {\n    setIsLoading(true)\n    try {\n      if (isEdit && grade) {\n        await gradeService.updateGrade(grade.id, {\n          marks: data.marks,\n          grade: data.grade,\n          remarks: data.remarks,\n        })\n      } else {\n        await gradeService.createGrade(data)\n      }\n\n      onSuccess()\n      onClose()\n    } catch (error: any) {\n      console.error('Failed to save grade:', error)\n      toast.error(error.response?.data?.detail || 'Failed to save grade')\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n      <Card className=\"w-full max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-4\">\n          <CardTitle>{isEdit ? 'Edit Grade' : 'Add New Grade'}</CardTitle>\n          <Button variant=\"ghost\" size=\"sm\" onClick={onClose}>\n            <X className=\"h-4 w-4\" />\n          </Button>\n        </CardHeader>\n        <CardContent>\n          <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-6\">\n            {/* Grade Information */}\n            <div className=\"space-y-4\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"class_id\">Class *</Label>\n                  <Select\n                    value={watch('class_id')}\n                    onValueChange={(value) => setValue('class_id', value)}\n                    disabled={isEdit}\n                  >\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"Select class\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {classes.map((cls) => (\n                        <SelectItem key={cls.id} value={cls.id}>\n                          {cls.name} - {cls.section}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  {errors.class_id && (\n                    <p className=\"text-sm text-red-600\">{errors.class_id.message}</p>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"student_id\">Student *</Label>\n                  <Select\n                    value={watch('student_id')}\n                    onValueChange={(value) => setValue('student_id', value)}\n                    disabled={isEdit}\n                  >\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"Select student\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {filteredStudents.map((student) => (\n                        <SelectItem key={student.id} value={student.id}>\n                          {student.user?.full_name} ({student.admission_number})\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  {errors.student_id && (\n                    <p className=\"text-sm text-red-600\">{errors.student_id.message}</p>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"subject\">Subject *</Label>\n                  <Select\n                    value={watch('subject')}\n                    onValueChange={(value) => setValue('subject', value)}\n                    disabled={isEdit}\n                  >\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"Select subject\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {SUBJECTS.map((subject) => (\n                        <SelectItem key={subject} value={subject}>\n                          {subject}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  {errors.subject && (\n                    <p className=\"text-sm text-red-600\">{errors.subject.message}</p>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"marks\">Marks (0-100) *</Label>\n                  <Input\n                    id=\"marks\"\n                    type=\"number\"\n                    min=\"0\"\n                    max=\"100\"\n                    step=\"0.5\"\n                    {...register('marks', { valueAsNumber: true })}\n                    placeholder=\"Enter marks\"\n                  />\n                  {errors.marks && (\n                    <p className=\"text-sm text-red-600\">{errors.marks.message}</p>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"grade\">Grade (Auto-calculated)</Label>\n                  <Input\n                    id=\"grade\"\n                    {...register('grade')}\n                    readOnly\n                    className=\"bg-gray-100\"\n                  />\n                  {errors.grade && (\n                    <p className=\"text-sm text-red-600\">{errors.grade.message}</p>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"term\">Term *</Label>\n                  <Select\n                    value={watch('term')}\n                    onValueChange={(value) => setValue('term', value)}\n                    disabled={isEdit}\n                  >\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"Select term\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {TERMS.map((term) => (\n                        <SelectItem key={term} value={term}>\n                          {term}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  {errors.term && (\n                    <p className=\"text-sm text-red-600\">{errors.term.message}</p>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"academic_year\">Academic Year *</Label>\n                  <Input\n                    id=\"academic_year\"\n                    {...register('academic_year')}\n                    placeholder=\"e.g., 2024-2025\"\n                    disabled={isEdit}\n                  />\n                  {errors.academic_year && (\n                    <p className=\"text-sm text-red-600\">{errors.academic_year.message}</p>\n                  )}\n                </div>\n\n                <div className=\"md:col-span-2 space-y-2\">\n                  <Label htmlFor=\"remarks\">Remarks (Optional)</Label>\n                  <Input\n                    id=\"remarks\"\n                    {...register('remarks')}\n                    placeholder=\"Enter any remarks\"\n                  />\n                </div>\n              </div>\n            </div>\n\n            {/* Grade Scale Reference */}\n            <div className=\"bg-gray-50 p-4 rounded-lg\">\n              <h4 className=\"font-medium mb-2\">Grading Scale</h4>\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm\">\n                {GRADE_SCALE.map((g) => (\n                  <div key={g.grade} className=\"flex items-center gap-2\">\n                    <span className=\"font-semibold\">{g.grade}:</span>\n                    <span className=\"text-gray-600\">{g.min}-{g.max}</span>\n                  </div>\n                ))}\n              </div>\n            </div>\n\n            {/* Form Actions */}\n            <div className=\"flex justify-end space-x-2 pt-4\">\n              <Button type=\"button\" variant=\"outline\" onClick={onClose}>\n                Cancel\n              </Button>\n              <Button type=\"submit\" disabled={isLoading}>\n                {isLoading && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n                {isEdit ? 'Update Grade' : 'Add Grade'}\n              </Button>\n            </div>\n          </form>\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\layout\\DashboardLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\layout\\Sidebar.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Trophy' is defined but never used.","line":17,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":9}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport Link from 'next/link'\nimport { usePathname } from 'next/navigation'\nimport { cn } from '@/lib/utils'\nimport {\n  LayoutDashboard,\n  Users,\n  GraduationCap,\n  BookOpen,\n  Calendar,\n  DollarSign,\n  FileText,\n  Settings,\n  LogOut,\n  Bell,\n  Trophy,\n  BarChart3,\n  Award,\n  ClipboardCheck,\n  FileCheck,\n  Upload,\n} from 'lucide-react'\nimport { useAuth } from '@/contexts/AuthContext'\nimport { UserRole } from '@/types'\n\ninterface SidebarProps {\n  role: UserRole\n}\n\nconst sidebarLinks = {\n  admin: [\n    { href: '/admin/dashboard', label: 'Dashboard', icon: LayoutDashboard },\n    { href: '/admin/students', label: 'Students', icon: Users },\n    { href: '/admin/teachers', label: 'Teachers', icon: GraduationCap },\n    { href: '/admin/classes', label: 'Classes', icon: BookOpen },\n    { href: '/admin/attendance', label: 'Attendance', icon: Calendar },\n    { href: '/admin/grades', label: 'Grades', icon: FileText },\n    { href: '/admin/exams', label: 'Exams', icon: ClipboardCheck },\n    { href: '/admin/results', label: 'Results', icon: FileCheck },\n    { href: '/admin/papers', label: 'Papers', icon: Upload },\n    { href: '/admin/grading-schemes', label: 'Grading Schemes', icon: Award },\n    { href: '/admin/finance', label: 'Finance', icon: DollarSign },\n    { href: '/admin/announcements', label: 'Announcements', icon: Bell },\n    { href: '/admin/events', label: 'Events', icon: Calendar },\n    { href: '/admin/stationery', label: 'Stationery', icon: BookOpen },\n    { href: '/admin/reports', label: 'Reports', icon: BarChart3 },\n    { href: '/admin/settings', label: 'Settings', icon: Settings },\n  ],\n  principal: [\n    { href: '/principal/dashboard', label: 'Dashboard', icon: LayoutDashboard },\n    { href: '/principal/teachers', label: 'Teachers', icon: GraduationCap },\n    { href: '/principal/students', label: 'Students', icon: Users },\n    { href: '/admin/exams', label: 'Exams', icon: ClipboardCheck },\n    { href: '/admin/results', label: 'Results', icon: FileCheck },\n    { href: '/admin/papers', label: 'Papers', icon: Upload },\n    { href: '/principal/reports', label: 'Reports', icon: FileText },\n    { href: '/principal/finance', label: 'Finance', icon: DollarSign },\n  ],\n  teacher: [\n    { href: '/teacher/dashboard', label: 'Dashboard', icon: LayoutDashboard },\n    { href: '/teacher/classes', label: 'My Classes', icon: BookOpen },\n    { href: '/teacher/attendance', label: 'Attendance', icon: Calendar },\n    { href: '/teacher/grades', label: 'Grades', icon: FileText },\n    { href: '/teacher/exams', label: 'Exams', icon: ClipboardCheck },\n    { href: '/teacher/results', label: 'Results', icon: FileCheck },\n    { href: '/teacher/profile', label: 'Profile', icon: Settings },\n  ],\n  student: [\n    { href: '/student/dashboard', label: 'Dashboard', icon: LayoutDashboard },\n    { href: '/student/grades', label: 'My Grades', icon: FileText },\n    { href: '/student/attendance', label: 'Attendance', icon: Calendar },\n    { href: '/student/stationery', label: 'Stationery', icon: BookOpen },\n    { href: '/student/profile', label: 'Profile', icon: Settings }\n  ],\n}\n\nexport function Sidebar({ role }: SidebarProps) {\n  const pathname = usePathname()\n  const { user, logout } = useAuth()\n\n  const links = sidebarLinks[role] || []\n\n  const handleLogout = () => {\n    logout()\n  }\n\n  return (\n    <div className=\"flex h-full w-64 flex-col bg-gray-900 text-white\">\n      <div className=\"flex h-16 items-center justify-center border-b border-gray-800\">\n        <h1 className=\"text-xl font-bold\">SMS</h1>\n      </div>\n\n      <div className=\"flex-1 overflow-y-auto py-4\">\n        <nav className=\"space-y-1 px-2\">\n          {links.map((link) => {\n            const Icon = link.icon\n            const isActive = pathname === link.href\n\n            return (\n              <Link\n                key={link.href}\n                href={link.href}\n                className={cn(\n                  'flex items-center gap-3 rounded-lg px-3 py-2 text-sm font-medium transition-colors',\n                  isActive\n                    ? 'bg-gray-800 text-white'\n                    : 'text-gray-400 hover:bg-gray-800 hover:text-white'\n                )}\n              >\n                <Icon className=\"h-5 w-5\" />\n                {link.label}\n              </Link>\n            )\n          })}\n        </nav>\n      </div>\n\n      <div className=\"border-t border-gray-800 p-4\">\n        <div className=\"mb-4 flex items-center gap-3\">\n          <div className=\"flex h-10 w-10 items-center justify-center rounded-full bg-gray-800\">\n            {user?.full_name?.charAt(0).toUpperCase() || 'U'}\n          </div>\n          <div className=\"flex-1 overflow-hidden\">\n            <p className=\"truncate text-sm font-medium\">{user?.full_name}</p>\n            <p className=\"truncate text-xs text-gray-400\">{user?.email}</p>\n          </div>\n        </div>\n        <button\n          onClick={handleLogout}\n          className=\"flex w-full items-center gap-3 rounded-lg px-3 py-2 text-sm font-medium text-gray-400 transition-colors hover:bg-gray-800 hover:text-white\"\n        >\n          <LogOut className=\"h-5 w-5\" />\n          Logout\n        </button>\n      </div>\n    </div>\n  )\n}\n\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\providers.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\shared\\AttendanceBadge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\shared\\ConfirmDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\shared\\EmptyState.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\shared\\EntityLink.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'router' is assigned a value but never used.","line":26,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport Link from 'next/link'\r\nimport { useRouter } from 'next/navigation'\r\nimport { Button } from '@/components/ui/button'\r\nimport { ChevronRight, ExternalLink } from 'lucide-react'\r\nimport { ReactNode } from 'react'\r\n\r\ninterface EntityLinkProps {\r\n  href: string\r\n  children: ReactNode\r\n  variant?: 'link' | 'button' | 'badge'\r\n  className?: string\r\n  external?: boolean\r\n  onClick?: () => void\r\n}\r\n\r\nexport function EntityLink({ \r\n  href, \r\n  children, \r\n  variant = 'link',\r\n  className = '',\r\n  external = false,\r\n  onClick\r\n}: EntityLinkProps) {\r\n  const router = useRouter()\r\n\r\n  const handleClick = (e: React.MouseEvent) => {\r\n    if (onClick) {\r\n      e.preventDefault()\r\n      onClick()\r\n    }\r\n  }\r\n\r\n  if (variant === 'button') {\r\n    return (\r\n      <Button\r\n        variant=\"outline\"\r\n        size=\"sm\"\r\n        asChild\r\n        className={className}\r\n        onClick={handleClick}\r\n      >\r\n        <Link href={href} target={external ? '_blank' : undefined}>\r\n          {children}\r\n          {external && <ExternalLink className=\"h-3 w-3 ml-1\" />}\r\n        </Link>\r\n      </Button>\r\n    )\r\n  }\r\n\r\n  if (variant === 'badge') {\r\n    return (\r\n      <Link \r\n        href={href} \r\n        className={`inline-flex items-center gap-1 text-sm font-medium text-blue-600 hover:text-blue-800 hover:underline ${className}`}\r\n        onClick={handleClick}\r\n      >\r\n        {children}\r\n        <ChevronRight className=\"h-3 w-3\" />\r\n      </Link>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <Link \r\n      href={href}\r\n      className={`text-blue-600 hover:text-blue-800 hover:underline ${className}`}\r\n      onClick={handleClick}\r\n    >\r\n      {children}\r\n    </Link>\r\n  )\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\shared\\ErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\shared\\FilterBar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\shared\\LoadingSkeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\shared\\ReportCardModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Share2' is defined but never used.","line":6,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":44}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { useSettings } from '@/contexts/SettingsContext'\nimport { X, Printer, Download, Mail, Share2 } from 'lucide-react'\nimport { Grade, Student, Class } from '@/types'\nimport { useMemo } from 'react'\n\ninterface ReportCardModalProps {\n  student: Student\n  grades: Grade[]\n  classInfo?: Class\n  term: string\n  academicYear: string\n  isOpen: boolean\n  onClose: () => void\n  onExport?: () => void\n  onEmail?: () => void\n}\n\nexport function ReportCardModal({\n  student,\n  grades,\n  classInfo,\n  term,\n  academicYear,\n  isOpen,\n  onClose,\n  onExport,\n  onEmail,\n}: ReportCardModalProps) {\n  const { schoolName } = useSettings()\n\n  // Calculate statistics\n  const stats = useMemo(() => {\n    const totalGrades = grades.length\n    const passingGrades = grades.filter((g: Grade) => Number(g.marks) >= 50).length\n    const totalMarks = grades.reduce((sum: number, g: Grade) => sum + Number(g.marks), 0)\n    const averageMarks = totalGrades > 0 ? totalMarks / totalGrades : 0\n    const passRate = totalGrades > 0 ? (passingGrades / totalGrades) * 100 : 0\n\n    return {\n      totalGrades,\n      passingGrades,\n      averageMarks,\n      passRate,\n    }\n  }, [grades])\n\n  // Calculate grade from marks\n  const calculateGrade = (marks: number): string => {\n    if (marks >= 90) return 'A+'\n    if (marks >= 80) return 'A'\n    if (marks >= 70) return 'B+'\n    if (marks >= 60) return 'B'\n    if (marks >= 50) return 'C+'\n    if (marks >= 40) return 'C'\n    if (marks >= 33) return 'D'\n    return 'F'\n  }\n\n  // Get grade color\n  const getGradeColor = (grade: string) => {\n    switch (grade) {\n      case 'A+': case 'A': return 'bg-green-100 text-green-800 border-green-200'\n      case 'B+': case 'B': return 'bg-blue-100 text-blue-800 border-blue-200'\n      case 'C+': case 'C': return 'bg-yellow-100 text-yellow-800 border-yellow-200'\n      case 'D': return 'bg-orange-100 text-orange-800 border-orange-200'\n      case 'F': return 'bg-red-100 text-red-800 border-red-200'\n      default: return 'bg-gray-100 text-gray-800 border-gray-200'\n    }\n  }\n\n  const handlePrint = () => {\n    window.print()\n  }\n\n  const handleDownload = () => {\n    if (onExport) {\n      onExport()\n    } else {\n      // Default: trigger print which can be saved as PDF\n      handlePrint()\n    }\n  }\n\n  if (!isOpen) return null\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4 print:relative print:bg-transparent print:p-0\">\n      <div className=\"w-full max-w-4xl bg-white rounded-lg shadow-xl max-h-[90vh] overflow-auto print:shadow-none print:max-h-none print:rounded-none\">\n        {/* Report Card Header */}\n        <div className=\"p-6 border-b print:border-b-2 print:border-gray-900\">\n          <div className=\"flex justify-between items-start mb-4 print:mb-6\">\n            <div>\n              <h2 className=\"text-3xl font-bold print:text-4xl\">ACADEMIC REPORT CARD</h2>\n              <p className=\"text-lg text-gray-600 print:text-xl\">{schoolName}</p>\n            </div>\n            <div className=\"flex gap-2 print:hidden\">\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={handleDownload}\n                title=\"Download PDF\"\n              >\n                <Download className=\"h-4 w-4\" />\n              </Button>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={handlePrint}\n                title=\"Print\"\n              >\n                <Printer className=\"h-4 w-4\" />\n              </Button>\n              {onEmail && (\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={onEmail}\n                  title=\"Email Report Card\"\n                >\n                  <Mail className=\"h-4 w-4\" />\n                </Button>\n              )}\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={onClose}\n                title=\"Close\"\n              >\n                <X className=\"h-5 w-5\" />\n              </Button>\n            </div>\n          </div>\n          \n          {/* Student Info */}\n          <div className=\"grid grid-cols-2 gap-4 print:gap-6 mb-4\">\n            <div>\n              <p className=\"text-sm text-gray-600 print:text-base\">Student Name:</p>\n              <p className=\"font-semibold text-lg print:text-xl\">\n                {student.user?.full_name || 'Unknown'}\n              </p>\n            </div>\n            <div>\n              <p className=\"text-sm text-gray-600 print:text-base\">Admission Number:</p>\n              <p className=\"font-semibold text-lg print:text-xl\">\n                {student.admission_number}\n              </p>\n            </div>\n            <div>\n              <p className=\"text-sm text-gray-600 print:text-base\">Class:</p>\n              <p className=\"font-semibold text-lg print:text-xl\">\n                {classInfo ? `${classInfo.name} - ${classInfo.section}` : 'N/A'}\n              </p>\n            </div>\n            <div>\n              <p className=\"text-sm text-gray-600 print:text-base\">Term & Year:</p>\n              <p className=\"font-semibold text-lg print:text-xl\">\n                {term} {academicYear}\n              </p>\n            </div>\n          </div>\n        </div>\n\n        {/* Grades Table */}\n        <div className=\"p-6\">\n          <table className=\"w-full border-collapse print:border-2 print:border-gray-900\">\n            <thead>\n              <tr className=\"bg-gray-50 print:bg-gray-200\">\n                <th className=\"border py-3 px-4 text-left font-semibold print:border-gray-900\">Subject</th>\n                <th className=\"border py-3 px-4 text-center font-semibold print:border-gray-900\">Marks</th>\n                <th className=\"border py-3 px-4 text-center font-semibold print:border-gray-900\">Grade</th>\n                <th className=\"border py-3 px-4 text-center font-semibold print:border-gray-900\">Remarks</th>\n              </tr>\n            </thead>\n            <tbody>\n              {grades.map((grade: Grade, index) => (\n                <tr key={grade.id} className={index % 2 === 0 ? 'bg-white' : 'bg-gray-50'}>\n                  <td className=\"border py-3 px-4 font-medium print:border-gray-900\">{grade.subject}</td>\n                  <td className=\"border py-3 px-4 text-center print:border-gray-900\">{grade.marks}/100</td>\n                  <td className=\"border py-3 px-4 text-center print:border-gray-900\">\n                    <Badge className={getGradeColor(grade.grade)}>\n                      {grade.grade}\n                    </Badge>\n                  </td>\n                  <td className=\"border py-3 px-4 text-center text-sm print:border-gray-900\">\n                    {grade.remarks || '-'}\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n            <tfoot className=\"bg-gray-50 print:bg-gray-200 font-semibold\">\n              <tr>\n                <td className=\"border py-3 px-4 print:border-gray-900\">Overall</td>\n                <td className=\"border py-3 px-4 text-center print:border-gray-900\">\n                  {stats.averageMarks.toFixed(1)}%\n                </td>\n                <td className=\"border py-3 px-4 text-center print:border-gray-900\">\n                  <Badge className={getGradeColor(calculateGrade(stats.averageMarks))}>\n                    {calculateGrade(stats.averageMarks)}\n                  </Badge>\n                </td>\n                <td className=\"border py-3 px-4 text-center print:border-gray-900\">\n                  {stats.passingGrades}/{stats.totalGrades} Passed\n                </td>\n              </tr>\n            </tfoot>\n          </table>\n\n          {/* Summary */}\n          <div className=\"mt-6 p-4 bg-blue-50 print:bg-gray-100 rounded-lg print:rounded-none\">\n            <h3 className=\"font-semibold mb-2 print:text-lg\">Performance Summary</h3>\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm print:text-base\">\n              <div>\n                <p className=\"text-gray-600\">Total Subjects</p>\n                <p className=\"font-semibold text-lg\">{stats.totalGrades}</p>\n              </div>\n              <div>\n                <p className=\"text-gray-600\">Passed</p>\n                <p className=\"font-semibold text-lg text-green-600\">\n                  {stats.passingGrades}\n                </p>\n              </div>\n              <div>\n                <p className=\"text-gray-600\">Overall GPA</p>\n                <p className=\"font-semibold text-lg text-blue-600\">\n                  {stats.averageMarks.toFixed(1)}%\n                </p>\n              </div>\n              <div>\n                <p className=\"text-gray-600\">Status</p>\n                <p className=\"font-semibold text-lg\">\n                  {stats.passRate >= 50 ? 'Passed' : 'In Progress'}\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\shared\\StatCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\shared\\StudentCard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Award' is defined but never used.","line":7,"column":42,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":47},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronRight' is defined but never used.","line":7,"column":49,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":61}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { Card, CardContent } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { useRouter } from 'next/navigation'\nimport { Users, Eye, FileText, Calendar, Award, ChevronRight } from 'lucide-react'\nimport { Student } from '@/types'\n\ninterface StudentCardProps {\n  student: Student\n  showActions?: boolean\n  showStats?: boolean\n  stats?: {\n    attendanceRate?: number\n    averageGrade?: number\n    totalGrades?: number\n  }\n}\n\nexport function StudentCard({ \n  student, \n  showActions = true, \n  showStats = false,\n  stats \n}: StudentCardProps) {\n  const router = useRouter()\n\n  return (\n    <Card className=\"hover:shadow-lg transition-shadow\">\n      <CardContent className=\"p-6\">\n        <div className=\"flex items-start justify-between\">\n          <div className=\"flex items-center gap-4 flex-1\">\n            <div className=\"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center\">\n              <Users className=\"h-6 w-6 text-blue-600\" />\n            </div>\n            <div className=\"flex-1\">\n              <div className=\"flex items-center gap-2\">\n                <h3 className=\"font-semibold text-lg text-gray-900\">\n                  {student.user?.full_name || 'Unknown'}\n                </h3>\n                <Badge className={\n                  student.status === 'active' \n                    ? 'bg-green-100 text-green-800' \n                    : 'bg-gray-100 text-gray-800'\n                }>\n                  {student.status}\n                </Badge>\n              </div>\n              <div className=\"mt-1 space-y-1\">\n                <p className=\"text-sm text-gray-600\">\n                  Admission: {student.admission_number}\n                </p>\n                {student.class_id && (\n                  <p className=\"text-sm text-gray-600\">\n                    Class ID: {student.class_id}\n                  </p>\n                )}\n                {student.guardian_info?.name && (\n                  <p className=\"text-sm text-gray-500\">\n                    Guardian: {student.guardian_info.name}\n                  </p>\n                )}\n              </div>\n              {showStats && stats && (\n                <div className=\"flex gap-4 mt-3 pt-3 border-t\">\n                  {stats.attendanceRate !== undefined && (\n                    <div>\n                      <p className=\"text-xs text-gray-500\">Attendance</p>\n                      <p className=\"text-sm font-semibold\">{stats.attendanceRate}%</p>\n                    </div>\n                  )}\n                  {stats.averageGrade !== undefined && (\n                    <div>\n                      <p className=\"text-xs text-gray-500\">Avg Grade</p>\n                      <p className=\"text-sm font-semibold\">{stats.averageGrade}%</p>\n                    </div>\n                  )}\n                  {stats.totalGrades !== undefined && (\n                    <div>\n                      <p className=\"text-xs text-gray-500\">Grades</p>\n                      <p className=\"text-sm font-semibold\">{stats.totalGrades}</p>\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n          </div>\n          {showActions && (\n            <div className=\"flex flex-col gap-2\">\n              <Button\n                size=\"sm\"\n                variant=\"outline\"\n                onClick={() => router.push(`/admin/students?student_id=${student.id}`)}\n                className=\"flex items-center gap-1\"\n              >\n                <Eye className=\"h-4 w-4\" />\n                View\n              </Button>\n              <Button\n                size=\"sm\"\n                variant=\"ghost\"\n                onClick={() => router.push(`/admin/grades?student_id=${student.id}`)}\n                className=\"flex items-center gap-1\"\n                title=\"View Grades\"\n              >\n                <FileText className=\"h-4 w-4\" />\n              </Button>\n              <Button\n                size=\"sm\"\n                variant=\"ghost\"\n                onClick={() => router.push(`/admin/attendance?user_id=${student.user_id}`)}\n                className=\"flex items-center gap-1\"\n                title=\"View Attendance\"\n              >\n                <Calendar className=\"h-4 w-4\" />\n              </Button>\n            </div>\n          )}\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\students\\StudentForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'reset' is assigned a value but never used.","line":78,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":78,"endColumn":10},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":95,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3882,3885],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3882,3885],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":141,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":141,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5285,5288],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5285,5288],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":159,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":159,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5877,5880],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5877,5880],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":169,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":169,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6324,6327],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6324,6327],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":335,"column":75,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":335,"endColumn":78,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13589,13592],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13589,13592],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useEffect } from 'react'\nimport { useForm } from 'react-hook-form'\nimport { zodResolver } from '@hookform/resolvers/zod'\nimport * as z from 'zod'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { studentService } from '@/services/studentService'\nimport { classService } from '@/services/classService'\nimport { useAuth } from '@/contexts/AuthContext'\nimport { Student, Class, GuardianInfo } from '@/types'\nimport { Loader2, X } from 'lucide-react'\nimport { toast } from '@/components/ui/toast'\n\nconst studentSchema = z.object({\n  admission_number: z.string()\n    .min(1, 'Admission number is required')\n    .regex(/^[A-Z0-9]+$/, 'Admission number should contain only uppercase letters and numbers'),\n  full_name: z.string()\n    .min(2, 'Full name must be at least 2 characters')\n    .max(100, 'Full name must be less than 100 characters')\n    .regex(/^[a-zA-Z\\s]+$/, 'Full name should contain only letters and spaces'),\n  email: z.string()\n    .email('Please enter a valid email address')\n    .min(5, 'Email must be at least 5 characters'),\n  password: z.string().optional(),\n  phone: z.string()\n    .regex(/^[0-9+\\-\\s()]+$/, 'Please enter a valid phone number')\n    .optional(),\n  address: z.string()\n    .max(200, 'Address must be less than 200 characters')\n    .optional(),\n  admission_date: z.string().min(1, 'Admission date is required'),\n  class_id: z.string().optional(),\n  guardian_name: z.string()\n    .min(2, 'Guardian name must be at least 2 characters')\n    .max(100, 'Guardian name must be less than 100 characters')\n    .regex(/^[a-zA-Z\\s]+$/, 'Guardian name should contain only letters and spaces'),\n  guardian_relation: z.string().refine(val => val && val !== 'placeholder' && val !== '', 'Please select guardian relation'),\n  guardian_phone: z.string()\n    .min(10, 'Guardian phone must be at least 10 digits')\n    .regex(/^[0-9+\\-\\s()]+$/, 'Please enter a valid phone number'),\n  guardian_email: z.string()\n    .email('Please enter a valid guardian email')\n    .optional()\n    .or(z.literal('')),\n  guardian_address: z.string()\n    .max(200, 'Guardian address must be less than 200 characters')\n    .optional(),\n  status: z.enum(['active', 'inactive', 'graduated', 'transferred']),\n})\n\ntype StudentFormData = z.infer<typeof studentSchema>\n\ninterface StudentFormProps {\n  student?: Student\n  onClose: () => void\n  onSuccess: () => void\n}\n\nexport function StudentForm({ student, onClose, onSuccess }: StudentFormProps) {\n  const [isLoading, setIsLoading] = useState(false)\n  const [classes, setClasses] = useState<Class[]>([])\n  const { user } = useAuth()\n  \n  const isEdit = !!student\n\n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n    setValue,\n    watch,\n    reset\n  } = useForm<StudentFormData>({\n    resolver: zodResolver(studentSchema),\n    defaultValues: {\n      admission_number: student?.admission_number || '',\n      full_name: student?.user?.full_name || '',\n      email: student?.user?.email || '',\n      password: '', // Will be auto-generated for new students\n      phone: student?.user?.phone || '',\n      address: student?.user?.address || '',\n      admission_date: student?.admission_date ? student.admission_date.split('T')[0] : '',\n      class_id: student?.class_id || '',\n      guardian_name: student?.guardian_info?.name || '',\n      guardian_relation: student?.guardian_info?.relation || '',\n      guardian_phone: student?.guardian_info?.phone || '',\n      guardian_email: student?.guardian_info?.email || '',\n      guardian_address: student?.guardian_info?.address || '',\n      status: (student?.status as any) || 'active',\n    }\n  })\n\n  // Load classes\n  useEffect(() => {\n    const loadClasses = async () => {\n      try {\n        const classesData = await classService.getClasses({ limit: 1000 })\n        setClasses(classesData)\n      } catch (error) {\n        console.error('Failed to load classes:', error)\n      }\n    }\n    loadClasses()\n  }, [])\n\n  const onSubmit = async (data: StudentFormData) => {\n    if (!user) return\n\n    setIsLoading(true)\n    try {\n      const guardianInfo: GuardianInfo = {\n        name: data.guardian_name,\n        relation: data.guardian_relation,\n        phone: data.guardian_phone,\n        email: data.guardian_email || undefined,\n        address: data.guardian_address || undefined,\n      }\n\n      // Auto-generate password if not provided for new students\n      const password = isEdit ? undefined : (data.password || `${data.admission_number}@123`)\n\n      if (isEdit && student) {\n        // For updates, send only the fields that can be updated\n        const updateData = {\n          full_name: data.full_name,\n          phone: data.phone,\n          address: data.address,\n          class_id: data.class_id || null,\n          guardian_info: guardianInfo,\n          status: data.status,\n        }\n        await studentService.updateStudent(student.id, updateData)\n      } else {\n        // For creation, send data in the format backend expects\n        const createData: any = {\n          // User info\n          email: data.email,\n          password: password || `${data.admission_number}@123`,\n          full_name: data.full_name,\n          phone: data.phone || undefined,\n          address: data.address || undefined,\n          // Student specific\n          admission_number: data.admission_number,\n          admission_date: data.admission_date,\n          class_id: data.class_id || undefined,\n          guardian_info: guardianInfo,\n        }\n        await studentService.createStudent(createData)\n      }\n\n      onSuccess()\n      onClose()\n    } catch (error: any) {\n      console.error('Failed to save student:', error)\n      \n      // Handle different error formats\n      let errorMessage = 'Failed to save student'\n      \n      if (error.response?.data?.detail) {\n        if (typeof error.response.data.detail === 'string') {\n          errorMessage = error.response.data.detail\n        } else if (Array.isArray(error.response.data.detail)) {\n          errorMessage = error.response.data.detail.map((err: any) => \n            typeof err === 'string' ? err : err.msg || JSON.stringify(err)\n          ).join(', ')\n        } else if (typeof error.response.data.detail === 'object') {\n          errorMessage = error.response.data.detail.message || JSON.stringify(error.response.data.detail)\n        }\n      } else if (error.message) {\n        errorMessage = error.message\n      }\n      \n      toast.error(errorMessage)\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n      <Card className=\"w-full max-w-4xl max-h-[95vh] overflow-y-auto\">\n        <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-4\">\n          <CardTitle>{isEdit ? 'Edit Student' : 'Add New Student'}</CardTitle>\n          <Button variant=\"ghost\" size=\"sm\" onClick={onClose}>\n            <X className=\"h-4 w-4\" />\n          </Button>\n        </CardHeader>\n        <CardContent>\n          <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-6\">\n            {/* Professional Header */}\n            <div className=\"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6\">\n              <div className=\"flex items-center gap-3 mb-3\">\n                <div className=\"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center\">\n                  <span className=\"text-blue-600 font-bold text-lg\">📚</span>\n                </div>\n                <div>\n                  <h4 className=\"text-lg font-semibold text-blue-900\">Student Registration</h4>\n                  <p className=\"text-sm text-blue-700\">Complete all required fields to register a new student</p>\n                </div>\n              </div>\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2 text-xs text-blue-600\">\n                <div className=\"flex items-center gap-1\">\n                  <span className=\"w-2 h-2 bg-blue-400 rounded-full\"></span>\n                  <span>Personal Info</span>\n                </div>\n                <div className=\"flex items-center gap-1\">\n                  <span className=\"w-2 h-2 bg-blue-400 rounded-full\"></span>\n                  <span>Contact Details</span>\n                </div>\n                <div className=\"flex items-center gap-1\">\n                  <span className=\"w-2 h-2 bg-blue-400 rounded-full\"></span>\n                  <span>Academic Info</span>\n                </div>\n                <div className=\"flex items-center gap-1\">\n                  <span className=\"w-2 h-2 bg-blue-400 rounded-full\"></span>\n                  <span>Guardian Details</span>\n                </div>\n              </div>\n            </div>\n\n            {/* Student Information */}\n            <div className=\"space-y-4\">\n              <h3 className=\"text-lg font-semibold\">Student Information</h3>\n              \n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"admission_number\">Admission Number *</Label>\n                  <Input\n                    id=\"admission_number\"\n                    {...register('admission_number')}\n                    placeholder=\"Enter admission number\"\n                    className={errors.admission_number ? 'border-red-500' : ''}\n                  />\n                  {errors.admission_number && (\n                    <p className=\"text-sm text-red-600\">{errors.admission_number.message}</p>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"full_name\">Full Name *</Label>\n                  <Input\n                    id=\"full_name\"\n                    {...register('full_name')}\n                    placeholder=\"Enter full name\"\n                    className={errors.full_name ? 'border-red-500' : ''}\n                  />\n                  {errors.full_name && (\n                    <p className=\"text-sm text-red-600\">{errors.full_name.message}</p>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"email\">Email *</Label>\n                  <Input\n                    id=\"email\"\n                    type=\"email\"\n                    {...register('email')}\n                    placeholder=\"Enter email address\"\n                    className={errors.email ? 'border-red-500' : ''}\n                  />\n                  {errors.email && (\n                    <p className=\"text-sm text-red-600\">{errors.email.message}</p>\n                  )}\n                </div>\n\n                {!isEdit && (\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"password\">Password *</Label>\n                    <Input\n                      id=\"password\"\n                      type=\"password\"\n                      {...register('password')}\n                      placeholder=\"Enter password (or leave blank for auto-generated)\"\n                    />\n                    <p className=\"text-xs text-gray-500\">\n                      Leave blank to auto-generate: {watch('admission_number')}@123\n                    </p>\n                    {errors.password && (\n                      <p className=\"text-sm text-red-600\">{errors.password.message}</p>\n                    )}\n                  </div>\n                )}\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"phone\">Phone</Label>\n                  <Input\n                    id=\"phone\"\n                    {...register('phone')}\n                    placeholder=\"Enter phone number\"\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"admission_date\">Admission Date *</Label>\n                  <Input\n                    id=\"admission_date\"\n                    type=\"date\"\n                    {...register('admission_date')}\n                  />\n                  {errors.admission_date && (\n                    <p className=\"text-sm text-red-600\">{errors.admission_date.message}</p>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"class_id\">Class</Label>\n                  <Select\n                    value={watch('class_id') || 'none'}\n                    onValueChange={(value) => setValue('class_id', value === 'none' ? '' : value)}\n                  >\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"Select class\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"none\">No class assigned</SelectItem>\n                      {classes.map((cls) => (\n                        <SelectItem key={cls.id} value={cls.id}>\n                          {cls.name} - {cls.section}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"status\">Status *</Label>\n                  <Select\n                    value={watch('status') || 'active'}\n                    onValueChange={(value) => setValue('status', value as any)}\n                  >\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"Select status\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"active\">Active</SelectItem>\n                      <SelectItem value=\"inactive\">Inactive</SelectItem>\n                      <SelectItem value=\"graduated\">Graduated</SelectItem>\n                      <SelectItem value=\"transferred\">Transferred</SelectItem>\n                    </SelectContent>\n                  </Select>\n                  {errors.status && (\n                    <p className=\"text-sm text-red-600\">{errors.status.message}</p>\n                  )}\n                </div>\n\n                <div className=\"md:col-span-2 space-y-2\">\n                  <Label htmlFor=\"address\">Address</Label>\n                  <Input\n                    id=\"address\"\n                    {...register('address')}\n                    placeholder=\"Enter address\"\n                  />\n                </div>\n              </div>\n            </div>\n\n            {/* Guardian Information */}\n            <div className=\"space-y-4\">\n              <h3 className=\"text-lg font-semibold\">Guardian Information</h3>\n              \n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"guardian_name\">Guardian Name *</Label>\n                  <Input\n                    id=\"guardian_name\"\n                    {...register('guardian_name')}\n                    placeholder=\"Enter guardian name\"\n                  />\n                  {errors.guardian_name && (\n                    <p className=\"text-sm text-red-600\">{errors.guardian_name.message}</p>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"guardian_relation\">Relation *</Label>\n                  <Select\n                    value={watch('guardian_relation') || 'placeholder'}\n                    onValueChange={(value) => setValue('guardian_relation', value === 'placeholder' ? '' : value)}\n                  >\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"Select relation\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"placeholder\" disabled>Select relation</SelectItem>\n                      <SelectItem value=\"father\">Father</SelectItem>\n                      <SelectItem value=\"mother\">Mother</SelectItem>\n                      <SelectItem value=\"brother\">Brother</SelectItem>\n                      <SelectItem value=\"sister\">Sister</SelectItem>\n                      <SelectItem value=\"uncle\">Uncle</SelectItem>\n                      <SelectItem value=\"aunt\">Aunt</SelectItem>\n                      <SelectItem value=\"grandfather\">Grandfather</SelectItem>\n                      <SelectItem value=\"grandmother\">Grandmother</SelectItem>\n                      <SelectItem value=\"guardian\">Guardian</SelectItem>\n                      <SelectItem value=\"other\">Other</SelectItem>\n                    </SelectContent>\n                  </Select>\n                  {errors.guardian_relation && (\n                    <p className=\"text-sm text-red-600\">{errors.guardian_relation.message}</p>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"guardian_phone\">Guardian Phone *</Label>\n                  <Input\n                    id=\"guardian_phone\"\n                    {...register('guardian_phone')}\n                    placeholder=\"Enter guardian phone\"\n                  />\n                  {errors.guardian_phone && (\n                    <p className=\"text-sm text-red-600\">{errors.guardian_phone.message}</p>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"guardian_email\">Guardian Email</Label>\n                  <Input\n                    id=\"guardian_email\"\n                    type=\"email\"\n                    {...register('guardian_email')}\n                    placeholder=\"Enter guardian email\"\n                  />\n                  {errors.guardian_email && (\n                    <p className=\"text-sm text-red-600\">{errors.guardian_email.message}</p>\n                  )}\n                </div>\n\n                <div className=\"md:col-span-2 space-y-2\">\n                  <Label htmlFor=\"guardian_address\">Guardian Address</Label>\n                  <Input\n                    id=\"guardian_address\"\n                    {...register('guardian_address')}\n                    placeholder=\"Enter guardian address\"\n                  />\n                </div>\n              </div>\n            </div>\n\n            {/* Form Validation Summary */}\n            {Object.keys(errors).length > 0 && (\n              <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\n                <h4 className=\"text-sm font-medium text-red-800 mb-2\">❌ Please fix the following errors:</h4>\n                <ul className=\"text-sm text-red-700 space-y-1\">\n                  {Object.entries(errors).map(([field, error]) => (\n                    <li key={field}>• <strong>{field.replace('_', ' ')}</strong>: {error?.message || `${field} is required`}</li>\n                  ))}\n                </ul>\n                <p className=\"text-sm text-red-600 mt-2\">\n                  💡 <strong>Tip:</strong> Scroll up to see all form fields. All fields marked with <span className=\"text-red-500 font-semibold\">*</span> are required.\n                </p>\n              </div>\n            )}\n\n            {/* Success Preview */}\n            {Object.keys(errors).length === 0 && watch('admission_number') && watch('full_name') && watch('email') && (\n              <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\n                <h4 className=\"text-sm font-medium text-green-800 mb-2\">✅ Form Ready to Submit</h4>\n                <p className=\"text-sm text-green-700\">\n                  All required fields are filled. Student will be created as: <strong>{watch('full_name')}</strong> (Admission: {watch('admission_number')})\n                </p>\n              </div>\n            )}\n\n            {/* Form Actions */}\n            <div className=\"flex justify-end gap-2 pt-4\">\n              <Button type=\"button\" variant=\"outline\" onClick={onClose}>\n                Cancel\n              </Button>\n              <Button type=\"submit\" disabled={isLoading}>\n                {isLoading && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n                {isEdit ? 'Update Student' : 'Create Student'}\n              </Button>\n            </div>\n          </form>\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\teachers\\TeacherForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used.","line":3,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Trash2' is defined but never used.","line":15,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":34},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'reset' is assigned a value but never used.","line":81,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":81,"endColumn":10},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":96,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":96,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3745,3748],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3745,3748],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":157,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":157,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5609,5612],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5609,5612],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":167,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":167,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6056,6059],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6056,6059],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":304,"column":75,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":304,"endColumn":78,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11888,11891],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11888,11891],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useEffect } from 'react'\nimport { useForm } from 'react-hook-form'\nimport { zodResolver } from '@hookform/resolvers/zod'\nimport * as z from 'zod'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Label } from '@/components/ui/label'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { teacherService } from '@/services/teacherService'\nimport { useAuth } from '@/contexts/AuthContext'\nimport { Teacher, SalaryInfo } from '@/types'\nimport { Loader2, X, Plus, Trash2 } from 'lucide-react'\nimport { toast } from '@/components/ui/toast'\n\nconst teacherSchema = z.object({\n  employee_id: z.string()\n    .min(1, 'Employee ID is required')\n    .regex(/^[A-Z0-9]+$/, 'Employee ID should contain only uppercase letters and numbers'),\n  full_name: z.string()\n    .min(2, 'Full name must be at least 2 characters')\n    .max(100, 'Full name must be less than 100 characters')\n    .regex(/^[a-zA-Z\\s]+$/, 'Full name should contain only letters and spaces'),\n  email: z.string()\n    .email('Please enter a valid email address')\n    .min(5, 'Email must be at least 5 characters'),\n  phone: z.string()\n    .regex(/^[0-9+\\-\\s()]+$/, 'Please enter a valid phone number')\n    .optional(),\n  address: z.string()\n    .max(200, 'Address must be less than 200 characters')\n    .optional(),\n  join_date: z.string().min(1, 'Join date is required'),\n  qualification: z.string()\n    .min(2, 'Qualification must be at least 2 characters')\n    .max(100, 'Qualification must be less than 100 characters'),\n  subjects: z.array(z.string()).min(1, 'At least one subject is required'),\n  basic_salary: z.number()\n    .min(0, 'Basic salary must be positive')\n    .max(1000000, 'Basic salary seems too high'),\n  allowances: z.number()\n    .min(0, 'Allowances must be positive')\n    .max(500000, 'Allowances seem too high')\n    .optional(),\n  currency: z.string().min(1, 'Currency is required'),\n  status: z.enum(['active', 'inactive', 'terminated', 'retired']),\n})\n\ntype TeacherFormData = z.infer<typeof teacherSchema>\n\ninterface TeacherFormProps {\n  teacher?: Teacher\n  onClose: () => void\n  onSuccess: () => void\n}\n\nconst SUBJECT_OPTIONS = [\n  'Mathematics', 'English', 'Science', 'Physics', 'Chemistry', 'Biology',\n  'History', 'Geography', 'Computer Science', 'Art', 'Music', 'Physical Education',\n  'Social Studies', 'Islamic Studies', 'Urdu', 'Arabic', 'French', 'Spanish',\n  'Economics', 'Business Studies', 'Accounting', 'Psychology', 'Sociology'\n]\n\nconst CURRENCY_OPTIONS = ['PKR', 'USD', 'EUR', 'GBP']\n\nexport function TeacherForm({ teacher, onClose, onSuccess }: TeacherFormProps) {\n  const [isLoading, setIsLoading] = useState(false)\n  const [newSubject, setNewSubject] = useState('')\n  const { user } = useAuth()\n  \n  const isEdit = !!teacher\n\n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n    setValue,\n    watch,\n    reset\n  } = useForm<TeacherFormData>({\n    resolver: zodResolver(teacherSchema),\n    defaultValues: {\n      employee_id: teacher?.employee_id || '',\n      full_name: teacher?.user?.full_name || '',\n      email: teacher?.user?.email || '',\n      phone: teacher?.user?.phone || '',\n      address: teacher?.user?.address || '',\n      join_date: teacher?.join_date ? teacher.join_date.split('T')[0] : '',\n      qualification: teacher?.qualification || '',\n      subjects: teacher?.subjects || [],\n      basic_salary: teacher?.salary_info?.basic_salary || 0,\n      allowances: teacher?.salary_info?.allowances || 0,\n      currency: teacher?.salary_info?.currency || 'PKR',\n      status: (teacher?.status as any) || 'active',\n    }\n  })\n\n  const watchedSubjects = watch('subjects')\n\n  const addSubject = () => {\n    if (newSubject.trim() && !watchedSubjects.includes(newSubject.trim())) {\n      setValue('subjects', [...watchedSubjects, newSubject.trim()])\n      setNewSubject('')\n    }\n  }\n\n  const removeSubject = (subjectToRemove: string) => {\n    setValue('subjects', watchedSubjects.filter(subject => subject !== subjectToRemove))\n  }\n\n  const onSubmit = async (data: TeacherFormData) => {\n    if (!user) return\n\n    setIsLoading(true)\n    try {\n      const salaryInfo: SalaryInfo = {\n        basic_salary: data.basic_salary,\n        allowances: data.allowances || 0,\n        currency: data.currency,\n      }\n\n      if (isEdit && teacher) {\n        // For updates, send only the fields that can be updated\n        const updateData = {\n          full_name: data.full_name,\n          phone: data.phone,\n          address: data.address,\n          qualification: data.qualification,\n          subjects: data.subjects,\n          salary_info: salaryInfo,\n          status: data.status,\n        }\n        await teacherService.updateTeacher(teacher.id, updateData)\n      } else {\n        // For creation, send data in the format backend expects\n        const createData = {\n          // User info\n          email: data.email,\n          password: `${data.employee_id}@123`, // Auto-generate password\n          full_name: data.full_name,\n          phone: data.phone || undefined,\n          address: data.address || undefined,\n          // Teacher specific\n          employee_id: data.employee_id,\n          join_date: data.join_date,\n          qualification: data.qualification,\n          subjects: data.subjects,\n          salary_info: salaryInfo,\n        }\n        await teacherService.createTeacher(createData)\n      }\n\n      onSuccess()\n      onClose()\n    } catch (error: any) {\n      console.error('Failed to save teacher:', error)\n      \n      // Handle different error formats\n      let errorMessage = 'Failed to save teacher'\n      \n      if (error.response?.data?.detail) {\n        if (typeof error.response.data.detail === 'string') {\n          errorMessage = error.response.data.detail\n        } else if (Array.isArray(error.response.data.detail)) {\n          errorMessage = error.response.data.detail.map((err: any) => \n            typeof err === 'string' ? err : err.msg || JSON.stringify(err)\n          ).join(', ')\n        } else if (typeof error.response.data.detail === 'object') {\n          errorMessage = error.response.data.detail.message || JSON.stringify(error.response.data.detail)\n        }\n      } else if (error.message) {\n        errorMessage = error.message\n      }\n      \n      toast.error(errorMessage)\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n      <Card className=\"w-full max-w-3xl max-h-[90vh] overflow-y-auto\">\n        <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-4\">\n          <CardTitle>{isEdit ? 'Edit Teacher' : 'Add New Teacher'}</CardTitle>\n          <Button variant=\"ghost\" size=\"sm\" onClick={onClose}>\n            <X className=\"h-4 w-4\" />\n          </Button>\n        </CardHeader>\n        <CardContent>\n          <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-6\">\n            {/* Professional Header */}\n            <div className=\"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-6\">\n              <div className=\"flex items-center gap-3 mb-3\">\n                <div className=\"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center\">\n                  <span className=\"text-green-600 font-bold text-lg\">👨‍🏫</span>\n                </div>\n                <div>\n                  <h4 className=\"text-lg font-semibold text-green-900\">Teacher Registration</h4>\n                  <p className=\"text-sm text-green-700\">Complete all required fields to register a new teacher</p>\n                </div>\n              </div>\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2 text-xs text-green-600\">\n                <div className=\"flex items-center gap-1\">\n                  <span className=\"w-2 h-2 bg-green-400 rounded-full\"></span>\n                  <span>Personal Info</span>\n                </div>\n                <div className=\"flex items-center gap-1\">\n                  <span className=\"w-2 h-2 bg-green-400 rounded-full\"></span>\n                  <span>Academic Info</span>\n                </div>\n                <div className=\"flex items-center gap-1\">\n                  <span className=\"w-2 h-2 bg-green-400 rounded-full\"></span>\n                  <span>Subjects</span>\n                </div>\n                <div className=\"flex items-center gap-1\">\n                  <span className=\"w-2 h-2 bg-green-400 rounded-full\"></span>\n                  <span>Salary Info</span>\n                </div>\n              </div>\n            </div>\n\n            {/* Teacher Information */}\n            <div className=\"space-y-4\">\n              <h3 className=\"text-lg font-semibold\">Teacher Information</h3>\n              \n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"employee_id\">Employee ID *</Label>\n                  <Input\n                    id=\"employee_id\"\n                    {...register('employee_id')}\n                    placeholder=\"Enter employee ID\"\n                  />\n                  {errors.employee_id && (\n                    <p className=\"text-sm text-red-600\">{errors.employee_id.message}</p>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"full_name\">Full Name *</Label>\n                  <Input\n                    id=\"full_name\"\n                    {...register('full_name')}\n                    placeholder=\"Enter full name\"\n                  />\n                  {errors.full_name && (\n                    <p className=\"text-sm text-red-600\">{errors.full_name.message}</p>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"email\">Email *</Label>\n                  <Input\n                    id=\"email\"\n                    type=\"email\"\n                    {...register('email')}\n                    placeholder=\"Enter email address\"\n                  />\n                  {errors.email && (\n                    <p className=\"text-sm text-red-600\">{errors.email.message}</p>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"phone\">Phone</Label>\n                  <Input\n                    id=\"phone\"\n                    {...register('phone')}\n                    placeholder=\"Enter phone number\"\n                  />\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"join_date\">Join Date *</Label>\n                  <Input\n                    id=\"join_date\"\n                    type=\"date\"\n                    {...register('join_date')}\n                  />\n                  {errors.join_date && (\n                    <p className=\"text-sm text-red-600\">{errors.join_date.message}</p>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"qualification\">Qualification *</Label>\n                  <Input\n                    id=\"qualification\"\n                    {...register('qualification')}\n                    placeholder=\"e.g., BSc, MSc, PhD\"\n                  />\n                  {errors.qualification && (\n                    <p className=\"text-sm text-red-600\">{errors.qualification.message}</p>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"status\">Status *</Label>\n                  <Select\n                    value={watch('status') || 'active'}\n                    onValueChange={(value) => setValue('status', value as any)}\n                  >\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"Select status\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"active\">Active</SelectItem>\n                      <SelectItem value=\"inactive\">Inactive</SelectItem>\n                      <SelectItem value=\"terminated\">Terminated</SelectItem>\n                      <SelectItem value=\"retired\">Retired</SelectItem>\n                    </SelectContent>\n                  </Select>\n                  {errors.status && (\n                    <p className=\"text-sm text-red-600\">{errors.status.message}</p>\n                  )}\n                </div>\n\n                <div className=\"md:col-span-2 space-y-2\">\n                  <Label htmlFor=\"address\">Address</Label>\n                  <Input\n                    id=\"address\"\n                    {...register('address')}\n                    placeholder=\"Enter address\"\n                  />\n                </div>\n              </div>\n            </div>\n\n            {/* Subjects */}\n            <div className=\"space-y-4\">\n              <h3 className=\"text-lg font-semibold\">Subjects</h3>\n              \n              <div className=\"space-y-4\">\n                <div className=\"flex gap-2\">\n                  <Select\n                    value={newSubject || 'placeholder'}\n                    onValueChange={(value) => setNewSubject(value === 'placeholder' ? '' : value)}\n                  >\n                    <SelectTrigger className=\"flex-1\">\n                      <SelectValue placeholder=\"Select or type a subject\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"placeholder\" disabled>Select a subject</SelectItem>\n                      {SUBJECT_OPTIONS.map((subject) => (\n                        <SelectItem key={subject} value={subject}>\n                          {subject}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  <Button type=\"button\" onClick={addSubject}>\n                    <Plus className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label>Selected Subjects *</Label>\n                  {watchedSubjects.length === 0 ? (\n                    <p className=\"text-sm text-gray-500\">No subjects selected</p>\n                  ) : (\n                    <div className=\"flex flex-wrap gap-2\">\n                      {watchedSubjects.map((subject) => (\n                        <span\n                          key={subject}\n                          className=\"inline-flex items-center gap-1 rounded-full bg-blue-100 px-3 py-1 text-sm font-semibold text-blue-800\"\n                        >\n                          {subject}\n                          <button\n                            type=\"button\"\n                            onClick={() => removeSubject(subject)}\n                            className=\"ml-1 hover:bg-blue-200 rounded-full p-0.5\"\n                          >\n                            <X className=\"h-3 w-3\" />\n                          </button>\n                        </span>\n                      ))}\n                    </div>\n                  )}\n                  {errors.subjects && (\n                    <p className=\"text-sm text-red-600\">{errors.subjects.message}</p>\n                  )}\n                </div>\n              </div>\n            </div>\n\n            {/* Salary Information */}\n            <div className=\"space-y-4\">\n              <h3 className=\"text-lg font-semibold\">Salary Information</h3>\n              \n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"basic_salary\">Basic Salary *</Label>\n                  <Input\n                    id=\"basic_salary\"\n                    type=\"number\"\n                    step=\"0.01\"\n                    {...register('basic_salary', { valueAsNumber: true })}\n                    placeholder=\"0.00\"\n                  />\n                  {errors.basic_salary && (\n                    <p className=\"text-sm text-red-600\">{errors.basic_salary.message}</p>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"allowances\">Allowances</Label>\n                  <Input\n                    id=\"allowances\"\n                    type=\"number\"\n                    step=\"0.01\"\n                    {...register('allowances', { valueAsNumber: true })}\n                    placeholder=\"0.00\"\n                  />\n                  {errors.allowances && (\n                    <p className=\"text-sm text-red-600\">{errors.allowances.message}</p>\n                  )}\n                </div>\n\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"currency\">Currency *</Label>\n                  <Select\n                    value={watch('currency') || 'PKR'}\n                    onValueChange={(value) => setValue('currency', value)}\n                  >\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"Select currency\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {CURRENCY_OPTIONS.map((currency) => (\n                        <SelectItem key={currency} value={currency}>\n                          {currency}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  {errors.currency && (\n                    <p className=\"text-sm text-red-600\">{errors.currency.message}</p>\n                  )}\n                </div>\n              </div>\n\n              <div className=\"bg-gray-50 p-4 rounded-lg\">\n                <h4 className=\"font-medium mb-2\">Total Monthly Salary</h4>\n                <p className=\"text-2xl font-bold text-green-600\">\n                  {watch('currency')} {(watch('basic_salary') || 0) + (watch('allowances') || 0)}\n                </p>\n              </div>\n            </div>\n\n            {/* Form Actions */}\n            <div className=\"flex justify-end gap-2 pt-4\">\n              <Button type=\"button\" variant=\"outline\" onClick={onClose}>\n                Cancel\n              </Button>\n              <Button type=\"submit\" disabled={isLoading}>\n                {isLoading && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\n                {isEdit ? 'Update Teacher' : 'Create Teacher'}\n              </Button>\n            </div>\n          </form>\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\ui\\badge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\ui\\button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\ui\\calendar.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronLeft' is defined but never used.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ChevronRight' is defined but never used.","line":4,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":35}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\r\nimport { DayPicker } from \"react-day-picker\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\nimport { buttonVariants } from \"@/components/ui/button\"\r\n\r\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\r\n\r\nfunction Calendar({\r\n  className,\r\n  classNames,\r\n  showOutsideDays = true,\r\n  ...props\r\n}: CalendarProps) {\r\n  return (\r\n    <DayPicker\r\n      showOutsideDays={showOutsideDays}\r\n      className={cn(\"p-3\", className)}\r\n      classNames={{\r\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\r\n        month: \"space-y-4\",\r\n        caption: \"flex justify-center pt-1 relative items-center\",\r\n        caption_label: \"text-sm font-medium\",\r\n        nav: \"space-x-1 flex items-center\",\r\n        nav_button: cn(\r\n          buttonVariants({ variant: \"outline\" }),\r\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\r\n        ),\r\n        nav_button_previous: \"absolute left-1\",\r\n        nav_button_next: \"absolute right-1\",\r\n        table: \"w-full border-collapse space-y-1\",\r\n        head_row: \"flex\",\r\n        head_cell:\r\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\r\n        row: \"flex w-full mt-2\",\r\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\r\n        day: cn(\r\n          buttonVariants({ variant: \"ghost\" }),\r\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\r\n        ),\r\n        day_range_end: \"day-range-end\",\r\n        day_selected:\r\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\r\n        day_today: \"bg-accent text-accent-foreground\",\r\n        day_outside:\r\n          \"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30\",\r\n        day_disabled: \"text-muted-foreground opacity-50\",\r\n        day_range_middle:\r\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\r\n        day_hidden: \"invisible\",\r\n        ...classNames,\r\n      }}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\nCalendar.displayName = \"Calendar\"\r\n\r\nexport { Calendar }\r\n\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\ui\\card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\ui\\dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\ui\\input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\ui\\label.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\ui\\popover.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\ui\\select.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\ui\\skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\ui\\textarea.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\components\\ui\\toast.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\contexts\\AuthContext.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'pathname' is assigned a value but never used.","line":24,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'daysOld' is assigned a value but never used.","line":58,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":58,"endColumn":22},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":166,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":166,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5578,5581],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5578,5581],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":199,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":199,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6594,6597],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6594,6597],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadSession'. Either include it or remove the dependency array.","line":101,"column":6,"nodeType":"ArrayExpression","endLine":101,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [loadSession]","fix":{"range":[3140,3142],"text":"[loadSession]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"﻿\"use client\"\n\nimport React, { createContext, useContext, useEffect, useState, useCallback } from 'react'\nimport { useRouter, usePathname } from 'next/navigation'\nimport { authService } from '@/services/authService'\nimport { User } from '@/types'\n\ninterface AuthContextType {\n  user: User | null\n  isAuthenticated: boolean\n  isLoading: boolean\n  login: (email: string, password: string) => Promise<void>\n  logout: () => void\n  refreshSession: () => Promise<void>\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined)\n\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\n  const [user, setUser] = useState<User | null>(null)\n  const [isAuthenticated, setIsAuthenticated] = useState(false)\n  const [isLoading, setIsLoading] = useState(true)\n  const router = useRouter()\n  const pathname = usePathname()\n\n  // Clear session helper\n  const clearSession = useCallback(() => {\n    \n    localStorage.removeItem('access_token')\n    localStorage.removeItem('user')\n    localStorage.removeItem('auth_timestamp')\n\n    const isHttps = typeof window !== 'undefined' && window.location.protocol === 'https:'\n    const secure = isHttps ? '; Secure' : ''\n    document.cookie = `access_token=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT; SameSite=Lax${secure}`\n\n    setUser(null)\n    setIsAuthenticated(false)\n  }, [])\n\n  // Load session from storage\n  const loadSession = useCallback(async () => {\n    try {\n      const token = localStorage.getItem('access_token')\n      const storedUser = localStorage.getItem('user')\n      const authTimestamp = localStorage.getItem('auth_timestamp')\n      \n\n      if (!token || !storedUser) {\n        setIsLoading(false)\n        return\n      }\n\n      // Check if token is expired (30 days)\n      if (authTimestamp) {\n        const tokenAge = Date.now() - parseInt(authTimestamp)\n        const maxAge = 30 * 24 * 60 * 60 * 1000 // 30 days\n        const daysOld = (tokenAge / (24 * 60 * 60 * 1000)).toFixed(1)\n\n\n        if (tokenAge > maxAge) {\n          clearSession()\n          setIsLoading(false)\n          return\n        }\n      }\n\n      // Parse user with error handling\n      let parsedUser\n      try {\n        parsedUser = JSON.parse(storedUser)\n        if (!parsedUser || !parsedUser.id || !parsedUser.email || !parsedUser.role) {\n          throw new Error('Invalid user data structure')\n        }\n      } catch (parseError) {\n        console.error('❌ Failed to parse stored user:', parseError)\n        clearSession()\n        setIsLoading(false)\n        return\n      }\n\n      \n      // Set user immediately from storage (fast app start)\n      setUser(parsedUser)\n      setIsAuthenticated(true)\n      setIsLoading(false)\n      \n      // REMOVED: Backend verification - causes session clearing issues\n      // We trust the stored token unless explicitly invalidated\n    } catch (error) {\n      console.error('❌ Failed to load session:', error)\n      clearSession()\n      setIsLoading(false)\n    }\n  }, [clearSession])\n\n  // Initialize session on mount - only once\n  useEffect(() => {\n    loadSession()\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []) // Intentionally empty - only run once on mount\n\n  const login = async (email: string, password: string) => {\n    try {\n      setIsLoading(true)\n      const response = await authService.login(email, password)\n      \n      // Validate response structure\n      if (!response || !response.access_token || !response.user) {\n        throw new Error('Invalid login response: missing access_token or user data')\n      }\n\n      const userData: User = {\n        id: response.user.id,\n        email: response.user.email,\n        full_name: response.user.full_name || '',\n        role: response.user.role,\n        phone: response.user.phone,\n        address: response.user.address,\n        avatar_url: response.user.avatar_url,\n        created_at: response.user.created_at || new Date().toISOString(),\n      }\n\n      // Validate user data\n      if (!userData.id || !userData.email || !userData.role) {\n        throw new Error('Invalid user data in login response')\n      }\n\n\n      // Store in localStorage\n      try {\n        localStorage.setItem('access_token', response.access_token)\n        localStorage.setItem('user', JSON.stringify(userData))\n        localStorage.setItem('auth_timestamp', Date.now().toString())\n      } catch (storageError) {\n        console.error('❌ Failed to store session:', storageError)\n        throw new Error('Failed to save session. Please check browser storage permissions.')\n      }\n\n      // Store in cookie for middleware\n      try {\n        const isHttps = typeof window !== 'undefined' && window.location.protocol === 'https:'\n        const secure = isHttps ? '; Secure' : ''\n        const maxAge = 30 * 24 * 60 * 60 // 30 days\n        document.cookie = `access_token=${response.access_token}; path=/; max-age=${maxAge}; SameSite=Lax${secure}`\n      } catch (cookieError) {\n        console.warn('⚠️ Failed to set cookie:', cookieError)\n        // Non-fatal, continue with localStorage only\n      }\n\n      setUser(userData)\n      setIsAuthenticated(true)\n\n      // Redirect based on role\n      const redirectPaths: Record<string, string> = {\n        admin: '/admin/dashboard',\n        principal: '/principal/dashboard',\n        teacher: '/teacher/dashboard',\n        student: '/student/dashboard',\n      }\n      \n      const redirectPath = redirectPaths[userData.role] || '/admin/dashboard'\n      \n      // Use router.replace to avoid adding to history\n      router.replace(redirectPath)\n    } catch (error: any) {\n      console.error('❌ Login failed:', error)\n      \n      // Clear any partial session data on error\n      clearSession()\n      \n      // Re-throw with better error message\n      if (error.response) {\n        // Axios error\n        const message = error.response.data?.detail || error.response.data?.message || 'Login failed'\n        throw new Error(message)\n      } else if (error.message) {\n        // Custom error message\n        throw error\n      } else {\n        throw new Error('Login failed. Please check your credentials and try again.')\n      }\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  const logout = useCallback(() => {\n    clearSession()\n    router.push('/login')\n  }, [clearSession, router])\n\n  const refreshSession = async () => {\n    try {\n      const currentUser = await authService.getCurrentUser()\n      setUser(currentUser)\n      localStorage.setItem('user', JSON.stringify(currentUser))\n      localStorage.setItem('auth_timestamp', Date.now().toString())\n    } catch (error: any) {\n      console.warn('⚠️ Session refresh failed (will retry later):', error.message)\n      // Don't clear session on refresh failure - keep user logged in\n      // Only log the error for monitoring\n    }\n  }\n\n  const value: AuthContextType = {\n    user,\n    isAuthenticated,\n    isLoading,\n    login,\n    logout,\n    refreshSession,\n  }\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext)\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider')\n  }\n  return context\n}\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\contexts\\SettingsContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\lib\\api.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\lib\\entityHelpers.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\lib\\filterHelpers.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'s' is defined but never used. Allowed unused args must match /^_/u.","line":81,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":81,"endColumn":33},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":289,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":289,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7678,7681],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7678,7681],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Shared filter logic and utilities\r\n */\r\n\r\nimport { Student, Teacher, Class, Grade, Attendance, Expense, Donation } from '@/types'\r\n\r\nexport interface BaseFilter {\r\n  search?: string\r\n  limit?: number\r\n  offset?: number\r\n}\r\n\r\nexport interface StudentFilter extends BaseFilter {\r\n  class_id?: string\r\n  status?: 'active' | 'inactive'\r\n  academic_year?: string\r\n}\r\n\r\nexport interface TeacherFilter extends BaseFilter {\r\n  status?: 'active' | 'inactive'\r\n  subject?: string\r\n}\r\n\r\nexport interface ClassFilter extends BaseFilter {\r\n  teacher_id?: string\r\n  academic_year?: string\r\n}\r\n\r\nexport interface GradeFilter extends BaseFilter {\r\n  student_id?: string\r\n  class_id?: string\r\n  subject?: string\r\n  term?: string\r\n  academic_year?: string\r\n  min_marks?: number\r\n  max_marks?: number\r\n}\r\n\r\nexport interface AttendanceFilter extends BaseFilter {\r\n  user_id?: string\r\n  class_id?: string\r\n  date?: string\r\n  date_from?: string\r\n  date_to?: string\r\n  status?: 'present' | 'absent' | 'late' | 'excused'\r\n}\r\n\r\nexport interface FinancialFilter extends BaseFilter {\r\n  date_from?: string\r\n  date_to?: string\r\n  category?: string\r\n}\r\n\r\n/**\r\n * Filter students based on criteria\r\n */\r\nexport function filterStudents(students: Student[], filter: StudentFilter): Student[] {\r\n  let filtered = [...students]\r\n\r\n  if (filter.search) {\r\n    const searchLower = filter.search.toLowerCase()\r\n    filtered = filtered.filter(s =>\r\n      s.admission_number.toLowerCase().includes(searchLower) ||\r\n      s.user?.full_name?.toLowerCase().includes(searchLower) ||\r\n      s.guardian_info?.name?.toLowerCase().includes(searchLower) ||\r\n      s.user?.email?.toLowerCase().includes(searchLower)\r\n    )\r\n  }\r\n\r\n  if (filter.class_id) {\r\n    filtered = filtered.filter(s => s.class_id === filter.class_id)\r\n  }\r\n\r\n  if (filter.status) {\r\n    filtered = filtered.filter(s => s.status === filter.status)\r\n  }\r\n\r\n  if (filter.academic_year) {\r\n    // If students have academic_year field, filter by it\r\n    // Otherwise, filter by their class's academic_year\r\n    filtered = filtered.filter(s => {\r\n      // This assumes students are linked to classes which have academic_year\r\n      // You may need to join with classes data to filter properly\r\n      return true // Placeholder - implement based on your data structure\r\n    })\r\n  }\r\n\r\n  return filtered\r\n}\r\n\r\n/**\r\n * Filter teachers based on criteria\r\n */\r\nexport function filterTeachers(teachers: Teacher[], filter: TeacherFilter): Teacher[] {\r\n  let filtered = [...teachers]\r\n\r\n  if (filter.search) {\r\n    const searchLower = filter.search.toLowerCase()\r\n    filtered = filtered.filter(t =>\r\n      t.employee_id.toLowerCase().includes(searchLower) ||\r\n      t.user?.full_name?.toLowerCase().includes(searchLower) ||\r\n      t.user?.email?.toLowerCase().includes(searchLower) ||\r\n      t.qualification.toLowerCase().includes(searchLower) ||\r\n      t.subjects.some(sub => sub.toLowerCase().includes(searchLower))\r\n    )\r\n  }\r\n\r\n  if (filter.status) {\r\n    filtered = filtered.filter(t => t.status === filter.status)\r\n  }\r\n\r\n  if (filter.subject) {\r\n    filtered = filtered.filter(t => \r\n      t.subjects.some(sub => sub.toLowerCase() === filter.subject!.toLowerCase())\r\n    )\r\n  }\r\n\r\n  return filtered\r\n}\r\n\r\n/**\r\n * Filter classes based on criteria\r\n */\r\nexport function filterClasses(classes: Class[], filter: ClassFilter): Class[] {\r\n  let filtered = [...classes]\r\n\r\n  if (filter.search) {\r\n    const searchLower = filter.search.toLowerCase()\r\n    filtered = filtered.filter(c =>\r\n      c.name.toLowerCase().includes(searchLower) ||\r\n      c.section.toLowerCase().includes(searchLower) ||\r\n      c.academic_year.toLowerCase().includes(searchLower)\r\n    )\r\n  }\r\n\r\n  if (filter.teacher_id) {\r\n    filtered = filtered.filter(c => c.teacher_id === filter.teacher_id)\r\n  }\r\n\r\n  if (filter.academic_year) {\r\n    filtered = filtered.filter(c => c.academic_year === filter.academic_year)\r\n  }\r\n\r\n  return filtered\r\n}\r\n\r\n/**\r\n * Filter grades based on criteria\r\n */\r\nexport function filterGrades(grades: Grade[], filter: GradeFilter, students?: Student[]): Grade[] {\r\n  let filtered = [...grades]\r\n\r\n  if (filter.student_id) {\r\n    filtered = filtered.filter(g => g.student_id === filter.student_id)\r\n  }\r\n\r\n  if (filter.class_id && students) {\r\n    const classStudentIds = students\r\n      .filter(s => s.class_id === filter.class_id)\r\n      .map(s => s.id)\r\n    filtered = filtered.filter(g => classStudentIds.includes(g.student_id))\r\n  }\r\n\r\n  if (filter.subject) {\r\n    filtered = filtered.filter(g => \r\n      g.subject.toLowerCase() === filter.subject!.toLowerCase()\r\n    )\r\n  }\r\n\r\n  if (filter.term) {\r\n    filtered = filtered.filter(g => g.term === filter.term)\r\n  }\r\n\r\n  if (filter.academic_year) {\r\n    filtered = filtered.filter(g => g.academic_year === filter.academic_year)\r\n  }\r\n\r\n  if (filter.min_marks !== undefined) {\r\n    filtered = filtered.filter(g => Number(g.marks) >= filter.min_marks!)\r\n  }\r\n\r\n  if (filter.max_marks !== undefined) {\r\n    filtered = filtered.filter(g => Number(g.marks) <= filter.max_marks!)\r\n  }\r\n\r\n  return filtered\r\n}\r\n\r\n/**\r\n * Filter attendance based on criteria\r\n */\r\nexport function filterAttendance(\r\n  attendance: Attendance[],\r\n  filter: AttendanceFilter,\r\n  students?: Student[]\r\n): Attendance[] {\r\n  let filtered = [...attendance]\r\n\r\n  if (filter.user_id) {\r\n    filtered = filtered.filter(a => a.user_id === filter.user_id)\r\n  }\r\n\r\n  if (filter.class_id && students) {\r\n    const classUserIds = students\r\n      .filter(s => s.class_id === filter.class_id)\r\n      .map(s => s.user_id)\r\n      .filter(Boolean)\r\n    filtered = filtered.filter(a => classUserIds.includes(a.user_id))\r\n  }\r\n\r\n  if (filter.date) {\r\n    filtered = filtered.filter(a => a.date === filter.date)\r\n  }\r\n\r\n  if (filter.date_from) {\r\n    filtered = filtered.filter(a => a.date >= filter.date_from!)\r\n  }\r\n\r\n  if (filter.date_to) {\r\n    filtered = filtered.filter(a => a.date <= filter.date_to!)\r\n  }\r\n\r\n  if (filter.status) {\r\n    filtered = filtered.filter(a => a.status === filter.status)\r\n  }\r\n\r\n  return filtered\r\n}\r\n\r\n/**\r\n * Filter expenses based on criteria\r\n */\r\nexport function filterExpenses(expenses: Expense[], filter: FinancialFilter): Expense[] {\r\n  let filtered = [...expenses]\r\n\r\n  if (filter.search) {\r\n    const searchLower = filter.search.toLowerCase()\r\n    filtered = filtered.filter(e =>\r\n      e.description?.toLowerCase().includes(searchLower) ||\r\n      e.category?.toLowerCase().includes(searchLower) ||\r\n      e.payment_method?.toLowerCase().includes(searchLower)\r\n    )\r\n  }\r\n\r\n  if (filter.date_from) {\r\n    filtered = filtered.filter(e => e.date >= filter.date_from!)\r\n  }\r\n\r\n  if (filter.date_to) {\r\n    filtered = filtered.filter(e => e.date <= filter.date_to!)\r\n  }\r\n\r\n  if (filter.category) {\r\n    filtered = filtered.filter(e => e.category === filter.category)\r\n  }\r\n\r\n  return filtered\r\n}\r\n\r\n/**\r\n * Filter donations based on criteria\r\n */\r\nexport function filterDonations(donations: Donation[], filter: FinancialFilter): Donation[] {\r\n  let filtered = [...donations]\r\n\r\n  if (filter.search) {\r\n    const searchLower = filter.search.toLowerCase()\r\n    filtered = filtered.filter(d =>\r\n      d.donor_name?.toLowerCase().includes(searchLower) ||\r\n      d.purpose?.toLowerCase().includes(searchLower) ||\r\n      d.payment_method?.toLowerCase().includes(searchLower)\r\n    )\r\n  }\r\n\r\n  if (filter.date_from) {\r\n    filtered = filtered.filter(d => d.date >= filter.date_from!)\r\n  }\r\n\r\n  if (filter.date_to) {\r\n    filtered = filtered.filter(d => d.date <= filter.date_to!)\r\n  }\r\n\r\n  return filtered\r\n}\r\n\r\n/**\r\n * Build query string from filter object\r\n */\r\nexport function buildFilterQuery(filter: Record<string, any>): string {\r\n  const params = new URLSearchParams()\r\n  \r\n  Object.entries(filter).forEach(([key, value]) => {\r\n    if (value !== undefined && value !== null && value !== '') {\r\n      params.set(key, String(value))\r\n    }\r\n  })\r\n  \r\n  return params.toString()\r\n}\r\n\r\n/**\r\n * Parse query string to filter object\r\n */\r\nexport function parseFilterQuery(queryString: string): Record<string, string> {\r\n  const params = new URLSearchParams(queryString)\r\n  const filter: Record<string, string> = {}\r\n  \r\n  params.forEach((value, key) => {\r\n    filter[key] = value\r\n  })\r\n  \r\n  return filter\r\n}\r\n\r\n/**\r\n * Apply pagination to filtered results\r\n */\r\nexport function paginate<T>(items: T[], limit?: number, offset?: number): T[] {\r\n  if (!limit) return items\r\n  \r\n  const start = offset || 0\r\n  const end = start + limit\r\n  \r\n  return items.slice(start, end)\r\n}\r\n\r\n/**\r\n * Get date range for common periods\r\n */\r\nexport function getDateRange(period: 'today' | 'this_week' | 'this_month' | 'this_year' | 'last_month'): {\r\n  from: string\r\n  to: string\r\n} {\r\n  const today = new Date()\r\n  let from: Date\r\n  let to: Date = new Date(today)\r\n\r\n  switch (period) {\r\n    case 'today':\r\n      from = new Date(today)\r\n      break\r\n    case 'this_week':\r\n      from = new Date(today)\r\n      from.setDate(today.getDate() - today.getDay()) // Start of week (Sunday)\r\n      break\r\n    case 'this_month':\r\n      from = new Date(today.getFullYear(), today.getMonth(), 1)\r\n      break\r\n    case 'last_month':\r\n      from = new Date(today.getFullYear(), today.getMonth() - 1, 1)\r\n      to = new Date(today.getFullYear(), today.getMonth(), 0)\r\n      break\r\n    case 'this_year':\r\n      from = new Date(today.getFullYear(), 0, 1)\r\n      break\r\n    default:\r\n      from = new Date(today)\r\n  }\r\n\r\n  return {\r\n    from: from.toISOString().split('T')[0],\r\n    to: to.toISOString().split('T')[0]\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\lib\\gradingUtils.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":356,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":356,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10393,10396],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10393,10396],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Comprehensive Grading System\r\n * Based on provided school criteria\r\n */\r\n\r\n// Configuration\r\nexport const GRADING_CONFIG = {\r\n  absentMarker: \"A\", // case-insensitive\r\n  promotionThresholdPercent: 40, // default; configurable\r\n  gradeBands: {\r\n    A_PLUS: { min: 80, label: \"A+\" },\r\n    A: { min: 70, max: 79.99, label: \"A\" },\r\n    B: { min: 60, max: 69.99, label: \"B\" },\r\n    C: { min: 50, max: 59.99, label: \"C\" },\r\n    D: { min: 40, max: 49.99, label: \"D\" },\r\n    F: { min: 0, max: 39.99, label: \"F\" }\r\n  },\r\n  rounding: 2, // decimal places for percentages\r\n  treatBlankAsAbsent: false\r\n}\r\n\r\n// Types\r\nexport interface SubjectResult {\r\n  subjectId: string\r\n  subjectName: string\r\n  maxMarks: number\r\n  passMark: number\r\n  obtained: number | string\r\n  numericMark: number\r\n  status: 'Pass' | 'Fail' | 'Absent'\r\n}\r\n\r\nexport interface TermResult {\r\n  termNumber: number\r\n  subjects: SubjectResult[]\r\n  termTotal: number\r\n  termMaxTotal: number\r\n  termPercent: number\r\n  statuses: string[]\r\n}\r\n\r\nexport interface StudentGradeData {\r\n  studentId: string\r\n  name: string\r\n  roll: string\r\n  class: string\r\n  terms: TermResult[]\r\n  combinedT2: number\r\n  finalAggregate: number\r\n  finalPercent: number\r\n  finalGrade: string\r\n  finalStatus: 'Pass' | 'Fail' | 'Absent'\r\n  promoted: boolean\r\n  rank: number\r\n  rankLabel: string\r\n}\r\n\r\nexport interface ClassSummary {\r\n  totalStudents: number\r\n  absentStudents: number\r\n  presentStudents: number\r\n  passCount: number\r\n  failCount: number\r\n  passPercentage: number\r\n  yearPassPercent: number\r\n}\r\n\r\n/**\r\n * Compute subject status based on obtained marks and pass criteria\r\n */\r\nexport function computeSubjectStatus(\r\n  obtained: number | string,\r\n  passMark: number,\r\n  absentMarker: string = GRADING_CONFIG.absentMarker\r\n): { numericMark: number; status: 'Pass' | 'Fail' | 'Absent' } {\r\n  const obtainedStr = String(obtained).trim()\r\n  \r\n  // Check if absent\r\n  if (obtainedStr.toLowerCase() === absentMarker.toLowerCase()) {\r\n    return { numericMark: 0, status: 'Absent' }\r\n  }\r\n  \r\n  // Check if blank and treatBlankAsAbsent is true\r\n  if (GRADING_CONFIG.treatBlankAsAbsent && (obtainedStr === '' || obtainedStr === 'null' || obtainedStr === 'undefined')) {\r\n    return { numericMark: 0, status: 'Absent' }\r\n  }\r\n  \r\n  // Convert to number\r\n  const numericMark = parseFloat(obtainedStr)\r\n  \r\n  // Check if valid number\r\n  if (isNaN(numericMark)) {\r\n    throw new Error(`Invalid obtained value: ${obtained}`)\r\n  }\r\n  \r\n  // Determine status\r\n  if (numericMark >= passMark) {\r\n    return { numericMark, status: 'Pass' }\r\n  } else {\r\n    return { numericMark, status: 'Fail' }\r\n  }\r\n}\r\n\r\n/**\r\n * Compute term summary from subjects\r\n */\r\nexport function computeTermSummary(subjects: SubjectResult[]): {\r\n  termTotal: number\r\n  termMaxTotal: number\r\n  termPercent: number\r\n  statuses: string[]\r\n} {\r\n  const termTotal = subjects.reduce((sum, subject) => sum + subject.numericMark, 0)\r\n  const termMaxTotal = subjects.reduce((sum, subject) => sum + subject.maxMarks, 0)\r\n  const termPercent = termMaxTotal > 0 ? (termTotal / termMaxTotal) * 100 : 0\r\n  const statuses = subjects.map(subject => subject.status)\r\n  \r\n  return {\r\n    termTotal,\r\n    termMaxTotal,\r\n    termPercent: Math.round(termPercent * Math.pow(10, GRADING_CONFIG.rounding)) / Math.pow(10, GRADING_CONFIG.rounding),\r\n    statuses\r\n  }\r\n}\r\n\r\n/**\r\n * Compute final status from subject statuses (exact rule order)\r\n */\r\nexport function computeFinalStatus(statuses: string[]): 'Pass' | 'Fail' | 'Absent' {\r\n  const absentCount = statuses.filter(status => status === 'Absent').length\r\n  const failCount = statuses.filter(status => status === 'Fail').length\r\n  \r\n  // Rule 1: If absentCount >= 4 → finalStatus = \"Absent\"\r\n  if (absentCount >= 4) return 'Absent'\r\n  \r\n  // Rule 2: If absentCount == 2 OR absentCount == 3 → finalStatus = \"Fail\"\r\n  if (absentCount === 2 || absentCount === 3) return 'Fail'\r\n  \r\n  // Rule 3: If failCount >= 2 → finalStatus = \"Fail\"\r\n  if (failCount >= 2) return 'Fail'\r\n  \r\n  // Rule 4: If failCount == 1 AND absentCount == 1 → finalStatus = \"Fail\"\r\n  if (failCount === 1 && absentCount === 1) return 'Fail'\r\n  \r\n  // Rule 5: Else → finalStatus = \"Pass\"\r\n  return 'Pass'\r\n}\r\n\r\n/**\r\n * Map percentage to grade using grade bands\r\n */\r\nexport function mapPercentToGrade(percent: number): string {\r\n  const { gradeBands } = GRADING_CONFIG\r\n  \r\n  if (percent >= gradeBands.A_PLUS.min) return gradeBands.A_PLUS.label\r\n  if (percent >= gradeBands.A.min) return gradeBands.A.label\r\n  if (percent >= gradeBands.B.min) return gradeBands.B.label\r\n  if (percent >= gradeBands.C.min) return gradeBands.C.label\r\n  if (percent >= gradeBands.D.min) return gradeBands.D.label\r\n  return gradeBands.F.label\r\n}\r\n\r\n/**\r\n * Convert rank number to ordinal label\r\n */\r\nexport function getRankLabel(rank: number): string {\r\n  const suffixes = ['th', 'st', 'nd', 'rd']\r\n  const remainder = rank % 100\r\n  return rank + (suffixes[(remainder - 20) % 10] || suffixes[remainder] || suffixes[0])\r\n}\r\n\r\n/**\r\n * Calculate rankings for students\r\n */\r\nexport function calculateRankings(students: StudentGradeData[]): StudentGradeData[] {\r\n  // Sort by finalAggregate (higher first), then by name for ties\r\n  const sorted = [...students].sort((a, b) => {\r\n    if (b.finalAggregate !== a.finalAggregate) {\r\n      return b.finalAggregate - a.finalAggregate\r\n    }\r\n    return a.name.localeCompare(b.name)\r\n  })\r\n  \r\n  // Assign ranks (handle ties)\r\n  let currentRank = 1\r\n  let currentAggregate = sorted[0]?.finalAggregate\r\n  \r\n  return sorted.map((student, index) => {\r\n    if (student.finalAggregate !== currentAggregate) {\r\n      currentRank = index + 1\r\n      currentAggregate = student.finalAggregate\r\n    }\r\n    \r\n    return {\r\n      ...student,\r\n      rank: currentRank,\r\n      rankLabel: getRankLabel(currentRank)\r\n    }\r\n  })\r\n}\r\n\r\n/**\r\n * Calculate promotion status\r\n */\r\nexport function calculatePromotion(finalStatus: string, finalPercent: number): boolean {\r\n  return finalStatus === 'Pass' && finalPercent >= GRADING_CONFIG.promotionThresholdPercent\r\n}\r\n\r\n/**\r\n * Process complete student grade data\r\n */\r\nexport function processStudentGrades(\r\n  studentId: string,\r\n  name: string,\r\n  roll: string,\r\n  classLevel: string,\r\n  termsData: Array<{\r\n    termNumber: number\r\n    subjects: Array<{\r\n      subjectId: string\r\n      subjectName: string\r\n      maxMarks: number\r\n      passMark: number\r\n      obtained: number | string\r\n    }>\r\n  }>\r\n): StudentGradeData {\r\n  // Process each term\r\n  const terms: TermResult[] = termsData.map(termData => {\r\n    const subjects: SubjectResult[] = termData.subjects.map(subject => {\r\n      const { numericMark, status } = computeSubjectStatus(\r\n        subject.obtained,\r\n        subject.passMark\r\n      )\r\n      \r\n      return {\r\n        subjectId: subject.subjectId,\r\n        subjectName: subject.subjectName,\r\n        maxMarks: subject.maxMarks,\r\n        passMark: subject.passMark,\r\n        obtained: subject.obtained,\r\n        numericMark,\r\n        status\r\n      }\r\n    })\r\n    \r\n    const termSummary = computeTermSummary(subjects)\r\n    \r\n    return {\r\n      termNumber: termData.termNumber,\r\n      subjects,\r\n      ...termSummary\r\n    }\r\n  })\r\n  \r\n  // Calculate aggregates\r\n  const T1 = terms[0]?.termTotal || 0\r\n  const T2 = terms[1]?.termTotal || 0\r\n  const T3 = terms[2]?.termTotal || 0\r\n  \r\n  const combinedT2 = (T1 + T2) / 2\r\n  const finalAggregate = (T1 + T2 + T3) / 3\r\n  \r\n  // Calculate final percentage (using consistent denominator)\r\n  const termMaxTotal = terms[0]?.termMaxTotal || 1\r\n  const finalPercent = (finalAggregate / termMaxTotal) * 100\r\n  \r\n  // Get final grade\r\n  const finalGrade = mapPercentToGrade(finalPercent)\r\n  \r\n  // Get final status (using latest term statuses or aggregated)\r\n  const finalStatuses = terms[terms.length - 1]?.statuses || []\r\n  const finalStatus = computeFinalStatus(finalStatuses)\r\n  \r\n  // Calculate promotion\r\n  const promoted = calculatePromotion(finalStatus, finalPercent)\r\n  \r\n  return {\r\n    studentId,\r\n    name,\r\n    roll,\r\n    class: classLevel,\r\n    terms,\r\n    combinedT2: Math.round(combinedT2 * 100) / 100,\r\n    finalAggregate: Math.round(finalAggregate * 100) / 100,\r\n    finalPercent: Math.round(finalPercent * 100) / 100,\r\n    finalGrade,\r\n    finalStatus,\r\n    promoted,\r\n    rank: 0, // Will be set by calculateRankings\r\n    rankLabel: '' // Will be set by calculateRankings\r\n  }\r\n}\r\n\r\n/**\r\n * Calculate class summary statistics\r\n */\r\nexport function calculateClassSummary(students: StudentGradeData[]): ClassSummary {\r\n  const totalStudents = students.length\r\n  const absentStudents = students.filter(s => s.finalStatus === 'Absent').length\r\n  const presentStudents = totalStudents - absentStudents\r\n  const passCount = students.filter(s => s.finalStatus === 'Pass').length\r\n  const failCount = presentStudents - passCount\r\n  const passPercentage = presentStudents > 0 ? (passCount / presentStudents) * 100 : 0\r\n  \r\n  // Calculate year pass percentage (average of term pass percentages)\r\n  // This would need term-wise data, simplified for now\r\n  const yearPassPercent = passPercentage\r\n  \r\n  return {\r\n    totalStudents,\r\n    absentStudents,\r\n    presentStudents,\r\n    passCount,\r\n    failCount,\r\n    passPercentage: Math.round(passPercentage * 100) / 100,\r\n    yearPassPercent: Math.round(yearPassPercent * 100) / 100\r\n  }\r\n}\r\n\r\n/**\r\n * Generate report card data for a student\r\n */\r\nexport function generateReportCard(student: StudentGradeData) {\r\n  return {\r\n    studentId: student.studentId,\r\n    name: student.name,\r\n    roll: student.roll,\r\n    class: student.class,\r\n    terms: student.terms.map(term => ({\r\n      termNumber: term.termNumber,\r\n      termTotal: term.termTotal,\r\n      termMaxTotal: term.termMaxTotal,\r\n      termPercent: term.termPercent,\r\n      subjectResults: term.subjects.map(subject => ({\r\n        subjectId: subject.subjectId,\r\n        subjectName: subject.subjectName,\r\n        numericMark: subject.numericMark,\r\n        status: subject.status\r\n      }))\r\n    })),\r\n    combinedT2: student.combinedT2,\r\n    finalAggregate: student.finalAggregate,\r\n    finalPercent: student.finalPercent,\r\n    finalGrade: student.finalGrade,\r\n    finalStatus: student.finalStatus,\r\n    promoted: student.promoted,\r\n    rank: student.rank,\r\n    rankLabel: student.rankLabel\r\n  }\r\n}\r\n\r\n/**\r\n * Validate grade data\r\n */\r\nexport function validateGradeData(data: any): boolean {\r\n  try {\r\n    // Basic validation\r\n    if (!data.studentId || !data.name || !data.roll || !data.class) {\r\n      return false\r\n    }\r\n    \r\n    if (!Array.isArray(data.terms) || data.terms.length === 0) {\r\n      return false\r\n    }\r\n    \r\n    // Validate each term\r\n    for (const term of data.terms) {\r\n      if (!Array.isArray(term.subjects) || term.subjects.length === 0) {\r\n        return false\r\n      }\r\n      \r\n      // Validate each subject\r\n      for (const subject of term.subjects) {\r\n        if (!subject.subjectId || !subject.subjectName || \r\n            typeof subject.maxMarks !== 'number' || \r\n            typeof subject.passMark !== 'number') {\r\n          return false\r\n        }\r\n      }\r\n    }\r\n    \r\n    return true\r\n  } catch (error) {\r\n    console.error('Grade data validation error:', error)\r\n    return false\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\lib\\navigation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\lib\\reportHelpers.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\lib\\supabase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\middleware.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'request' is defined but never used. Allowed unused args must match /^_/u.","line":4,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":48}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from 'next/server'\nimport type { NextRequest } from 'next/server'\n\nexport function middleware(request: NextRequest) {\n  // For professional CRM session management, we let the client handle everything\n  // This ensures smooth refresh without redirects\n  // The AuthContext and AuthGate components handle authentication properly\n  \n  return NextResponse.next()\n}\n\nexport const config = {\n  matcher: [\n    '/((?!api|_next/static|_next/image|favicon.ico).*)',\n  ],\n}\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\next-env.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\services\\announcementService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\services\\attendanceSalaryService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":76,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":76,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1817,1820],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1817,1820],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":210,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":210,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5551,5554],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5551,5554],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":222,"column":92,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":222,"endColumn":95,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5913,5916],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5913,5916],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":224,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":224,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5968,5971],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5968,5971],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":228,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":228,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6118,6121],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6118,6121],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":244,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":244,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6656,6659],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6656,6659],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":265,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":265,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7275,7278],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7275,7278],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":281,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":281,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7829,7832],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7829,7832],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":305,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":305,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8519,8522],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8519,8522],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":338,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":338,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9588,9591],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9588,9591],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from '@/lib/api'\n\n// Types\nexport interface SchoolTiming {\n  id: string\n  timing_name: string\n  arrival_time: string\n  departure_time: string\n  grace_period_minutes: number\n  is_active: boolean\n  created_at: string\n  updated_at: string\n}\n\nexport interface AttendanceRule {\n  id: string\n  rule_name: string\n  rule_type: 'late_coming' | 'half_day' | 'absent' | 'early_departure'\n  condition_description: string\n  deduction_type: 'percentage' | 'fixed_amount' | 'full_day' | 'half_day'\n  deduction_value: number\n  grace_minutes: number\n  max_late_count: number\n  is_active: boolean\n  created_at: string\n  updated_at: string\n}\n\nexport interface BiometricAttendance {\n  id: string\n  teacher_id: string\n  attendance_date: string\n  check_in_time?: string\n  check_out_time?: string\n  total_hours: number\n  status: 'present' | 'absent' | 'half_day' | 'late' | 'early_departure'\n  late_minutes: number\n  early_departure_minutes: number\n  deduction_amount: number\n  deduction_reason?: string\n  is_manual_override: boolean\n  override_reason?: string\n  uploaded_file_id?: string\n  created_at: string\n  updated_at: string\n}\n\nexport interface CSVUploadHistory {\n  id: string\n  file_name: string\n  file_size: number\n  upload_date: string\n  records_processed: number\n  records_successful: number\n  records_failed: number\n  upload_status: 'processing' | 'completed' | 'failed' | 'partial'\n  error_log?: string\n  uploaded_by?: string\n  created_at: string\n}\n\nexport interface MonthlySalaryCalculation {\n  id: string\n  teacher_id: string\n  calculation_month: number\n  calculation_year: number\n  basic_salary: number\n  per_day_salary: number\n  total_working_days: number\n  present_days: number\n  absent_days: number\n  half_days: number\n  late_days: number\n  total_deductions: number\n  net_salary: number\n  calculation_details?: any\n  is_approved: boolean\n  approved_by?: string\n  approved_at?: string\n  created_at: string\n  updated_at: string\n}\n\nexport interface TeacherSalaryConfig {\n  id: string\n  teacher_id: string\n  basic_monthly_salary: number\n  per_day_salary: number\n  effective_from: string\n  effective_to?: string\n  is_active: boolean\n  created_at: string\n  updated_at: string\n}\n\nexport interface AttendanceSummary {\n  teacher_id: string\n  teacher_name: string\n  total_days: number\n  present_days: number\n  absent_days: number\n  half_days: number\n  late_days: number\n  attendance_percentage: number\n  total_deductions: number\n}\n\nexport const attendanceSalaryService = {\n  // School Timings\n  async getSchoolTimings(): Promise<SchoolTiming[]> {\n    const response = await api.get<SchoolTiming[]>('/attendance-salary/timings')\n    return response.data\n  },\n\n  async createSchoolTiming(data: {\n    timing_name: string\n    arrival_time: string\n    departure_time: string\n    grace_period_minutes: number\n    is_active?: boolean\n  }): Promise<SchoolTiming> {\n    const response = await api.post<SchoolTiming>('/attendance-salary/timings', data)\n    return response.data\n  },\n\n  async updateSchoolTiming(id: string, data: {\n    timing_name?: string\n    arrival_time?: string\n    departure_time?: string\n    grace_period_minutes?: number\n    is_active?: boolean\n  }): Promise<SchoolTiming> {\n    const response = await api.put<SchoolTiming>(`/attendance-salary/timings/${id}`, data)\n    return response.data\n  },\n\n  // Attendance Rules\n  async getAttendanceRules(): Promise<AttendanceRule[]> {\n    const response = await api.get<AttendanceRule[]>('/attendance-salary/rules')\n    return response.data\n  },\n\n  async createAttendanceRule(data: {\n    rule_name: string\n    rule_type: string\n    condition_description: string\n    deduction_type: string\n    deduction_value: number\n    grace_minutes?: number\n    max_late_count?: number\n    is_active?: boolean\n  }): Promise<AttendanceRule> {\n    const response = await api.post<AttendanceRule>('/attendance-salary/rules', data)\n    return response.data\n  },\n\n  async updateAttendanceRule(id: string, data: {\n    rule_name?: string\n    condition_description?: string\n    deduction_type?: string\n    deduction_value?: number\n    grace_minutes?: number\n    max_late_count?: number\n    is_active?: boolean\n  }): Promise<AttendanceRule> {\n    const response = await api.put<AttendanceRule>(`/attendance-salary/rules/${id}`, data)\n    return response.data\n  },\n\n  // CSV Upload\n  async uploadBiometricCSV(file: File): Promise<CSVUploadHistory> {\n    const formData = new FormData()\n    formData.append('file', file)\n    \n    const response = await api.post<CSVUploadHistory>('/attendance-salary/upload-csv', formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data',\n      },\n    })\n    return response.data\n  },\n\n  // Biometric Attendance\n  async getBiometricAttendance(params?: {\n    teacher_id?: string\n    date_from?: string\n    date_to?: string\n  }): Promise<BiometricAttendance[]> {\n    const response = await api.get<BiometricAttendance[]>('/attendance-salary/biometric', { params })\n    return response.data\n  },\n\n  async getAttendanceSummary(params?: {\n    month?: number\n    year?: number\n  }): Promise<AttendanceSummary[]> {\n    const response = await api.get<AttendanceSummary[]>('/attendance-salary/summary', { params })\n    return response.data\n  },\n\n  // Salary Calculations\n  async calculateMonthlySalary(data: {\n    month: number\n    year: number\n    teacher_ids?: string[]\n  }): Promise<MonthlySalaryCalculation[]> {\n    try {\n      const response = await api.post<MonthlySalaryCalculation[]>('/attendance-salary/calculate-salary', data)\n      return response.data\n    } catch (error: any) {\n      if (error.response) {\n        const data = error.response.data\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\n        if (detail) {\n          error.message = detail\n        }\n      }\n      throw error\n    }\n  },\n\n  async previewSalaryCalculation(teacher_id: string, month: number, year: number): Promise<any> {\n    try {\n      const response = await api.post<any>('/attendance-salary/preview-salary', null, {\n        params: { teacher_id, month, year }\n      })\n      return response.data\n    } catch (error: any) {\n      if (error.response) {\n        const data = error.response.data\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\n        if (detail) {\n          error.message = detail\n        }\n      }\n      throw error\n    }\n  },\n\n  async recalculateSalary(calculation_id: string): Promise<MonthlySalaryCalculation> {\n    try {\n      const response = await api.post<MonthlySalaryCalculation>(`/attendance-salary/recalculate-salary/${calculation_id}`)\n      return response.data\n    } catch (error: any) {\n      if (error.response) {\n        const data = error.response.data\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\n        if (detail) {\n          error.message = detail\n        }\n      }\n      throw error\n    }\n  },\n\n  async getSalaryCalculations(params?: {\n    month?: number\n    year?: number\n    teacher_id?: string\n    is_approved?: boolean\n  }): Promise<MonthlySalaryCalculation[]> {\n    try {\n      const response = await api.get<MonthlySalaryCalculation[]>('/attendance-salary/salary-calculations', { params })\n      return response.data\n    } catch (error: any) {\n      if (error.response) {\n        const data = error.response.data\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\n        if (detail) {\n          error.message = detail\n        }\n      }\n      throw error\n    }\n  },\n\n  async approveSalaryCalculation(calculation_id: string): Promise<MonthlySalaryCalculation> {\n    try {\n      const response = await api.post<MonthlySalaryCalculation>(`/attendance-salary/salary-calculations/${calculation_id}/approve`)\n      return response.data\n    } catch (error: any) {\n      if (error.response) {\n        const data = error.response.data\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\n        if (detail) {\n          error.message = detail\n        }\n      }\n      throw error\n    }\n  },\n\n  async bulkApproveSalaryCalculations(calculation_ids: string[]): Promise<{\n    approved_count: number\n    total_count: number\n    errors?: string[]\n  }> {\n    try {\n      const response = await api.post<{\n        approved_count: number\n        total_count: number\n        errors?: string[]\n      }>('/attendance-salary/salary-calculations/bulk-approve', calculation_ids)\n      return response.data\n    } catch (error: any) {\n      if (error.response) {\n        const data = error.response.data\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\n        if (detail) {\n          error.message = detail\n        }\n      }\n      throw error\n    }\n  },\n\n  // Teacher Salary Configuration\n  async getTeacherSalaryConfig(teacher_id?: string): Promise<TeacherSalaryConfig[]> {\n    const response = await api.get<TeacherSalaryConfig[]>('/attendance-salary/teacher-salary-config', {\n      params: { teacher_id }\n    })\n    return response.data\n  },\n\n  async createTeacherSalaryConfig(data: {\n    teacher_id: string\n    basic_monthly_salary: number\n    per_day_salary: number\n    effective_from: string\n    effective_to?: string\n    is_active?: boolean\n  }, adjustment_reason?: string): Promise<TeacherSalaryConfig> {\n    try {\n      const response = await api.post<TeacherSalaryConfig>('/attendance-salary/teacher-salary-config', data, {\n        params: adjustment_reason ? { adjustment_reason } : {}\n      })\n      return response.data\n    } catch (error: any) {\n      if (error.response) {\n        const data = error.response.data\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\n        if (detail) {\n          error.message = detail\n        }\n      }\n      throw error\n    }\n  },\n\n  async updateTeacherSalaryConfig(id: string, data: {\n    basic_monthly_salary?: number\n    per_day_salary?: number\n    effective_to?: string\n    is_active?: boolean\n  }): Promise<TeacherSalaryConfig> {\n    const response = await api.put<TeacherSalaryConfig>(`/attendance-salary/teacher-salary-config/${id}`, data)\n    return response.data\n  },\n\n  // Upload History\n  async getUploadHistory(): Promise<CSVUploadHistory[]> {\n    const response = await api.get<CSVUploadHistory[]>('/attendance-salary/upload-history')\n    return response.data\n  }\n}\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\services\\attendanceService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":40,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1162,1165],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1162,1165],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":72,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":72,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2183,2186],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2183,2186],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":91,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":91,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2711,2714],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2711,2714],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":106,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":106,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3110,3113],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3110,3113],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":135,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":135,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3848,3851],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3848,3851],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":168,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":168,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4684,4687],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4684,4687],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from '@/lib/api'\nimport { Attendance, AttendanceStatus } from '@/types'\n\nexport const attendanceService = {\n  async getAttendance(params?: {\n    user_id?: string\n    date_from?: string\n    date_to?: string\n    status?: AttendanceStatus\n    limit?: number\n    offset?: number\n  }): Promise<Attendance[]> {\n    const response = await api.get<Attendance[]>('/attendance', { params })\n    return response.data\n  },\n\n  async getAttendanceRecord(id: string): Promise<Attendance> {\n    const response = await api.get<Attendance>(`/attendance/${id}`)\n    return response.data\n  },\n\n  async markAttendance(data: {\n    user_id: string\n    date: string\n    status: AttendanceStatus\n    remarks?: string\n  }): Promise<Attendance> {\n    try {\n      // Validate date is not in the future\n      const attendanceDate = new Date(data.date)\n      const today = new Date()\n      today.setHours(23, 59, 59, 999) // End of today\n      \n      if (attendanceDate > today) {\n        throw new Error('Attendance date cannot be in the future')\n      }\n      \n      const response = await api.post<Attendance>('/attendance', data)\n      return response.data\n    } catch (error: any) {\n      if (error.response) {\n        const data = error.response.data\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\n        if (detail) {\n          error.message = detail\n        }\n      }\n      throw error\n    }\n  },\n\n  async markBulkAttendance(attendances: Array<{\n    user_id: string\n    date: string\n    status: AttendanceStatus\n    remarks?: string\n  }>): Promise<{ message: string; records: Attendance[]; success_count: number; total_count: number; errors?: string[] }> {\n    try {\n      // Validate all dates are not in the future\n      const today = new Date()\n      today.setHours(23, 59, 59, 999)\n      \n      for (const att of attendances) {\n        const attendanceDate = new Date(att.date)\n        if (attendanceDate > today) {\n          throw new Error(`Attendance date ${att.date} cannot be in the future`)\n        }\n      }\n      \n      const response = await api.post('/attendance/bulk', { attendances })\n      return response.data\n    } catch (error: any) {\n      if (error.response) {\n        const data = error.response.data\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\n        if (detail) {\n          error.message = detail\n        }\n      }\n      throw error\n    }\n  },\n\n  async updateAttendance(id: string, data: {\n    status?: AttendanceStatus\n    remarks?: string\n  }): Promise<Attendance> {\n    try {\n      const response = await api.put<Attendance>(`/attendance/${id}`, data)\n      return response.data\n    } catch (error: any) {\n      if (error.response) {\n        const data = error.response.data\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\n        if (detail) {\n          error.message = detail\n        }\n      }\n      throw error\n    }\n  },\n\n  async deleteAttendance(id: string): Promise<void> {\n    try {\n      await api.delete(`/attendance/${id}`)\n    } catch (error: any) {\n      if (error.response) {\n        const data = error.response.data\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\n        if (detail) {\n          error.message = detail\n        }\n      }\n      throw error\n    }\n  },\n  \n  async getAttendanceStatistics(user_id: string, params?: {\n    date_from?: string\n    date_to?: string\n  }): Promise<{\n    user_id: string\n    date_from?: string\n    date_to?: string\n    total_records: number\n    present: number\n    absent: number\n    late: number\n    excused: number\n    attendance_percentage: number\n  }> {\n    try {\n      const response = await api.get(`/attendance/stats/${user_id}`, { params })\n      return response.data\n    } catch (error: any) {\n      if (error.response) {\n        const data = error.response.data\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\n        if (detail) {\n          error.message = detail\n        }\n      }\n      throw error\n    }\n  },\n  \n  async getClassAttendanceStatistics(class_id: string, params?: {\n    date_from?: string\n    date_to?: string\n  }): Promise<{\n    class_id: string\n    total_students: number\n    date_from?: string\n    date_to?: string\n    statistics: Array<{\n      user_id: string\n      present: number\n      absent: number\n      late: number\n      excused: number\n      total: number\n      attendance_percentage: number\n    }>\n  }> {\n    try {\n      const response = await api.get(`/attendance/stats/class/${class_id}`, { params })\n      return response.data\n    } catch (error: any) {\n      if (error.response) {\n        const data = error.response.data\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\n        if (detail) {\n          error.message = detail\n        }\n      }\n      throw error\n    }\n  },\n}\n\n\n\n\n\n\n\n\n\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\services\\authService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":26,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[797,800],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[797,800],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from '@/lib/api'\nimport { LoginResponse, User } from '@/types'\n\nexport const authService = {\n  async login(email: string, password: string): Promise<LoginResponse> {\n    try {\n      const response = await api.post<LoginResponse>('/auth/login', {\n        email,\n        password,\n      })\n      \n      // Validate response structure\n      if (!response.data || typeof response.data !== 'object') {\n        throw new Error('Invalid response from server')\n      }\n      \n      if (!response.data.access_token) {\n        throw new Error('No access token received from server')\n      }\n      \n      if (!response.data.user || typeof response.data.user !== 'object') {\n        throw new Error('No user data received from server')\n      }\n      \n      return response.data\n    } catch (error: any) {\n      // Enhance error message for better debugging\n      if (error.response) {\n        const data = error.response.data\n        // Handle both old format (detail) and new format (message/error)\n        const detail = data?.detail || data?.message || (data?.error ? data.message : null)\n        if (detail) {\n          error.message = detail\n        } else if (data?.error && typeof data === 'object') {\n          // Our custom error format\n          error.message = data.message || 'An error occurred'\n        }\n      }\n      throw error\n    }\n  },\n\n  async logout(): Promise<void> {\n    await api.post('/auth/logout')\n  },\n\n  async getCurrentUser(): Promise<User> {\n    const response = await api.get<User>('/auth/me')\n    return response.data\n  },\n\n  async changePassword(oldPassword: string, newPassword: string): Promise<void> {\n    await api.post('/auth/change-password', {\n      old_password: oldPassword,\n      new_password: newPassword,\n    })\n  },\n}\n\n\n\n\n\n\n\n\n\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\services\\classService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":35,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[913,916],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[913,916],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from '@/lib/api'\nimport { Class, Student } from '@/types'\n\nexport const classService = {\n  async getClasses(params?: {\n    academic_year?: string\n    teacher_id?: string\n    limit?: number\n    offset?: number\n  }): Promise<Class[]> {\n    const response = await api.get<Class[]>('/classes', { params })\n    return response.data\n  },\n\n  async getClass(id: string): Promise<Class> {\n    const response = await api.get<Class>(`/classes/${id}`)\n    return response.data\n  },\n\n  async getClassStudents(id: string): Promise<Student[]> {\n    const response = await api.get<Student[]>(`/classes/${id}/students`)\n    return response.data\n  },\n\n  async createClass(data: {\n    name: string\n    section: string\n    teacher_id?: string\n    academic_year: string\n  }): Promise<Class> {\n    const response = await api.post<Class>('/classes', data)\n    return response.data\n  },\n\n  async updateClass(id: string, data: any): Promise<Class> {\n    const response = await api.put<Class>(`/classes/${id}`, data)\n    return response.data\n  },\n\n  async assignTeacher(classId: string, teacherId: string): Promise<void> {\n    await api.post(`/classes/${classId}/assign-teacher`, {\n      teacher_id: teacherId,\n    })\n  },\n\n  async addStudents(classId: string, studentIds: string[]): Promise<void> {\n    await api.post(`/classes/${classId}/add-students`, {\n      student_ids: studentIds,\n    })\n  },\n\n  async removeStudent(classId: string, studentId: string): Promise<void> {\n    await api.post(`/classes/${classId}/remove-student`, {\n      student_id: studentId,\n    })\n  },\n\n  async deleteClass(id: string): Promise<void> {\n    await api.delete(`/classes/${id}`)\n  },\n}\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\services\\eventService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\services\\examService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":47,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":47,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1073,1076],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1073,1076],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":63,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":63,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1521,1524],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1521,1524],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":79,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":79,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1979,1982],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1979,1982],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":95,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2454,2457],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2454,2457],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":110,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":110,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2857,2860],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2857,2860],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":122,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":122,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3189,3192],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3189,3192],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":126,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":126,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3345,3348],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3345,3348],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from '@/lib/api'\r\nimport { Exam, ExamType, ExamStatus } from '@/types'\r\n\r\nexport interface ExamCreate {\r\n  exam_name: string\r\n  exam_type: ExamType\r\n  term: string\r\n  academic_year: string\r\n  class_id: string\r\n  subject: string\r\n  total_marks: number\r\n  passing_marks: number\r\n  exam_date?: string\r\n  duration_minutes?: number\r\n  instructions?: string\r\n}\r\n\r\nexport interface ExamUpdate {\r\n  exam_name?: string\r\n  exam_type?: ExamType\r\n  term?: string\r\n  academic_year?: string\r\n  class_id?: string\r\n  subject?: string\r\n  total_marks?: number\r\n  passing_marks?: number\r\n  exam_date?: string\r\n  duration_minutes?: number\r\n  instructions?: string\r\n  status?: ExamStatus\r\n}\r\n\r\nexport const examService = {\r\n  async getExams(params?: {\r\n    class_id?: string\r\n    subject?: string\r\n    term?: string\r\n    academic_year?: string\r\n    exam_type?: string\r\n    status?: string\r\n    limit?: number\r\n    offset?: number\r\n  }): Promise<Exam[]> {\r\n    try {\r\n      const response = await api.get<Exam[]>('/exams', { params })\r\n      return response.data\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n\r\n  async getExam(id: string): Promise<Exam> {\r\n    try {\r\n      const response = await api.get<Exam>(`/exams/${id}`)\r\n      return response.data\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n\r\n  async createExam(data: ExamCreate): Promise<Exam> {\r\n    try {\r\n      const response = await api.post<Exam>('/exams', data)\r\n      return response.data\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n\r\n  async updateExam(id: string, data: ExamUpdate): Promise<Exam> {\r\n    try {\r\n      const response = await api.put<Exam>(`/exams/${id}`, data)\r\n      return response.data\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n\r\n  async deleteExam(id: string): Promise<void> {\r\n    try {\r\n      await api.delete(`/exams/${id}`)\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n\r\n  async getPendingApprovals(): Promise<{ papers: any[]; count: number }> {\r\n    try {\r\n      const response = await api.get('/exams/pending-approval/list')\r\n      return response.data\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\services\\financeService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":173,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":173,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4537,4540],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4537,4540],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":184,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":184,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4905,4908],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4905,4908],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from '@/lib/api'\nimport {\n  StationeryItem,\n  StationeryDistribution,\n  SalaryRecord,\n  Expense,\n  Donation,\n} from '@/types'\n\nexport const financeService = {\n  // Stationery Items\n  async getStationeryItems(params?: {\n    category?: string\n    low_stock?: boolean\n  }): Promise<StationeryItem[]> {\n    const response = await api.get<StationeryItem[]>(\n      '/finance/stationery/items',\n      { params }\n    )\n    return response.data\n  },\n\n  async getStationeryItem(id: string): Promise<StationeryItem> {\n    const response = await api.get<StationeryItem>(\n      `/finance/stationery/items/${id}`\n    )\n    return response.data\n  },\n\n  async createStationeryItem(data: Omit<StationeryItem, 'id' | 'created_at'>): Promise<StationeryItem> {\n    const response = await api.post<StationeryItem>(\n      '/finance/stationery/items',\n      data\n    )\n    return response.data\n  },\n\n  async updateStationeryItem(id: string, data: Partial<StationeryItem>): Promise<StationeryItem> {\n    const response = await api.put<StationeryItem>(\n      `/finance/stationery/items/${id}`,\n      data\n    )\n    return response.data\n  },\n\n  async deleteStationeryItem(id: string): Promise<void> {\n    await api.delete(`/finance/stationery/items/${id}`)\n  },\n\n  // Stationery Distributions\n  async getDistributions(params?: {\n    student_id?: string\n    item_id?: string\n    date_from?: string\n    date_to?: string\n  }): Promise<StationeryDistribution[]> {\n    const response = await api.get<StationeryDistribution[]>(\n      '/finance/stationery/distributions',\n      { params }\n    )\n    return response.data\n  },\n\n  async distributeStationery(data: {\n    student_id: string\n    item_id: string\n    quantity: number\n    distributed_date: string\n  }): Promise<StationeryDistribution> {\n    const response = await api.post<StationeryDistribution>(\n      '/finance/stationery/distributions',\n      data\n    )\n    return response.data\n  },\n\n  // Salary Records\n  async getSalaryRecords(params?: {\n    teacher_id?: string\n    month?: number\n    year?: number\n  }): Promise<SalaryRecord[]> {\n    const response = await api.get<SalaryRecord[]>('/finance/salaries', {\n      params,\n    })\n    return response.data\n  },\n\n  async createSalaryRecord(data: {\n    teacher_id: string\n    month: number\n    year: number\n    basic_salary: number\n    deductions?: number\n    bonuses?: number\n  }): Promise<SalaryRecord> {\n    const response = await api.post<SalaryRecord>('/finance/salaries', data)\n    return response.data\n  },\n\n  async updateSalaryRecord(id: string, data: Partial<SalaryRecord>): Promise<SalaryRecord> {\n    const response = await api.put<SalaryRecord>(\n      `/finance/salaries/${id}`,\n      data\n    )\n    return response.data\n  },\n\n  // Expenses\n  async getExpenses(params?: {\n    category?: string\n    date_from?: string\n    date_to?: string\n  }): Promise<Expense[]> {\n    const response = await api.get<Expense[]>('/finance/expenses', { params })\n    return response.data\n  },\n\n  async createExpense(data: {\n    category: string\n    amount: number\n    description: string\n    date: string\n  }): Promise<Expense> {\n    const response = await api.post<Expense>('/finance/expenses', data)\n    return response.data\n  },\n\n  async updateExpense(id: string, data: Partial<Expense>): Promise<Expense> {\n    const response = await api.put<Expense>(`/finance/expenses/${id}`, data)\n    return response.data\n  },\n\n  async deleteExpense(id: string): Promise<void> {\n    await api.delete(`/finance/expenses/${id}`)\n  },\n\n  // Donations\n  async getDonations(params?: {\n    date_from?: string\n    date_to?: string\n  }): Promise<Donation[]> {\n    const response = await api.get<Donation[]>('/finance/donations', { params })\n    return response.data\n  },\n\n  async createDonation(data: {\n    donor_name: string\n    amount: number\n    date: string\n    purpose?: string\n    receipt_number: string\n  }): Promise<Donation> {\n    const response = await api.post<Donation>('/finance/donations', data)\n    return response.data\n  },\n\n  async updateDonation(id: string, data: Partial<Donation>): Promise<Donation> {\n    const response = await api.put<Donation>(`/finance/donations/${id}`, data)\n    return response.data\n  },\n\n  async deleteDonation(id: string): Promise<void> {\n    await api.delete(`/finance/donations/${id}`)\n  },\n\n  // Financial Reports\n  async getFinancialSummary(params: {\n    report_type?: 'daily' | 'weekly' | 'monthly' | '6-month' | 'yearly' | 'custom'\n    date_from?: string\n    date_to?: string\n    include_comparison?: boolean\n  }): Promise<any> {\n    const response = await api.get('/finance/reports/summary', { params })\n    return response.data\n  },\n\n  async generateFinancialReport(data: {\n    report_type: 'daily' | 'weekly' | 'monthly' | '6-month' | 'yearly' | 'custom'\n    date_from?: string\n    date_to?: string\n    format?: 'json' | 'pdf' | 'excel' | 'csv'\n    include_charts?: boolean\n  }): Promise<any> {\n    const response = await api.post('/finance/reports', data)\n    return response.data\n  },\n}\n\n\n\n\n\n\n\n\n\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\services\\gradeService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":28,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":28,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[804,807],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[804,807],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":48,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":48,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1401,1404],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1401,1404],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":86,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":86,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2478,2481],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2478,2481],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":130,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":130,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3907,3910],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3907,3910],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":154,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":154,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4650,4653],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4650,4653],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":169,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":169,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5040,5043],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5040,5043],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":217,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":217,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6292,6295],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6292,6295],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from '@/lib/api'\nimport { Grade } from '@/types'\n\nexport const gradeService = {\n  async getGrades(params?: {\n    student_id?: string\n    class_id?: string\n    subject?: string\n    term?: string\n    academic_year?: string\n    limit?: number\n    offset?: number\n  }): Promise<Grade[]> {\n    try {\n      // Normalize term: 'Final' -> 'Annual' for API\n      const apiParams = params ? {\n        ...params,\n        term: params.term === 'Final' ? 'Annual' : params.term\n      } : undefined\n      \n      const response = await api.get<Grade[]>('/grades', { params: apiParams })\n      \n      // Normalize term back to 'Final' for display if needed\n      return response.data.map(grade => ({\n        ...grade,\n        term: grade.term === 'Annual' ? 'Final' : grade.term\n      }))\n    } catch (error: any) {\n      if (error.response) {\n        const data = error.response.data\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\n        if (detail) {\n          error.message = detail\n        }\n      }\n      throw error\n    }\n  },\n\n  async getGrade(id: string): Promise<Grade> {\n    try {\n      const response = await api.get<Grade>(`/grades/${id}`)\n      // Normalize term back to 'Final' for display if needed\n      return {\n        ...response.data,\n        term: response.data.term === 'Annual' ? 'Final' : response.data.term\n      }\n    } catch (error: any) {\n      if (error.response) {\n        const data = error.response.data\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\n        if (detail) {\n          error.message = detail\n        }\n      }\n      throw error\n    }\n  },\n\n  async createGrade(data: {\n    student_id: string\n    class_id: string\n    subject: string\n    marks: number\n    grade?: string // Optional - backend will auto-calculate if not provided\n    term: string\n    academic_year: string\n    remarks?: string\n  }): Promise<Grade> {\n    try {\n      // Normalize term: 'Final' -> 'Annual' for API\n      const apiData = {\n        ...data,\n        term: data.term === 'Final' ? 'Annual' : data.term,\n        // Don't send grade - backend will auto-calculate\n        grade: undefined\n      }\n      \n      const response = await api.post<Grade>('/grades', apiData)\n      \n      // Normalize term back to 'Final' for display\n      return {\n        ...response.data,\n        term: response.data.term === 'Annual' ? 'Final' : response.data.term\n      }\n    } catch (error: any) {\n      // Enhance error message for better debugging\n      if (error.response) {\n        const data = error.response.data\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\n        if (detail) {\n          error.message = detail\n        }\n      }\n      throw error\n    }\n  },\n\n  async createBulkGrades(grades: Array<{\n    student_id: string\n    class_id: string\n    subject: string\n    marks: number\n    grade?: string // Optional - backend will auto-calculate if not provided\n    term: string\n    academic_year: string\n    remarks?: string\n  }>): Promise<{ message: string; grades: Grade[]; success_count: number; total_count: number; errors?: string[] }> {\n    try {\n      // Normalize terms: 'Final' -> 'Annual' for all grades\n      const normalizedGrades = grades.map(grade => ({\n        ...grade,\n        term: grade.term === 'Final' ? 'Annual' : grade.term,\n        // Don't send grade - backend will auto-calculate\n        grade: undefined\n      }))\n      \n      const response = await api.post('/grades/bulk', { grades: normalizedGrades })\n      \n      // Normalize terms back to 'Final' for display\n      const result = response.data\n      if (result.grades) {\n        result.grades = result.grades.map((grade: Grade) => ({\n          ...grade,\n          term: grade.term === 'Annual' ? 'Final' : grade.term\n        }))\n      }\n      \n      return result\n    } catch (error: any) {\n      if (error.response) {\n        const data = error.response.data\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\n        if (detail) {\n          error.message = detail\n        }\n      }\n      throw error\n    }\n  },\n\n  async updateGrade(id: string, data: {\n    marks?: number\n    grade?: string // Optional - backend will auto-recalculate if marks are updated\n    remarks?: string\n  }): Promise<Grade> {\n    try {\n      const response = await api.put<Grade>(`/grades/${id}`, data)\n      // Normalize term back to 'Final' for display if needed\n      return {\n        ...response.data,\n        term: response.data.term === 'Annual' ? 'Final' : response.data.term\n      }\n    } catch (error: any) {\n      if (error.response) {\n        const data = error.response.data\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\n        if (detail) {\n          error.message = detail\n        }\n      }\n      throw error\n    }\n  },\n\n  async deleteGrade(id: string): Promise<void> {\n    try {\n      await api.delete(`/grades/${id}`)\n    } catch (error: any) {\n      if (error.response) {\n        const data = error.response.data\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\n        if (detail) {\n          error.message = detail\n        }\n      }\n      throw error\n    }\n  },\n\n  async getPositions(params: {\n    class_id: string\n    term: string\n    academic_year: string\n    top_n?: number\n  }): Promise<{\n    class_id: string\n    class_name: string\n    term: string\n    academic_year: string\n    positions: Array<{\n      student_id: string\n      student_name: string\n      admission_number: string\n      position: number\n      average_marks: number\n      total_marks: number\n      total_subjects: number\n      passed_subjects: number\n    }>\n    class_average: number\n  }> {\n    try {\n      // Normalize term: 'Final' -> 'Annual' for API\n      const apiParams = {\n        ...params,\n        term: params.term === 'Final' ? 'Annual' : params.term\n      }\n      \n      const response = await api.get('/grades/positions', { params: apiParams })\n      \n      // Normalize term back to 'Final' for display if needed\n      return {\n        ...response.data,\n        term: response.data.term === 'Annual' ? 'Final' : response.data.term\n      }\n    } catch (error: any) {\n      if (error.response) {\n        const data = error.response.data\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\n        if (detail) {\n          error.message = detail\n        }\n      }\n      throw error\n    }\n  },\n}\n\n\n\n\n\n\n\n\n\n\n\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\services\\gradingSchemeService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":32,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[749,752],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[749,752],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":48,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":48,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1233,1236],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1233,1236],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":64,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1718,1721],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1718,1721],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":86,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":86,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2350,2353],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2350,2353],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":110,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":110,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2979,2982],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2979,2982],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":132,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":132,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3595,3598],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3595,3598],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":147,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":147,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4017,4020],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4017,4020],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from '@/lib/api'\r\n\r\nexport interface GradingCriterion {\r\n  id?: string\r\n  grade_name: string\r\n  min_marks: number\r\n  max_marks: number\r\n  gpa_value: number\r\n  is_passing: boolean\r\n  display_order: number\r\n}\r\n\r\nexport interface GradingScheme {\r\n  id: string\r\n  name: string\r\n  description?: string\r\n  is_active: boolean\r\n  is_default: boolean\r\n  criteria: GradingCriterion[]\r\n  created_at: string\r\n  updated_at?: string\r\n}\r\n\r\nexport const gradingSchemeService = {\r\n  async getGradingSchemes(params?: {\r\n    is_active?: boolean\r\n    include_default?: boolean\r\n  }): Promise<GradingScheme[]> {\r\n    try {\r\n      const response = await api.get<GradingScheme[]>('/grading-schemes', { params })\r\n      return response.data\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n\r\n  async getDefaultGradingScheme(): Promise<GradingScheme> {\r\n    try {\r\n      const response = await api.get<GradingScheme>('/grading-schemes/default')\r\n      return response.data\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n\r\n  async getGradingScheme(id: string): Promise<GradingScheme> {\r\n    try {\r\n      const response = await api.get<GradingScheme>(`/grading-schemes/${id}`)\r\n      return response.data\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n\r\n  async createGradingScheme(data: {\r\n    name: string\r\n    description?: string\r\n    is_active?: boolean\r\n    is_default?: boolean\r\n    criteria: Omit<GradingCriterion, 'id'>[]\r\n  }): Promise<GradingScheme> {\r\n    try {\r\n      const response = await api.post<GradingScheme>('/grading-schemes', data)\r\n      return response.data\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n\r\n  async updateGradingScheme(\r\n    id: string,\r\n    data: {\r\n      name?: string\r\n      description?: string\r\n      is_active?: boolean\r\n      is_default?: boolean\r\n    }\r\n  ): Promise<GradingScheme> {\r\n    try {\r\n      const response = await api.put<GradingScheme>(`/grading-schemes/${id}`, data)\r\n      return response.data\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n\r\n  async updateGradingSchemeCriteria(\r\n    id: string,\r\n    criteria: Omit<GradingCriterion, 'id'>[]\r\n  ): Promise<GradingScheme> {\r\n    try {\r\n      const response = await api.put<GradingScheme>(`/grading-schemes/${id}/criteria`, {\r\n        scheme_id: id,\r\n        criteria\r\n      })\r\n      return response.data\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n\r\n  async deleteGradingScheme(id: string): Promise<void> {\r\n    try {\r\n      await api.delete(`/grading-schemes/${id}`)\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\services\\invoiceService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":58,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":58,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1297,1300],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1297,1300],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":74,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":74,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1765,1768],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1765,1768],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":90,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":90,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2248,2251],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2248,2251],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":106,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":106,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2746,2749],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2746,2749],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":125,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":125,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3356,3359],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3356,3359],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from '@/lib/api'\r\n\r\nexport interface InvoiceItem {\r\n  description: string\r\n  quantity: number\r\n  unit_price: number\r\n  amount: number\r\n  category?: string\r\n}\r\n\r\nexport interface Invoice {\r\n  id: string\r\n  invoice_number: string\r\n  teacher_id: string\r\n  calculation_id: string\r\n  month: number\r\n  year: number\r\n  invoice_date: string\r\n  due_date?: string\r\n  status: 'draft' | 'sent' | 'paid' | 'overdue' | 'cancelled'\r\n  items: InvoiceItem[]\r\n  subtotal: number\r\n  deductions: number\r\n  bonuses: number\r\n  tax: number\r\n  net_amount: number\r\n  total_amount: number\r\n  notes?: string\r\n  created_at: string\r\n  updated_at: string\r\n}\r\n\r\nexport interface InvoiceCreate {\r\n  calculation_id: string\r\n  invoice_date?: string\r\n  due_date?: string\r\n  template?: 'simple' | 'detailed'\r\n  notes?: string\r\n}\r\n\r\nexport interface InvoiceUpdate {\r\n  status?: 'draft' | 'sent' | 'paid' | 'overdue' | 'cancelled'\r\n  due_date?: string\r\n  notes?: string\r\n}\r\n\r\nexport const invoiceService = {\r\n  async getInvoices(params?: {\r\n    teacher_id?: string\r\n    month?: number\r\n    year?: number\r\n    status?: string\r\n    calculation_id?: string\r\n  }): Promise<Invoice[]> {\r\n    try {\r\n      const response = await api.get<Invoice[]>('/finance/invoices', { params })\r\n      return response.data\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n\r\n  async getInvoice(id: string): Promise<Invoice> {\r\n    try {\r\n      const response = await api.get<Invoice>(`/finance/invoices/${id}`)\r\n      return response.data\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n\r\n  async generateInvoice(data: InvoiceCreate): Promise<Invoice> {\r\n    try {\r\n      const response = await api.post<Invoice>('/finance/invoices', data)\r\n      return response.data\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n\r\n  async updateInvoice(id: string, data: InvoiceUpdate): Promise<Invoice> {\r\n    try {\r\n      const response = await api.put<Invoice>(`/finance/invoices/${id}`, data)\r\n      return response.data\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n\r\n  async downloadInvoice(id: string, format: 'pdf' | 'html' = 'pdf'): Promise<Blob | string> {\r\n    try {\r\n      const response = await api.get(`/finance/invoices/${id}/download`, {\r\n        params: { format },\r\n        responseType: format === 'pdf' ? 'blob' : 'text'\r\n      })\r\n      return response.data\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\services\\notificationService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\services\\paperService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":86,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":86,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1920,1923],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1920,1923],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":124,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":124,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2989,2992],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2989,2992],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":129,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":129,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3136,3139],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3136,3139],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":134,"column":86,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":134,"endColumn":89,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3327,3330],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3327,3330],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from '@/lib/api';\n\nexport interface Paper {\n  id: string;\n  class_id: string;\n  class_name: string;\n  subject: string;\n  term: string;\n  year: number;\n  file_url: string;\n  file_name: string;\n  file_type: string;\n  file_size?: number;\n  description?: string;\n  uploaded_by: string;\n  uploaded_by_name?: string;\n  upload_date: string;\n  submitted_for_approval_at?: string;\n  created_at: string;\n  updated_at: string;\n}\n\nexport interface PaperCreate {\n  class_id: string;\n  class_name: string;\n  subject: string;\n  term: string;\n  year: number;\n  file_url: string;\n  file_name: string;\n  file_type: string;\n  file_size?: number;\n  description?: string;\n}\n\nexport interface PaperUpdate {\n  class_id?: string;\n  class_name?: string;\n  subject?: string;\n  term?: string;\n  year?: number;\n  file_url?: string;\n  file_name?: string;\n  file_type?: string;\n  file_size?: number;\n  description?: string;\n}\n\nexport interface PaperStats {\n  total_papers: number;\n  papers_by_term: Record<string, number>;\n  papers_by_class: Record<string, number>;\n  papers_by_subject: Record<string, number>;\n  papers_by_year: Record<string, number>;\n  recent_uploads: number;\n}\n\nexport const paperService = {\n  // Get all papers with optional filters\n  async getAll(params?: {\n    class_id?: string;\n    subject?: string;\n    term?: string;\n    year?: number;\n    uploaded_by?: string;\n    limit?: number;\n    offset?: number;\n  }): Promise<Paper[]> {\n    const response = await api.get('/papers', { params });\n    return response.data;\n  },\n\n  // Get a single paper by ID\n  async getById(id: string): Promise<Paper> {\n    const response = await api.get(`/papers/${id}`);\n    return response.data;\n  },\n\n  // Get paper statistics\n  async getStats(): Promise<PaperStats> {\n    const response = await api.get('/papers/stats');\n    return response.data;\n  },\n\n  // Get class paper summary\n  async getClassSummary(classId: string): Promise<any> {\n    const response = await api.get(`/papers/class/${classId}/summary`);\n    return response.data;\n  },\n\n  // Create a new paper\n  async create(data: PaperCreate): Promise<Paper> {\n    const response = await api.post('/papers', data);\n    return response.data;\n  },\n\n  // Update a paper\n  async update(id: string, data: PaperUpdate): Promise<Paper> {\n    const response = await api.put(`/papers/${id}`, data);\n    return response.data;\n  },\n\n  // Delete a paper\n  async delete(id: string): Promise<void> {\n    await api.delete(`/papers/${id}`);\n  },\n\n  // Upload file to Supabase storage (helper function)\n  async uploadFile(file: File, folder: string = 'papers'): Promise<string> {\n    const formData = new FormData();\n    formData.append('file', file);\n    formData.append('folder', folder);\n    \n    const response = await api.post('/upload', formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data',\n      },\n    });\n    \n    return response.data.url;\n  },\n\n  // Approval workflow methods\n  async submitForApproval(paperId: string): Promise<any> {\n    const response = await api.post(`/papers/${paperId}/submit`);\n    return response.data;\n  },\n\n  async approve(paperId: string): Promise<any> {\n    const response = await api.post(`/papers/${paperId}/approve`);\n    return response.data;\n  },\n\n  async reject(paperId: string, rejectionReason: string, comments?: string): Promise<any> {\n    const response = await api.post(`/papers/${paperId}/reject`, {\n      rejection_reason: rejectionReason,\n      comments: comments\n    });\n    return response.data;\n  },\n\n  async getPending(limit?: number, offset?: number): Promise<{ papers: Paper[]; count: number }> {\n    const response = await api.get('/papers/pending/list', {\n      params: { limit, offset }\n    });\n    return response.data;\n  },\n};\n\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\services\\reportService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\services\\resultService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":63,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":63,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1477,1480],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1477,1480],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":79,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":79,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1941,1944],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1941,1944],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":95,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2417,2420],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2417,2420],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":111,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":111,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2910,2913],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2910,2913],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":126,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":126,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3317,3320],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3317,3320],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":142,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":142,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3824,3827],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3824,3827],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":169,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":169,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4588,4591],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4588,4591],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":187,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":187,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5118,5121],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5118,5121],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from '@/lib/api'\r\nimport { ExamResult, ResultStatus } from '@/types'\r\n\r\nexport interface ResultCreate {\r\n  exam_id: string\r\n  student_id: string\r\n  marks_obtained: number\r\n  total_marks: number\r\n  grade?: string\r\n  status?: ResultStatus\r\n  remarks?: string\r\n}\r\n\r\nexport interface ResultUpdate {\r\n  marks_obtained?: number\r\n  total_marks?: number\r\n  grade?: string\r\n  status?: ResultStatus\r\n  remarks?: string\r\n}\r\n\r\nexport interface BulkResultEntry {\r\n  student_id?: string\r\n  admission_number?: string\r\n  student_name?: string\r\n  marks_obtained: number\r\n  status?: ResultStatus\r\n  remarks?: string\r\n}\r\n\r\nexport interface BulkUploadRequest {\r\n  exam_id: string\r\n  results: BulkResultEntry[]\r\n  overwrite_existing?: boolean\r\n}\r\n\r\nexport interface BulkUploadResponse {\r\n  success_count: number\r\n  error_count: number\r\n  errors: Array<{ row?: number; student_id?: string; error: string }>\r\n  message: string\r\n}\r\n\r\nexport interface ValidationResponse {\r\n  valid: boolean\r\n  errors: Array<{ row: number; error: string }>\r\n  warnings: Array<{ row: number; warning: string }>\r\n  valid_entries: number\r\n  invalid_entries: number\r\n}\r\n\r\nexport const resultService = {\r\n  async getResults(params?: {\r\n    exam_id?: string\r\n    class_id?: string\r\n    student_id?: string\r\n    limit?: number\r\n    offset?: number\r\n  }): Promise<ExamResult[]> {\r\n    try {\r\n      const response = await api.get<ExamResult[]>('/results', { params })\r\n      return response.data\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n\r\n  async getResult(id: string): Promise<ExamResult> {\r\n    try {\r\n      const response = await api.get<ExamResult>(`/results/${id}`)\r\n      return response.data\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n\r\n  async createResult(data: ResultCreate): Promise<ExamResult> {\r\n    try {\r\n      const response = await api.post<ExamResult>('/results', data)\r\n      return response.data\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n\r\n  async updateResult(id: string, data: ResultUpdate): Promise<ExamResult> {\r\n    try {\r\n      const response = await api.put<ExamResult>(`/results/${id}`, data)\r\n      return response.data\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n\r\n  async deleteResult(id: string): Promise<void> {\r\n    try {\r\n      await api.delete(`/results/${id}`)\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n\r\n  async bulkUpload(data: BulkUploadRequest): Promise<BulkUploadResponse> {\r\n    try {\r\n      const response = await api.post<BulkUploadResponse>('/results/bulk-upload', data)\r\n      return response.data\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n\r\n  async validateUpload(exam_id: string, file: File): Promise<ValidationResponse> {\r\n    try {\r\n      const formData = new FormData()\r\n      formData.append('file', file)\r\n      \r\n      const response = await api.post<ValidationResponse>(\r\n        `/results/validate-upload?exam_id=${exam_id}`,\r\n        formData,\r\n        {\r\n          headers: {\r\n            'Content-Type': 'multipart/form-data',\r\n          },\r\n        }\r\n      )\r\n      return response.data\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n\r\n  async downloadTemplate(exam_id: string): Promise<Blob> {\r\n    try {\r\n      const response = await api.get(`/results/export-template?exam_id=${exam_id}`, {\r\n        responseType: 'blob',\r\n      })\r\n      return response.data\r\n    } catch (error: any) {\r\n      if (error.response) {\r\n        const data = error.response.data\r\n        const detail = data?.message || data?.detail || (data?.error ? data.message : null)\r\n        if (detail) {\r\n          error.message = detail\r\n        }\r\n      }\r\n      throw error\r\n    }\r\n  },\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\services\\settingsService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":72,"column":71,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":72,"endColumn":74,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1935,1938],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1935,1938],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":155,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":155,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4431,4434],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4431,4434],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { api } from '@/lib/api'\r\n\r\n// Types\r\nexport interface SystemSetting {\r\n  id: string\r\n  setting_key: string\r\n  setting_value: string\r\n  setting_type: 'string' | 'number' | 'boolean' | 'json'\r\n  category: 'general' | 'academic' | 'financial' | 'security' | 'notification' | 'appearance'\r\n  description?: string\r\n  is_public: boolean\r\n  created_at: string\r\n  updated_at: string\r\n  updated_by?: string\r\n}\r\n\r\nexport interface RolePermission {\r\n  id: string\r\n  role: 'admin' | 'principal' | 'teacher' | 'student' | 'parent'\r\n  permission_key: string\r\n  permission_value: boolean\r\n  created_at: string\r\n  updated_at: string\r\n}\r\n\r\nexport interface FeeStructure {\r\n  id: string\r\n  class_level: string\r\n  fee_type: 'tuition' | 'admission' | 'exam' | 'library' | 'transport' | 'activity' | 'other'\r\n  amount: number\r\n  currency: string\r\n  academic_year: string\r\n  is_active: boolean\r\n  created_at: string\r\n  updated_at: string\r\n}\r\n\r\nexport interface AcademicYear {\r\n  id: string\r\n  year_name: string\r\n  start_date: string\r\n  end_date: string\r\n  is_current: boolean\r\n  created_at: string\r\n  updated_at: string\r\n}\r\n\r\nexport const settingsService = {\r\n  // System Settings\r\n  async getSystemSettings(params?: {\r\n    category?: string\r\n    public_only?: boolean\r\n  }): Promise<SystemSetting[]> {\r\n    const response = await api.get<SystemSetting[]>('/settings/system', { params })\r\n    return response.data\r\n  },\r\n\r\n  async getSystemSetting(key: string): Promise<SystemSetting> {\r\n    const response = await api.get<SystemSetting>(`/settings/system/${key}`)\r\n    return response.data\r\n  },\r\n\r\n  async updateSystemSetting(key: string, data: {\r\n    setting_value?: string\r\n    description?: string\r\n    is_public?: boolean\r\n  }): Promise<SystemSetting> {\r\n    const response = await api.put<SystemSetting>(`/settings/system/${key}`, data)\r\n    return response.data\r\n  },\r\n\r\n  async bulkUpdateSettings(settings: Record<string, string>): Promise<any> {\r\n    const response = await api.post('/settings/system/bulk', { settings })\r\n    return response.data\r\n  },\r\n\r\n  // Role Permissions\r\n  async getRolePermissions(role?: string): Promise<RolePermission[]> {\r\n    const response = await api.get<RolePermission[]>('/settings/permissions', {\r\n      params: { role }\r\n    })\r\n    return response.data\r\n  },\r\n\r\n  async updateRolePermission(role: string, permissionKey: string, value: boolean): Promise<RolePermission> {\r\n    const response = await api.put<RolePermission>(\r\n      `/settings/permissions/${role}/${permissionKey}`,\r\n      { permission_value: value }\r\n    )\r\n    return response.data\r\n  },\r\n\r\n  // Fee Structure\r\n  async getFeeStructure(params?: {\r\n    class_level?: string\r\n    academic_year?: string\r\n    active_only?: boolean\r\n  }): Promise<FeeStructure[]> {\r\n    const response = await api.get<FeeStructure[]>('/settings/fees', { params })\r\n    return response.data\r\n  },\r\n\r\n  async createFeeStructure(data: {\r\n    class_level: string\r\n    fee_type: string\r\n    amount: number\r\n    currency: string\r\n    academic_year: string\r\n    is_active?: boolean\r\n  }): Promise<FeeStructure> {\r\n    const response = await api.post<FeeStructure>('/settings/fees', data)\r\n    return response.data\r\n  },\r\n\r\n  async updateFeeStructure(id: string, data: {\r\n    amount?: number\r\n    is_active?: boolean\r\n  }): Promise<FeeStructure> {\r\n    const response = await api.put<FeeStructure>(`/settings/fees/${id}`, data)\r\n    return response.data\r\n  },\r\n\r\n  async deleteFeeStructure(id: string): Promise<void> {\r\n    await api.delete(`/settings/fees/${id}`)\r\n  },\r\n\r\n  // Academic Years\r\n  async getAcademicYears(currentOnly?: boolean): Promise<AcademicYear[]> {\r\n    const response = await api.get<AcademicYear[]>('/settings/academic-years', {\r\n      params: { current_only: currentOnly }\r\n    })\r\n    return response.data\r\n  },\r\n\r\n  async createAcademicYear(data: {\r\n    year_name: string\r\n    start_date: string\r\n    end_date: string\r\n    is_current?: boolean\r\n  }): Promise<AcademicYear> {\r\n    const response = await api.post<AcademicYear>('/settings/academic-years', data)\r\n    return response.data\r\n  },\r\n\r\n  async updateAcademicYear(id: string, data: {\r\n    start_date?: string\r\n    end_date?: string\r\n    is_current?: boolean\r\n  }): Promise<AcademicYear> {\r\n    const response = await api.put<AcademicYear>(`/settings/academic-years/${id}`, data)\r\n    return response.data\r\n  },\r\n\r\n  // Export All Settings\r\n  async exportAllSettings(): Promise<any> {\r\n    const response = await api.get('/settings/export')\r\n    return response.data\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\services\\studentService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":26,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[739,742],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[739,742],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":31,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[904,907],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[904,907],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from '@/lib/api'\r\nimport { Student, Grade, Attendance, StationeryDistribution } from '@/types'\r\n\r\nexport const studentService = {\r\n  async getStudents(params?: {\r\n    class_id?: string\r\n    search?: string\r\n    status?: string\r\n    limit?: number\r\n    offset?: number\r\n  }): Promise<Student[]> {\r\n    const response = await api.get<Student[]>('/students', { params })\r\n    return response.data\r\n  },\r\n\r\n  async getStudent(id: string): Promise<Student> {\r\n    const response = await api.get<Student>(`/students/${id}`)\r\n    return response.data\r\n  },\r\n\r\n  async getMyProfile(): Promise<Student> {\r\n    const response = await api.get<Student>('/students/me/profile')\r\n    return response.data\r\n  },\r\n\r\n  async createStudent(data: any): Promise<Student> {\r\n    const response = await api.post<Student>('/students', data)\r\n    return response.data\r\n  },\r\n\r\n  async updateStudent(id: string, data: any): Promise<Student> {\r\n    const response = await api.put<Student>(`/students/${id}`, data)\r\n    return response.data\r\n  },\r\n\r\n  async deleteStudent(id: string): Promise<void> {\r\n    await api.delete(`/students/${id}`)\r\n  },\r\n\r\n  // Student-specific data\r\n  async getMyGrades(params?: {\r\n    term?: string\r\n    academic_year?: string\r\n  }): Promise<Grade[]> {\r\n    const response = await api.get<Grade[]>('/grades/me', { params })\r\n    return response.data\r\n  },\r\n\r\n  async getMyAttendance(params?: {\r\n    date_from?: string\r\n    date_to?: string\r\n  }): Promise<Attendance[]> {\r\n    const response = await api.get<Attendance[]>('/attendance/me', { params })\r\n    return response.data\r\n  },\r\n\r\n  async getMyStationery(): Promise<StationeryDistribution[]> {\r\n    const response = await api.get<StationeryDistribution[]>(\r\n      '/finance/stationery/distributions/me'\r\n    )\r\n    return response.data\r\n  },\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\services\\syllabusService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\services\\teacherService.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Student' is defined but never used.","line":2,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":33},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":30,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":30,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[836,839],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[836,839],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":35,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1001,1004],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1001,1004],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import api from '@/lib/api'\r\nimport { Teacher, Class, Student } from '@/types'\r\n\r\nexport const teacherService = {\r\n  async getTeachers(params?: {\r\n    search?: string\r\n    status?: string\r\n    limit?: number\r\n    offset?: number\r\n  }): Promise<Teacher[]> {\r\n    const response = await api.get<Teacher[]>('/teachers', { params })\r\n    return response.data\r\n  },\r\n\r\n  async getTeacher(id: string): Promise<Teacher> {\r\n    const response = await api.get<Teacher>(`/teachers/${id}`)\r\n    return response.data\r\n  },\r\n\r\n  async getMyProfile(): Promise<Teacher> {\r\n    const response = await api.get<Teacher>('/teachers/me/profile')\r\n    return response.data\r\n  },\r\n\r\n  async getMyClasses(): Promise<Class[]> {\r\n    const response = await api.get<Class[]>('/teachers/me/classes')\r\n    return response.data\r\n  },\r\n\r\n  async createTeacher(data: any): Promise<Teacher> {\r\n    const response = await api.post<Teacher>('/teachers', data)\r\n    return response.data\r\n  },\r\n\r\n  async updateTeacher(id: string, data: any): Promise<Teacher> {\r\n    const response = await api.put<Teacher>(`/teachers/${id}`, data)\r\n    return response.data\r\n  },\r\n\r\n  async deleteTeacher(id: string): Promise<void> {\r\n    await api.delete(`/teachers/${id}`)\r\n  },\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\services\\timetableService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\store\\authStore.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\tailwind.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\working\\Mian Qamar\\New School System\\frontend\\types\\index.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":147,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":147,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2976,2979],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2976,2979],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// User types\nexport type UserRole = 'admin' | 'principal' | 'teacher' | 'student'\n\nexport interface User {\n  id: string\n  email: string\n  full_name: string\n  role: UserRole\n  phone?: string\n  address?: string\n  avatar_url?: string\n  created_at: string\n}\n\nexport interface GuardianInfo {\n  name: string\n  relation: string\n  phone: string\n  email?: string\n  address?: string\n}\n\nexport interface Student {\n  id: string\n  user_id: string\n  admission_number: string\n  admission_date: string\n  class_id?: string\n  guardian_info: GuardianInfo\n  status: string\n  created_at: string\n  user?: User\n}\n\nexport interface SalaryInfo {\n  basic_salary: number\n  allowances?: number\n  currency: string\n}\n\nexport interface Teacher {\n  id: string\n  user_id: string\n  employee_id: string\n  join_date: string\n  qualification: string\n  subjects: string[]\n  salary_info: SalaryInfo\n  status: string\n  created_at: string\n  user?: User\n}\n\nexport interface Class {\n  id: string\n  name: string\n  section: string\n  teacher_id?: string\n  academic_year: string\n  created_at: string\n}\n\nexport interface Grade {\n  id: string\n  student_id: string\n  class_id: string\n  subject: string\n  marks: number\n  grade: string\n  term: string\n  academic_year: string\n  remarks?: string\n  created_at: string\n  updated_at?: string\n}\n\nexport interface StudentPosition {\n  student_id: string\n  student_name: string\n  admission_number: string\n  position: number\n  average_marks: number\n  total_marks: number\n  total_subjects: number\n  passed_subjects: number\n}\n\nexport interface ClassPositions {\n  class_id: string\n  class_name: string\n  term: string\n  academic_year: string\n  positions: StudentPosition[]\n  class_average?: number\n}\n\n// Exam Management Types\nexport type ExamType = 'term_exam' | 'mid_term' | 'final' | 'quiz' | 'assignment' | 'annual' | 'custom'\nexport type ExamStatus = 'draft' | 'published' | 'completed' | 'archived'\nexport type ApprovalStatus = 'draft' | 'pending' | 'approved' | 'rejected'\nexport type ResultStatus = 'active' | 'absent' | 'absent_with_excuse' | 'incomplete'\n\nexport interface Exam {\n  id: string\n  exam_name: string\n  exam_type: ExamType\n  term: string\n  academic_year: string\n  class_id: string\n  subject: string\n  total_marks: number\n  passing_marks: number\n  exam_date?: string\n  duration_minutes?: number\n  instructions?: string\n  created_by: string\n  created_by_name?: string\n  status: ExamStatus\n  created_at: string\n  updated_at?: string\n}\n\nexport interface ExamResult {\n  id: string\n  exam_id: string\n  student_id: string\n  student_name?: string\n  admission_number?: string\n  marks_obtained: number\n  total_marks: number\n  grade?: string\n  percentage: number\n  status: ResultStatus\n  remarks?: string\n  uploaded_by: string\n  uploaded_by_name?: string\n  uploaded_at: string\n  created_at: string\n  updated_at?: string\n}\n\nexport interface ExamSettings {\n  id: string\n  school_name: string\n  terms_config: string[]\n  exam_types: string[]\n  default_grading_criteria?: Record<string, any>\n  bulk_upload_enabled: boolean\n  approval_required: boolean\n  auto_calculate_grade: boolean\n  created_by?: string\n  updated_by?: string\n  created_at: string\n  updated_at?: string\n}\n\nexport interface BulkResultEntry {\n  student_id?: string\n  admission_number?: string\n  student_name?: string\n  marks_obtained: number\n  status?: ResultStatus\n  remarks?: string\n}\n\nexport interface GradingCriterion {\n  id?: string\n  grade_name: string\n  min_marks: number\n  max_marks: number\n  gpa_value: number\n  is_passing: boolean\n  display_order: number\n}\n\nexport interface GradingScheme {\n  id: string\n  name: string\n  description?: string\n  is_active: boolean\n  is_default: boolean\n  criteria: GradingCriterion[]\n  created_at: string\n  updated_at?: string\n}\n\nexport type AttendanceStatus = 'present' | 'absent' | 'late' | 'excused'\n\nexport interface Attendance {\n  id: string\n  user_id: string\n  date: string\n  status: AttendanceStatus\n  marked_by: string\n  remarks?: string\n  created_at: string\n}\n\nexport interface StationeryItem {\n  id: string\n  name: string\n  category: string\n  quantity: number\n  unit: string\n  reorder_level: number\n  created_at: string\n}\n\nexport interface StationeryDistribution {\n  id: string\n  student_id: string\n  item_id: string\n  quantity: number\n  distributed_date: string\n  distributed_by: string\n  created_at: string\n}\n\nexport interface SalaryRecord {\n  id: string\n  teacher_id: string\n  month: number\n  year: number\n  basic_salary: number\n  deductions: number\n  bonuses: number\n  net_salary: number\n  paid_date?: string\n  created_at: string\n}\n\nexport interface Expense {\n  id: string\n  category: string\n  amount: number\n  description: string\n  date: string\n  recorded_by: string\n  payment_method?: string\n  created_at: string\n}\n\nexport interface Donation {\n  id: string\n  donor_name: string\n  amount: number\n  date: string\n  purpose?: string\n  receipt_number: string\n  payment_method?: string\n  created_at: string\n}\n\nexport interface Notification {\n  id: string\n  user_id: string\n  title: string\n  body: string\n  link?: string\n  announcement_id?: string\n  read_at?: string\n  created_at: string\n}\n\nexport interface Timetable {\n  id: string\n  class_id: string\n  period_duration_minutes: number\n  break_duration_minutes: number\n  total_periods_per_day: number\n  working_days: number[] // [1,2,3,4,5] for Monday-Friday\n  start_time: string\n  status: 'draft' | 'final'\n  created_by: string\n  created_at: string\n  updated_at: string\n}\n\nexport interface TimetableEntry {\n  id: string\n  timetable_id: string\n  day_of_week: number // 1=Monday, 7=Sunday\n  period_number: number\n  is_break: boolean\n  subject?: string\n  teacher_id?: string\n  class_id?: string\n  start_time?: string\n  end_time?: string\n}\n\nexport interface Syllabus {\n  id: string\n  class_id: string\n  class_name: string\n  subject: string\n  term: 'first_term' | 'second_term' | 'third_term' | 'annual'\n  year: number\n  file_url: string\n  file_name: string\n  file_type: string\n  file_size?: number\n  uploaded_by: string\n  upload_date: string\n  created_at: string\n  updated_at: string\n}\n\n// API Response types\nexport interface LoginResponse {\n  access_token: string\n  token_type: string\n  user: User\n}\n\nexport interface ApiError {\n  detail: string\n}\n\n\n\n\n\n\n\n\n\n\n\n","usedDeprecatedRules":[]}]